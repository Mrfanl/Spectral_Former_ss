/home/amax/anaconda3/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
height=145,width=145,band=200
**************************************************
patch is : 7
mirror_image shape : [151,151,200]
**************************************************
x_train shape = (512, 7, 7, 200), type = float64
x_test  shape = (9737, 7, 7, 200), type = float64
x_true  shape = (21025, 7, 7, 200), type = float64
**************************************************
x_train_band shape = (512, 147, 200), type = float64
x_test_band  shape = (9737, 147, 200), type = float64
x_true_band  shape = (21025, 147, 200), type = float64
**************************************************
y_train: shape = (512,) ,type = int64
y_test: shape = (9737,) ,type = int64
y_true: shape = (21025,) ,type = int64
**************************************************
start training
Epoch: 001 train_loss: 2.5226 train_acc: 19.9219
Epoch: 002 train_loss: 2.3262 train_acc: 24.0234
Epoch: 003 train_loss: 2.2015 train_acc: 34.5703
Epoch: 004 train_loss: 2.0449 train_acc: 36.1328
Epoch: 005 train_loss: 1.9080 train_acc: 37.6953
Epoch: 006 train_loss: 1.8310 train_acc: 37.8906
Epoch: 007 train_loss: 1.7601 train_acc: 40.0391
Epoch: 008 train_loss: 1.7214 train_acc: 40.4297
Epoch: 009 train_loss: 1.6831 train_acc: 42.9688
Epoch: 010 train_loss: 1.6469 train_acc: 42.9688
Epoch: 011 train_loss: 1.6360 train_acc: 42.5781
Epoch: 012 train_loss: 1.5929 train_acc: 43.9453
Epoch: 013 train_loss: 1.5672 train_acc: 44.9219
Epoch: 014 train_loss: 1.5420 train_acc: 44.9219
Epoch: 015 train_loss: 1.5329 train_acc: 45.3125
Epoch: 016 train_loss: 1.5083 train_acc: 46.2891
Epoch: 017 train_loss: 1.4816 train_acc: 47.0703
Epoch: 018 train_loss: 1.4860 train_acc: 47.2656
Epoch: 019 train_loss: 1.4653 train_acc: 48.0469
Epoch: 020 train_loss: 1.4366 train_acc: 47.8516
Epoch: 021 train_loss: 1.4300 train_acc: 46.8750
Epoch: 022 train_loss: 1.4224 train_acc: 48.8281
Epoch: 023 train_loss: 1.4263 train_acc: 48.8281
Epoch: 024 train_loss: 1.4079 train_acc: 47.4609
Epoch: 025 train_loss: 1.3842 train_acc: 49.8047
Epoch: 026 train_loss: 1.3685 train_acc: 49.4141
Epoch: 027 train_loss: 1.3557 train_acc: 49.6094
Epoch: 028 train_loss: 1.3555 train_acc: 49.0234
Epoch: 029 train_loss: 1.3691 train_acc: 48.6328
Epoch: 030 train_loss: 1.3372 train_acc: 50.3906
Epoch: 031 train_loss: 1.3255 train_acc: 49.6094
Epoch: 032 train_loss: 1.3218 train_acc: 49.8047
Epoch: 033 train_loss: 1.3042 train_acc: 50.5859
Epoch: 034 train_loss: 1.3077 train_acc: 51.3672
Epoch: 035 train_loss: 1.2957 train_acc: 51.3672
Epoch: 036 train_loss: 1.2843 train_acc: 50.0000
Epoch: 037 train_loss: 1.2772 train_acc: 50.0000
Epoch: 038 train_loss: 1.2718 train_acc: 52.1484
Epoch: 039 train_loss: 1.2567 train_acc: 51.5625
Epoch: 040 train_loss: 1.2665 train_acc: 52.3438
Epoch: 041 train_loss: 1.2436 train_acc: 54.6875
Epoch: 042 train_loss: 1.2537 train_acc: 51.7578
Epoch: 043 train_loss: 1.2438 train_acc: 51.9531
Epoch: 044 train_loss: 1.2131 train_acc: 53.5156
Epoch: 045 train_loss: 1.2034 train_acc: 55.0781
Epoch: 046 train_loss: 1.1981 train_acc: 54.2969
Epoch: 047 train_loss: 1.1959 train_acc: 53.9062
Epoch: 048 train_loss: 1.1821 train_acc: 53.9062
Epoch: 049 train_loss: 1.1967 train_acc: 55.6641
Epoch: 050 train_loss: 1.1931 train_acc: 53.7109
Epoch: 051 train_loss: 1.1407 train_acc: 55.4688
Epoch: 052 train_loss: 1.1466 train_acc: 55.8594
Epoch: 053 train_loss: 1.2115 train_acc: 51.5625
Epoch: 054 train_loss: 1.1885 train_acc: 54.2969
Epoch: 055 train_loss: 1.1762 train_acc: 56.0547
Epoch: 056 train_loss: 1.1661 train_acc: 54.4922
Epoch: 057 train_loss: 1.1235 train_acc: 57.2266
Epoch: 058 train_loss: 1.1188 train_acc: 55.4688
Epoch: 059 train_loss: 1.1173 train_acc: 55.6641
Epoch: 060 train_loss: 1.1055 train_acc: 56.8359
Epoch: 061 train_loss: 1.1075 train_acc: 55.6641
Epoch: 062 train_loss: 1.0641 train_acc: 58.3984
Epoch: 063 train_loss: 1.0834 train_acc: 59.1797
Epoch: 064 train_loss: 1.0834 train_acc: 57.2266
Epoch: 065 train_loss: 1.0758 train_acc: 57.6172
Epoch: 066 train_loss: 1.0523 train_acc: 59.3750
Epoch: 067 train_loss: 1.0491 train_acc: 59.5703
Epoch: 068 train_loss: 1.0808 train_acc: 58.7891
Epoch: 069 train_loss: 1.0334 train_acc: 59.7656
Epoch: 070 train_loss: 1.0252 train_acc: 61.5234
Epoch: 071 train_loss: 1.0416 train_acc: 60.3516
Epoch: 072 train_loss: 1.0480 train_acc: 58.9844
Epoch: 073 train_loss: 1.0089 train_acc: 58.9844
Epoch: 074 train_loss: 1.0074 train_acc: 59.3750
Epoch: 075 train_loss: 1.0299 train_acc: 59.1797
Epoch: 076 train_loss: 1.0347 train_acc: 60.9375
Epoch: 077 train_loss: 1.0209 train_acc: 60.3516
Epoch: 078 train_loss: 0.9919 train_acc: 61.3281
Epoch: 079 train_loss: 0.9688 train_acc: 63.2812
Epoch: 080 train_loss: 0.9598 train_acc: 63.0859
Epoch: 081 train_loss: 0.9801 train_acc: 62.6953
Epoch: 082 train_loss: 0.9634 train_acc: 61.7188
Epoch: 083 train_loss: 0.9235 train_acc: 64.2578
Epoch: 084 train_loss: 0.9304 train_acc: 62.8906
Epoch: 085 train_loss: 0.9544 train_acc: 63.0859
Epoch: 086 train_loss: 0.9805 train_acc: 61.9141
Epoch: 087 train_loss: 0.9396 train_acc: 61.5234
Epoch: 088 train_loss: 0.9496 train_acc: 63.8672
Epoch: 089 train_loss: 0.9497 train_acc: 61.7188
Epoch: 090 train_loss: 0.9265 train_acc: 63.8672
Epoch: 091 train_loss: 0.8971 train_acc: 64.0625
Epoch: 092 train_loss: 0.8737 train_acc: 66.9922
Epoch: 093 train_loss: 0.8650 train_acc: 65.4297
Epoch: 094 train_loss: 0.8673 train_acc: 69.5312
Epoch: 095 train_loss: 0.8441 train_acc: 68.9453
Epoch: 096 train_loss: 0.8515 train_acc: 65.8203
Epoch: 097 train_loss: 0.8633 train_acc: 67.5781
Epoch: 098 train_loss: 0.8654 train_acc: 66.2109
Epoch: 099 train_loss: 0.8583 train_acc: 66.6016
Epoch: 100 train_loss: 0.8294 train_acc: 69.5312
Epoch: 101 train_loss: 0.7904 train_acc: 69.3359
Epoch: 102 train_loss: 0.8066 train_acc: 69.5312
Epoch: 103 train_loss: 0.8057 train_acc: 68.7500
Epoch: 104 train_loss: 0.8617 train_acc: 67.1875
Epoch: 105 train_loss: 0.8197 train_acc: 70.5078
Epoch: 106 train_loss: 0.7829 train_acc: 71.6797
Epoch: 107 train_loss: 0.7882 train_acc: 69.7266
Epoch: 108 train_loss: 0.8488 train_acc: 67.3828
Epoch: 109 train_loss: 0.8597 train_acc: 67.9688
Epoch: 110 train_loss: 0.8101 train_acc: 71.2891
Epoch: 111 train_loss: 0.7600 train_acc: 73.4375
Epoch: 112 train_loss: 0.7409 train_acc: 74.6094
Epoch: 113 train_loss: 0.7756 train_acc: 71.8750
Epoch: 114 train_loss: 0.8094 train_acc: 70.7031
Epoch: 115 train_loss: 0.7920 train_acc: 69.3359
Epoch: 116 train_loss: 0.7589 train_acc: 71.4844
Epoch: 117 train_loss: 0.7272 train_acc: 74.8047
Epoch: 118 train_loss: 0.6893 train_acc: 74.6094
Epoch: 119 train_loss: 0.6952 train_acc: 75.7812
Epoch: 120 train_loss: 0.6821 train_acc: 76.1719
Epoch: 121 train_loss: 0.7000 train_acc: 73.2422
Epoch: 122 train_loss: 0.6901 train_acc: 74.2188
Epoch: 123 train_loss: 0.6423 train_acc: 76.1719
Epoch: 124 train_loss: 0.6692 train_acc: 74.2188
Epoch: 125 train_loss: 0.6825 train_acc: 74.4141
Epoch: 126 train_loss: 0.6499 train_acc: 76.1719
Epoch: 127 train_loss: 0.6989 train_acc: 75.9766
Epoch: 128 train_loss: 0.7427 train_acc: 74.0234
Epoch: 129 train_loss: 0.6836 train_acc: 74.6094
Epoch: 130 train_loss: 0.6505 train_acc: 77.1484
Epoch: 131 train_loss: 0.6376 train_acc: 75.9766
Epoch: 132 train_loss: 0.6223 train_acc: 80.0781
Epoch: 133 train_loss: 0.6059 train_acc: 79.4922
Epoch: 134 train_loss: 0.7187 train_acc: 72.0703
Epoch: 135 train_loss: 0.6549 train_acc: 74.4141
Epoch: 136 train_loss: 0.6087 train_acc: 78.9062
Epoch: 137 train_loss: 0.6084 train_acc: 76.9531
Epoch: 138 train_loss: 0.6135 train_acc: 78.1250
Epoch: 139 train_loss: 0.5899 train_acc: 79.4922
Epoch: 140 train_loss: 0.5515 train_acc: 81.0547
Epoch: 141 train_loss: 0.6041 train_acc: 77.5391
Epoch: 142 train_loss: 0.6024 train_acc: 79.4922
Epoch: 143 train_loss: 0.6229 train_acc: 75.9766
Epoch: 144 train_loss: 0.6132 train_acc: 76.1719
Epoch: 145 train_loss: 0.5927 train_acc: 78.9062
Epoch: 146 train_loss: 0.5880 train_acc: 77.5391
Epoch: 147 train_loss: 0.5384 train_acc: 83.0078
Epoch: 148 train_loss: 0.5863 train_acc: 78.9062
Epoch: 149 train_loss: 0.5898 train_acc: 79.2969
Epoch: 150 train_loss: 0.5906 train_acc: 79.2969
Epoch: 151 train_loss: 0.5395 train_acc: 80.4688
Epoch: 152 train_loss: 0.5726 train_acc: 78.7109
Epoch: 153 train_loss: 0.5829 train_acc: 77.1484
Epoch: 154 train_loss: 0.5336 train_acc: 82.8125
Epoch: 155 train_loss: 0.5113 train_acc: 82.6172
Epoch: 156 train_loss: 0.4642 train_acc: 85.5469
Epoch: 157 train_loss: 0.5065 train_acc: 82.2266
Epoch: 158 train_loss: 0.4576 train_acc: 84.1797
Epoch: 159 train_loss: 0.4496 train_acc: 85.7422
Epoch: 160 train_loss: 0.4708 train_acc: 83.9844
Epoch: 161 train_loss: 0.5023 train_acc: 83.5938
Epoch: 162 train_loss: 0.4750 train_acc: 85.1562
Epoch: 163 train_loss: 0.4423 train_acc: 84.9609
Epoch: 164 train_loss: 0.4791 train_acc: 82.8125
Epoch: 165 train_loss: 0.5201 train_acc: 81.6406
Epoch: 166 train_loss: 0.4881 train_acc: 83.7891
Epoch: 167 train_loss: 0.4906 train_acc: 83.2031
Epoch: 168 train_loss: 0.4333 train_acc: 85.9375
Epoch: 169 train_loss: 0.4617 train_acc: 84.7656
Epoch: 170 train_loss: 0.4812 train_acc: 82.8125
Epoch: 171 train_loss: 0.4229 train_acc: 85.1562
Epoch: 172 train_loss: 0.4661 train_acc: 83.0078
Epoch: 173 train_loss: 0.4544 train_acc: 83.9844
Epoch: 174 train_loss: 0.4497 train_acc: 84.9609
Epoch: 175 train_loss: 0.3981 train_acc: 85.7422
Epoch: 176 train_loss: 0.3716 train_acc: 88.6719
Epoch: 177 train_loss: 0.3910 train_acc: 86.5234
Epoch: 178 train_loss: 0.3992 train_acc: 85.7422
Epoch: 179 train_loss: 0.4300 train_acc: 85.1562
Epoch: 180 train_loss: 0.3882 train_acc: 88.2812
Epoch: 181 train_loss: 0.3764 train_acc: 87.8906
Epoch: 182 train_loss: 0.4233 train_acc: 86.1328
Epoch: 183 train_loss: 0.3983 train_acc: 86.1328
Epoch: 184 train_loss: 0.3669 train_acc: 86.7188
Epoch: 185 train_loss: 0.3882 train_acc: 87.6953
Epoch: 186 train_loss: 0.3726 train_acc: 86.1328
Epoch: 187 train_loss: 0.4538 train_acc: 84.7656
Epoch: 188 train_loss: 0.4456 train_acc: 85.1562
Epoch: 189 train_loss: 0.3857 train_acc: 87.5000
Epoch: 190 train_loss: 0.3724 train_acc: 88.0859
Epoch: 191 train_loss: 0.3497 train_acc: 90.0391
Epoch: 192 train_loss: 0.3841 train_acc: 87.5000
Epoch: 193 train_loss: 0.4195 train_acc: 85.7422
Epoch: 194 train_loss: 0.4296 train_acc: 85.1562
Epoch: 195 train_loss: 0.4008 train_acc: 85.5469
Epoch: 196 train_loss: 0.3374 train_acc: 89.2578
Epoch: 197 train_loss: 0.3331 train_acc: 88.8672
Epoch: 198 train_loss: 0.3276 train_acc: 89.4531
Epoch: 199 train_loss: 0.3674 train_acc: 88.8672
Epoch: 200 train_loss: 0.3511 train_acc: 89.0625
Epoch: 201 train_loss: 0.3393 train_acc: 89.4531
Epoch: 202 train_loss: 0.3542 train_acc: 89.0625
Epoch: 203 train_loss: 0.3512 train_acc: 86.1328
Epoch: 204 train_loss: 0.3218 train_acc: 89.6484
Epoch: 205 train_loss: 0.3552 train_acc: 89.2578
Epoch: 206 train_loss: 0.2957 train_acc: 90.4297
Epoch: 207 train_loss: 0.3001 train_acc: 90.4297
Epoch: 208 train_loss: 0.3397 train_acc: 89.2578
Epoch: 209 train_loss: 0.3184 train_acc: 88.6719
Epoch: 210 train_loss: 0.2965 train_acc: 91.2109
Epoch: 211 train_loss: 0.3112 train_acc: 91.4062
Epoch: 212 train_loss: 0.3349 train_acc: 88.0859
Epoch: 213 train_loss: 0.2964 train_acc: 91.6016
Epoch: 214 train_loss: 0.2819 train_acc: 91.2109
Epoch: 215 train_loss: 0.2693 train_acc: 91.9922
Epoch: 216 train_loss: 0.2615 train_acc: 92.5781
Epoch: 217 train_loss: 0.2554 train_acc: 93.5547
Epoch: 218 train_loss: 0.2700 train_acc: 92.3828
Epoch: 219 train_loss: 0.2516 train_acc: 92.7734
Epoch: 220 train_loss: 0.2719 train_acc: 92.3828
Epoch: 221 train_loss: 0.3104 train_acc: 89.6484
Epoch: 222 train_loss: 0.2633 train_acc: 92.3828
Epoch: 223 train_loss: 0.3081 train_acc: 90.4297
Epoch: 224 train_loss: 0.3339 train_acc: 87.8906
Epoch: 225 train_loss: 0.2659 train_acc: 91.9922
Epoch: 226 train_loss: 0.2622 train_acc: 92.5781
Epoch: 227 train_loss: 0.2525 train_acc: 93.5547
Epoch: 228 train_loss: 0.2842 train_acc: 91.0156
Epoch: 229 train_loss: 0.2386 train_acc: 93.3594
Epoch: 230 train_loss: 0.2620 train_acc: 90.8203
Epoch: 231 train_loss: 0.2483 train_acc: 93.3594
Epoch: 232 train_loss: 0.2214 train_acc: 93.3594
Epoch: 233 train_loss: 0.2462 train_acc: 92.1875
Epoch: 234 train_loss: 0.2344 train_acc: 92.9688
Epoch: 235 train_loss: 0.2486 train_acc: 92.3828
Epoch: 236 train_loss: 0.2823 train_acc: 90.6250
Epoch: 237 train_loss: 0.3105 train_acc: 90.2344
Epoch: 238 train_loss: 0.3209 train_acc: 89.6484
Epoch: 239 train_loss: 0.3041 train_acc: 91.9922
Epoch: 240 train_loss: 0.2822 train_acc: 90.2344
Epoch: 241 train_loss: 0.2630 train_acc: 91.7969
Epoch: 242 train_loss: 0.2330 train_acc: 93.3594
Epoch: 243 train_loss: 0.2474 train_acc: 93.5547
Epoch: 244 train_loss: 0.2447 train_acc: 92.5781
Epoch: 245 train_loss: 0.2194 train_acc: 93.5547
Epoch: 246 train_loss: 0.1970 train_acc: 94.7266
Epoch: 247 train_loss: 0.2242 train_acc: 93.1641
Epoch: 248 train_loss: 0.2527 train_acc: 91.7969
Epoch: 249 train_loss: 0.1911 train_acc: 94.9219
Epoch: 250 train_loss: 0.2253 train_acc: 93.3594
Epoch: 251 train_loss: 0.2111 train_acc: 93.7500
Epoch: 252 train_loss: 0.2189 train_acc: 94.1406
Epoch: 253 train_loss: 0.2189 train_acc: 93.9453
Epoch: 254 train_loss: 0.2579 train_acc: 91.7969
Epoch: 255 train_loss: 0.1942 train_acc: 94.9219
Epoch: 256 train_loss: 0.1965 train_acc: 95.8984
Epoch: 257 train_loss: 0.1993 train_acc: 94.9219
Epoch: 258 train_loss: 0.1985 train_acc: 94.3359
Epoch: 259 train_loss: 0.1873 train_acc: 95.5078
Epoch: 260 train_loss: 0.1985 train_acc: 94.7266
Epoch: 261 train_loss: 0.2018 train_acc: 94.5312
Epoch: 262 train_loss: 0.1980 train_acc: 94.3359
Epoch: 263 train_loss: 0.2725 train_acc: 92.3828
Epoch: 264 train_loss: 0.1793 train_acc: 96.2891
Epoch: 265 train_loss: 0.2008 train_acc: 94.7266
Epoch: 266 train_loss: 0.1859 train_acc: 95.7031
Epoch: 267 train_loss: 0.2021 train_acc: 94.7266
Epoch: 268 train_loss: 0.1864 train_acc: 94.9219
Epoch: 269 train_loss: 0.2234 train_acc: 93.1641
Epoch: 270 train_loss: 0.1716 train_acc: 96.0938
Epoch: 271 train_loss: 0.1553 train_acc: 96.6797
Epoch: 272 train_loss: 0.2286 train_acc: 94.1406
Epoch: 273 train_loss: 0.1866 train_acc: 95.3125
Epoch: 274 train_loss: 0.1969 train_acc: 94.3359
Epoch: 275 train_loss: 0.1974 train_acc: 95.7031
Epoch: 276 train_loss: 0.1808 train_acc: 93.7500
Epoch: 277 train_loss: 0.1831 train_acc: 94.5312
Epoch: 278 train_loss: 0.1959 train_acc: 93.9453
Epoch: 279 train_loss: 0.2088 train_acc: 94.1406
Epoch: 280 train_loss: 0.1906 train_acc: 94.7266
Epoch: 281 train_loss: 0.1784 train_acc: 95.5078
Epoch: 282 train_loss: 0.1869 train_acc: 94.7266
Epoch: 283 train_loss: 0.2303 train_acc: 93.7500
Epoch: 284 train_loss: 0.2049 train_acc: 94.7266
Epoch: 285 train_loss: 0.2145 train_acc: 93.3594
Epoch: 286 train_loss: 0.1979 train_acc: 94.5312
Epoch: 287 train_loss: 0.2134 train_acc: 94.9219
Epoch: 288 train_loss: 0.1719 train_acc: 94.9219
Epoch: 289 train_loss: 0.1454 train_acc: 96.4844
Epoch: 290 train_loss: 0.1906 train_acc: 94.1406
Epoch: 291 train_loss: 0.1674 train_acc: 95.1172
Epoch: 292 train_loss: 0.1733 train_acc: 95.1172
Epoch: 293 train_loss: 0.1516 train_acc: 96.6797
Epoch: 294 train_loss: 0.1542 train_acc: 95.8984
Epoch: 295 train_loss: 0.1512 train_acc: 97.0703
Epoch: 296 train_loss: 0.1476 train_acc: 96.6797
Epoch: 297 train_loss: 0.1649 train_acc: 95.8984
Epoch: 298 train_loss: 0.1681 train_acc: 96.2891
Epoch: 299 train_loss: 0.1544 train_acc: 96.2891
Epoch: 300 train_loss: 0.1560 train_acc: 95.8984
Running Time: 173.87
**************************************************
Final result:
OA: 0.7954 | AA: 0.6608 | Kappa: 0.7676
[0.25       0.78776713 0.84010152 0.72       0.84313725 0.90634006
 0.         0.95594714 0.05263158 0.73347779 0.78559177 0.70515098
 0.99487179 0.86439268 0.54223433 0.59090909]
**************************************************
Parameter:
dataset: Indian
flag_test: train
mode: CAF
gpu_id: 0
seed: 0
batch_size: 64
test_freq: 5
patches: 7
band_patches: 3
epoches: 300
learning_rate: 0.0005
gamma: 0.9
weight_decay: 0.005
height=145,width=145,band=200
**************************************************
patch is : 7
mirror_image shape : [151,151,200]
**************************************************
x_train shape = (512, 7, 7, 200), type = float64
x_test  shape = (9737, 7, 7, 200), type = float64
x_true  shape = (21025, 7, 7, 200), type = float64
/home/amax/anaconda3/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
**************************************************
x_train_band shape = (512, 147, 200), type = float64
x_test_band  shape = (9737, 147, 200), type = float64
x_true_band  shape = (21025, 147, 200), type = float64
**************************************************
y_train: shape = (512,) ,type = int64
y_test: shape = (9737,) ,type = int64
y_true: shape = (21025,) ,type = int64
**************************************************
start training
Epoch: 001 train_loss: 2.5345 train_acc: 19.1406
Epoch: 002 train_loss: 2.3568 train_acc: 24.0234
Epoch: 003 train_loss: 2.2840 train_acc: 24.2188
Epoch: 004 train_loss: 2.1482 train_acc: 34.7656
Epoch: 005 train_loss: 1.9704 train_acc: 35.7422
Epoch: 006 train_loss: 1.8820 train_acc: 37.8906
Epoch: 007 train_loss: 1.8011 train_acc: 40.0391
Epoch: 008 train_loss: 1.7498 train_acc: 40.4297
Epoch: 009 train_loss: 1.7177 train_acc: 41.2109
Epoch: 010 train_loss: 1.6951 train_acc: 42.3828
Epoch: 011 train_loss: 1.6427 train_acc: 42.7734
Epoch: 012 train_loss: 1.6381 train_acc: 41.2109
Epoch: 013 train_loss: 1.5999 train_acc: 43.7500
Epoch: 014 train_loss: 1.5781 train_acc: 45.1172
Epoch: 015 train_loss: 1.5350 train_acc: 45.8984
Epoch: 016 train_loss: 1.5046 train_acc: 47.0703
Epoch: 017 train_loss: 1.4603 train_acc: 47.2656
Epoch: 018 train_loss: 1.4415 train_acc: 48.4375
Epoch: 019 train_loss: 1.4229 train_acc: 48.4375
Epoch: 020 train_loss: 1.4117 train_acc: 49.2188
Epoch: 021 train_loss: 1.4049 train_acc: 48.8281
Epoch: 022 train_loss: 1.3943 train_acc: 49.4141
Epoch: 023 train_loss: 1.3793 train_acc: 49.8047
Epoch: 024 train_loss: 1.3689 train_acc: 49.2188
Epoch: 025 train_loss: 1.3547 train_acc: 48.4375
Epoch: 026 train_loss: 1.3540 train_acc: 50.9766
Epoch: 027 train_loss: 1.3122 train_acc: 51.5625
Epoch: 028 train_loss: 1.3197 train_acc: 50.0000
Epoch: 029 train_loss: 1.3090 train_acc: 50.9766
Epoch: 030 train_loss: 1.3039 train_acc: 50.5859
Epoch: 031 train_loss: 1.3002 train_acc: 51.5625
Epoch: 032 train_loss: 1.2819 train_acc: 51.5625
Epoch: 033 train_loss: 1.2801 train_acc: 51.1719
Epoch: 034 train_loss: 1.2624 train_acc: 50.0000
Epoch: 035 train_loss: 1.2594 train_acc: 52.7344
Epoch: 036 train_loss: 1.2484 train_acc: 52.1484
Epoch: 037 train_loss: 1.2535 train_acc: 52.5391
Epoch: 038 train_loss: 1.2471 train_acc: 51.7578
Epoch: 039 train_loss: 1.2441 train_acc: 52.3438
Epoch: 040 train_loss: 1.2428 train_acc: 53.7109
Epoch: 041 train_loss: 1.2385 train_acc: 52.3438
Epoch: 042 train_loss: 1.2285 train_acc: 51.9531
Epoch: 043 train_loss: 1.2035 train_acc: 53.5156
Epoch: 044 train_loss: 1.2172 train_acc: 52.7344
Epoch: 045 train_loss: 1.2111 train_acc: 53.5156
Epoch: 046 train_loss: 1.2113 train_acc: 53.7109
Epoch: 047 train_loss: 1.1854 train_acc: 54.8828
Epoch: 048 train_loss: 1.1622 train_acc: 54.2969
Epoch: 049 train_loss: 1.1621 train_acc: 55.8594
Epoch: 050 train_loss: 1.1605 train_acc: 55.8594
Epoch: 051 train_loss: 1.1498 train_acc: 55.0781
Epoch: 052 train_loss: 1.1312 train_acc: 55.8594
Epoch: 053 train_loss: 1.1252 train_acc: 57.8125
Epoch: 054 train_loss: 1.1377 train_acc: 58.0078
Epoch: 055 train_loss: 1.1271 train_acc: 55.2734
Epoch: 056 train_loss: 1.1278 train_acc: 55.6641
Epoch: 057 train_loss: 1.1316 train_acc: 57.2266
Epoch: 058 train_loss: 1.1029 train_acc: 57.0312
Epoch: 059 train_loss: 1.1007 train_acc: 56.2500
Epoch: 060 train_loss: 1.0963 train_acc: 57.6172
Epoch: 061 train_loss: 1.0613 train_acc: 57.2266
Epoch: 062 train_loss: 1.0438 train_acc: 59.9609
Epoch: 063 train_loss: 1.0778 train_acc: 55.6641
Epoch: 064 train_loss: 1.0402 train_acc: 59.1797
Epoch: 065 train_loss: 1.0384 train_acc: 58.2031
Epoch: 066 train_loss: 1.0220 train_acc: 59.5703
Epoch: 067 train_loss: 1.0674 train_acc: 56.2500
Epoch: 068 train_loss: 1.1324 train_acc: 53.1250
Epoch: 069 train_loss: 1.0753 train_acc: 59.5703
Epoch: 070 train_loss: 1.1065 train_acc: 58.9844
Epoch: 071 train_loss: 1.0288 train_acc: 62.1094
Epoch: 072 train_loss: 0.9862 train_acc: 62.3047
Epoch: 073 train_loss: 0.9778 train_acc: 62.3047
Epoch: 074 train_loss: 0.9651 train_acc: 61.9141
Epoch: 075 train_loss: 0.9731 train_acc: 62.6953
Epoch: 076 train_loss: 0.9310 train_acc: 63.6719
Epoch: 077 train_loss: 0.9273 train_acc: 64.4531
Epoch: 078 train_loss: 0.9279 train_acc: 62.6953
Epoch: 079 train_loss: 0.9405 train_acc: 62.3047
Epoch: 080 train_loss: 0.9504 train_acc: 63.2812
Epoch: 081 train_loss: 0.9388 train_acc: 62.1094
Epoch: 082 train_loss: 0.9095 train_acc: 65.8203
Epoch: 083 train_loss: 0.9527 train_acc: 61.1328
Epoch: 084 train_loss: 0.8936 train_acc: 64.6484
Epoch: 085 train_loss: 0.8723 train_acc: 67.3828
Epoch: 086 train_loss: 0.8559 train_acc: 66.7969
Epoch: 087 train_loss: 0.9635 train_acc: 59.9609
Epoch: 088 train_loss: 0.8890 train_acc: 65.0391
Epoch: 089 train_loss: 0.8838 train_acc: 64.2578
Epoch: 090 train_loss: 0.8866 train_acc: 65.6250
Epoch: 091 train_loss: 0.8282 train_acc: 67.3828
Epoch: 092 train_loss: 0.9021 train_acc: 64.4531
Epoch: 093 train_loss: 0.9040 train_acc: 66.7969
Epoch: 094 train_loss: 0.8705 train_acc: 64.8438
Epoch: 095 train_loss: 0.8319 train_acc: 67.7734
Epoch: 096 train_loss: 0.7788 train_acc: 71.6797
Epoch: 097 train_loss: 0.8023 train_acc: 69.1406
Epoch: 098 train_loss: 0.7747 train_acc: 69.3359
Epoch: 099 train_loss: 0.8460 train_acc: 67.9688
Epoch: 100 train_loss: 0.8776 train_acc: 66.2109
Epoch: 101 train_loss: 0.7853 train_acc: 71.8750
Epoch: 102 train_loss: 0.7639 train_acc: 69.1406
Epoch: 103 train_loss: 0.7420 train_acc: 73.4375
Epoch: 104 train_loss: 0.7353 train_acc: 70.7031
Epoch: 105 train_loss: 0.7151 train_acc: 73.8281
Epoch: 106 train_loss: 0.7144 train_acc: 70.8984
Epoch: 107 train_loss: 0.6901 train_acc: 74.6094
Epoch: 108 train_loss: 0.6995 train_acc: 73.2422
Epoch: 109 train_loss: 0.7038 train_acc: 75.5859
Epoch: 110 train_loss: 0.7474 train_acc: 72.4609
Epoch: 111 train_loss: 0.7371 train_acc: 71.6797
Epoch: 112 train_loss: 0.7048 train_acc: 74.6094
Epoch: 113 train_loss: 0.6880 train_acc: 73.8281
Epoch: 114 train_loss: 0.6722 train_acc: 75.1953
Epoch: 115 train_loss: 0.6477 train_acc: 76.7578
Epoch: 116 train_loss: 0.6951 train_acc: 75.1953
Epoch: 117 train_loss: 0.6631 train_acc: 76.9531
Epoch: 118 train_loss: 0.6332 train_acc: 75.9766
Epoch: 119 train_loss: 0.6423 train_acc: 76.3672
Epoch: 120 train_loss: 0.6578 train_acc: 76.3672
Epoch: 121 train_loss: 0.6357 train_acc: 78.5156
Epoch: 122 train_loss: 0.6487 train_acc: 76.7578
Epoch: 123 train_loss: 0.6181 train_acc: 80.8594
Epoch: 124 train_loss: 0.6111 train_acc: 78.3203
Epoch: 125 train_loss: 0.6282 train_acc: 78.3203
Epoch: 126 train_loss: 0.6199 train_acc: 79.6875
Epoch: 127 train_loss: 0.6052 train_acc: 76.3672
Epoch: 128 train_loss: 0.6302 train_acc: 77.7344
Epoch: 129 train_loss: 0.6109 train_acc: 79.1016
Epoch: 130 train_loss: 0.6456 train_acc: 76.5625
Epoch: 131 train_loss: 0.6007 train_acc: 79.1016
Epoch: 132 train_loss: 0.6060 train_acc: 76.9531
Epoch: 133 train_loss: 0.5694 train_acc: 80.0781
Epoch: 134 train_loss: 0.5716 train_acc: 79.4922
Epoch: 135 train_loss: 0.5635 train_acc: 80.2734
Epoch: 136 train_loss: 0.5796 train_acc: 80.8594
Epoch: 137 train_loss: 0.5530 train_acc: 80.6641
Epoch: 138 train_loss: 0.5177 train_acc: 83.0078
Epoch: 139 train_loss: 0.5417 train_acc: 81.6406
Epoch: 140 train_loss: 0.5463 train_acc: 83.9844
Epoch: 141 train_loss: 0.5990 train_acc: 79.2969
Epoch: 142 train_loss: 0.5849 train_acc: 79.4922
Epoch: 143 train_loss: 0.4845 train_acc: 84.1797
Epoch: 144 train_loss: 0.4997 train_acc: 84.9609
Epoch: 145 train_loss: 0.5221 train_acc: 81.2500
Epoch: 146 train_loss: 0.5176 train_acc: 83.5938
Epoch: 147 train_loss: 0.4947 train_acc: 83.5938
Epoch: 148 train_loss: 0.4841 train_acc: 83.9844
Epoch: 149 train_loss: 0.4916 train_acc: 83.9844
Epoch: 150 train_loss: 0.4739 train_acc: 84.7656
Epoch: 151 train_loss: 0.4725 train_acc: 84.3750
Epoch: 152 train_loss: 0.4566 train_acc: 84.9609
Epoch: 153 train_loss: 0.4637 train_acc: 84.7656
Epoch: 154 train_loss: 0.4481 train_acc: 87.3047
Epoch: 155 train_loss: 0.4204 train_acc: 85.3516
Epoch: 156 train_loss: 0.4674 train_acc: 85.1562
Epoch: 157 train_loss: 0.4680 train_acc: 83.5938
Epoch: 158 train_loss: 0.4484 train_acc: 87.3047
Epoch: 159 train_loss: 0.4083 train_acc: 86.7188
Epoch: 160 train_loss: 0.4252 train_acc: 85.3516
Epoch: 161 train_loss: 0.4296 train_acc: 87.6953
Epoch: 162 train_loss: 0.4514 train_acc: 84.5703
Epoch: 163 train_loss: 0.3878 train_acc: 88.2812
Epoch: 164 train_loss: 0.3611 train_acc: 90.4297
Epoch: 165 train_loss: 0.3927 train_acc: 87.3047
Epoch: 166 train_loss: 0.3607 train_acc: 91.4062
Epoch: 167 train_loss: 0.3810 train_acc: 89.2578
Epoch: 168 train_loss: 0.3692 train_acc: 88.0859
Epoch: 169 train_loss: 0.3882 train_acc: 87.3047
Epoch: 170 train_loss: 0.4052 train_acc: 86.9141
Epoch: 171 train_loss: 0.3675 train_acc: 89.2578
Epoch: 172 train_loss: 0.3635 train_acc: 89.0625
Epoch: 173 train_loss: 0.3767 train_acc: 88.8672
Epoch: 174 train_loss: 0.4183 train_acc: 85.5469
Epoch: 175 train_loss: 0.3861 train_acc: 86.9141
Epoch: 176 train_loss: 0.4010 train_acc: 88.4766
Epoch: 177 train_loss: 0.3552 train_acc: 89.0625
Epoch: 178 train_loss: 0.3975 train_acc: 87.6953
Epoch: 179 train_loss: 0.4032 train_acc: 85.7422
Epoch: 180 train_loss: 0.3352 train_acc: 90.4297
Epoch: 181 train_loss: 0.3090 train_acc: 91.0156
Epoch: 182 train_loss: 0.3135 train_acc: 91.4062
Epoch: 183 train_loss: 0.3263 train_acc: 90.6250
Epoch: 184 train_loss: 0.3719 train_acc: 87.8906
Epoch: 185 train_loss: 0.3747 train_acc: 88.6719
Epoch: 186 train_loss: 0.3705 train_acc: 88.2812
Epoch: 187 train_loss: 0.3532 train_acc: 88.6719
Epoch: 188 train_loss: 0.3115 train_acc: 90.2344
Epoch: 189 train_loss: 0.2859 train_acc: 91.4062
Epoch: 190 train_loss: 0.3030 train_acc: 91.4062
Epoch: 191 train_loss: 0.3068 train_acc: 91.0156
Epoch: 192 train_loss: 0.3225 train_acc: 89.4531
Epoch: 193 train_loss: 0.3556 train_acc: 89.0625
Epoch: 194 train_loss: 0.3102 train_acc: 91.0156
Epoch: 195 train_loss: 0.2953 train_acc: 90.6250
Epoch: 196 train_loss: 0.2825 train_acc: 92.1875
Epoch: 197 train_loss: 0.2813 train_acc: 93.9453
Epoch: 198 train_loss: 0.2802 train_acc: 92.3828
Epoch: 199 train_loss: 0.3070 train_acc: 90.4297
Epoch: 200 train_loss: 0.2940 train_acc: 92.5781
Epoch: 201 train_loss: 0.2636 train_acc: 93.5547
Epoch: 202 train_loss: 0.3037 train_acc: 90.0391
Epoch: 203 train_loss: 0.3018 train_acc: 90.2344
Epoch: 204 train_loss: 0.2782 train_acc: 93.1641
Epoch: 205 train_loss: 0.2720 train_acc: 92.9688
Epoch: 206 train_loss: 0.2614 train_acc: 92.3828
Epoch: 207 train_loss: 0.2680 train_acc: 91.2109
Epoch: 208 train_loss: 0.3222 train_acc: 88.8672
Epoch: 209 train_loss: 0.3002 train_acc: 91.2109
Epoch: 210 train_loss: 0.3104 train_acc: 90.0391
Epoch: 211 train_loss: 0.2989 train_acc: 90.8203
Epoch: 212 train_loss: 0.2613 train_acc: 91.6016
Epoch: 213 train_loss: 0.2656 train_acc: 91.4062
Epoch: 214 train_loss: 0.2505 train_acc: 92.5781
Epoch: 215 train_loss: 0.2543 train_acc: 92.3828
Epoch: 216 train_loss: 0.2626 train_acc: 93.5547
Epoch: 217 train_loss: 0.2112 train_acc: 94.3359
Epoch: 218 train_loss: 0.2380 train_acc: 93.3594
Epoch: 219 train_loss: 0.2250 train_acc: 93.9453
Epoch: 220 train_loss: 0.2668 train_acc: 92.9688
Epoch: 221 train_loss: 0.2222 train_acc: 93.5547
Epoch: 222 train_loss: 0.2156 train_acc: 95.3125
Epoch: 223 train_loss: 0.2419 train_acc: 93.3594
Epoch: 224 train_loss: 0.2463 train_acc: 92.3828
Epoch: 225 train_loss: 0.2310 train_acc: 93.7500
Epoch: 226 train_loss: 0.1987 train_acc: 95.5078
Epoch: 227 train_loss: 0.2087 train_acc: 94.5312
Epoch: 228 train_loss: 0.2202 train_acc: 93.1641
Epoch: 229 train_loss: 0.1930 train_acc: 93.9453
Epoch: 230 train_loss: 0.2615 train_acc: 91.4062
Epoch: 231 train_loss: 0.2355 train_acc: 92.5781
Epoch: 232 train_loss: 0.2251 train_acc: 94.7266
Epoch: 233 train_loss: 0.2383 train_acc: 93.5547
Epoch: 234 train_loss: 0.2165 train_acc: 93.1641
Epoch: 235 train_loss: 0.2189 train_acc: 93.9453
Epoch: 236 train_loss: 0.1958 train_acc: 94.5312
Epoch: 237 train_loss: 0.2056 train_acc: 95.5078
Epoch: 238 train_loss: 0.2042 train_acc: 95.3125
Epoch: 239 train_loss: 0.2184 train_acc: 93.1641
Epoch: 240 train_loss: 0.2338 train_acc: 92.1875
Epoch: 241 train_loss: 0.2323 train_acc: 93.7500
Epoch: 242 train_loss: 0.2092 train_acc: 94.1406
Epoch: 243 train_loss: 0.1969 train_acc: 94.7266
Epoch: 244 train_loss: 0.1981 train_acc: 94.3359
Epoch: 245 train_loss: 0.2075 train_acc: 93.3594
Epoch: 246 train_loss: 0.2038 train_acc: 93.3594
Epoch: 247 train_loss: 0.2270 train_acc: 93.1641
Epoch: 248 train_loss: 0.1874 train_acc: 95.5078
Epoch: 249 train_loss: 0.2090 train_acc: 94.3359
Epoch: 250 train_loss: 0.2269 train_acc: 93.5547
Epoch: 251 train_loss: 0.2339 train_acc: 92.5781
Epoch: 252 train_loss: 0.1745 train_acc: 94.7266
Epoch: 253 train_loss: 0.2092 train_acc: 94.5312
Epoch: 254 train_loss: 0.1555 train_acc: 97.4609
Epoch: 255 train_loss: 0.1863 train_acc: 94.9219
Epoch: 256 train_loss: 0.1660 train_acc: 95.8984
Epoch: 257 train_loss: 0.1642 train_acc: 96.6797
Epoch: 258 train_loss: 0.1795 train_acc: 95.1172
Epoch: 259 train_loss: 0.2134 train_acc: 94.3359
Epoch: 260 train_loss: 0.2118 train_acc: 93.7500
Epoch: 261 train_loss: 0.2169 train_acc: 92.9688
Epoch: 262 train_loss: 0.2210 train_acc: 94.1406
Epoch: 263 train_loss: 0.2065 train_acc: 94.1406
Epoch: 264 train_loss: 0.1831 train_acc: 95.1172
Epoch: 265 train_loss: 0.1835 train_acc: 94.7266
Epoch: 266 train_loss: 0.1587 train_acc: 95.8984
Epoch: 267 train_loss: 0.1449 train_acc: 97.0703
Epoch: 268 train_loss: 0.1930 train_acc: 95.1172
Epoch: 269 train_loss: 0.1870 train_acc: 93.7500
Epoch: 270 train_loss: 0.1941 train_acc: 93.9453
Epoch: 271 train_loss: 0.1835 train_acc: 94.7266
Epoch: 272 train_loss: 0.1755 train_acc: 94.9219
Epoch: 273 train_loss: 0.2089 train_acc: 94.7266
Epoch: 274 train_loss: 0.1773 train_acc: 95.8984
Epoch: 275 train_loss: 0.1739 train_acc: 94.5312
Epoch: 276 train_loss: 0.1382 train_acc: 97.2656
Epoch: 277 train_loss: 0.1644 train_acc: 95.8984
Epoch: 278 train_loss: 0.1524 train_acc: 96.4844
Epoch: 279 train_loss: 0.1732 train_acc: 96.0938
Epoch: 280 train_loss: 0.1999 train_acc: 93.7500
Epoch: 281 train_loss: 0.1443 train_acc: 96.2891
Epoch: 282 train_loss: 0.1590 train_acc: 95.5078
Epoch: 283 train_loss: 0.1429 train_acc: 96.8750
Epoch: 284 train_loss: 0.1692 train_acc: 95.3125
Epoch: 285 train_loss: 0.1329 train_acc: 96.6797
Epoch: 286 train_loss: 0.1435 train_acc: 96.2891
Epoch: 287 train_loss: 0.1472 train_acc: 96.6797
Epoch: 288 train_loss: 0.1458 train_acc: 96.6797
Epoch: 289 train_loss: 0.1760 train_acc: 95.1172
Epoch: 290 train_loss: 0.1623 train_acc: 94.9219
Epoch: 291 train_loss: 0.1743 train_acc: 94.7266
Epoch: 292 train_loss: 0.1481 train_acc: 96.4844
Epoch: 293 train_loss: 0.1458 train_acc: 96.6797
Epoch: 294 train_loss: 0.1604 train_acc: 96.2891
Epoch: 295 train_loss: 0.1528 train_acc: 95.8984
Epoch: 296 train_loss: 0.1467 train_acc: 96.2891
Epoch: 297 train_loss: 0.1164 train_acc: 97.8516
Epoch: 298 train_loss: 0.1430 train_acc: 96.6797
Epoch: 299 train_loss: 0.1658 train_acc: 96.0938
Epoch: 300 train_loss: 0.1441 train_acc: 96.6797
Running Time: 168.23
**************************************************
Final result:
OA: 0.6980 | AA: 0.5778 | Kappa: 0.6575
[0.04545455 0.75092115 0.66370558 0.51111111 0.82788671 0.75216138
 0.03703704 0.95594714 0.21052632 0.7248104  0.64493997 0.54706927
 0.99487179 0.78202995 0.39782016 0.39772727]
**************************************************
Parameter:
dataset: Indian
flag_test: train
mode: CAF
gpu_id: 0
seed: 1
batch_size: 64
test_freq: 5
patches: 7
band_patches: 3
epoches: 300
learning_rate: 0.0005
gamma: 0.9
weight_decay: 0.005
height=145,width=145,band=200
**************************************************
patch is : 7
mirror_image shape : [151,151,200]
**************************************************
x_train shape = (512, 7, 7, 200), type = float64
x_test  shape = (9737, 7, 7, 200), type = float64
x_true  shape = (21025, 7, 7, 200), type = float64
**************************************************
x_train_band shape = (512, 147, 200), type = float64
x_test_band  shape = (9737, 147, 200), type = float64
x_true_band  shape = (21025, 147, 200), type = float64
**************************************************
y_train: shape = (512,) ,type = int64
y_test: shape = (9737,) ,type = int64
/home/amax/anaconda3/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
y_true: shape = (21025,) ,type = int64
**************************************************
start training
Epoch: 001 train_loss: 2.5740 train_acc: 18.5547
Epoch: 002 train_loss: 2.3558 train_acc: 24.0234
Epoch: 003 train_loss: 2.3133 train_acc: 25.3906
Epoch: 004 train_loss: 2.2514 train_acc: 28.9062
Epoch: 005 train_loss: 2.1211 train_acc: 34.3750
Epoch: 006 train_loss: 1.9695 train_acc: 36.3281
Epoch: 007 train_loss: 1.8677 train_acc: 33.2031
Epoch: 008 train_loss: 1.7970 train_acc: 37.3047
Epoch: 009 train_loss: 1.7347 train_acc: 38.2812
Epoch: 010 train_loss: 1.6937 train_acc: 39.2578
Epoch: 011 train_loss: 1.6486 train_acc: 42.3828
Epoch: 012 train_loss: 1.6158 train_acc: 41.7969
Epoch: 013 train_loss: 1.5809 train_acc: 42.9688
Epoch: 014 train_loss: 1.5641 train_acc: 43.9453
Epoch: 015 train_loss: 1.5519 train_acc: 43.3594
Epoch: 016 train_loss: 1.5302 train_acc: 43.3594
Epoch: 017 train_loss: 1.5094 train_acc: 44.7266
Epoch: 018 train_loss: 1.5052 train_acc: 43.7500
Epoch: 019 train_loss: 1.4794 train_acc: 46.2891
Epoch: 020 train_loss: 1.4740 train_acc: 45.5078
Epoch: 021 train_loss: 1.4482 train_acc: 47.2656
Epoch: 022 train_loss: 1.4417 train_acc: 46.0938
Epoch: 023 train_loss: 1.4296 train_acc: 44.9219
Epoch: 024 train_loss: 1.4389 train_acc: 45.5078
Epoch: 025 train_loss: 1.4247 train_acc: 45.1172
Epoch: 026 train_loss: 1.4107 train_acc: 46.6797
Epoch: 027 train_loss: 1.3953 train_acc: 46.6797
Epoch: 028 train_loss: 1.3911 train_acc: 48.0469
Epoch: 029 train_loss: 1.3669 train_acc: 46.0938
Epoch: 030 train_loss: 1.3703 train_acc: 45.5078
Epoch: 031 train_loss: 1.3356 train_acc: 47.2656
Epoch: 032 train_loss: 1.3302 train_acc: 46.2891
Epoch: 033 train_loss: 1.3156 train_acc: 49.2188
Epoch: 034 train_loss: 1.3144 train_acc: 46.8750
Epoch: 035 train_loss: 1.2869 train_acc: 50.3906
Epoch: 036 train_loss: 1.2918 train_acc: 49.4141
Epoch: 037 train_loss: 1.3039 train_acc: 48.8281
Epoch: 038 train_loss: 1.2464 train_acc: 50.7812
Epoch: 039 train_loss: 1.2545 train_acc: 50.7812
Epoch: 040 train_loss: 1.2243 train_acc: 50.3906
Epoch: 041 train_loss: 1.2170 train_acc: 52.3438
Epoch: 042 train_loss: 1.2432 train_acc: 51.5625
Epoch: 043 train_loss: 1.2301 train_acc: 53.7109
Epoch: 044 train_loss: 1.2663 train_acc: 49.0234
Epoch: 045 train_loss: 1.2233 train_acc: 50.1953
Epoch: 046 train_loss: 1.1971 train_acc: 51.9531
Epoch: 047 train_loss: 1.2267 train_acc: 50.7812
Epoch: 048 train_loss: 1.2578 train_acc: 48.8281
Epoch: 049 train_loss: 1.2015 train_acc: 50.7812
Epoch: 050 train_loss: 1.1772 train_acc: 52.3438
Epoch: 051 train_loss: 1.1485 train_acc: 54.4922
Epoch: 052 train_loss: 1.1547 train_acc: 55.6641
Epoch: 053 train_loss: 1.1263 train_acc: 54.6875
Epoch: 054 train_loss: 1.1393 train_acc: 53.7109
Epoch: 055 train_loss: 1.1182 train_acc: 56.8359
Epoch: 056 train_loss: 1.1065 train_acc: 57.6172
Epoch: 057 train_loss: 1.0836 train_acc: 56.2500
Epoch: 058 train_loss: 1.0988 train_acc: 56.2500
Epoch: 059 train_loss: 1.0834 train_acc: 56.4453
Epoch: 060 train_loss: 1.0647 train_acc: 57.0312
Epoch: 061 train_loss: 1.0599 train_acc: 55.8594
Epoch: 062 train_loss: 1.0828 train_acc: 57.0312
Epoch: 063 train_loss: 1.0842 train_acc: 55.0781
Epoch: 064 train_loss: 1.0548 train_acc: 58.3984
Epoch: 065 train_loss: 1.0125 train_acc: 60.3516
Epoch: 066 train_loss: 1.0064 train_acc: 60.7422
Epoch: 067 train_loss: 0.9999 train_acc: 61.1328
Epoch: 068 train_loss: 1.0144 train_acc: 61.1328
Epoch: 069 train_loss: 0.9709 train_acc: 63.0859
Epoch: 070 train_loss: 0.9774 train_acc: 61.9141
Epoch: 071 train_loss: 0.9556 train_acc: 66.6016
Epoch: 072 train_loss: 0.9347 train_acc: 65.4297
Epoch: 073 train_loss: 0.9444 train_acc: 67.9688
Epoch: 074 train_loss: 0.9791 train_acc: 64.0625
Epoch: 075 train_loss: 0.9901 train_acc: 62.1094
Epoch: 076 train_loss: 0.9635 train_acc: 60.7422
Epoch: 077 train_loss: 0.9067 train_acc: 66.7969
Epoch: 078 train_loss: 0.8943 train_acc: 66.2109
Epoch: 079 train_loss: 0.8696 train_acc: 67.7734
Epoch: 080 train_loss: 0.8994 train_acc: 68.5547
Epoch: 081 train_loss: 0.9895 train_acc: 60.3516
Epoch: 082 train_loss: 0.8984 train_acc: 65.4297
Epoch: 083 train_loss: 0.8825 train_acc: 66.4062
Epoch: 084 train_loss: 0.8347 train_acc: 68.7500
Epoch: 085 train_loss: 0.8410 train_acc: 68.9453
Epoch: 086 train_loss: 0.8490 train_acc: 68.5547
Epoch: 087 train_loss: 0.8386 train_acc: 68.5547
Epoch: 088 train_loss: 0.8189 train_acc: 71.6797
Epoch: 089 train_loss: 0.7814 train_acc: 73.0469
Epoch: 090 train_loss: 0.7576 train_acc: 72.6562
Epoch: 091 train_loss: 0.7633 train_acc: 74.2188
Epoch: 092 train_loss: 0.7905 train_acc: 71.4844
Epoch: 093 train_loss: 0.8164 train_acc: 68.1641
Epoch: 094 train_loss: 0.7974 train_acc: 70.7031
Epoch: 095 train_loss: 0.7855 train_acc: 68.9453
Epoch: 096 train_loss: 0.7801 train_acc: 71.0938
Epoch: 097 train_loss: 0.7646 train_acc: 72.4609
Epoch: 098 train_loss: 0.7438 train_acc: 73.0469
Epoch: 099 train_loss: 0.7455 train_acc: 73.6328
Epoch: 100 train_loss: 0.7498 train_acc: 72.4609
Epoch: 101 train_loss: 0.7785 train_acc: 71.4844
Epoch: 102 train_loss: 0.8048 train_acc: 68.5547
Epoch: 103 train_loss: 0.7724 train_acc: 70.1172
Epoch: 104 train_loss: 0.7399 train_acc: 72.0703
Epoch: 105 train_loss: 0.8039 train_acc: 67.5781
Epoch: 106 train_loss: 0.8051 train_acc: 69.3359
Epoch: 107 train_loss: 0.6990 train_acc: 75.7812
Epoch: 108 train_loss: 0.6824 train_acc: 74.8047
Epoch: 109 train_loss: 0.6903 train_acc: 73.8281
Epoch: 110 train_loss: 0.6657 train_acc: 77.5391
Epoch: 111 train_loss: 0.7026 train_acc: 74.6094
Epoch: 112 train_loss: 0.6592 train_acc: 76.9531
Epoch: 113 train_loss: 0.6638 train_acc: 75.3906
Epoch: 114 train_loss: 0.6559 train_acc: 78.9062
Epoch: 115 train_loss: 0.6673 train_acc: 73.4375
Epoch: 116 train_loss: 0.6626 train_acc: 75.1953
Epoch: 117 train_loss: 0.6363 train_acc: 77.9297
Epoch: 118 train_loss: 0.6593 train_acc: 75.7812
Epoch: 119 train_loss: 0.7353 train_acc: 71.4844
Epoch: 120 train_loss: 0.7159 train_acc: 72.8516
Epoch: 121 train_loss: 0.6741 train_acc: 73.2422
Epoch: 122 train_loss: 0.6343 train_acc: 76.5625
Epoch: 123 train_loss: 0.6223 train_acc: 76.1719
Epoch: 124 train_loss: 0.6251 train_acc: 76.9531
Epoch: 125 train_loss: 0.6009 train_acc: 78.7109
Epoch: 126 train_loss: 0.7135 train_acc: 72.8516
Epoch: 127 train_loss: 0.6990 train_acc: 75.1953
Epoch: 128 train_loss: 0.6984 train_acc: 73.6328
Epoch: 129 train_loss: 0.6127 train_acc: 77.5391
Epoch: 130 train_loss: 0.5889 train_acc: 78.1250
Epoch: 131 train_loss: 0.5689 train_acc: 79.4922
Epoch: 132 train_loss: 0.5843 train_acc: 79.4922
Epoch: 133 train_loss: 0.5633 train_acc: 79.2969
Epoch: 134 train_loss: 0.5860 train_acc: 77.7344
Epoch: 135 train_loss: 0.5958 train_acc: 78.3203
Epoch: 136 train_loss: 0.5496 train_acc: 81.4453
Epoch: 137 train_loss: 0.5700 train_acc: 80.0781
Epoch: 138 train_loss: 0.5575 train_acc: 80.6641
Epoch: 139 train_loss: 0.5623 train_acc: 78.7109
Epoch: 140 train_loss: 0.5511 train_acc: 78.9062
Epoch: 141 train_loss: 0.5273 train_acc: 81.2500
Epoch: 142 train_loss: 0.5490 train_acc: 79.2969
Epoch: 143 train_loss: 0.5787 train_acc: 79.8828
Epoch: 144 train_loss: 0.5556 train_acc: 79.1016
Epoch: 145 train_loss: 0.5584 train_acc: 81.0547
Epoch: 146 train_loss: 0.5405 train_acc: 80.4688
Epoch: 147 train_loss: 0.6405 train_acc: 76.3672
Epoch: 148 train_loss: 0.6023 train_acc: 77.1484
Epoch: 149 train_loss: 0.5644 train_acc: 79.4922
Epoch: 150 train_loss: 0.5282 train_acc: 81.6406
Epoch: 151 train_loss: 0.4858 train_acc: 82.0312
Epoch: 152 train_loss: 0.4947 train_acc: 81.4453
Epoch: 153 train_loss: 0.4976 train_acc: 82.2266
Epoch: 154 train_loss: 0.4856 train_acc: 83.2031
Epoch: 155 train_loss: 0.5051 train_acc: 81.4453
Epoch: 156 train_loss: 0.5213 train_acc: 80.2734
Epoch: 157 train_loss: 0.5097 train_acc: 81.0547
Epoch: 158 train_loss: 0.4903 train_acc: 81.2500
Epoch: 159 train_loss: 0.4689 train_acc: 83.9844
Epoch: 160 train_loss: 0.4877 train_acc: 83.3984
Epoch: 161 train_loss: 0.5045 train_acc: 83.3984
Epoch: 162 train_loss: 0.5342 train_acc: 80.6641
Epoch: 163 train_loss: 0.4908 train_acc: 82.6172
Epoch: 164 train_loss: 0.5554 train_acc: 79.8828
Epoch: 165 train_loss: 0.5227 train_acc: 81.0547
/home/amax/anaconda3/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
Epoch: 166 train_loss: 0.5194 train_acc: 82.8125
Epoch: 167 train_loss: 0.4492 train_acc: 86.7188
Epoch: 168 train_loss: 0.4827 train_acc: 81.4453
Epoch: 169 train_loss: 0.4823 train_acc: 82.2266
Epoch: 170 train_loss: 0.4660 train_acc: 84.7656
Epoch: 171 train_loss: 0.4456 train_acc: 85.5469
Epoch: 172 train_loss: 0.4576 train_acc: 84.9609
Epoch: 173 train_loss: 0.4755 train_acc: 83.5938
Epoch: 174 train_loss: 0.4555 train_acc: 83.5938
Epoch: 175 train_loss: 0.4300 train_acc: 85.1562
Epoch: 176 train_loss: 0.4397 train_acc: 83.0078
Epoch: 177 train_loss: 0.4854 train_acc: 81.0547
Epoch: 178 train_loss: 0.4359 train_acc: 84.7656
Epoch: 179 train_loss: 0.4238 train_acc: 85.3516
Epoch: 180 train_loss: 0.4505 train_acc: 83.7891
Epoch: 181 train_loss: 0.4005 train_acc: 86.3281
Epoch: 182 train_loss: 0.4006 train_acc: 86.7188
Epoch: 183 train_loss: 0.4140 train_acc: 88.6719
Epoch: 184 train_loss: 0.4027 train_acc: 87.8906
Epoch: 185 train_loss: 0.4478 train_acc: 83.2031
Epoch: 186 train_loss: 0.3916 train_acc: 87.6953
Epoch: 187 train_loss: 0.4320 train_acc: 85.1562
Epoch: 188 train_loss: 0.4048 train_acc: 85.9375
Epoch: 189 train_loss: 0.3909 train_acc: 87.3047
Epoch: 190 train_loss: 0.3787 train_acc: 85.9375
Epoch: 191 train_loss: 0.3928 train_acc: 87.1094
Epoch: 192 train_loss: 0.3764 train_acc: 87.1094
Epoch: 193 train_loss: 0.3785 train_acc: 87.5000
Epoch: 194 train_loss: 0.3846 train_acc: 87.3047
Epoch: 195 train_loss: 0.3725 train_acc: 86.7188
Epoch: 196 train_loss: 0.3683 train_acc: 88.0859
Epoch: 197 train_loss: 0.3644 train_acc: 86.3281
Epoch: 198 train_loss: 0.3898 train_acc: 87.8906
Epoch: 199 train_loss: 0.3718 train_acc: 87.3047
Epoch: 200 train_loss: 0.3535 train_acc: 87.6953
Epoch: 201 train_loss: 0.3953 train_acc: 86.7188
Epoch: 202 train_loss: 0.4008 train_acc: 86.9141
Epoch: 203 train_loss: 0.3639 train_acc: 89.0625
Epoch: 204 train_loss: 0.3741 train_acc: 87.5000
Epoch: 205 train_loss: 0.3644 train_acc: 87.6953
Epoch: 206 train_loss: 0.3845 train_acc: 86.7188
Epoch: 207 train_loss: 0.3805 train_acc: 87.3047
Epoch: 208 train_loss: 0.3281 train_acc: 89.6484
Epoch: 209 train_loss: 0.3248 train_acc: 88.0859
Epoch: 210 train_loss: 0.3221 train_acc: 91.2109
Epoch: 211 train_loss: 0.3001 train_acc: 91.0156
Epoch: 212 train_loss: 0.3078 train_acc: 89.8438
Epoch: 213 train_loss: 0.3752 train_acc: 88.6719
Epoch: 214 train_loss: 0.4154 train_acc: 85.3516
Epoch: 215 train_loss: 0.4179 train_acc: 85.9375
Epoch: 216 train_loss: 0.3584 train_acc: 86.5234
Epoch: 217 train_loss: 0.3453 train_acc: 87.5000
Epoch: 218 train_loss: 0.3354 train_acc: 88.4766
Epoch: 219 train_loss: 0.3616 train_acc: 88.0859
Epoch: 220 train_loss: 0.3358 train_acc: 89.2578
Epoch: 221 train_loss: 0.3292 train_acc: 88.8672
Epoch: 222 train_loss: 0.2927 train_acc: 90.4297
Epoch: 223 train_loss: 0.2908 train_acc: 90.4297
Epoch: 224 train_loss: 0.3174 train_acc: 90.6250
Epoch: 225 train_loss: 0.3361 train_acc: 87.6953
Epoch: 226 train_loss: 0.3342 train_acc: 88.4766
Epoch: 227 train_loss: 0.3226 train_acc: 90.6250
Epoch: 228 train_loss: 0.3403 train_acc: 89.8438
Epoch: 229 train_loss: 0.3474 train_acc: 88.0859
Epoch: 230 train_loss: 0.3470 train_acc: 87.3047
Epoch: 231 train_loss: 0.2924 train_acc: 90.6250
Epoch: 232 train_loss: 0.3319 train_acc: 90.2344
Epoch: 233 train_loss: 0.3114 train_acc: 90.0391
Epoch: 234 train_loss: 0.3161 train_acc: 90.8203
Epoch: 235 train_loss: 0.3549 train_acc: 87.3047
Epoch: 236 train_loss: 0.3055 train_acc: 91.2109
Epoch: 237 train_loss: 0.2896 train_acc: 91.7969
Epoch: 238 train_loss: 0.3242 train_acc: 86.9141
Epoch: 239 train_loss: 0.3028 train_acc: 90.0391
Epoch: 240 train_loss: 0.2887 train_acc: 91.4062
Epoch: 241 train_loss: 0.2586 train_acc: 92.3828
Epoch: 242 train_loss: 0.2243 train_acc: 93.9453
Epoch: 243 train_loss: 0.2388 train_acc: 92.9688
Epoch: 244 train_loss: 0.2950 train_acc: 91.7969
Epoch: 245 train_loss: 0.2678 train_acc: 91.6016
Epoch: 246 train_loss: 0.2918 train_acc: 89.8438
Epoch: 247 train_loss: 0.3328 train_acc: 87.3047
Epoch: 248 train_loss: 0.3531 train_acc: 86.9141
Epoch: 249 train_loss: 0.3530 train_acc: 88.6719
Epoch: 250 train_loss: 0.3319 train_acc: 87.6953
Epoch: 251 train_loss: 0.3307 train_acc: 89.4531
Epoch: 252 train_loss: 0.2889 train_acc: 92.1875
Epoch: 253 train_loss: 0.3107 train_acc: 90.2344
Epoch: 254 train_loss: 0.2588 train_acc: 92.1875
Epoch: 255 train_loss: 0.2463 train_acc: 93.5547
Epoch: 256 train_loss: 0.2269 train_acc: 94.1406
Epoch: 257 train_loss: 0.2171 train_acc: 94.7266
Epoch: 258 train_loss: 0.2573 train_acc: 91.6016
Epoch: 259 train_loss: 0.2434 train_acc: 92.9688
Epoch: 260 train_loss: 0.2674 train_acc: 92.1875
Epoch: 261 train_loss: 0.2194 train_acc: 93.7500
Epoch: 262 train_loss: 0.2203 train_acc: 94.3359
Epoch: 263 train_loss: 0.2242 train_acc: 93.5547
Epoch: 264 train_loss: 0.2496 train_acc: 92.5781
Epoch: 265 train_loss: 0.2182 train_acc: 94.9219
Epoch: 266 train_loss: 0.2541 train_acc: 92.3828
Epoch: 267 train_loss: 0.2951 train_acc: 90.6250
Epoch: 268 train_loss: 0.2572 train_acc: 92.1875
Epoch: 269 train_loss: 0.2135 train_acc: 94.5312
Epoch: 270 train_loss: 0.2571 train_acc: 91.9922
Epoch: 271 train_loss: 0.2381 train_acc: 92.7734
Epoch: 272 train_loss: 0.2261 train_acc: 91.9922
Epoch: 273 train_loss: 0.2760 train_acc: 90.6250
Epoch: 274 train_loss: 0.2734 train_acc: 91.0156
Epoch: 275 train_loss: 0.2147 train_acc: 94.1406
Epoch: 276 train_loss: 0.2294 train_acc: 93.5547
Epoch: 277 train_loss: 0.2102 train_acc: 94.1406
Epoch: 278 train_loss: 0.2041 train_acc: 94.9219
Epoch: 279 train_loss: 0.2260 train_acc: 93.1641
Epoch: 280 train_loss: 0.2661 train_acc: 91.6016
Epoch: 281 train_loss: 0.2034 train_acc: 93.9453
Epoch: 282 train_loss: 0.1753 train_acc: 95.8984
Epoch: 283 train_loss: 0.2045 train_acc: 94.1406
Epoch: 284 train_loss: 0.2351 train_acc: 91.7969
Epoch: 285 train_loss: 0.2175 train_acc: 94.3359
Epoch: 286 train_loss: 0.1819 train_acc: 95.8984
Epoch: 287 train_loss: 0.1877 train_acc: 95.8984
Epoch: 288 train_loss: 0.1767 train_acc: 95.8984
Epoch: 289 train_loss: 0.2484 train_acc: 91.6016
Epoch: 290 train_loss: 0.3052 train_acc: 89.8438
Epoch: 291 train_loss: 0.3089 train_acc: 90.0391
Epoch: 292 train_loss: 0.2891 train_acc: 91.6016
Epoch: 293 train_loss: 0.2524 train_acc: 92.1875
Epoch: 294 train_loss: 0.2348 train_acc: 92.5781
Epoch: 295 train_loss: 0.2198 train_acc: 92.9688
Epoch: 296 train_loss: 0.2032 train_acc: 94.3359
Epoch: 297 train_loss: 0.1922 train_acc: 95.1172
Epoch: 298 train_loss: 0.1942 train_acc: 95.1172
Epoch: 299 train_loss: 0.1919 train_acc: 94.9219
Epoch: 300 train_loss: 0.2272 train_acc: 92.3828
Running Time: 165.74
**************************************************
Final result:
OA: 0.7516 | AA: 0.6083 | Kappa: 0.7141
[0.25       0.6742815  0.69035533 0.45777778 0.46840959 0.78962536
 0.11111111 0.95154185 0.15789474 0.72264355 0.88464837 0.5062167
 0.86666667 0.94176373 0.41961853 0.84090909]
**************************************************
Parameter:
dataset: Indian
flag_test: train
mode: CAF
gpu_id: 0
seed: 2
batch_size: 64
test_freq: 5
patches: 7
band_patches: 3
epoches: 300
learning_rate: 0.0005
gamma: 0.9
weight_decay: 0.005
height=145,width=145,band=200
**************************************************
patch is : 7
mirror_image shape : [151,151,200]
**************************************************
x_train shape = (512, 7, 7, 200), type = float64
x_test  shape = (9737, 7, 7, 200), type = float64
x_true  shape = (21025, 7, 7, 200), type = float64
**************************************************
x_train_band shape = (512, 147, 200), type = float64
x_test_band  shape = (9737, 147, 200), type = float64
x_true_band  shape = (21025, 147, 200), type = float64
**************************************************
y_train: shape = (512,) ,type = int64
y_test: shape = (9737,) ,type = int64
y_true: shape = (21025,) ,type = int64
**************************************************
start training
Epoch: 001 train_loss: 2.4646 train_acc: 19.7266
Epoch: 002 train_loss: 2.3846 train_acc: 24.0234
Epoch: 003 train_loss: 2.3276 train_acc: 24.4141
Epoch: 004 train_loss: 2.2842 train_acc: 24.2188
Epoch: 005 train_loss: 2.1675 train_acc: 35.7422
Epoch: 006 train_loss: 1.9928 train_acc: 35.7422
Epoch: 007 train_loss: 1.8735 train_acc: 37.3047
Epoch: 008 train_loss: 1.7875 train_acc: 38.8672
Epoch: 009 train_loss: 1.7039 train_acc: 41.0156
Epoch: 010 train_loss: 1.6577 train_acc: 42.1875
Epoch: 011 train_loss: 1.6223 train_acc: 41.7969
Epoch: 012 train_loss: 1.5604 train_acc: 45.3125
Epoch: 013 train_loss: 1.5352 train_acc: 45.1172
Epoch: 014 train_loss: 1.5090 train_acc: 45.7031
Epoch: 015 train_loss: 1.4954 train_acc: 46.4844
Epoch: 016 train_loss: 1.4683 train_acc: 47.2656
Epoch: 017 train_loss: 1.4465 train_acc: 47.2656
Epoch: 018 train_loss: 1.4317 train_acc: 47.4609
Epoch: 019 train_loss: 1.4285 train_acc: 47.0703
Epoch: 020 train_loss: 1.4023 train_acc: 49.8047
Epoch: 021 train_loss: 1.4009 train_acc: 48.4375
Epoch: 022 train_loss: 1.3841 train_acc: 50.1953
Epoch: 023 train_loss: 1.3815 train_acc: 48.4375
Epoch: 024 train_loss: 1.3529 train_acc: 50.0000
Epoch: 025 train_loss: 1.3365 train_acc: 51.3672
Epoch: 026 train_loss: 1.3438 train_acc: 50.7812
Epoch: 027 train_loss: 1.3251 train_acc: 49.2188
Epoch: 028 train_loss: 1.3245 train_acc: 50.7812
Epoch: 029 train_loss: 1.3209 train_acc: 50.1953
Epoch: 030 train_loss: 1.2927 train_acc: 52.3438
Epoch: 031 train_loss: 1.2694 train_acc: 53.7109
Epoch: 032 train_loss: 1.2820 train_acc: 53.5156
Epoch: 033 train_loss: 1.2763 train_acc: 51.3672
Epoch: 034 train_loss: 1.2853 train_acc: 53.3203
Epoch: 035 train_loss: 1.2677 train_acc: 54.1016
Epoch: 036 train_loss: 1.2500 train_acc: 53.3203
Epoch: 037 train_loss: 1.2317 train_acc: 55.2734
Epoch: 038 train_loss: 1.2274 train_acc: 53.3203
Epoch: 039 train_loss: 1.2538 train_acc: 52.5391
Epoch: 040 train_loss: 1.2348 train_acc: 54.6875
Epoch: 041 train_loss: 1.2632 train_acc: 53.1250
Epoch: 042 train_loss: 1.2331 train_acc: 55.4688
Epoch: 043 train_loss: 1.2187 train_acc: 55.2734
Epoch: 044 train_loss: 1.1950 train_acc: 56.4453
Epoch: 045 train_loss: 1.1830 train_acc: 55.2734
Epoch: 046 train_loss: 1.1920 train_acc: 56.8359
Epoch: 047 train_loss: 1.1866 train_acc: 54.8828
Epoch: 048 train_loss: 1.1592 train_acc: 55.8594
Epoch: 049 train_loss: 1.1309 train_acc: 58.2031
Epoch: 050 train_loss: 1.1488 train_acc: 57.4219
Epoch: 051 train_loss: 1.1436 train_acc: 58.0078
Epoch: 052 train_loss: 1.1259 train_acc: 58.7891
Epoch: 053 train_loss: 1.1170 train_acc: 58.0078
Epoch: 054 train_loss: 1.0924 train_acc: 60.5469
Epoch: 055 train_loss: 1.1018 train_acc: 59.7656
Epoch: 056 train_loss: 1.1198 train_acc: 59.7656
Epoch: 057 train_loss: 1.0669 train_acc: 60.7422
Epoch: 058 train_loss: 1.0861 train_acc: 58.9844
Epoch: 059 train_loss: 1.0960 train_acc: 57.6172
Epoch: 060 train_loss: 1.0559 train_acc: 59.7656
Epoch: 061 train_loss: 1.0801 train_acc: 61.3281
Epoch: 062 train_loss: 1.0508 train_acc: 59.9609
Epoch: 063 train_loss: 1.0338 train_acc: 61.1328
Epoch: 064 train_loss: 1.0345 train_acc: 61.7188
Epoch: 065 train_loss: 1.0427 train_acc: 61.9141
Epoch: 066 train_loss: 1.0450 train_acc: 62.5000
Epoch: 067 train_loss: 1.0405 train_acc: 61.5234
Epoch: 068 train_loss: 1.0316 train_acc: 59.1797
Epoch: 069 train_loss: 1.0103 train_acc: 62.1094
Epoch: 070 train_loss: 0.9992 train_acc: 63.2812
Epoch: 071 train_loss: 0.9652 train_acc: 63.6719
Epoch: 072 train_loss: 0.9749 train_acc: 62.6953
Epoch: 073 train_loss: 0.9815 train_acc: 62.5000
Epoch: 074 train_loss: 0.9444 train_acc: 64.0625
Epoch: 075 train_loss: 0.9791 train_acc: 60.1562
Epoch: 076 train_loss: 0.9366 train_acc: 64.0625
Epoch: 077 train_loss: 0.9155 train_acc: 63.2812
Epoch: 078 train_loss: 0.9346 train_acc: 64.8438
Epoch: 079 train_loss: 0.9232 train_acc: 64.8438
Epoch: 080 train_loss: 0.8965 train_acc: 66.4062
Epoch: 081 train_loss: 0.8910 train_acc: 68.5547
Epoch: 082 train_loss: 0.9351 train_acc: 65.6250
Epoch: 083 train_loss: 0.8848 train_acc: 67.9688
Epoch: 084 train_loss: 0.8575 train_acc: 67.1875
Epoch: 085 train_loss: 0.8726 train_acc: 67.5781
Epoch: 086 train_loss: 0.8555 train_acc: 69.1406
Epoch: 087 train_loss: 0.8411 train_acc: 68.9453
Epoch: 088 train_loss: 0.8416 train_acc: 68.7500
Epoch: 089 train_loss: 0.8058 train_acc: 70.3125
Epoch: 090 train_loss: 0.7987 train_acc: 71.8750
Epoch: 091 train_loss: 0.7795 train_acc: 70.5078
Epoch: 092 train_loss: 0.7865 train_acc: 70.3125
Epoch: 093 train_loss: 0.7403 train_acc: 74.8047
Epoch: 094 train_loss: 0.7522 train_acc: 73.2422
Epoch: 095 train_loss: 0.8258 train_acc: 69.3359
Epoch: 096 train_loss: 0.7991 train_acc: 69.5312
Epoch: 097 train_loss: 0.7940 train_acc: 71.4844
Epoch: 098 train_loss: 0.7607 train_acc: 73.0469
Epoch: 099 train_loss: 0.7510 train_acc: 71.4844
Epoch: 100 train_loss: 0.7349 train_acc: 74.0234
Epoch: 101 train_loss: 0.7804 train_acc: 73.0469
Epoch: 102 train_loss: 0.7563 train_acc: 72.6562
Epoch: 103 train_loss: 0.7095 train_acc: 74.2188
Epoch: 104 train_loss: 0.7029 train_acc: 75.3906
Epoch: 105 train_loss: 0.7063 train_acc: 74.2188
Epoch: 106 train_loss: 0.6735 train_acc: 77.1484
Epoch: 107 train_loss: 0.6979 train_acc: 76.5625
Epoch: 108 train_loss: 0.6633 train_acc: 74.6094
Epoch: 109 train_loss: 0.6344 train_acc: 76.7578
Epoch: 110 train_loss: 0.6853 train_acc: 74.6094
Epoch: 111 train_loss: 0.6765 train_acc: 74.6094
Epoch: 112 train_loss: 0.6574 train_acc: 78.9062
Epoch: 113 train_loss: 0.6502 train_acc: 78.9062
Epoch: 114 train_loss: 0.6533 train_acc: 77.5391
Epoch: 115 train_loss: 0.6563 train_acc: 76.5625
Epoch: 116 train_loss: 0.6062 train_acc: 78.7109
Epoch: 117 train_loss: 0.5675 train_acc: 81.8359
Epoch: 118 train_loss: 0.5962 train_acc: 78.9062
Epoch: 119 train_loss: 0.6221 train_acc: 79.2969
Epoch: 120 train_loss: 0.6592 train_acc: 75.7812
Epoch: 121 train_loss: 0.6293 train_acc: 78.7109
Epoch: 122 train_loss: 0.6233 train_acc: 75.1953
Epoch: 123 train_loss: 0.5942 train_acc: 79.8828
Epoch: 124 train_loss: 0.6219 train_acc: 77.1484
Epoch: 125 train_loss: 0.5673 train_acc: 80.6641
Epoch: 126 train_loss: 0.5661 train_acc: 80.0781
Epoch: 127 train_loss: 0.5328 train_acc: 81.0547
Epoch: 128 train_loss: 0.5790 train_acc: 79.4922
Epoch: 129 train_loss: 0.5286 train_acc: 81.2500
Epoch: 130 train_loss: 0.5522 train_acc: 82.6172
Epoch: 131 train_loss: 0.5247 train_acc: 83.9844
Epoch: 132 train_loss: 0.5068 train_acc: 82.6172
Epoch: 133 train_loss: 0.4866 train_acc: 84.1797
Epoch: 134 train_loss: 0.5188 train_acc: 83.0078
Epoch: 135 train_loss: 0.4954 train_acc: 83.9844
Epoch: 136 train_loss: 0.4757 train_acc: 84.7656
Epoch: 137 train_loss: 0.4568 train_acc: 86.5234
Epoch: 138 train_loss: 0.4316 train_acc: 86.9141
Epoch: 139 train_loss: 0.4357 train_acc: 85.7422
Epoch: 140 train_loss: 0.4647 train_acc: 84.9609
Epoch: 141 train_loss: 0.4502 train_acc: 85.3516
Epoch: 142 train_loss: 0.5004 train_acc: 83.3984
Epoch: 143 train_loss: 0.4756 train_acc: 83.9844
Epoch: 144 train_loss: 0.4459 train_acc: 82.6172
Epoch: 145 train_loss: 0.4421 train_acc: 86.1328
Epoch: 146 train_loss: 0.4287 train_acc: 86.9141
Epoch: 147 train_loss: 0.4330 train_acc: 85.3516
Epoch: 148 train_loss: 0.3907 train_acc: 87.6953
Epoch: 149 train_loss: 0.4191 train_acc: 86.3281
Epoch: 150 train_loss: 0.3737 train_acc: 88.0859
Epoch: 151 train_loss: 0.4185 train_acc: 87.1094
Epoch: 152 train_loss: 0.4391 train_acc: 86.7188
Epoch: 153 train_loss: 0.3963 train_acc: 86.5234
Epoch: 154 train_loss: 0.3625 train_acc: 90.4297
Epoch: 155 train_loss: 0.3767 train_acc: 87.3047
Epoch: 156 train_loss: 0.3565 train_acc: 89.4531
Epoch: 157 train_loss: 0.3699 train_acc: 89.0625
Epoch: 158 train_loss: 0.3661 train_acc: 88.2812
Epoch: 159 train_loss: 0.3609 train_acc: 89.2578
Epoch: 160 train_loss: 0.3245 train_acc: 90.0391
Epoch: 161 train_loss: 0.3413 train_acc: 91.2109
Epoch: 162 train_loss: 0.3569 train_acc: 88.4766
Epoch: 163 train_loss: 0.3264 train_acc: 89.8438
Epoch: 164 train_loss: 0.3302 train_acc: 91.4062
Epoch: 165 train_loss: 0.2927 train_acc: 90.6250
Epoch: 166 train_loss: 0.3063 train_acc: 90.6250
Epoch: 167 train_loss: 0.3247 train_acc: 89.6484
Epoch: 168 train_loss: 0.2890 train_acc: 90.6250
Epoch: 169 train_loss: 0.3787 train_acc: 89.0625
Epoch: 170 train_loss: 0.3744 train_acc: 88.2812
Epoch: 171 train_loss: 0.3567 train_acc: 89.4531
Epoch: 172 train_loss: 0.3312 train_acc: 88.8672
/home/amax/anaconda3/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
Epoch: 173 train_loss: 0.3327 train_acc: 89.4531
Epoch: 174 train_loss: 0.2865 train_acc: 91.6016
Epoch: 175 train_loss: 0.3095 train_acc: 90.8203
Epoch: 176 train_loss: 0.3077 train_acc: 90.2344
Epoch: 177 train_loss: 0.2577 train_acc: 92.1875
Epoch: 178 train_loss: 0.2787 train_acc: 92.1875
Epoch: 179 train_loss: 0.2805 train_acc: 92.1875
Epoch: 180 train_loss: 0.3118 train_acc: 90.8203
Epoch: 181 train_loss: 0.3585 train_acc: 87.8906
Epoch: 182 train_loss: 0.3614 train_acc: 88.4766
Epoch: 183 train_loss: 0.2940 train_acc: 90.8203
Epoch: 184 train_loss: 0.2621 train_acc: 92.7734
Epoch: 185 train_loss: 0.2684 train_acc: 92.9688
Epoch: 186 train_loss: 0.2556 train_acc: 94.1406
Epoch: 187 train_loss: 0.2411 train_acc: 92.5781
Epoch: 188 train_loss: 0.2716 train_acc: 93.1641
Epoch: 189 train_loss: 0.3048 train_acc: 90.0391
Epoch: 190 train_loss: 0.3108 train_acc: 89.4531
Epoch: 191 train_loss: 0.2693 train_acc: 92.1875
Epoch: 192 train_loss: 0.2878 train_acc: 91.7969
Epoch: 193 train_loss: 0.2788 train_acc: 91.4062
Epoch: 194 train_loss: 0.2781 train_acc: 91.7969
Epoch: 195 train_loss: 0.2458 train_acc: 94.1406
Epoch: 196 train_loss: 0.2507 train_acc: 91.4062
Epoch: 197 train_loss: 0.2384 train_acc: 93.3594
Epoch: 198 train_loss: 0.2181 train_acc: 94.3359
Epoch: 199 train_loss: 0.2103 train_acc: 93.9453
Epoch: 200 train_loss: 0.2096 train_acc: 94.3359
Epoch: 201 train_loss: 0.2187 train_acc: 95.7031
Epoch: 202 train_loss: 0.2095 train_acc: 94.5312
Epoch: 203 train_loss: 0.2386 train_acc: 93.5547
Epoch: 204 train_loss: 0.1999 train_acc: 95.3125
Epoch: 205 train_loss: 0.2075 train_acc: 94.7266
Epoch: 206 train_loss: 0.2309 train_acc: 93.3594
Epoch: 207 train_loss: 0.2379 train_acc: 94.5312
Epoch: 208 train_loss: 0.2469 train_acc: 92.9688
Epoch: 209 train_loss: 0.2210 train_acc: 94.5312
Epoch: 210 train_loss: 0.2214 train_acc: 93.9453
Epoch: 211 train_loss: 0.2028 train_acc: 94.1406
Epoch: 212 train_loss: 0.1772 train_acc: 97.6562
Epoch: 213 train_loss: 0.2641 train_acc: 91.9922
Epoch: 214 train_loss: 0.2008 train_acc: 95.1172
Epoch: 215 train_loss: 0.1859 train_acc: 94.3359
Epoch: 216 train_loss: 0.1586 train_acc: 96.6797
Epoch: 217 train_loss: 0.1635 train_acc: 96.0938
Epoch: 218 train_loss: 0.1785 train_acc: 95.5078
Epoch: 219 train_loss: 0.2061 train_acc: 94.9219
Epoch: 220 train_loss: 0.2129 train_acc: 93.7500
Epoch: 221 train_loss: 0.1826 train_acc: 95.1172
Epoch: 222 train_loss: 0.1963 train_acc: 94.7266
Epoch: 223 train_loss: 0.2252 train_acc: 92.7734
Epoch: 224 train_loss: 0.1972 train_acc: 93.7500
Epoch: 225 train_loss: 0.2023 train_acc: 93.9453
Epoch: 226 train_loss: 0.2025 train_acc: 95.1172
Epoch: 227 train_loss: 0.1918 train_acc: 95.3125
Epoch: 228 train_loss: 0.2005 train_acc: 94.7266
Epoch: 229 train_loss: 0.2318 train_acc: 93.7500
Epoch: 230 train_loss: 0.1733 train_acc: 94.5312
Epoch: 231 train_loss: 0.2107 train_acc: 93.7500
Epoch: 232 train_loss: 0.1927 train_acc: 94.7266
Epoch: 233 train_loss: 0.1654 train_acc: 95.5078
Epoch: 234 train_loss: 0.1688 train_acc: 95.3125
Epoch: 235 train_loss: 0.1424 train_acc: 97.2656
Epoch: 236 train_loss: 0.1752 train_acc: 94.7266
Epoch: 237 train_loss: 0.2177 train_acc: 94.1406
Epoch: 238 train_loss: 0.2038 train_acc: 93.3594
Epoch: 239 train_loss: 0.1661 train_acc: 95.8984
Epoch: 240 train_loss: 0.1739 train_acc: 94.5312
Epoch: 241 train_loss: 0.1399 train_acc: 97.6562
Epoch: 242 train_loss: 0.1237 train_acc: 98.0469
Epoch: 243 train_loss: 0.1158 train_acc: 98.6328
Epoch: 244 train_loss: 0.1288 train_acc: 97.8516
Epoch: 245 train_loss: 0.1601 train_acc: 95.8984
Epoch: 246 train_loss: 0.1298 train_acc: 96.8750
Epoch: 247 train_loss: 0.1339 train_acc: 96.8750
Epoch: 248 train_loss: 0.1604 train_acc: 96.4844
Epoch: 249 train_loss: 0.1308 train_acc: 96.8750
Epoch: 250 train_loss: 0.1409 train_acc: 96.4844
Epoch: 251 train_loss: 0.1638 train_acc: 95.1172
Epoch: 252 train_loss: 0.1232 train_acc: 97.2656
Epoch: 253 train_loss: 0.1595 train_acc: 95.3125
Epoch: 254 train_loss: 0.1499 train_acc: 96.4844
Epoch: 255 train_loss: 0.1613 train_acc: 95.8984
Epoch: 256 train_loss: 0.1522 train_acc: 96.2891
Epoch: 257 train_loss: 0.1337 train_acc: 97.0703
Epoch: 258 train_loss: 0.1243 train_acc: 96.6797
Epoch: 259 train_loss: 0.1457 train_acc: 96.6797
Epoch: 260 train_loss: 0.1438 train_acc: 96.4844
Epoch: 261 train_loss: 0.1369 train_acc: 96.4844
Epoch: 262 train_loss: 0.1186 train_acc: 97.8516
Epoch: 263 train_loss: 0.1407 train_acc: 97.8516
Epoch: 264 train_loss: 0.1756 train_acc: 94.7266
Epoch: 265 train_loss: 0.1689 train_acc: 95.7031
Epoch: 266 train_loss: 0.1733 train_acc: 94.9219
Epoch: 267 train_loss: 0.1516 train_acc: 95.1172
Epoch: 268 train_loss: 0.1168 train_acc: 97.4609
Epoch: 269 train_loss: 0.1320 train_acc: 96.6797
Epoch: 270 train_loss: 0.1122 train_acc: 98.4375
Epoch: 271 train_loss: 0.1183 train_acc: 97.0703
Epoch: 272 train_loss: 0.1132 train_acc: 97.8516
Epoch: 273 train_loss: 0.1124 train_acc: 97.8516
Epoch: 274 train_loss: 0.1299 train_acc: 96.8750
Epoch: 275 train_loss: 0.1474 train_acc: 95.1172
Epoch: 276 train_loss: 0.1226 train_acc: 97.8516
Epoch: 277 train_loss: 0.1061 train_acc: 97.6562
Epoch: 278 train_loss: 0.1155 train_acc: 96.6797
Epoch: 279 train_loss: 0.1338 train_acc: 96.8750
Epoch: 280 train_loss: 0.1420 train_acc: 96.2891
Epoch: 281 train_loss: 0.1493 train_acc: 96.2891
Epoch: 282 train_loss: 0.1556 train_acc: 95.7031
Epoch: 283 train_loss: 0.1077 train_acc: 97.8516
Epoch: 284 train_loss: 0.1245 train_acc: 96.6797
Epoch: 285 train_loss: 0.0877 train_acc: 98.6328
Epoch: 286 train_loss: 0.0997 train_acc: 97.8516
Epoch: 287 train_loss: 0.0947 train_acc: 98.2422
Epoch: 288 train_loss: 0.1098 train_acc: 97.2656
Epoch: 289 train_loss: 0.1467 train_acc: 96.6797
Epoch: 290 train_loss: 0.1360 train_acc: 95.7031
Epoch: 291 train_loss: 0.1332 train_acc: 97.8516
Epoch: 292 train_loss: 0.1028 train_acc: 98.0469
Epoch: 293 train_loss: 0.0990 train_acc: 97.8516
Epoch: 294 train_loss: 0.1135 train_acc: 97.8516
Epoch: 295 train_loss: 0.0982 train_acc: 98.0469
Epoch: 296 train_loss: 0.1244 train_acc: 96.8750
Epoch: 297 train_loss: 0.1149 train_acc: 98.2422
Epoch: 298 train_loss: 0.1165 train_acc: 97.0703
Epoch: 299 train_loss: 0.1196 train_acc: 97.0703
Epoch: 300 train_loss: 0.1240 train_acc: 97.4609
Running Time: 166.40
**************************************************
Final result:
OA: 0.7761 | AA: 0.6286 | Kappa: 0.7432
[0.02272727 0.79218865 0.63959391 0.6        0.61437908 0.74495677
 0.11111111 0.9845815  0.31578947 0.74647887 0.86277873 0.58792185
 0.86153846 0.94093178 0.52861035 0.70454545]
**************************************************
Parameter:
dataset: Indian
flag_test: train
mode: CAF
gpu_id: 0
seed: 3
batch_size: 64
test_freq: 5
patches: 7
band_patches: 3
epoches: 300
learning_rate: 0.0005
gamma: 0.9
weight_decay: 0.005
height=145,width=145,band=200
**************************************************
patch is : 7
mirror_image shape : [151,151,200]
**************************************************
x_train shape = (512, 7, 7, 200), type = float64
x_test  shape = (9737, 7, 7, 200), type = float64
x_true  shape = (21025, 7, 7, 200), type = float64
**************************************************
x_train_band shape = (512, 147, 200), type = float64
x_test_band  shape = (9737, 147, 200), type = float64
x_true_band  shape = (21025, 147, 200), type = float64
**************************************************
y_train: shape = (512,) ,type = int64
y_test: shape = (9737,) ,type = int64
y_true: shape = (21025,) ,type = int64
**************************************************
start training
Epoch: 001 train_loss: 2.5030 train_acc: 20.5078
Epoch: 002 train_loss: 2.3936 train_acc: 24.2188
Epoch: 003 train_loss: 2.3291 train_acc: 24.0234
Epoch: 004 train_loss: 2.2860 train_acc: 24.0234
Epoch: 005 train_loss: 2.2173 train_acc: 30.0781
Epoch: 006 train_loss: 2.0702 train_acc: 34.9609
Epoch: 007 train_loss: 1.9291 train_acc: 35.3516
Epoch: 008 train_loss: 1.8450 train_acc: 37.5000
Epoch: 009 train_loss: 1.7952 train_acc: 37.1094
Epoch: 010 train_loss: 1.7455 train_acc: 40.2344
Epoch: 011 train_loss: 1.7172 train_acc: 39.8438
Epoch: 012 train_loss: 1.7001 train_acc: 42.5781
Epoch: 013 train_loss: 1.6489 train_acc: 43.5547
Epoch: 014 train_loss: 1.6228 train_acc: 42.5781
Epoch: 015 train_loss: 1.5942 train_acc: 43.3594
Epoch: 016 train_loss: 1.6055 train_acc: 43.1641
Epoch: 017 train_loss: 1.5692 train_acc: 47.2656
Epoch: 018 train_loss: 1.5144 train_acc: 47.2656
Epoch: 019 train_loss: 1.5009 train_acc: 47.6562
Epoch: 020 train_loss: 1.4932 train_acc: 49.8047
Epoch: 021 train_loss: 1.4626 train_acc: 48.0469
Epoch: 022 train_loss: 1.4837 train_acc: 45.5078
Epoch: 023 train_loss: 1.4249 train_acc: 50.3906
Epoch: 024 train_loss: 1.3853 train_acc: 51.1719
Epoch: 025 train_loss: 1.3576 train_acc: 51.5625
Epoch: 026 train_loss: 1.3368 train_acc: 50.7812
Epoch: 027 train_loss: 1.3423 train_acc: 51.3672
Epoch: 028 train_loss: 1.3175 train_acc: 52.9297
Epoch: 029 train_loss: 1.3037 train_acc: 52.9297
Epoch: 030 train_loss: 1.2898 train_acc: 53.3203
Epoch: 031 train_loss: 1.2805 train_acc: 52.7344
Epoch: 032 train_loss: 1.2878 train_acc: 53.7109
Epoch: 033 train_loss: 1.2982 train_acc: 52.3438
Epoch: 034 train_loss: 1.2788 train_acc: 51.7578
Epoch: 035 train_loss: 1.2569 train_acc: 53.5156
Epoch: 036 train_loss: 1.2698 train_acc: 54.2969
Epoch: 037 train_loss: 1.2331 train_acc: 53.9062
Epoch: 038 train_loss: 1.2292 train_acc: 56.0547
Epoch: 039 train_loss: 1.2120 train_acc: 53.7109
Epoch: 040 train_loss: 1.2746 train_acc: 53.1250
Epoch: 041 train_loss: 1.2465 train_acc: 51.5625
Epoch: 042 train_loss: 1.2286 train_acc: 51.5625
Epoch: 043 train_loss: 1.2034 train_acc: 55.0781
Epoch: 044 train_loss: 1.2006 train_acc: 54.6875
Epoch: 045 train_loss: 1.1714 train_acc: 56.8359
Epoch: 046 train_loss: 1.1545 train_acc: 56.6406
Epoch: 047 train_loss: 1.1516 train_acc: 55.8594
Epoch: 048 train_loss: 1.1550 train_acc: 55.2734
Epoch: 049 train_loss: 1.1518 train_acc: 57.0312
Epoch: 050 train_loss: 1.1209 train_acc: 59.1797
Epoch: 051 train_loss: 1.1283 train_acc: 58.7891
Epoch: 052 train_loss: 1.1897 train_acc: 54.6875
Epoch: 053 train_loss: 1.1728 train_acc: 53.7109
Epoch: 054 train_loss: 1.1777 train_acc: 54.1016
Epoch: 055 train_loss: 1.1673 train_acc: 56.4453
Epoch: 056 train_loss: 1.1278 train_acc: 56.0547
Epoch: 057 train_loss: 1.1177 train_acc: 56.8359
Epoch: 058 train_loss: 1.0920 train_acc: 59.3750
Epoch: 059 train_loss: 1.1262 train_acc: 56.2500
Epoch: 060 train_loss: 1.0943 train_acc: 58.0078
Epoch: 061 train_loss: 1.1252 train_acc: 56.8359
Epoch: 062 train_loss: 1.0837 train_acc: 59.1797
Epoch: 063 train_loss: 1.0771 train_acc: 58.3984
Epoch: 064 train_loss: 1.0936 train_acc: 59.5703
Epoch: 065 train_loss: 1.0698 train_acc: 59.5703
Epoch: 066 train_loss: 1.0558 train_acc: 58.5938
Epoch: 067 train_loss: 1.0665 train_acc: 59.1797
Epoch: 068 train_loss: 1.0462 train_acc: 61.3281
Epoch: 069 train_loss: 1.0525 train_acc: 60.7422
Epoch: 070 train_loss: 1.0563 train_acc: 59.7656
Epoch: 071 train_loss: 1.0347 train_acc: 58.2031
Epoch: 072 train_loss: 1.0376 train_acc: 61.3281
Epoch: 073 train_loss: 1.0862 train_acc: 57.8125
Epoch: 074 train_loss: 1.1485 train_acc: 53.9062
Epoch: 075 train_loss: 1.0969 train_acc: 55.2734
Epoch: 076 train_loss: 1.0339 train_acc: 61.1328
Epoch: 077 train_loss: 1.0349 train_acc: 62.5000
Epoch: 078 train_loss: 1.0411 train_acc: 61.7188
Epoch: 079 train_loss: 1.0220 train_acc: 62.1094
Epoch: 080 train_loss: 0.9858 train_acc: 64.2578
Epoch: 081 train_loss: 1.0037 train_acc: 63.2812
Epoch: 082 train_loss: 0.9930 train_acc: 62.1094
Epoch: 083 train_loss: 1.0079 train_acc: 63.0859
Epoch: 084 train_loss: 1.0108 train_acc: 61.1328
Epoch: 085 train_loss: 1.0025 train_acc: 61.5234
Epoch: 086 train_loss: 1.0444 train_acc: 61.7188
Epoch: 087 train_loss: 1.0244 train_acc: 61.7188
Epoch: 088 train_loss: 0.9460 train_acc: 64.8438
Epoch: 089 train_loss: 0.9338 train_acc: 67.3828
Epoch: 090 train_loss: 0.9514 train_acc: 63.8672
Epoch: 091 train_loss: 0.9448 train_acc: 65.0391
Epoch: 092 train_loss: 0.9295 train_acc: 64.8438
Epoch: 093 train_loss: 0.9547 train_acc: 64.4531
Epoch: 094 train_loss: 0.9303 train_acc: 65.0391
Epoch: 095 train_loss: 0.9161 train_acc: 67.1875
Epoch: 096 train_loss: 0.8846 train_acc: 68.3594
Epoch: 097 train_loss: 0.9000 train_acc: 67.9688
Epoch: 098 train_loss: 0.9216 train_acc: 68.9453
Epoch: 099 train_loss: 0.8742 train_acc: 71.0938
Epoch: 100 train_loss: 0.8991 train_acc: 67.7734
Epoch: 101 train_loss: 0.8872 train_acc: 67.7734
Epoch: 102 train_loss: 0.8462 train_acc: 71.6797
Epoch: 103 train_loss: 0.8631 train_acc: 70.3125
Epoch: 104 train_loss: 0.8706 train_acc: 69.3359
Epoch: 105 train_loss: 0.8462 train_acc: 69.1406
Epoch: 106 train_loss: 0.8125 train_acc: 72.4609
Epoch: 107 train_loss: 0.8368 train_acc: 69.1406
Epoch: 108 train_loss: 0.8146 train_acc: 71.0938
Epoch: 109 train_loss: 0.8082 train_acc: 73.2422
Epoch: 110 train_loss: 0.8704 train_acc: 68.5547
Epoch: 111 train_loss: 0.9126 train_acc: 66.4062
Epoch: 112 train_loss: 0.9210 train_acc: 66.6016
Epoch: 113 train_loss: 0.8294 train_acc: 70.5078
Epoch: 114 train_loss: 0.8222 train_acc: 71.6797
Epoch: 115 train_loss: 0.7906 train_acc: 70.1172
Epoch: 116 train_loss: 0.7657 train_acc: 74.0234
Epoch: 117 train_loss: 0.7362 train_acc: 74.4141
Epoch: 118 train_loss: 0.7882 train_acc: 71.8750
Epoch: 119 train_loss: 0.7761 train_acc: 74.2188
Epoch: 120 train_loss: 0.7539 train_acc: 74.2188
Epoch: 121 train_loss: 0.7184 train_acc: 75.3906
Epoch: 122 train_loss: 0.7145 train_acc: 76.1719
Epoch: 123 train_loss: 0.6806 train_acc: 77.7344
Epoch: 124 train_loss: 0.6697 train_acc: 77.1484
Epoch: 125 train_loss: 0.6807 train_acc: 78.3203
Epoch: 126 train_loss: 0.6942 train_acc: 76.7578
Epoch: 127 train_loss: 0.7395 train_acc: 74.8047
Epoch: 128 train_loss: 0.6721 train_acc: 77.5391
Epoch: 129 train_loss: 0.6590 train_acc: 78.9062
Epoch: 130 train_loss: 0.6661 train_acc: 77.3438
Epoch: 131 train_loss: 0.6362 train_acc: 80.6641
Epoch: 132 train_loss: 0.6142 train_acc: 80.8594
Epoch: 133 train_loss: 0.6371 train_acc: 78.9062
Epoch: 134 train_loss: 0.6837 train_acc: 75.5859
Epoch: 135 train_loss: 0.6248 train_acc: 79.4922
Epoch: 136 train_loss: 0.6618 train_acc: 76.7578
Epoch: 137 train_loss: 0.6142 train_acc: 80.0781
Epoch: 138 train_loss: 0.6217 train_acc: 76.7578
Epoch: 139 train_loss: 0.6023 train_acc: 78.5156
Epoch: 140 train_loss: 0.6327 train_acc: 77.7344
Epoch: 141 train_loss: 0.6486 train_acc: 77.9297
Epoch: 142 train_loss: 0.6852 train_acc: 75.9766
Epoch: 143 train_loss: 0.7501 train_acc: 74.4141
Epoch: 144 train_loss: 0.7125 train_acc: 75.0000
Epoch: 145 train_loss: 0.7131 train_acc: 75.0000
Epoch: 146 train_loss: 0.6189 train_acc: 77.3438
Epoch: 147 train_loss: 0.6076 train_acc: 79.2969
Epoch: 148 train_loss: 0.5603 train_acc: 81.2500
Epoch: 149 train_loss: 0.5486 train_acc: 82.8125
Epoch: 150 train_loss: 0.5859 train_acc: 79.2969
Epoch: 151 train_loss: 0.5275 train_acc: 83.0078
Epoch: 152 train_loss: 0.5628 train_acc: 82.4219
Epoch: 153 train_loss: 0.5148 train_acc: 82.8125
Epoch: 154 train_loss: 0.5067 train_acc: 83.2031
Epoch: 155 train_loss: 0.5144 train_acc: 83.0078
Epoch: 156 train_loss: 0.5291 train_acc: 82.2266
Epoch: 157 train_loss: 0.4839 train_acc: 83.5938
Epoch: 158 train_loss: 0.4785 train_acc: 86.1328
Epoch: 159 train_loss: 0.4844 train_acc: 83.5938
Epoch: 160 train_loss: 0.4900 train_acc: 85.1562
Epoch: 161 train_loss: 0.4879 train_acc: 85.1562
Epoch: 162 train_loss: 0.5522 train_acc: 81.4453
Epoch: 163 train_loss: 0.5615 train_acc: 80.2734
Epoch: 164 train_loss: 0.5604 train_acc: 80.0781
Epoch: 165 train_loss: 0.5075 train_acc: 82.2266
Epoch: 166 train_loss: 0.4962 train_acc: 81.4453
Epoch: 167 train_loss: 0.5015 train_acc: 82.2266
Epoch: 168 train_loss: 0.4570 train_acc: 86.9141
Epoch: 169 train_loss: 0.4287 train_acc: 86.9141
Epoch: 170 train_loss: 0.4164 train_acc: 87.1094
Epoch: 171 train_loss: 0.4266 train_acc: 85.9375
Epoch: 172 train_loss: 0.4175 train_acc: 86.1328
Epoch: 173 train_loss: 0.4396 train_acc: 85.5469
Epoch: 174 train_loss: 0.4238 train_acc: 86.7188
Epoch: 175 train_loss: 0.4249 train_acc: 86.7188
Epoch: 176 train_loss: 0.4332 train_acc: 86.5234
Epoch: 177 train_loss: 0.4170 train_acc: 88.8672
Epoch: 178 train_loss: 0.4038 train_acc: 87.3047
Epoch: 179 train_loss: 0.4246 train_acc: 85.7422
/home/amax/anaconda3/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
Epoch: 180 train_loss: 0.3882 train_acc: 87.6953
Epoch: 181 train_loss: 0.3976 train_acc: 89.2578
Epoch: 182 train_loss: 0.3984 train_acc: 87.5000
Epoch: 183 train_loss: 0.3789 train_acc: 87.5000
Epoch: 184 train_loss: 0.4068 train_acc: 87.3047
Epoch: 185 train_loss: 0.3711 train_acc: 88.2812
Epoch: 186 train_loss: 0.3767 train_acc: 89.2578
Epoch: 187 train_loss: 0.3997 train_acc: 87.3047
Epoch: 188 train_loss: 0.3780 train_acc: 88.0859
Epoch: 189 train_loss: 0.3739 train_acc: 88.8672
Epoch: 190 train_loss: 0.3556 train_acc: 90.0391
Epoch: 191 train_loss: 0.4233 train_acc: 85.3516
Epoch: 192 train_loss: 0.4365 train_acc: 86.5234
Epoch: 193 train_loss: 0.3652 train_acc: 89.2578
Epoch: 194 train_loss: 0.3438 train_acc: 89.4531
Epoch: 195 train_loss: 0.3384 train_acc: 90.8203
Epoch: 196 train_loss: 0.3546 train_acc: 88.2812
Epoch: 197 train_loss: 0.3234 train_acc: 89.8438
Epoch: 198 train_loss: 0.3393 train_acc: 89.8438
Epoch: 199 train_loss: 0.3682 train_acc: 90.0391
Epoch: 200 train_loss: 0.3579 train_acc: 88.2812
Epoch: 201 train_loss: 0.3469 train_acc: 88.0859
Epoch: 202 train_loss: 0.3732 train_acc: 87.6953
Epoch: 203 train_loss: 0.2789 train_acc: 92.5781
Epoch: 204 train_loss: 0.2580 train_acc: 93.7500
Epoch: 205 train_loss: 0.2834 train_acc: 91.9922
Epoch: 206 train_loss: 0.3890 train_acc: 88.8672
Epoch: 207 train_loss: 0.3527 train_acc: 89.0625
Epoch: 208 train_loss: 0.3323 train_acc: 90.2344
Epoch: 209 train_loss: 0.3095 train_acc: 91.2109
Epoch: 210 train_loss: 0.3191 train_acc: 88.8672
Epoch: 211 train_loss: 0.2966 train_acc: 91.9922
Epoch: 212 train_loss: 0.3065 train_acc: 90.4297
Epoch: 213 train_loss: 0.2718 train_acc: 92.1875
Epoch: 214 train_loss: 0.2591 train_acc: 93.7500
Epoch: 215 train_loss: 0.2916 train_acc: 91.9922
Epoch: 216 train_loss: 0.2462 train_acc: 93.9453
Epoch: 217 train_loss: 0.2385 train_acc: 94.3359
Epoch: 218 train_loss: 0.2456 train_acc: 93.7500
Epoch: 219 train_loss: 0.2526 train_acc: 92.9688
Epoch: 220 train_loss: 0.2405 train_acc: 93.3594
Epoch: 221 train_loss: 0.2547 train_acc: 92.7734
Epoch: 222 train_loss: 0.2319 train_acc: 94.9219
Epoch: 223 train_loss: 0.2152 train_acc: 95.1172
Epoch: 224 train_loss: 0.2116 train_acc: 94.7266
Epoch: 225 train_loss: 0.2261 train_acc: 93.9453
Epoch: 226 train_loss: 0.2301 train_acc: 93.3594
Epoch: 227 train_loss: 0.2124 train_acc: 95.5078
Epoch: 228 train_loss: 0.2594 train_acc: 91.6016
Epoch: 229 train_loss: 0.2391 train_acc: 93.5547
Epoch: 230 train_loss: 0.2525 train_acc: 92.1875
Epoch: 231 train_loss: 0.2880 train_acc: 90.8203
Epoch: 232 train_loss: 0.2374 train_acc: 93.9453
Epoch: 233 train_loss: 0.2469 train_acc: 92.3828
Epoch: 234 train_loss: 0.2327 train_acc: 93.5547
Epoch: 235 train_loss: 0.2260 train_acc: 95.3125
Epoch: 236 train_loss: 0.2069 train_acc: 94.1406
Epoch: 237 train_loss: 0.2142 train_acc: 94.5312
Epoch: 238 train_loss: 0.1997 train_acc: 93.7500
Epoch: 239 train_loss: 0.2001 train_acc: 94.1406
Epoch: 240 train_loss: 0.1871 train_acc: 95.3125
Epoch: 241 train_loss: 0.1889 train_acc: 94.7266
Epoch: 242 train_loss: 0.2183 train_acc: 94.1406
Epoch: 243 train_loss: 0.2050 train_acc: 95.1172
Epoch: 244 train_loss: 0.1957 train_acc: 95.8984
Epoch: 245 train_loss: 0.2325 train_acc: 93.3594
Epoch: 246 train_loss: 0.2050 train_acc: 95.1172
Epoch: 247 train_loss: 0.2294 train_acc: 93.7500
Epoch: 248 train_loss: 0.2057 train_acc: 94.7266
Epoch: 249 train_loss: 0.1747 train_acc: 96.4844
Epoch: 250 train_loss: 0.1625 train_acc: 96.8750
Epoch: 251 train_loss: 0.1605 train_acc: 97.0703
Epoch: 252 train_loss: 0.1682 train_acc: 96.0938
Epoch: 253 train_loss: 0.1980 train_acc: 93.9453
Epoch: 254 train_loss: 0.2099 train_acc: 93.7500
Epoch: 255 train_loss: 0.1975 train_acc: 93.9453
Epoch: 256 train_loss: 0.2201 train_acc: 95.3125
Epoch: 257 train_loss: 0.1773 train_acc: 96.2891
Epoch: 258 train_loss: 0.2078 train_acc: 94.7266
Epoch: 259 train_loss: 0.1818 train_acc: 96.2891
Epoch: 260 train_loss: 0.1751 train_acc: 95.8984
Epoch: 261 train_loss: 0.1563 train_acc: 96.4844
Epoch: 262 train_loss: 0.2076 train_acc: 94.3359
Epoch: 263 train_loss: 0.2014 train_acc: 94.5312
Epoch: 264 train_loss: 0.1955 train_acc: 93.9453
Epoch: 265 train_loss: 0.1688 train_acc: 96.8750
Epoch: 266 train_loss: 0.1509 train_acc: 96.6797
Epoch: 267 train_loss: 0.1335 train_acc: 98.6328
Epoch: 268 train_loss: 0.1472 train_acc: 96.8750
Epoch: 269 train_loss: 0.1648 train_acc: 96.4844
Epoch: 270 train_loss: 0.1393 train_acc: 97.4609
Epoch: 271 train_loss: 0.1283 train_acc: 97.6562
Epoch: 272 train_loss: 0.1540 train_acc: 97.0703
Epoch: 273 train_loss: 0.1631 train_acc: 97.2656
Epoch: 274 train_loss: 0.1671 train_acc: 95.3125
Epoch: 275 train_loss: 0.1548 train_acc: 95.7031
Epoch: 276 train_loss: 0.1609 train_acc: 96.4844
Epoch: 277 train_loss: 0.1474 train_acc: 96.6797
Epoch: 278 train_loss: 0.1490 train_acc: 95.8984
Epoch: 279 train_loss: 0.1534 train_acc: 96.0938
Epoch: 280 train_loss: 0.1472 train_acc: 96.8750
Epoch: 281 train_loss: 0.1364 train_acc: 96.8750
Epoch: 282 train_loss: 0.1274 train_acc: 97.0703
Epoch: 283 train_loss: 0.1449 train_acc: 97.6562
Epoch: 284 train_loss: 0.1447 train_acc: 97.2656
Epoch: 285 train_loss: 0.1571 train_acc: 95.7031
Epoch: 286 train_loss: 0.1746 train_acc: 95.1172
Epoch: 287 train_loss: 0.1590 train_acc: 96.0938
Epoch: 288 train_loss: 0.1358 train_acc: 97.4609
Epoch: 289 train_loss: 0.1284 train_acc: 97.4609
Epoch: 290 train_loss: 0.1194 train_acc: 97.2656
Epoch: 291 train_loss: 0.1159 train_acc: 98.6328
Epoch: 292 train_loss: 0.1299 train_acc: 97.6562
Epoch: 293 train_loss: 0.1385 train_acc: 95.8984
Epoch: 294 train_loss: 0.1409 train_acc: 96.8750
Epoch: 295 train_loss: 0.1257 train_acc: 97.2656
Epoch: 296 train_loss: 0.1111 train_acc: 98.4375
Epoch: 297 train_loss: 0.1507 train_acc: 95.7031
Epoch: 298 train_loss: 0.1330 train_acc: 96.4844
Epoch: 299 train_loss: 0.1435 train_acc: 96.0938
Epoch: 300 train_loss: 0.1492 train_acc: 95.8984
Running Time: 167.24
**************************************************
Final result:
OA: 0.7929 | AA: 0.6670 | Kappa: 0.7645
[0.11363636 0.71702284 0.72335025 0.45777778 0.8453159  0.93659942
 0.33333333 0.98898678 0.         0.86673889 0.80445969 0.64653641
 0.99487179 0.8985025  0.50408719 0.84090909]
**************************************************
Parameter:
dataset: Indian
flag_test: train
mode: CAF
gpu_id: 0
seed: 4
batch_size: 64
test_freq: 5
patches: 7
band_patches: 3
epoches: 300
learning_rate: 0.0005
gamma: 0.9
weight_decay: 0.005
height=145,width=145,band=200
**************************************************
patch is : 7
mirror_image shape : [151,151,200]
**************************************************
x_train shape = (512, 7, 7, 200), type = float64
x_test  shape = (9737, 7, 7, 200), type = float64
x_true  shape = (21025, 7, 7, 200), type = float64
**************************************************
x_train_band shape = (512, 147, 200), type = float64
x_test_band  shape = (9737, 147, 200), type = float64
x_true_band  shape = (21025, 147, 200), type = float64
**************************************************
y_train: shape = (512,) ,type = int64
y_test: shape = (9737,) ,type = int64
y_true: shape = (21025,) ,type = int64
**************************************************
start training
Epoch: 001 train_loss: 2.5123 train_acc: 20.7031
Epoch: 002 train_loss: 2.3160 train_acc: 27.1484
Epoch: 003 train_loss: 2.1206 train_acc: 36.3281
Epoch: 004 train_loss: 1.9620 train_acc: 36.1328
Epoch: 005 train_loss: 1.8558 train_acc: 36.9141
Epoch: 006 train_loss: 1.7869 train_acc: 38.8672
Epoch: 007 train_loss: 1.7503 train_acc: 40.0391
Epoch: 008 train_loss: 1.7115 train_acc: 39.0625
Epoch: 009 train_loss: 1.6662 train_acc: 42.1875
Epoch: 010 train_loss: 1.6405 train_acc: 41.0156
Epoch: 011 train_loss: 1.6286 train_acc: 41.9922
Epoch: 012 train_loss: 1.6063 train_acc: 42.9688
Epoch: 013 train_loss: 1.5802 train_acc: 42.5781
Epoch: 014 train_loss: 1.5605 train_acc: 43.5547
Epoch: 015 train_loss: 1.5374 train_acc: 45.3125
Epoch: 016 train_loss: 1.5063 train_acc: 45.5078
Epoch: 017 train_loss: 1.4874 train_acc: 46.4844
Epoch: 018 train_loss: 1.4668 train_acc: 48.0469
Epoch: 019 train_loss: 1.4506 train_acc: 47.6562
Epoch: 020 train_loss: 1.4434 train_acc: 47.8516
Epoch: 021 train_loss: 1.4251 train_acc: 47.4609
Epoch: 022 train_loss: 1.4063 train_acc: 49.8047
Epoch: 023 train_loss: 1.4281 train_acc: 48.2422
Epoch: 024 train_loss: 1.3844 train_acc: 49.6094
Epoch: 025 train_loss: 1.3565 train_acc: 50.1953
Epoch: 026 train_loss: 1.3609 train_acc: 49.6094
Epoch: 027 train_loss: 1.3760 train_acc: 50.1953
Epoch: 028 train_loss: 1.3654 train_acc: 49.2188
Epoch: 029 train_loss: 1.3443 train_acc: 49.2188
Epoch: 030 train_loss: 1.3459 train_acc: 52.5391
Epoch: 031 train_loss: 1.3282 train_acc: 51.9531
Epoch: 032 train_loss: 1.3421 train_acc: 51.5625
Epoch: 033 train_loss: 1.2997 train_acc: 52.7344
Epoch: 034 train_loss: 1.2892 train_acc: 53.3203
Epoch: 035 train_loss: 1.2984 train_acc: 51.3672
Epoch: 036 train_loss: 1.2842 train_acc: 53.7109
Epoch: 037 train_loss: 1.2700 train_acc: 54.1016
Epoch: 038 train_loss: 1.2914 train_acc: 51.7578
Epoch: 039 train_loss: 1.2695 train_acc: 52.5391
Epoch: 040 train_loss: 1.2479 train_acc: 54.4922
Epoch: 041 train_loss: 1.2524 train_acc: 54.1016
Epoch: 042 train_loss: 1.2845 train_acc: 51.5625
Epoch: 043 train_loss: 1.2644 train_acc: 53.5156
Epoch: 044 train_loss: 1.2775 train_acc: 52.1484
Epoch: 045 train_loss: 1.2781 train_acc: 52.1484
Epoch: 046 train_loss: 1.2553 train_acc: 52.3438
Epoch: 047 train_loss: 1.2536 train_acc: 52.9297
Epoch: 048 train_loss: 1.2290 train_acc: 51.9531
Epoch: 049 train_loss: 1.2330 train_acc: 53.7109
Epoch: 050 train_loss: 1.2101 train_acc: 55.2734
Epoch: 051 train_loss: 1.1965 train_acc: 55.6641
Epoch: 052 train_loss: 1.1744 train_acc: 55.4688
Epoch: 053 train_loss: 1.1755 train_acc: 56.2500
Epoch: 054 train_loss: 1.1582 train_acc: 56.6406
Epoch: 055 train_loss: 1.1966 train_acc: 56.0547
Epoch: 056 train_loss: 1.1998 train_acc: 54.4922
Epoch: 057 train_loss: 1.1973 train_acc: 53.3203
Epoch: 058 train_loss: 1.1825 train_acc: 54.1016
Epoch: 059 train_loss: 1.1605 train_acc: 58.7891
Epoch: 060 train_loss: 1.1314 train_acc: 58.0078
Epoch: 061 train_loss: 1.1291 train_acc: 56.4453
Epoch: 062 train_loss: 1.1288 train_acc: 57.0312
Epoch: 063 train_loss: 1.0773 train_acc: 59.5703
Epoch: 064 train_loss: 1.0950 train_acc: 58.2031
Epoch: 065 train_loss: 1.0659 train_acc: 59.9609
Epoch: 066 train_loss: 1.0430 train_acc: 60.7422
Epoch: 067 train_loss: 1.0389 train_acc: 59.7656
Epoch: 068 train_loss: 1.0838 train_acc: 56.8359
Epoch: 069 train_loss: 1.0453 train_acc: 61.7188
Epoch: 070 train_loss: 1.0124 train_acc: 61.7188
Epoch: 071 train_loss: 1.0695 train_acc: 60.1562
Epoch: 072 train_loss: 1.0810 train_acc: 59.1797
Epoch: 073 train_loss: 1.0316 train_acc: 59.7656
Epoch: 074 train_loss: 1.0305 train_acc: 60.7422
Epoch: 075 train_loss: 1.0005 train_acc: 63.2812
Epoch: 076 train_loss: 0.9790 train_acc: 63.4766
Epoch: 077 train_loss: 0.9740 train_acc: 62.6953
Epoch: 078 train_loss: 0.9502 train_acc: 66.2109
Epoch: 079 train_loss: 0.9598 train_acc: 64.8438
Epoch: 080 train_loss: 0.9876 train_acc: 61.3281
Epoch: 081 train_loss: 0.9818 train_acc: 63.0859
Epoch: 082 train_loss: 0.9621 train_acc: 63.6719
Epoch: 083 train_loss: 0.9912 train_acc: 62.1094
Epoch: 084 train_loss: 0.9911 train_acc: 64.8438
Epoch: 085 train_loss: 1.0055 train_acc: 61.9141
Epoch: 086 train_loss: 0.9631 train_acc: 62.8906
Epoch: 087 train_loss: 0.9377 train_acc: 64.4531
Epoch: 088 train_loss: 0.9040 train_acc: 67.3828
Epoch: 089 train_loss: 0.9128 train_acc: 65.4297
Epoch: 090 train_loss: 0.9656 train_acc: 61.5234
Epoch: 091 train_loss: 0.8988 train_acc: 66.0156
Epoch: 092 train_loss: 0.9030 train_acc: 67.9688
Epoch: 093 train_loss: 0.8925 train_acc: 66.7969
Epoch: 094 train_loss: 0.8529 train_acc: 68.9453
Epoch: 095 train_loss: 0.8571 train_acc: 68.5547
Epoch: 096 train_loss: 0.8451 train_acc: 68.5547
Epoch: 097 train_loss: 0.8512 train_acc: 68.7500
Epoch: 098 train_loss: 0.8787 train_acc: 66.2109
Epoch: 099 train_loss: 0.8989 train_acc: 65.8203
Epoch: 100 train_loss: 0.8405 train_acc: 69.1406
Epoch: 101 train_loss: 0.8754 train_acc: 66.9922
Epoch: 102 train_loss: 0.9591 train_acc: 63.6719
Epoch: 103 train_loss: 0.8901 train_acc: 64.4531
Epoch: 104 train_loss: 0.8513 train_acc: 68.5547
Epoch: 105 train_loss: 0.7982 train_acc: 71.8750
Epoch: 106 train_loss: 0.8005 train_acc: 71.6797
Epoch: 107 train_loss: 0.8032 train_acc: 70.3125
Epoch: 108 train_loss: 0.8529 train_acc: 69.9219
Epoch: 109 train_loss: 0.7764 train_acc: 72.6562
Epoch: 110 train_loss: 0.7580 train_acc: 71.2891
Epoch: 111 train_loss: 0.7751 train_acc: 72.8516
Epoch: 112 train_loss: 0.7740 train_acc: 70.7031
Epoch: 113 train_loss: 0.7404 train_acc: 73.8281
Epoch: 114 train_loss: 0.7939 train_acc: 71.8750
Epoch: 115 train_loss: 0.7635 train_acc: 71.2891
Epoch: 116 train_loss: 0.7452 train_acc: 72.2656
Epoch: 117 train_loss: 0.7461 train_acc: 73.6328
Epoch: 118 train_loss: 0.7568 train_acc: 72.8516
Epoch: 119 train_loss: 0.7906 train_acc: 71.4844
Epoch: 120 train_loss: 0.7602 train_acc: 70.8984
Epoch: 121 train_loss: 0.7654 train_acc: 70.5078
Epoch: 122 train_loss: 0.7130 train_acc: 75.1953
Epoch: 123 train_loss: 0.7547 train_acc: 71.4844
Epoch: 124 train_loss: 0.7697 train_acc: 71.0938
Epoch: 125 train_loss: 0.7068 train_acc: 72.8516
Epoch: 126 train_loss: 0.7161 train_acc: 73.6328
Epoch: 127 train_loss: 0.7017 train_acc: 74.2188
Epoch: 128 train_loss: 0.6858 train_acc: 75.3906
Epoch: 129 train_loss: 0.7096 train_acc: 73.8281
Epoch: 130 train_loss: 0.7237 train_acc: 73.2422
Epoch: 131 train_loss: 0.6711 train_acc: 74.2188
Epoch: 132 train_loss: 0.7081 train_acc: 76.3672
Epoch: 133 train_loss: 0.6756 train_acc: 74.8047
Epoch: 134 train_loss: 0.6905 train_acc: 73.6328
Epoch: 135 train_loss: 0.7147 train_acc: 73.4375
Epoch: 136 train_loss: 0.6673 train_acc: 75.5859
Epoch: 137 train_loss: 0.6520 train_acc: 78.5156
Epoch: 138 train_loss: 0.6701 train_acc: 75.9766
Epoch: 139 train_loss: 0.6315 train_acc: 75.1953
Epoch: 140 train_loss: 0.6496 train_acc: 76.5625
Epoch: 141 train_loss: 0.6269 train_acc: 77.7344
Epoch: 142 train_loss: 0.6405 train_acc: 76.9531
Epoch: 143 train_loss: 0.6599 train_acc: 76.7578
Epoch: 144 train_loss: 0.6845 train_acc: 76.9531
Epoch: 145 train_loss: 0.6157 train_acc: 78.9062
Epoch: 146 train_loss: 0.6164 train_acc: 78.1250
Epoch: 147 train_loss: 0.6237 train_acc: 77.9297
Epoch: 148 train_loss: 0.6233 train_acc: 78.7109
Epoch: 149 train_loss: 0.6198 train_acc: 77.3438
Epoch: 150 train_loss: 0.5818 train_acc: 79.6875
Epoch: 151 train_loss: 0.5766 train_acc: 80.4688
Epoch: 152 train_loss: 0.5607 train_acc: 83.0078
Epoch: 153 train_loss: 0.5621 train_acc: 80.8594
Epoch: 154 train_loss: 0.5601 train_acc: 80.4688
Epoch: 155 train_loss: 0.5508 train_acc: 79.8828
Epoch: 156 train_loss: 0.6208 train_acc: 76.1719
Epoch: 157 train_loss: 0.6052 train_acc: 78.7109
Epoch: 158 train_loss: 0.5889 train_acc: 80.2734
Epoch: 159 train_loss: 0.5685 train_acc: 79.6875
Epoch: 160 train_loss: 0.5755 train_acc: 80.0781
Epoch: 161 train_loss: 0.5538 train_acc: 78.9062
Epoch: 162 train_loss: 0.5497 train_acc: 80.4688
Epoch: 163 train_loss: 0.5415 train_acc: 81.2500
Epoch: 164 train_loss: 0.5108 train_acc: 83.3984
Epoch: 165 train_loss: 0.5024 train_acc: 83.3984
Epoch: 166 train_loss: 0.4976 train_acc: 84.9609
Epoch: 167 train_loss: 0.5000 train_acc: 84.3750
Epoch: 168 train_loss: 0.5436 train_acc: 82.2266
Epoch: 169 train_loss: 0.4875 train_acc: 82.6172
Epoch: 170 train_loss: 0.5178 train_acc: 80.8594
Epoch: 171 train_loss: 0.5413 train_acc: 81.0547
Epoch: 172 train_loss: 0.4945 train_acc: 83.2031
Epoch: 173 train_loss: 0.4957 train_acc: 83.5938
Epoch: 174 train_loss: 0.4757 train_acc: 84.1797
Epoch: 175 train_loss: 0.4215 train_acc: 87.1094
Epoch: 176 train_loss: 0.4416 train_acc: 85.3516
Epoch: 177 train_loss: 0.4950 train_acc: 85.1562
Epoch: 178 train_loss: 0.5021 train_acc: 83.7891
Epoch: 179 train_loss: 0.5289 train_acc: 81.4453
Epoch: 180 train_loss: 0.5339 train_acc: 81.0547
Epoch: 181 train_loss: 0.4545 train_acc: 85.3516
Epoch: 182 train_loss: 0.4693 train_acc: 84.3750
Epoch: 183 train_loss: 0.4296 train_acc: 86.1328
Epoch: 184 train_loss: 0.4078 train_acc: 88.6719
Epoch: 185 train_loss: 0.4038 train_acc: 87.5000
Epoch: 186 train_loss: 0.3974 train_acc: 88.4766
/home/amax/anaconda3/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
Epoch: 187 train_loss: 0.3927 train_acc: 87.6953
Epoch: 188 train_loss: 0.3764 train_acc: 88.4766
Epoch: 189 train_loss: 0.3933 train_acc: 87.3047
Epoch: 190 train_loss: 0.3852 train_acc: 89.0625
Epoch: 191 train_loss: 0.3665 train_acc: 88.6719
Epoch: 192 train_loss: 0.4218 train_acc: 87.1094
Epoch: 193 train_loss: 0.3575 train_acc: 90.6250
Epoch: 194 train_loss: 0.3659 train_acc: 89.4531
Epoch: 195 train_loss: 0.3260 train_acc: 90.6250
Epoch: 196 train_loss: 0.3508 train_acc: 88.8672
Epoch: 197 train_loss: 0.3700 train_acc: 88.4766
Epoch: 198 train_loss: 0.3392 train_acc: 90.6250
Epoch: 199 train_loss: 0.3249 train_acc: 90.6250
Epoch: 200 train_loss: 0.3389 train_acc: 89.4531
Epoch: 201 train_loss: 0.3386 train_acc: 91.9922
Epoch: 202 train_loss: 0.3211 train_acc: 90.6250
Epoch: 203 train_loss: 0.3094 train_acc: 91.2109
Epoch: 204 train_loss: 0.3206 train_acc: 89.8438
Epoch: 205 train_loss: 0.3443 train_acc: 88.6719
Epoch: 206 train_loss: 0.3468 train_acc: 88.6719
Epoch: 207 train_loss: 0.3315 train_acc: 90.0391
Epoch: 208 train_loss: 0.3188 train_acc: 91.4062
Epoch: 209 train_loss: 0.3000 train_acc: 91.7969
Epoch: 210 train_loss: 0.3019 train_acc: 91.0156
Epoch: 211 train_loss: 0.3162 train_acc: 90.4297
Epoch: 212 train_loss: 0.2964 train_acc: 92.1875
Epoch: 213 train_loss: 0.2679 train_acc: 92.9688
Epoch: 214 train_loss: 0.3415 train_acc: 90.2344
Epoch: 215 train_loss: 0.3202 train_acc: 91.0156
Epoch: 216 train_loss: 0.2954 train_acc: 90.8203
Epoch: 217 train_loss: 0.2589 train_acc: 92.1875
Epoch: 218 train_loss: 0.3302 train_acc: 89.4531
Epoch: 219 train_loss: 0.3098 train_acc: 91.0156
Epoch: 220 train_loss: 0.2526 train_acc: 93.5547
Epoch: 221 train_loss: 0.2777 train_acc: 91.9922
Epoch: 222 train_loss: 0.2473 train_acc: 92.7734
Epoch: 223 train_loss: 0.2547 train_acc: 92.5781
Epoch: 224 train_loss: 0.2201 train_acc: 94.9219
Epoch: 225 train_loss: 0.2403 train_acc: 94.9219
Epoch: 226 train_loss: 0.2355 train_acc: 93.1641
Epoch: 227 train_loss: 0.2378 train_acc: 93.1641
Epoch: 228 train_loss: 0.2529 train_acc: 93.9453
Epoch: 229 train_loss: 0.2598 train_acc: 93.1641
Epoch: 230 train_loss: 0.2909 train_acc: 92.5781
Epoch: 231 train_loss: 0.2848 train_acc: 91.0156
Epoch: 232 train_loss: 0.2763 train_acc: 91.2109
Epoch: 233 train_loss: 0.3073 train_acc: 91.6016
Epoch: 234 train_loss: 0.2610 train_acc: 93.5547
Epoch: 235 train_loss: 0.2629 train_acc: 93.5547
Epoch: 236 train_loss: 0.2373 train_acc: 94.1406
Epoch: 237 train_loss: 0.2359 train_acc: 93.5547
Epoch: 238 train_loss: 0.2436 train_acc: 92.3828
Epoch: 239 train_loss: 0.2796 train_acc: 91.9922
Epoch: 240 train_loss: 0.2560 train_acc: 92.7734
Epoch: 241 train_loss: 0.2308 train_acc: 94.3359
Epoch: 242 train_loss: 0.2429 train_acc: 93.5547
Epoch: 243 train_loss: 0.2353 train_acc: 93.3594
Epoch: 244 train_loss: 0.2002 train_acc: 93.7500
Epoch: 245 train_loss: 0.1988 train_acc: 95.3125
Epoch: 246 train_loss: 0.2153 train_acc: 94.7266
Epoch: 247 train_loss: 0.1888 train_acc: 95.3125
Epoch: 248 train_loss: 0.2023 train_acc: 95.1172
Epoch: 249 train_loss: 0.1977 train_acc: 95.1172
Epoch: 250 train_loss: 0.2000 train_acc: 94.9219
Epoch: 251 train_loss: 0.1856 train_acc: 95.8984
Epoch: 252 train_loss: 0.1917 train_acc: 95.3125
Epoch: 253 train_loss: 0.1824 train_acc: 95.7031
Epoch: 254 train_loss: 0.2007 train_acc: 93.7500
Epoch: 255 train_loss: 0.1996 train_acc: 95.3125
Epoch: 256 train_loss: 0.1975 train_acc: 94.9219
Epoch: 257 train_loss: 0.1860 train_acc: 95.3125
Epoch: 258 train_loss: 0.2016 train_acc: 94.7266
Epoch: 259 train_loss: 0.1900 train_acc: 94.5312
Epoch: 260 train_loss: 0.1924 train_acc: 94.7266
Epoch: 261 train_loss: 0.1925 train_acc: 94.9219
Epoch: 262 train_loss: 0.1605 train_acc: 96.2891
Epoch: 263 train_loss: 0.1656 train_acc: 95.7031
Epoch: 264 train_loss: 0.1619 train_acc: 97.0703
Epoch: 265 train_loss: 0.1743 train_acc: 95.7031
Epoch: 266 train_loss: 0.2105 train_acc: 94.1406
Epoch: 267 train_loss: 0.2494 train_acc: 92.7734
Epoch: 268 train_loss: 0.2380 train_acc: 92.7734
Epoch: 269 train_loss: 0.2339 train_acc: 93.5547
Epoch: 270 train_loss: 0.2149 train_acc: 93.7500
Epoch: 271 train_loss: 0.2101 train_acc: 94.9219
Epoch: 272 train_loss: 0.1875 train_acc: 94.3359
Epoch: 273 train_loss: 0.1743 train_acc: 95.1172
Epoch: 274 train_loss: 0.1697 train_acc: 95.8984
Epoch: 275 train_loss: 0.1562 train_acc: 96.2891
Epoch: 276 train_loss: 0.1706 train_acc: 94.9219
Epoch: 277 train_loss: 0.1668 train_acc: 95.1172
Epoch: 278 train_loss: 0.1751 train_acc: 95.5078
Epoch: 279 train_loss: 0.2065 train_acc: 93.1641
Epoch: 280 train_loss: 0.1694 train_acc: 96.2891
Epoch: 281 train_loss: 0.1449 train_acc: 97.4609
Epoch: 282 train_loss: 0.1756 train_acc: 95.8984
Epoch: 283 train_loss: 0.1607 train_acc: 96.0938
Epoch: 284 train_loss: 0.1733 train_acc: 96.0938
Epoch: 285 train_loss: 0.1477 train_acc: 96.6797
Epoch: 286 train_loss: 0.1337 train_acc: 97.8516
Epoch: 287 train_loss: 0.1742 train_acc: 94.5312
Epoch: 288 train_loss: 0.1533 train_acc: 95.1172
Epoch: 289 train_loss: 0.1747 train_acc: 96.2891
Epoch: 290 train_loss: 0.1961 train_acc: 94.3359
Epoch: 291 train_loss: 0.1794 train_acc: 95.5078
Epoch: 292 train_loss: 0.1547 train_acc: 95.5078
Epoch: 293 train_loss: 0.1554 train_acc: 96.2891
Epoch: 294 train_loss: 0.1257 train_acc: 97.6562
Epoch: 295 train_loss: 0.1240 train_acc: 97.0703
Epoch: 296 train_loss: 0.1350 train_acc: 96.6797
Epoch: 297 train_loss: 0.1413 train_acc: 96.4844
Epoch: 298 train_loss: 0.1907 train_acc: 93.9453
Epoch: 299 train_loss: 0.1471 train_acc: 97.6562
Epoch: 300 train_loss: 0.1416 train_acc: 96.2891
Running Time: 168.08
**************************************************
Final result:
OA: 0.8100 | AA: 0.7043 | Kappa: 0.7830
[0.36363636 0.78481945 0.75761421 0.45333333 0.90196078 0.93227666
 0.03703704 0.97356828 0.57894737 0.85807151 0.84519726 0.58614565
 1.         0.90016639 0.38692098 0.90909091]
**************************************************
Parameter:
dataset: Indian
flag_test: train
mode: CAF
gpu_id: 0
seed: 5
batch_size: 64
test_freq: 5
patches: 7
band_patches: 3
epoches: 300
learning_rate: 0.0005
gamma: 0.9
weight_decay: 0.005
height=145,width=145,band=200
**************************************************
patch is : 7
mirror_image shape : [151,151,200]
**************************************************
x_train shape = (512, 7, 7, 200), type = float64
x_test  shape = (9737, 7, 7, 200), type = float64
x_true  shape = (21025, 7, 7, 200), type = float64
**************************************************
x_train_band shape = (512, 147, 200), type = float64
x_test_band  shape = (9737, 147, 200), type = float64
x_true_band  shape = (21025, 147, 200), type = float64
**************************************************
y_train: shape = (512,) ,type = int64
y_test: shape = (9737,) ,type = int64
y_true: shape = (21025,) ,type = int64
**************************************************
start training
Epoch: 001 train_loss: 2.4256 train_acc: 21.6797
Epoch: 002 train_loss: 2.1805 train_acc: 32.8125
Epoch: 003 train_loss: 2.0023 train_acc: 36.1328
Epoch: 004 train_loss: 1.8799 train_acc: 36.3281
Epoch: 005 train_loss: 1.8254 train_acc: 38.6719
Epoch: 006 train_loss: 1.7580 train_acc: 40.2344
Epoch: 007 train_loss: 1.7373 train_acc: 39.4531
Epoch: 008 train_loss: 1.6942 train_acc: 41.4062
Epoch: 009 train_loss: 1.6739 train_acc: 42.1875
Epoch: 010 train_loss: 1.6368 train_acc: 43.5547
Epoch: 011 train_loss: 1.6105 train_acc: 43.3594
Epoch: 012 train_loss: 1.5894 train_acc: 42.3828
Epoch: 013 train_loss: 1.5865 train_acc: 42.7734
Epoch: 014 train_loss: 1.5876 train_acc: 42.9688
Epoch: 015 train_loss: 1.5233 train_acc: 45.3125
Epoch: 016 train_loss: 1.4870 train_acc: 46.4844
Epoch: 017 train_loss: 1.4769 train_acc: 45.5078
Epoch: 018 train_loss: 1.4568 train_acc: 46.8750
Epoch: 019 train_loss: 1.4396 train_acc: 46.4844
Epoch: 020 train_loss: 1.4070 train_acc: 47.4609
Epoch: 021 train_loss: 1.4102 train_acc: 48.2422
Epoch: 022 train_loss: 1.3908 train_acc: 48.4375
Epoch: 023 train_loss: 1.3837 train_acc: 47.8516
Epoch: 024 train_loss: 1.4103 train_acc: 47.4609
Epoch: 025 train_loss: 1.3532 train_acc: 48.4375
Epoch: 026 train_loss: 1.3568 train_acc: 47.6562
Epoch: 027 train_loss: 1.3415 train_acc: 50.3906
Epoch: 028 train_loss: 1.3233 train_acc: 50.9766
Epoch: 029 train_loss: 1.3193 train_acc: 50.5859
Epoch: 030 train_loss: 1.2894 train_acc: 51.5625
Epoch: 031 train_loss: 1.3025 train_acc: 50.9766
Epoch: 032 train_loss: 1.2983 train_acc: 51.3672
Epoch: 033 train_loss: 1.3122 train_acc: 51.3672
Epoch: 034 train_loss: 1.2783 train_acc: 52.5391
Epoch: 035 train_loss: 1.2905 train_acc: 51.5625
Epoch: 036 train_loss: 1.2688 train_acc: 51.9531
Epoch: 037 train_loss: 1.2638 train_acc: 53.5156
Epoch: 038 train_loss: 1.2584 train_acc: 53.3203
Epoch: 039 train_loss: 1.2512 train_acc: 52.9297
Epoch: 040 train_loss: 1.2621 train_acc: 51.5625
Epoch: 041 train_loss: 1.2474 train_acc: 53.3203
Epoch: 042 train_loss: 1.2468 train_acc: 53.1250
Epoch: 043 train_loss: 1.2242 train_acc: 55.4688
Epoch: 044 train_loss: 1.2233 train_acc: 54.1016
Epoch: 045 train_loss: 1.2210 train_acc: 53.9062
Epoch: 046 train_loss: 1.2161 train_acc: 54.2969
Epoch: 047 train_loss: 1.2294 train_acc: 53.7109
Epoch: 048 train_loss: 1.2107 train_acc: 54.2969
Epoch: 049 train_loss: 1.2121 train_acc: 53.7109
Epoch: 050 train_loss: 1.1761 train_acc: 55.0781
Epoch: 051 train_loss: 1.1782 train_acc: 56.2500
Epoch: 052 train_loss: 1.1797 train_acc: 56.4453
Epoch: 053 train_loss: 1.2095 train_acc: 54.8828
Epoch: 054 train_loss: 1.1994 train_acc: 53.9062
Epoch: 055 train_loss: 1.1896 train_acc: 54.1016
Epoch: 056 train_loss: 1.1676 train_acc: 55.6641
Epoch: 057 train_loss: 1.1874 train_acc: 54.1016
Epoch: 058 train_loss: 1.2128 train_acc: 53.3203
Epoch: 059 train_loss: 1.2172 train_acc: 55.8594
Epoch: 060 train_loss: 1.1634 train_acc: 54.2969
Epoch: 061 train_loss: 1.1622 train_acc: 54.4922
Epoch: 062 train_loss: 1.1341 train_acc: 56.8359
Epoch: 063 train_loss: 1.1392 train_acc: 56.2500
Epoch: 064 train_loss: 1.1242 train_acc: 58.0078
Epoch: 065 train_loss: 1.1301 train_acc: 58.5938
Epoch: 066 train_loss: 1.1021 train_acc: 57.8125
Epoch: 067 train_loss: 1.1246 train_acc: 56.4453
Epoch: 068 train_loss: 1.1033 train_acc: 59.9609
Epoch: 069 train_loss: 1.1011 train_acc: 58.3984
Epoch: 070 train_loss: 1.0720 train_acc: 59.1797
Epoch: 071 train_loss: 1.0609 train_acc: 59.5703
Epoch: 072 train_loss: 1.0844 train_acc: 59.7656
Epoch: 073 train_loss: 1.0799 train_acc: 59.1797
Epoch: 074 train_loss: 1.0508 train_acc: 60.7422
Epoch: 075 train_loss: 1.0424 train_acc: 60.7422
Epoch: 076 train_loss: 1.0520 train_acc: 60.5469
Epoch: 077 train_loss: 1.0680 train_acc: 58.5938
Epoch: 078 train_loss: 1.0276 train_acc: 59.9609
Epoch: 079 train_loss: 1.0290 train_acc: 61.3281
Epoch: 080 train_loss: 1.0054 train_acc: 62.3047
Epoch: 081 train_loss: 0.9986 train_acc: 61.7188
Epoch: 082 train_loss: 1.0178 train_acc: 61.3281
Epoch: 083 train_loss: 1.0095 train_acc: 61.5234
Epoch: 084 train_loss: 1.0115 train_acc: 61.9141
Epoch: 085 train_loss: 0.9959 train_acc: 62.8906
Epoch: 086 train_loss: 0.9856 train_acc: 62.6953
Epoch: 087 train_loss: 0.9658 train_acc: 63.6719
Epoch: 088 train_loss: 0.9495 train_acc: 64.4531
Epoch: 089 train_loss: 1.0474 train_acc: 61.5234
Epoch: 090 train_loss: 0.9936 train_acc: 61.3281
Epoch: 091 train_loss: 1.0312 train_acc: 60.5469
Epoch: 092 train_loss: 0.9702 train_acc: 63.2812
Epoch: 093 train_loss: 0.9388 train_acc: 63.6719
Epoch: 094 train_loss: 0.9102 train_acc: 65.2344
Epoch: 095 train_loss: 0.9170 train_acc: 65.2344
Epoch: 096 train_loss: 0.9285 train_acc: 66.4062
Epoch: 097 train_loss: 0.9742 train_acc: 63.6719
Epoch: 098 train_loss: 0.9181 train_acc: 65.0391
Epoch: 099 train_loss: 0.9767 train_acc: 61.5234
Epoch: 100 train_loss: 0.9651 train_acc: 60.7422
Epoch: 101 train_loss: 0.9391 train_acc: 63.6719
Epoch: 102 train_loss: 0.9143 train_acc: 66.7969
Epoch: 103 train_loss: 0.9363 train_acc: 64.4531
Epoch: 104 train_loss: 0.8727 train_acc: 66.0156
Epoch: 105 train_loss: 0.9390 train_acc: 64.6484
Epoch: 106 train_loss: 0.8872 train_acc: 65.6250
Epoch: 107 train_loss: 0.8591 train_acc: 67.9688
Epoch: 108 train_loss: 0.8350 train_acc: 68.5547
Epoch: 109 train_loss: 0.8126 train_acc: 68.3594
Epoch: 110 train_loss: 0.8474 train_acc: 69.3359
Epoch: 111 train_loss: 0.8100 train_acc: 73.0469
Epoch: 112 train_loss: 0.7983 train_acc: 69.1406
Epoch: 113 train_loss: 0.8515 train_acc: 69.7266
Epoch: 114 train_loss: 0.8275 train_acc: 64.4531
Epoch: 115 train_loss: 0.8362 train_acc: 68.1641
Epoch: 116 train_loss: 0.7889 train_acc: 70.5078
Epoch: 117 train_loss: 0.7717 train_acc: 70.8984
Epoch: 118 train_loss: 0.7450 train_acc: 73.4375
Epoch: 119 train_loss: 0.7532 train_acc: 73.2422
Epoch: 120 train_loss: 0.7688 train_acc: 71.2891
Epoch: 121 train_loss: 0.7338 train_acc: 73.8281
Epoch: 122 train_loss: 0.7492 train_acc: 73.0469
Epoch: 123 train_loss: 0.7332 train_acc: 74.6094
Epoch: 124 train_loss: 0.7067 train_acc: 74.6094
Epoch: 125 train_loss: 0.7191 train_acc: 75.1953
Epoch: 126 train_loss: 0.6990 train_acc: 74.0234
Epoch: 127 train_loss: 0.6866 train_acc: 75.0000
Epoch: 128 train_loss: 0.7135 train_acc: 75.7812
Epoch: 129 train_loss: 0.7399 train_acc: 73.2422
Epoch: 130 train_loss: 0.6922 train_acc: 75.3906
Epoch: 131 train_loss: 0.6779 train_acc: 75.9766
Epoch: 132 train_loss: 0.6800 train_acc: 76.5625
Epoch: 133 train_loss: 0.6880 train_acc: 75.1953
Epoch: 134 train_loss: 0.6800 train_acc: 76.3672
Epoch: 135 train_loss: 0.7014 train_acc: 75.0000
Epoch: 136 train_loss: 0.6737 train_acc: 77.9297
Epoch: 137 train_loss: 0.6685 train_acc: 77.5391
Epoch: 138 train_loss: 0.6613 train_acc: 74.4141
Epoch: 139 train_loss: 0.6389 train_acc: 77.1484
Epoch: 140 train_loss: 0.6468 train_acc: 75.3906
Epoch: 141 train_loss: 0.6167 train_acc: 77.1484
Epoch: 142 train_loss: 0.6510 train_acc: 76.7578
Epoch: 143 train_loss: 0.6254 train_acc: 77.1484
Epoch: 144 train_loss: 0.5902 train_acc: 80.4688
Epoch: 145 train_loss: 0.6319 train_acc: 76.3672
Epoch: 146 train_loss: 0.6166 train_acc: 78.7109
Epoch: 147 train_loss: 0.5840 train_acc: 81.2500
Epoch: 148 train_loss: 0.5658 train_acc: 80.6641
Epoch: 149 train_loss: 0.5863 train_acc: 80.2734
Epoch: 150 train_loss: 0.6107 train_acc: 79.2969
Epoch: 151 train_loss: 0.6078 train_acc: 79.6875
Epoch: 152 train_loss: 0.5757 train_acc: 81.4453
Epoch: 153 train_loss: 0.5803 train_acc: 81.0547
Epoch: 154 train_loss: 0.5247 train_acc: 83.7891
Epoch: 155 train_loss: 0.5668 train_acc: 80.6641
Epoch: 156 train_loss: 0.5567 train_acc: 80.6641
Epoch: 157 train_loss: 0.5144 train_acc: 84.5703
Epoch: 158 train_loss: 0.5109 train_acc: 83.2031
Epoch: 159 train_loss: 0.4857 train_acc: 84.7656
Epoch: 160 train_loss: 0.5131 train_acc: 84.3750
Epoch: 161 train_loss: 0.4655 train_acc: 85.7422
Epoch: 162 train_loss: 0.5060 train_acc: 83.7891
Epoch: 163 train_loss: 0.4545 train_acc: 86.1328
Epoch: 164 train_loss: 0.4600 train_acc: 84.5703
Epoch: 165 train_loss: 0.4578 train_acc: 87.1094
Epoch: 166 train_loss: 0.5099 train_acc: 83.9844
Epoch: 167 train_loss: 0.5313 train_acc: 81.0547
Epoch: 168 train_loss: 0.4783 train_acc: 85.1562
Epoch: 169 train_loss: 0.4681 train_acc: 83.0078
Epoch: 170 train_loss: 0.5091 train_acc: 83.3984
Epoch: 171 train_loss: 0.5565 train_acc: 81.0547
Epoch: 172 train_loss: 0.4995 train_acc: 82.0312
Epoch: 173 train_loss: 0.4924 train_acc: 84.5703
Epoch: 174 train_loss: 0.4380 train_acc: 87.3047
Epoch: 175 train_loss: 0.4444 train_acc: 86.7188
Epoch: 176 train_loss: 0.4495 train_acc: 87.3047
Epoch: 177 train_loss: 0.4279 train_acc: 85.1562
Epoch: 178 train_loss: 0.4394 train_acc: 84.7656
Epoch: 179 train_loss: 0.4452 train_acc: 85.5469
Epoch: 180 train_loss: 0.4075 train_acc: 86.3281
Epoch: 181 train_loss: 0.4163 train_acc: 86.1328
Epoch: 182 train_loss: 0.3830 train_acc: 88.8672
Epoch: 183 train_loss: 0.3865 train_acc: 89.6484
Epoch: 184 train_loss: 0.4258 train_acc: 84.5703
Epoch: 185 train_loss: 0.4312 train_acc: 86.9141
Epoch: 186 train_loss: 0.4048 train_acc: 85.7422
Epoch: 187 train_loss: 0.3869 train_acc: 87.5000
Epoch: 188 train_loss: 0.3827 train_acc: 86.5234
Epoch: 189 train_loss: 0.3494 train_acc: 91.0156
Epoch: 190 train_loss: 0.3414 train_acc: 91.4062
Epoch: 191 train_loss: 0.3458 train_acc: 89.8438
Epoch: 192 train_loss: 0.3710 train_acc: 88.6719
Epoch: 193 train_loss: 0.3033 train_acc: 92.3828
/home/amax/anaconda3/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
Epoch: 194 train_loss: 0.3505 train_acc: 89.6484
Epoch: 195 train_loss: 0.3285 train_acc: 90.0391
Epoch: 196 train_loss: 0.3329 train_acc: 89.6484
Epoch: 197 train_loss: 0.3217 train_acc: 90.0391
Epoch: 198 train_loss: 0.3214 train_acc: 90.6250
Epoch: 199 train_loss: 0.2943 train_acc: 91.4062
Epoch: 200 train_loss: 0.3063 train_acc: 91.6016
Epoch: 201 train_loss: 0.2852 train_acc: 91.6016
Epoch: 202 train_loss: 0.3094 train_acc: 92.5781
Epoch: 203 train_loss: 0.3009 train_acc: 92.1875
Epoch: 204 train_loss: 0.2944 train_acc: 91.7969
Epoch: 205 train_loss: 0.2813 train_acc: 92.9688
Epoch: 206 train_loss: 0.3220 train_acc: 90.2344
Epoch: 207 train_loss: 0.3310 train_acc: 90.0391
Epoch: 208 train_loss: 0.3408 train_acc: 89.0625
Epoch: 209 train_loss: 0.3405 train_acc: 90.0391
Epoch: 210 train_loss: 0.2975 train_acc: 90.2344
Epoch: 211 train_loss: 0.3306 train_acc: 88.8672
Epoch: 212 train_loss: 0.3131 train_acc: 89.4531
Epoch: 213 train_loss: 0.2881 train_acc: 91.7969
Epoch: 214 train_loss: 0.3121 train_acc: 91.0156
Epoch: 215 train_loss: 0.2647 train_acc: 92.5781
Epoch: 216 train_loss: 0.2479 train_acc: 93.1641
Epoch: 217 train_loss: 0.2502 train_acc: 93.3594
Epoch: 218 train_loss: 0.2337 train_acc: 94.3359
Epoch: 219 train_loss: 0.2414 train_acc: 94.1406
Epoch: 220 train_loss: 0.2424 train_acc: 93.9453
Epoch: 221 train_loss: 0.2385 train_acc: 93.7500
Epoch: 222 train_loss: 0.2315 train_acc: 96.0938
Epoch: 223 train_loss: 0.2521 train_acc: 93.3594
Epoch: 224 train_loss: 0.2650 train_acc: 92.5781
Epoch: 225 train_loss: 0.3018 train_acc: 92.5781
Epoch: 226 train_loss: 0.2885 train_acc: 91.7969
Epoch: 227 train_loss: 0.2356 train_acc: 94.3359
Epoch: 228 train_loss: 0.2276 train_acc: 93.5547
Epoch: 229 train_loss: 0.2572 train_acc: 91.7969
Epoch: 230 train_loss: 0.2417 train_acc: 93.5547
Epoch: 231 train_loss: 0.2103 train_acc: 95.7031
Epoch: 232 train_loss: 0.2267 train_acc: 94.9219
Epoch: 233 train_loss: 0.2370 train_acc: 94.1406
Epoch: 234 train_loss: 0.2965 train_acc: 91.9922
Epoch: 235 train_loss: 0.2301 train_acc: 93.7500
Epoch: 236 train_loss: 0.2396 train_acc: 93.7500
Epoch: 237 train_loss: 0.3017 train_acc: 91.4062
Epoch: 238 train_loss: 0.2617 train_acc: 91.9922
Epoch: 239 train_loss: 0.2524 train_acc: 92.9688
Epoch: 240 train_loss: 0.2449 train_acc: 92.7734
Epoch: 241 train_loss: 0.2052 train_acc: 95.7031
Epoch: 242 train_loss: 0.1932 train_acc: 95.5078
Epoch: 243 train_loss: 0.2001 train_acc: 95.1172
Epoch: 244 train_loss: 0.2289 train_acc: 94.5312
Epoch: 245 train_loss: 0.2187 train_acc: 94.9219
Epoch: 246 train_loss: 0.2086 train_acc: 94.9219
Epoch: 247 train_loss: 0.1916 train_acc: 96.4844
Epoch: 248 train_loss: 0.2211 train_acc: 94.3359
Epoch: 249 train_loss: 0.2835 train_acc: 90.6250
Epoch: 250 train_loss: 0.2453 train_acc: 93.1641
Epoch: 251 train_loss: 0.2235 train_acc: 94.1406
Epoch: 252 train_loss: 0.2130 train_acc: 94.1406
Epoch: 253 train_loss: 0.1884 train_acc: 95.7031
Epoch: 254 train_loss: 0.1854 train_acc: 95.5078
Epoch: 255 train_loss: 0.1799 train_acc: 94.9219
Epoch: 256 train_loss: 0.1840 train_acc: 95.5078
Epoch: 257 train_loss: 0.1887 train_acc: 96.2891
Epoch: 258 train_loss: 0.1878 train_acc: 95.5078
Epoch: 259 train_loss: 0.1677 train_acc: 97.0703
Epoch: 260 train_loss: 0.1697 train_acc: 95.8984
Epoch: 261 train_loss: 0.1847 train_acc: 95.7031
Epoch: 262 train_loss: 0.1766 train_acc: 95.8984
Epoch: 263 train_loss: 0.1814 train_acc: 95.7031
Epoch: 264 train_loss: 0.1666 train_acc: 96.2891
Epoch: 265 train_loss: 0.1599 train_acc: 96.4844
Epoch: 266 train_loss: 0.1614 train_acc: 97.0703
Epoch: 267 train_loss: 0.1772 train_acc: 94.9219
Epoch: 268 train_loss: 0.1610 train_acc: 96.6797
Epoch: 269 train_loss: 0.1858 train_acc: 95.1172
Epoch: 270 train_loss: 0.1514 train_acc: 96.2891
Epoch: 271 train_loss: 0.1447 train_acc: 96.0938
Epoch: 272 train_loss: 0.1747 train_acc: 95.5078
Epoch: 273 train_loss: 0.1508 train_acc: 97.2656
Epoch: 274 train_loss: 0.1570 train_acc: 96.6797
Epoch: 275 train_loss: 0.1436 train_acc: 97.8516
Epoch: 276 train_loss: 0.1478 train_acc: 97.0703
Epoch: 277 train_loss: 0.1395 train_acc: 97.8516
Epoch: 278 train_loss: 0.1328 train_acc: 97.8516
Epoch: 279 train_loss: 0.1161 train_acc: 98.2422
Epoch: 280 train_loss: 0.1379 train_acc: 98.4375
Epoch: 281 train_loss: 0.1398 train_acc: 97.4609
Epoch: 282 train_loss: 0.1404 train_acc: 96.8750
Epoch: 283 train_loss: 0.1245 train_acc: 97.4609
Epoch: 284 train_loss: 0.1525 train_acc: 97.2656
Epoch: 285 train_loss: 0.1541 train_acc: 96.8750
Epoch: 286 train_loss: 0.1444 train_acc: 96.0938
Epoch: 287 train_loss: 0.1364 train_acc: 97.4609
Epoch: 288 train_loss: 0.1212 train_acc: 97.6562
Epoch: 289 train_loss: 0.1625 train_acc: 96.4844
Epoch: 290 train_loss: 0.1312 train_acc: 97.6562
Epoch: 291 train_loss: 0.1459 train_acc: 96.6797
Epoch: 292 train_loss: 0.1749 train_acc: 94.9219
Epoch: 293 train_loss: 0.1361 train_acc: 96.4844
Epoch: 294 train_loss: 0.1586 train_acc: 96.6797
Epoch: 295 train_loss: 0.1609 train_acc: 96.6797
Epoch: 296 train_loss: 0.1493 train_acc: 97.4609
Epoch: 297 train_loss: 0.1165 train_acc: 98.2422
Epoch: 298 train_loss: 0.1163 train_acc: 97.4609
Epoch: 299 train_loss: 0.1340 train_acc: 96.8750
Epoch: 300 train_loss: 0.1124 train_acc: 98.0469
Running Time: 166.09
**************************************************
Final result:
OA: 0.7325 | AA: 0.5823 | Kappa: 0.6939
[0.09090909 0.59248342 0.7106599  0.32       0.75816993 0.76801153
 0.14814815 0.98017621 0.         0.74106176 0.80789022 0.4955595
 0.95897436 0.91430948 0.49591281 0.53409091]
**************************************************
Parameter:
dataset: Indian
flag_test: train
mode: CAF
gpu_id: 0
seed: 6
batch_size: 64
test_freq: 5
patches: 7
band_patches: 3
epoches: 300
learning_rate: 0.0005
gamma: 0.9
weight_decay: 0.005
height=145,width=145,band=200
**************************************************
patch is : 7
mirror_image shape : [151,151,200]
**************************************************
x_train shape = (512, 7, 7, 200), type = float64
x_test  shape = (9737, 7, 7, 200), type = float64
x_true  shape = (21025, 7, 7, 200), type = float64
**************************************************
x_train_band shape = (512, 147, 200), type = float64
x_test_band  shape = (9737, 147, 200), type = float64
x_true_band  shape = (21025, 147, 200), type = float64
**************************************************
y_train: shape = (512,) ,type = int64
y_test: shape = (9737,) ,type = int64
y_true: shape = (21025,) ,type = int64
**************************************************
start training
Epoch: 001 train_loss: 2.5654 train_acc: 16.7969
Epoch: 002 train_loss: 2.3066 train_acc: 26.1719
Epoch: 003 train_loss: 2.1726 train_acc: 35.7422
Epoch: 004 train_loss: 1.9641 train_acc: 36.3281
Epoch: 005 train_loss: 1.8562 train_acc: 37.1094
Epoch: 006 train_loss: 1.7724 train_acc: 39.0625
Epoch: 007 train_loss: 1.7129 train_acc: 40.2344
Epoch: 008 train_loss: 1.6826 train_acc: 41.7969
Epoch: 009 train_loss: 1.6646 train_acc: 40.4297
Epoch: 010 train_loss: 1.6383 train_acc: 42.9688
Epoch: 011 train_loss: 1.5927 train_acc: 42.1875
Epoch: 012 train_loss: 1.5609 train_acc: 43.9453
Epoch: 013 train_loss: 1.5350 train_acc: 45.3125
Epoch: 014 train_loss: 1.5126 train_acc: 46.0938
Epoch: 015 train_loss: 1.5009 train_acc: 46.8750
Epoch: 016 train_loss: 1.4763 train_acc: 47.4609
Epoch: 017 train_loss: 1.4551 train_acc: 48.8281
Epoch: 018 train_loss: 1.4320 train_acc: 47.0703
Epoch: 019 train_loss: 1.4200 train_acc: 50.0000
Epoch: 020 train_loss: 1.3925 train_acc: 51.1719
Epoch: 021 train_loss: 1.3845 train_acc: 49.2188
Epoch: 022 train_loss: 1.3676 train_acc: 49.2188
Epoch: 023 train_loss: 1.3741 train_acc: 50.7812
Epoch: 024 train_loss: 1.3627 train_acc: 50.1953
Epoch: 025 train_loss: 1.3265 train_acc: 51.7578
Epoch: 026 train_loss: 1.3203 train_acc: 50.7812
Epoch: 027 train_loss: 1.2994 train_acc: 52.3438
Epoch: 028 train_loss: 1.2848 train_acc: 52.3438
Epoch: 029 train_loss: 1.2820 train_acc: 52.5391
Epoch: 030 train_loss: 1.2979 train_acc: 51.3672
Epoch: 031 train_loss: 1.2699 train_acc: 50.7812
Epoch: 032 train_loss: 1.2616 train_acc: 51.5625
Epoch: 033 train_loss: 1.2923 train_acc: 51.7578
Epoch: 034 train_loss: 1.2780 train_acc: 52.7344
Epoch: 035 train_loss: 1.2597 train_acc: 52.7344
Epoch: 036 train_loss: 1.2247 train_acc: 53.9062
Epoch: 037 train_loss: 1.2098 train_acc: 54.1016
Epoch: 038 train_loss: 1.2031 train_acc: 53.9062
Epoch: 039 train_loss: 1.1890 train_acc: 56.0547
Epoch: 040 train_loss: 1.1833 train_acc: 56.0547
Epoch: 041 train_loss: 1.2069 train_acc: 54.6875
Epoch: 042 train_loss: 1.2037 train_acc: 53.7109
Epoch: 043 train_loss: 1.1578 train_acc: 57.0312
Epoch: 044 train_loss: 1.1780 train_acc: 54.2969
Epoch: 045 train_loss: 1.1940 train_acc: 54.1016
Epoch: 046 train_loss: 1.2139 train_acc: 54.1016
Epoch: 047 train_loss: 1.2029 train_acc: 55.0781
Epoch: 048 train_loss: 1.1700 train_acc: 52.9297
Epoch: 049 train_loss: 1.1738 train_acc: 55.2734
Epoch: 050 train_loss: 1.1611 train_acc: 54.6875
Epoch: 051 train_loss: 1.1488 train_acc: 58.3984
Epoch: 052 train_loss: 1.1513 train_acc: 57.6172
Epoch: 053 train_loss: 1.1102 train_acc: 58.2031
Epoch: 054 train_loss: 1.1033 train_acc: 58.9844
Epoch: 055 train_loss: 1.1163 train_acc: 56.0547
Epoch: 056 train_loss: 1.1009 train_acc: 58.2031
Epoch: 057 train_loss: 1.0819 train_acc: 56.0547
Epoch: 058 train_loss: 1.0769 train_acc: 58.5938
Epoch: 059 train_loss: 1.0622 train_acc: 58.9844
Epoch: 060 train_loss: 1.0632 train_acc: 59.5703
Epoch: 061 train_loss: 1.0683 train_acc: 59.1797
Epoch: 062 train_loss: 1.0233 train_acc: 63.4766
Epoch: 063 train_loss: 1.0456 train_acc: 60.7422
Epoch: 064 train_loss: 1.0437 train_acc: 60.5469
Epoch: 065 train_loss: 1.0505 train_acc: 59.3750
Epoch: 066 train_loss: 1.0169 train_acc: 61.3281
Epoch: 067 train_loss: 1.0124 train_acc: 60.9375
Epoch: 068 train_loss: 1.0679 train_acc: 61.9141
Epoch: 069 train_loss: 1.0055 train_acc: 63.0859
Epoch: 070 train_loss: 1.0020 train_acc: 61.7188
Epoch: 071 train_loss: 0.9935 train_acc: 62.5000
Epoch: 072 train_loss: 0.9818 train_acc: 61.5234
Epoch: 073 train_loss: 0.9923 train_acc: 62.6953
Epoch: 074 train_loss: 1.0233 train_acc: 62.3047
Epoch: 075 train_loss: 0.9680 train_acc: 63.0859
Epoch: 076 train_loss: 0.9730 train_acc: 63.2812
Epoch: 077 train_loss: 0.9376 train_acc: 65.2344
Epoch: 078 train_loss: 0.9705 train_acc: 63.8672
Epoch: 079 train_loss: 0.9330 train_acc: 65.4297
Epoch: 080 train_loss: 0.9190 train_acc: 65.4297
Epoch: 081 train_loss: 0.9367 train_acc: 66.2109
Epoch: 082 train_loss: 0.9511 train_acc: 64.0625
Epoch: 083 train_loss: 0.9232 train_acc: 64.8438
Epoch: 084 train_loss: 0.9606 train_acc: 64.2578
Epoch: 085 train_loss: 0.9307 train_acc: 67.3828
Epoch: 086 train_loss: 0.9748 train_acc: 64.4531
Epoch: 087 train_loss: 0.9012 train_acc: 66.6016
Epoch: 088 train_loss: 0.9368 train_acc: 64.6484
Epoch: 089 train_loss: 0.9613 train_acc: 63.4766
Epoch: 090 train_loss: 0.9210 train_acc: 66.4062
Epoch: 091 train_loss: 0.9160 train_acc: 66.0156
Epoch: 092 train_loss: 0.8593 train_acc: 68.7500
Epoch: 093 train_loss: 0.8686 train_acc: 65.8203
Epoch: 094 train_loss: 0.8756 train_acc: 68.1641
Epoch: 095 train_loss: 0.8757 train_acc: 67.1875
Epoch: 096 train_loss: 0.8571 train_acc: 70.5078
Epoch: 097 train_loss: 0.8456 train_acc: 69.9219
Epoch: 098 train_loss: 0.8283 train_acc: 70.7031
Epoch: 099 train_loss: 0.8200 train_acc: 71.6797
Epoch: 100 train_loss: 0.8645 train_acc: 68.1641
Epoch: 101 train_loss: 0.8781 train_acc: 68.3594
Epoch: 102 train_loss: 0.9125 train_acc: 67.3828
Epoch: 103 train_loss: 0.8855 train_acc: 65.2344
Epoch: 104 train_loss: 0.8572 train_acc: 69.7266
Epoch: 105 train_loss: 0.8083 train_acc: 71.2891
Epoch: 106 train_loss: 0.8207 train_acc: 70.3125
Epoch: 107 train_loss: 0.8195 train_acc: 71.0938
Epoch: 108 train_loss: 0.8559 train_acc: 68.3594
Epoch: 109 train_loss: 0.8687 train_acc: 66.0156
Epoch: 110 train_loss: 0.8560 train_acc: 68.3594
Epoch: 111 train_loss: 0.8236 train_acc: 69.1406
Epoch: 112 train_loss: 0.8143 train_acc: 71.6797
Epoch: 113 train_loss: 0.8092 train_acc: 72.0703
Epoch: 114 train_loss: 0.8226 train_acc: 70.5078
Epoch: 115 train_loss: 0.8242 train_acc: 70.1172
Epoch: 116 train_loss: 0.7782 train_acc: 73.2422
Epoch: 117 train_loss: 0.7627 train_acc: 72.8516
Epoch: 118 train_loss: 0.7850 train_acc: 72.8516
Epoch: 119 train_loss: 0.8236 train_acc: 68.7500
Epoch: 120 train_loss: 0.8282 train_acc: 69.9219
Epoch: 121 train_loss: 0.7613 train_acc: 75.5859
Epoch: 122 train_loss: 0.7613 train_acc: 74.8047
Epoch: 123 train_loss: 0.7489 train_acc: 73.6328
Epoch: 124 train_loss: 0.7040 train_acc: 75.3906
Epoch: 125 train_loss: 0.7271 train_acc: 75.1953
Epoch: 126 train_loss: 0.7391 train_acc: 71.4844
Epoch: 127 train_loss: 0.6949 train_acc: 75.9766
Epoch: 128 train_loss: 0.7700 train_acc: 74.4141
Epoch: 129 train_loss: 0.6836 train_acc: 76.5625
Epoch: 130 train_loss: 0.7473 train_acc: 74.4141
Epoch: 131 train_loss: 0.7894 train_acc: 72.4609
Epoch: 132 train_loss: 0.8040 train_acc: 70.7031
Epoch: 133 train_loss: 0.7306 train_acc: 73.6328
Epoch: 134 train_loss: 0.6760 train_acc: 77.7344
Epoch: 135 train_loss: 0.6451 train_acc: 78.3203
Epoch: 136 train_loss: 0.7267 train_acc: 74.4141
Epoch: 137 train_loss: 0.6808 train_acc: 75.5859
Epoch: 138 train_loss: 0.7195 train_acc: 74.2188
Epoch: 139 train_loss: 0.7118 train_acc: 73.4375
Epoch: 140 train_loss: 0.6716 train_acc: 76.1719
Epoch: 141 train_loss: 0.6275 train_acc: 79.6875
Epoch: 142 train_loss: 0.6356 train_acc: 77.9297
Epoch: 143 train_loss: 0.6929 train_acc: 76.9531
Epoch: 144 train_loss: 0.7001 train_acc: 74.8047
Epoch: 145 train_loss: 0.6875 train_acc: 75.1953
Epoch: 146 train_loss: 0.7659 train_acc: 72.2656
Epoch: 147 train_loss: 0.6391 train_acc: 75.5859
Epoch: 148 train_loss: 0.6149 train_acc: 79.2969
Epoch: 149 train_loss: 0.5979 train_acc: 78.9062
Epoch: 150 train_loss: 0.5642 train_acc: 82.6172
Epoch: 151 train_loss: 0.5696 train_acc: 81.6406
Epoch: 152 train_loss: 0.5591 train_acc: 82.0312
Epoch: 153 train_loss: 0.5763 train_acc: 79.4922
Epoch: 154 train_loss: 0.5847 train_acc: 80.8594
Epoch: 155 train_loss: 0.5387 train_acc: 81.8359
Epoch: 156 train_loss: 0.5345 train_acc: 82.8125
Epoch: 157 train_loss: 0.5448 train_acc: 82.2266
Epoch: 158 train_loss: 0.5495 train_acc: 81.8359
Epoch: 159 train_loss: 0.5412 train_acc: 81.0547
Epoch: 160 train_loss: 0.5097 train_acc: 82.6172
Epoch: 161 train_loss: 0.5583 train_acc: 81.6406
Epoch: 162 train_loss: 0.5642 train_acc: 80.2734
Epoch: 163 train_loss: 0.5569 train_acc: 80.6641
Epoch: 164 train_loss: 0.5528 train_acc: 81.8359
Epoch: 165 train_loss: 0.5707 train_acc: 80.0781
Epoch: 166 train_loss: 0.5388 train_acc: 83.7891
Epoch: 167 train_loss: 0.5181 train_acc: 83.0078
Epoch: 168 train_loss: 0.5204 train_acc: 81.4453
Epoch: 169 train_loss: 0.5272 train_acc: 83.2031
Epoch: 170 train_loss: 0.5282 train_acc: 81.6406
Epoch: 171 train_loss: 0.5463 train_acc: 81.8359
Epoch: 172 train_loss: 0.4773 train_acc: 85.5469
Epoch: 173 train_loss: 0.4815 train_acc: 84.1797
Epoch: 174 train_loss: 0.5421 train_acc: 82.8125
Epoch: 175 train_loss: 0.5126 train_acc: 82.0312
Epoch: 176 train_loss: 0.4951 train_acc: 83.3984
Epoch: 177 train_loss: 0.4538 train_acc: 85.5469
Epoch: 178 train_loss: 0.4654 train_acc: 85.5469
Epoch: 179 train_loss: 0.4561 train_acc: 84.9609
Epoch: 180 train_loss: 0.4474 train_acc: 86.1328
Epoch: 181 train_loss: 0.4453 train_acc: 85.9375
Epoch: 182 train_loss: 0.4120 train_acc: 88.4766
Epoch: 183 train_loss: 0.3886 train_acc: 89.0625
Epoch: 184 train_loss: 0.3821 train_acc: 88.8672
Epoch: 185 train_loss: 0.4423 train_acc: 85.9375
Epoch: 186 train_loss: 0.5134 train_acc: 82.2266
Epoch: 187 train_loss: 0.4492 train_acc: 85.7422
Epoch: 188 train_loss: 0.4358 train_acc: 85.9375
Epoch: 189 train_loss: 0.3967 train_acc: 87.5000
Epoch: 190 train_loss: 0.3917 train_acc: 89.4531
Epoch: 191 train_loss: 0.3890 train_acc: 88.8672
Epoch: 192 train_loss: 0.3623 train_acc: 89.4531
Epoch: 193 train_loss: 0.4491 train_acc: 86.5234
Epoch: 194 train_loss: 0.4287 train_acc: 86.7188
Epoch: 195 train_loss: 0.4041 train_acc: 88.0859
Epoch: 196 train_loss: 0.4115 train_acc: 89.0625
Epoch: 197 train_loss: 0.4424 train_acc: 83.3984
Epoch: 198 train_loss: 0.3768 train_acc: 88.2812
Epoch: 199 train_loss: 0.3512 train_acc: 88.8672
Epoch: 200 train_loss: 0.3384 train_acc: 90.2344
/home/amax/anaconda3/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
Epoch: 201 train_loss: 0.3280 train_acc: 89.0625
Epoch: 202 train_loss: 0.3364 train_acc: 89.8438
Epoch: 203 train_loss: 0.3526 train_acc: 89.2578
Epoch: 204 train_loss: 0.3653 train_acc: 88.0859
Epoch: 205 train_loss: 0.3357 train_acc: 89.0625
Epoch: 206 train_loss: 0.3803 train_acc: 87.6953
Epoch: 207 train_loss: 0.4153 train_acc: 85.7422
Epoch: 208 train_loss: 0.4194 train_acc: 85.7422
Epoch: 209 train_loss: 0.3658 train_acc: 88.2812
Epoch: 210 train_loss: 0.3390 train_acc: 89.0625
Epoch: 211 train_loss: 0.3321 train_acc: 90.6250
Epoch: 212 train_loss: 0.3118 train_acc: 91.2109
Epoch: 213 train_loss: 0.3603 train_acc: 88.0859
Epoch: 214 train_loss: 0.3394 train_acc: 90.2344
Epoch: 215 train_loss: 0.3446 train_acc: 89.0625
Epoch: 216 train_loss: 0.3144 train_acc: 90.6250
Epoch: 217 train_loss: 0.3425 train_acc: 89.2578
Epoch: 218 train_loss: 0.3100 train_acc: 91.6016
Epoch: 219 train_loss: 0.3537 train_acc: 88.2812
Epoch: 220 train_loss: 0.3455 train_acc: 88.2812
Epoch: 221 train_loss: 0.3272 train_acc: 89.4531
Epoch: 222 train_loss: 0.3316 train_acc: 89.8438
Epoch: 223 train_loss: 0.2657 train_acc: 93.1641
Epoch: 224 train_loss: 0.3192 train_acc: 91.0156
Epoch: 225 train_loss: 0.3193 train_acc: 89.4531
Epoch: 226 train_loss: 0.3181 train_acc: 89.2578
Epoch: 227 train_loss: 0.3242 train_acc: 90.2344
Epoch: 228 train_loss: 0.3313 train_acc: 88.6719
Epoch: 229 train_loss: 0.3391 train_acc: 89.8438
Epoch: 230 train_loss: 0.2964 train_acc: 90.6250
Epoch: 231 train_loss: 0.3263 train_acc: 90.6250
Epoch: 232 train_loss: 0.2982 train_acc: 90.4297
Epoch: 233 train_loss: 0.2692 train_acc: 91.9922
Epoch: 234 train_loss: 0.2983 train_acc: 90.8203
Epoch: 235 train_loss: 0.2650 train_acc: 92.1875
Epoch: 236 train_loss: 0.2632 train_acc: 92.5781
Epoch: 237 train_loss: 0.2606 train_acc: 92.3828
Epoch: 238 train_loss: 0.2740 train_acc: 92.9688
Epoch: 239 train_loss: 0.2844 train_acc: 90.0391
Epoch: 240 train_loss: 0.3054 train_acc: 90.2344
Epoch: 241 train_loss: 0.2703 train_acc: 92.5781
Epoch: 242 train_loss: 0.2888 train_acc: 91.4062
Epoch: 243 train_loss: 0.2856 train_acc: 90.8203
Epoch: 244 train_loss: 0.2683 train_acc: 92.1875
Epoch: 245 train_loss: 0.2572 train_acc: 92.1875
Epoch: 246 train_loss: 0.2542 train_acc: 92.5781
Epoch: 247 train_loss: 0.2609 train_acc: 91.9922
Epoch: 248 train_loss: 0.2783 train_acc: 91.0156
Epoch: 249 train_loss: 0.2939 train_acc: 90.0391
Epoch: 250 train_loss: 0.2539 train_acc: 93.3594
Epoch: 251 train_loss: 0.2682 train_acc: 91.0156
Epoch: 252 train_loss: 0.2665 train_acc: 90.8203
Epoch: 253 train_loss: 0.2504 train_acc: 91.4062
Epoch: 254 train_loss: 0.2142 train_acc: 93.7500
Epoch: 255 train_loss: 0.2404 train_acc: 93.3594
Epoch: 256 train_loss: 0.2420 train_acc: 93.9453
Epoch: 257 train_loss: 0.2818 train_acc: 92.3828
Epoch: 258 train_loss: 0.2846 train_acc: 91.6016
Epoch: 259 train_loss: 0.2985 train_acc: 91.0156
Epoch: 260 train_loss: 0.2499 train_acc: 91.6016
Epoch: 261 train_loss: 0.2069 train_acc: 95.1172
Epoch: 262 train_loss: 0.1992 train_acc: 94.5312
Epoch: 263 train_loss: 0.2160 train_acc: 93.1641
Epoch: 264 train_loss: 0.2227 train_acc: 93.3594
Epoch: 265 train_loss: 0.2034 train_acc: 94.3359
Epoch: 266 train_loss: 0.1976 train_acc: 94.5312
Epoch: 267 train_loss: 0.2140 train_acc: 93.5547
Epoch: 268 train_loss: 0.2093 train_acc: 94.5312
Epoch: 269 train_loss: 0.2200 train_acc: 93.1641
Epoch: 270 train_loss: 0.2216 train_acc: 93.3594
Epoch: 271 train_loss: 0.2382 train_acc: 92.7734
Epoch: 272 train_loss: 0.2095 train_acc: 93.9453
Epoch: 273 train_loss: 0.2202 train_acc: 95.3125
Epoch: 274 train_loss: 0.2184 train_acc: 94.3359
Epoch: 275 train_loss: 0.2366 train_acc: 92.3828
Epoch: 276 train_loss: 0.2181 train_acc: 93.7500
Epoch: 277 train_loss: 0.2044 train_acc: 95.5078
Epoch: 278 train_loss: 0.2019 train_acc: 94.3359
Epoch: 279 train_loss: 0.1842 train_acc: 94.7266
Epoch: 280 train_loss: 0.1976 train_acc: 93.9453
Epoch: 281 train_loss: 0.2208 train_acc: 93.9453
Epoch: 282 train_loss: 0.2194 train_acc: 93.1641
Epoch: 283 train_loss: 0.1886 train_acc: 94.7266
Epoch: 284 train_loss: 0.2007 train_acc: 93.5547
Epoch: 285 train_loss: 0.2742 train_acc: 92.1875
Epoch: 286 train_loss: 0.2184 train_acc: 93.3594
Epoch: 287 train_loss: 0.2302 train_acc: 93.3594
Epoch: 288 train_loss: 0.2047 train_acc: 94.9219
Epoch: 289 train_loss: 0.2230 train_acc: 93.3594
Epoch: 290 train_loss: 0.1850 train_acc: 95.1172
Epoch: 291 train_loss: 0.1994 train_acc: 93.9453
Epoch: 292 train_loss: 0.1960 train_acc: 95.1172
Epoch: 293 train_loss: 0.1956 train_acc: 94.5312
Epoch: 294 train_loss: 0.1875 train_acc: 94.7266
Epoch: 295 train_loss: 0.1975 train_acc: 94.1406
Epoch: 296 train_loss: 0.1839 train_acc: 95.7031
Epoch: 297 train_loss: 0.1777 train_acc: 94.9219
Epoch: 298 train_loss: 0.1656 train_acc: 95.8984
Epoch: 299 train_loss: 0.1797 train_acc: 94.9219
Epoch: 300 train_loss: 0.1974 train_acc: 95.3125
Running Time: 166.86
**************************************************
Final result:
OA: 0.7218 | AA: 0.6096 | Kappa: 0.6839
[0.47727273 0.6705969  0.55456853 0.56444444 0.59912854 0.82997118
 0.03703704 0.89867841 0.10526316 0.73564464 0.76758148 0.68561279
 0.98461538 0.85690516 0.38419619 0.60227273]
**************************************************
Parameter:
dataset: Indian
flag_test: train
mode: CAF
gpu_id: 0
seed: 7
batch_size: 64
test_freq: 5
patches: 7
band_patches: 3
epoches: 300
learning_rate: 0.0005
gamma: 0.9
weight_decay: 0.005
height=145,width=145,band=200
**************************************************
patch is : 7
mirror_image shape : [151,151,200]
**************************************************
x_train shape = (512, 7, 7, 200), type = float64
x_test  shape = (9737, 7, 7, 200), type = float64
x_true  shape = (21025, 7, 7, 200), type = float64
**************************************************
x_train_band shape = (512, 147, 200), type = float64
x_test_band  shape = (9737, 147, 200), type = float64
x_true_band  shape = (21025, 147, 200), type = float64
**************************************************
y_train: shape = (512,) ,type = int64
y_test: shape = (9737,) ,type = int64
y_true: shape = (21025,) ,type = int64
**************************************************
start training
Epoch: 001 train_loss: 2.4637 train_acc: 22.2656
Epoch: 002 train_loss: 2.1017 train_acc: 35.9375
Epoch: 003 train_loss: 1.9267 train_acc: 36.3281
Epoch: 004 train_loss: 1.8524 train_acc: 35.7422
Epoch: 005 train_loss: 1.7705 train_acc: 38.2812
Epoch: 006 train_loss: 1.7424 train_acc: 38.2812
Epoch: 007 train_loss: 1.6902 train_acc: 40.0391
Epoch: 008 train_loss: 1.6563 train_acc: 41.7969
Epoch: 009 train_loss: 1.6396 train_acc: 42.5781
Epoch: 010 train_loss: 1.5974 train_acc: 43.7500
Epoch: 011 train_loss: 1.5922 train_acc: 43.9453
Epoch: 012 train_loss: 1.5447 train_acc: 45.1172
Epoch: 013 train_loss: 1.5211 train_acc: 46.8750
Epoch: 014 train_loss: 1.4914 train_acc: 46.6797
Epoch: 015 train_loss: 1.4521 train_acc: 48.6328
Epoch: 016 train_loss: 1.4476 train_acc: 48.6328
Epoch: 017 train_loss: 1.4174 train_acc: 48.0469
Epoch: 018 train_loss: 1.4165 train_acc: 47.0703
Epoch: 019 train_loss: 1.3972 train_acc: 49.0234
Epoch: 020 train_loss: 1.3977 train_acc: 49.2188
Epoch: 021 train_loss: 1.3803 train_acc: 48.8281
Epoch: 022 train_loss: 1.3662 train_acc: 49.2188
Epoch: 023 train_loss: 1.3392 train_acc: 50.1953
Epoch: 024 train_loss: 1.3503 train_acc: 51.1719
Epoch: 025 train_loss: 1.3640 train_acc: 48.6328
Epoch: 026 train_loss: 1.3400 train_acc: 51.5625
Epoch: 027 train_loss: 1.3269 train_acc: 50.7812
Epoch: 028 train_loss: 1.3122 train_acc: 50.5859
Epoch: 029 train_loss: 1.3188 train_acc: 50.3906
Epoch: 030 train_loss: 1.2890 train_acc: 51.5625
Epoch: 031 train_loss: 1.2932 train_acc: 51.5625
Epoch: 032 train_loss: 1.2758 train_acc: 51.5625
Epoch: 033 train_loss: 1.2755 train_acc: 53.1250
Epoch: 034 train_loss: 1.2653 train_acc: 51.9531
Epoch: 035 train_loss: 1.2609 train_acc: 52.1484
Epoch: 036 train_loss: 1.2445 train_acc: 52.7344
Epoch: 037 train_loss: 1.2556 train_acc: 51.5625
Epoch: 038 train_loss: 1.2272 train_acc: 53.5156
Epoch: 039 train_loss: 1.2215 train_acc: 53.7109
Epoch: 040 train_loss: 1.2213 train_acc: 53.1250
Epoch: 041 train_loss: 1.2241 train_acc: 53.3203
Epoch: 042 train_loss: 1.2203 train_acc: 54.1016
Epoch: 043 train_loss: 1.2009 train_acc: 55.0781
Epoch: 044 train_loss: 1.1938 train_acc: 52.5391
Epoch: 045 train_loss: 1.2170 train_acc: 52.3438
Epoch: 046 train_loss: 1.2155 train_acc: 53.5156
Epoch: 047 train_loss: 1.1890 train_acc: 52.5391
Epoch: 048 train_loss: 1.1774 train_acc: 54.4922
Epoch: 049 train_loss: 1.1784 train_acc: 54.4922
Epoch: 050 train_loss: 1.1710 train_acc: 54.6875
Epoch: 051 train_loss: 1.1731 train_acc: 54.8828
Epoch: 052 train_loss: 1.1840 train_acc: 53.9062
Epoch: 053 train_loss: 1.1977 train_acc: 52.1484
Epoch: 054 train_loss: 1.1558 train_acc: 54.6875
Epoch: 055 train_loss: 1.1441 train_acc: 55.6641
Epoch: 056 train_loss: 1.1534 train_acc: 54.1016
Epoch: 057 train_loss: 1.1423 train_acc: 57.4219
Epoch: 058 train_loss: 1.1362 train_acc: 55.0781
Epoch: 059 train_loss: 1.1105 train_acc: 56.8359
Epoch: 060 train_loss: 1.1311 train_acc: 55.0781
Epoch: 061 train_loss: 1.0991 train_acc: 56.4453
Epoch: 062 train_loss: 1.0905 train_acc: 58.5938
Epoch: 063 train_loss: 1.0763 train_acc: 58.3984
Epoch: 064 train_loss: 1.1223 train_acc: 56.6406
Epoch: 065 train_loss: 1.1059 train_acc: 56.4453
Epoch: 066 train_loss: 1.1146 train_acc: 57.6172
Epoch: 067 train_loss: 1.1112 train_acc: 56.2500
Epoch: 068 train_loss: 1.0776 train_acc: 57.2266
Epoch: 069 train_loss: 1.0669 train_acc: 57.2266
Epoch: 070 train_loss: 1.0456 train_acc: 60.7422
Epoch: 071 train_loss: 1.0831 train_acc: 58.0078
Epoch: 072 train_loss: 1.1221 train_acc: 54.4922
Epoch: 073 train_loss: 1.0670 train_acc: 58.7891
Epoch: 074 train_loss: 1.0714 train_acc: 58.5938
Epoch: 075 train_loss: 1.0676 train_acc: 59.3750
Epoch: 076 train_loss: 1.0349 train_acc: 59.5703
Epoch: 077 train_loss: 1.0253 train_acc: 58.0078
Epoch: 078 train_loss: 1.0357 train_acc: 60.9375
Epoch: 079 train_loss: 1.0181 train_acc: 60.7422
Epoch: 080 train_loss: 1.0057 train_acc: 60.1562
Epoch: 081 train_loss: 1.0167 train_acc: 60.5469
Epoch: 082 train_loss: 0.9904 train_acc: 63.8672
Epoch: 083 train_loss: 0.9924 train_acc: 61.9141
Epoch: 084 train_loss: 0.9529 train_acc: 65.8203
Epoch: 085 train_loss: 0.9971 train_acc: 62.6953
Epoch: 086 train_loss: 0.9639 train_acc: 63.6719
Epoch: 087 train_loss: 0.9795 train_acc: 63.0859
Epoch: 088 train_loss: 0.9347 train_acc: 64.8438
Epoch: 089 train_loss: 0.9049 train_acc: 67.3828
Epoch: 090 train_loss: 0.9203 train_acc: 64.0625
Epoch: 091 train_loss: 0.9201 train_acc: 65.2344
Epoch: 092 train_loss: 0.9630 train_acc: 65.2344
Epoch: 093 train_loss: 0.9411 train_acc: 64.4531
Epoch: 094 train_loss: 0.9403 train_acc: 65.0391
Epoch: 095 train_loss: 0.9083 train_acc: 63.4766
Epoch: 096 train_loss: 0.8675 train_acc: 68.1641
Epoch: 097 train_loss: 0.8378 train_acc: 71.0938
Epoch: 098 train_loss: 0.9128 train_acc: 62.8906
Epoch: 099 train_loss: 0.9186 train_acc: 64.6484
Epoch: 100 train_loss: 0.9263 train_acc: 63.0859
Epoch: 101 train_loss: 0.8731 train_acc: 66.9922
Epoch: 102 train_loss: 0.8819 train_acc: 66.4062
Epoch: 103 train_loss: 0.8829 train_acc: 67.7734
Epoch: 104 train_loss: 0.8266 train_acc: 70.8984
Epoch: 105 train_loss: 0.8000 train_acc: 70.8984
Epoch: 106 train_loss: 0.7893 train_acc: 70.8984
Epoch: 107 train_loss: 0.7796 train_acc: 72.0703
Epoch: 108 train_loss: 0.8120 train_acc: 72.4609
Epoch: 109 train_loss: 0.8085 train_acc: 71.6797
Epoch: 110 train_loss: 0.7389 train_acc: 72.4609
Epoch: 111 train_loss: 0.7916 train_acc: 73.4375
Epoch: 112 train_loss: 0.8174 train_acc: 70.7031
Epoch: 113 train_loss: 0.8687 train_acc: 66.4062
Epoch: 114 train_loss: 0.7493 train_acc: 73.6328
Epoch: 115 train_loss: 0.7325 train_acc: 75.3906
Epoch: 116 train_loss: 0.7505 train_acc: 73.4375
Epoch: 117 train_loss: 0.7077 train_acc: 73.0469
Epoch: 118 train_loss: 0.6967 train_acc: 74.6094
Epoch: 119 train_loss: 0.6808 train_acc: 76.3672
Epoch: 120 train_loss: 0.7078 train_acc: 75.7812
Epoch: 121 train_loss: 0.6977 train_acc: 74.4141
Epoch: 122 train_loss: 0.6711 train_acc: 76.1719
Epoch: 123 train_loss: 0.6660 train_acc: 74.4141
Epoch: 124 train_loss: 0.6465 train_acc: 77.9297
Epoch: 125 train_loss: 0.6359 train_acc: 76.3672
Epoch: 126 train_loss: 0.6485 train_acc: 76.7578
Epoch: 127 train_loss: 0.6107 train_acc: 78.7109
Epoch: 128 train_loss: 0.6402 train_acc: 74.4141
Epoch: 129 train_loss: 0.6640 train_acc: 75.9766
Epoch: 130 train_loss: 0.6457 train_acc: 75.5859
Epoch: 131 train_loss: 0.6308 train_acc: 78.9062
Epoch: 132 train_loss: 0.6411 train_acc: 76.9531
Epoch: 133 train_loss: 0.6516 train_acc: 77.7344
Epoch: 134 train_loss: 0.6214 train_acc: 80.0781
Epoch: 135 train_loss: 0.5896 train_acc: 79.6875
Epoch: 136 train_loss: 0.5851 train_acc: 80.6641
Epoch: 137 train_loss: 0.5650 train_acc: 81.4453
Epoch: 138 train_loss: 0.5675 train_acc: 79.8828
Epoch: 139 train_loss: 0.5359 train_acc: 83.7891
Epoch: 140 train_loss: 0.5523 train_acc: 79.6875
Epoch: 141 train_loss: 0.5247 train_acc: 83.0078
Epoch: 142 train_loss: 0.4921 train_acc: 84.9609
Epoch: 143 train_loss: 0.5539 train_acc: 78.9062
Epoch: 144 train_loss: 0.5615 train_acc: 81.0547
Epoch: 145 train_loss: 0.4838 train_acc: 84.1797
Epoch: 146 train_loss: 0.4797 train_acc: 84.1797
Epoch: 147 train_loss: 0.4900 train_acc: 83.9844
Epoch: 148 train_loss: 0.4423 train_acc: 85.9375
Epoch: 149 train_loss: 0.5281 train_acc: 84.1797
Epoch: 150 train_loss: 0.5413 train_acc: 82.2266
Epoch: 151 train_loss: 0.5346 train_acc: 80.8594
Epoch: 152 train_loss: 0.4777 train_acc: 82.0312
Epoch: 153 train_loss: 0.4443 train_acc: 87.3047
Epoch: 154 train_loss: 0.4228 train_acc: 85.1562
Epoch: 155 train_loss: 0.4450 train_acc: 86.3281
Epoch: 156 train_loss: 0.4046 train_acc: 87.3047
Epoch: 157 train_loss: 0.4441 train_acc: 86.5234
Epoch: 158 train_loss: 0.4135 train_acc: 86.3281
Epoch: 159 train_loss: 0.4509 train_acc: 83.2031
Epoch: 160 train_loss: 0.4990 train_acc: 83.3984
Epoch: 161 train_loss: 0.4841 train_acc: 84.9609
Epoch: 162 train_loss: 0.4410 train_acc: 85.5469
Epoch: 163 train_loss: 0.4534 train_acc: 85.3516
Epoch: 164 train_loss: 0.4175 train_acc: 87.5000
Epoch: 165 train_loss: 0.4179 train_acc: 85.1562
Epoch: 166 train_loss: 0.4398 train_acc: 84.1797
Epoch: 167 train_loss: 0.4602 train_acc: 85.7422
Epoch: 168 train_loss: 0.4062 train_acc: 86.9141
Epoch: 169 train_loss: 0.4364 train_acc: 85.1562
Epoch: 170 train_loss: 0.3960 train_acc: 86.3281
Epoch: 171 train_loss: 0.3852 train_acc: 87.1094
Epoch: 172 train_loss: 0.4460 train_acc: 83.3984
Epoch: 173 train_loss: 0.4060 train_acc: 86.3281
Epoch: 174 train_loss: 0.4203 train_acc: 85.1562
Epoch: 175 train_loss: 0.4152 train_acc: 86.7188
Epoch: 176 train_loss: 0.4141 train_acc: 85.5469
Epoch: 177 train_loss: 0.3785 train_acc: 88.0859
Epoch: 178 train_loss: 0.4071 train_acc: 86.7188
Epoch: 179 train_loss: 0.3968 train_acc: 86.7188
Epoch: 180 train_loss: 0.3577 train_acc: 90.8203
Epoch: 181 train_loss: 0.3251 train_acc: 90.8203
Epoch: 182 train_loss: 0.3183 train_acc: 90.2344
Epoch: 183 train_loss: 0.3537 train_acc: 89.8438
Epoch: 184 train_loss: 0.3179 train_acc: 90.6250
Epoch: 185 train_loss: 0.3319 train_acc: 91.0156
Epoch: 186 train_loss: 0.3038 train_acc: 91.9922
Epoch: 187 train_loss: 0.3435 train_acc: 89.0625
Epoch: 188 train_loss: 0.3515 train_acc: 88.8672
Epoch: 189 train_loss: 0.3657 train_acc: 87.6953
Epoch: 190 train_loss: 0.3575 train_acc: 87.6953
Epoch: 191 train_loss: 0.3374 train_acc: 89.2578
Epoch: 192 train_loss: 0.2811 train_acc: 92.9688
Epoch: 193 train_loss: 0.3160 train_acc: 90.0391
Epoch: 194 train_loss: 0.2905 train_acc: 92.3828
Epoch: 195 train_loss: 0.2723 train_acc: 93.1641
Epoch: 196 train_loss: 0.2764 train_acc: 91.4062
Epoch: 197 train_loss: 0.3217 train_acc: 90.0391
Epoch: 198 train_loss: 0.2905 train_acc: 91.4062
Epoch: 199 train_loss: 0.2912 train_acc: 91.9922
Epoch: 200 train_loss: 0.3030 train_acc: 90.8203
Epoch: 201 train_loss: 0.3108 train_acc: 90.6250
Epoch: 202 train_loss: 0.3362 train_acc: 89.4531
Epoch: 203 train_loss: 0.3055 train_acc: 91.0156
Epoch: 204 train_loss: 0.3423 train_acc: 88.0859
Epoch: 205 train_loss: 0.3061 train_acc: 91.4062
Epoch: 206 train_loss: 0.2830 train_acc: 90.6250
Epoch: 207 train_loss: 0.2889 train_acc: 92.7734
/home/amax/anaconda3/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
Epoch: 208 train_loss: 0.2726 train_acc: 92.7734
Epoch: 209 train_loss: 0.2629 train_acc: 92.9688
Epoch: 210 train_loss: 0.2470 train_acc: 93.7500
Epoch: 211 train_loss: 0.2340 train_acc: 93.7500
Epoch: 212 train_loss: 0.2326 train_acc: 93.7500
Epoch: 213 train_loss: 0.2557 train_acc: 92.1875
Epoch: 214 train_loss: 0.2399 train_acc: 93.5547
Epoch: 215 train_loss: 0.2547 train_acc: 92.7734
Epoch: 216 train_loss: 0.2779 train_acc: 91.4062
Epoch: 217 train_loss: 0.2735 train_acc: 91.7969
Epoch: 218 train_loss: 0.2585 train_acc: 91.6016
Epoch: 219 train_loss: 0.2292 train_acc: 95.8984
Epoch: 220 train_loss: 0.2650 train_acc: 91.9922
Epoch: 221 train_loss: 0.2315 train_acc: 94.7266
Epoch: 222 train_loss: 0.2796 train_acc: 91.4062
Epoch: 223 train_loss: 0.2509 train_acc: 92.7734
Epoch: 224 train_loss: 0.2177 train_acc: 94.9219
Epoch: 225 train_loss: 0.2310 train_acc: 95.1172
Epoch: 226 train_loss: 0.2626 train_acc: 92.3828
Epoch: 227 train_loss: 0.2634 train_acc: 92.1875
Epoch: 228 train_loss: 0.3221 train_acc: 89.8438
Epoch: 229 train_loss: 0.2616 train_acc: 93.3594
Epoch: 230 train_loss: 0.2451 train_acc: 92.7734
Epoch: 231 train_loss: 0.2356 train_acc: 93.5547
Epoch: 232 train_loss: 0.2253 train_acc: 94.7266
Epoch: 233 train_loss: 0.2323 train_acc: 93.3594
Epoch: 234 train_loss: 0.2139 train_acc: 94.9219
Epoch: 235 train_loss: 0.2174 train_acc: 94.9219
Epoch: 236 train_loss: 0.2175 train_acc: 94.9219
Epoch: 237 train_loss: 0.2291 train_acc: 94.3359
Epoch: 238 train_loss: 0.2348 train_acc: 93.5547
Epoch: 239 train_loss: 0.2131 train_acc: 93.5547
Epoch: 240 train_loss: 0.2230 train_acc: 93.9453
Epoch: 241 train_loss: 0.1881 train_acc: 95.3125
Epoch: 242 train_loss: 0.2187 train_acc: 93.7500
Epoch: 243 train_loss: 0.1907 train_acc: 95.3125
Epoch: 244 train_loss: 0.1949 train_acc: 95.7031
Epoch: 245 train_loss: 0.2002 train_acc: 94.1406
Epoch: 246 train_loss: 0.2028 train_acc: 95.3125
Epoch: 247 train_loss: 0.2129 train_acc: 94.5312
Epoch: 248 train_loss: 0.2017 train_acc: 94.7266
Epoch: 249 train_loss: 0.1726 train_acc: 96.6797
Epoch: 250 train_loss: 0.1663 train_acc: 95.8984
Epoch: 251 train_loss: 0.1586 train_acc: 96.4844
Epoch: 252 train_loss: 0.1654 train_acc: 95.7031
Epoch: 253 train_loss: 0.1567 train_acc: 96.6797
Epoch: 254 train_loss: 0.2009 train_acc: 95.3125
Epoch: 255 train_loss: 0.1925 train_acc: 94.5312
Epoch: 256 train_loss: 0.2214 train_acc: 93.9453
Epoch: 257 train_loss: 0.1828 train_acc: 96.2891
Epoch: 258 train_loss: 0.1722 train_acc: 95.7031
Epoch: 259 train_loss: 0.1411 train_acc: 97.2656
Epoch: 260 train_loss: 0.1657 train_acc: 96.0938
Epoch: 261 train_loss: 0.1548 train_acc: 96.8750
Epoch: 262 train_loss: 0.1649 train_acc: 97.2656
Epoch: 263 train_loss: 0.1710 train_acc: 96.2891
Epoch: 264 train_loss: 0.1621 train_acc: 96.2891
Epoch: 265 train_loss: 0.1830 train_acc: 95.3125
Epoch: 266 train_loss: 0.1756 train_acc: 95.5078
Epoch: 267 train_loss: 0.1628 train_acc: 96.4844
Epoch: 268 train_loss: 0.1404 train_acc: 97.6562
Epoch: 269 train_loss: 0.1405 train_acc: 97.0703
Epoch: 270 train_loss: 0.1544 train_acc: 96.6797
Epoch: 271 train_loss: 0.1625 train_acc: 95.8984
Epoch: 272 train_loss: 0.1396 train_acc: 97.4609
Epoch: 273 train_loss: 0.1472 train_acc: 96.4844
Epoch: 274 train_loss: 0.1712 train_acc: 94.9219
Epoch: 275 train_loss: 0.1446 train_acc: 96.6797
Epoch: 276 train_loss: 0.1866 train_acc: 94.5312
Epoch: 277 train_loss: 0.1739 train_acc: 96.0938
Epoch: 278 train_loss: 0.1680 train_acc: 96.6797
Epoch: 279 train_loss: 0.1343 train_acc: 97.0703
Epoch: 280 train_loss: 0.1569 train_acc: 96.6797
Epoch: 281 train_loss: 0.1380 train_acc: 97.4609
Epoch: 282 train_loss: 0.1231 train_acc: 97.8516
Epoch: 283 train_loss: 0.1369 train_acc: 97.4609
Epoch: 284 train_loss: 0.1369 train_acc: 97.6562
Epoch: 285 train_loss: 0.1506 train_acc: 96.6797
Epoch: 286 train_loss: 0.1239 train_acc: 98.0469
Epoch: 287 train_loss: 0.1163 train_acc: 97.6562
Epoch: 288 train_loss: 0.1691 train_acc: 95.5078
Epoch: 289 train_loss: 0.1213 train_acc: 98.8281
Epoch: 290 train_loss: 0.1623 train_acc: 95.5078
Epoch: 291 train_loss: 0.1467 train_acc: 95.7031
Epoch: 292 train_loss: 0.1347 train_acc: 96.8750
Epoch: 293 train_loss: 0.1322 train_acc: 97.0703
Epoch: 294 train_loss: 0.1400 train_acc: 97.0703
Epoch: 295 train_loss: 0.1564 train_acc: 95.7031
Epoch: 296 train_loss: 0.1569 train_acc: 96.4844
Epoch: 297 train_loss: 0.1309 train_acc: 97.0703
Epoch: 298 train_loss: 0.1606 train_acc: 96.0938
Epoch: 299 train_loss: 0.1536 train_acc: 96.4844
Epoch: 300 train_loss: 0.1509 train_acc: 95.7031
Running Time: 167.60
**************************************************
Final result:
OA: 0.7584 | AA: 0.6427 | Kappa: 0.7279
[0.13636364 0.63448784 0.90228426 0.52888889 0.74727669 0.93227666
 0.07407407 0.90088106 0.10526316 0.8071506  0.68439108 0.65364121
 0.99487179 0.92762063 0.5613079  0.69318182]
**************************************************
Parameter:
dataset: Indian
flag_test: train
mode: CAF
gpu_id: 0
seed: 8
batch_size: 64
test_freq: 5
patches: 7
band_patches: 3
epoches: 300
learning_rate: 0.0005
gamma: 0.9
weight_decay: 0.005
height=145,width=145,band=200
**************************************************
patch is : 7
mirror_image shape : [151,151,200]
**************************************************
x_train shape = (512, 7, 7, 200), type = float64
x_test  shape = (9737, 7, 7, 200), type = float64
x_true  shape = (21025, 7, 7, 200), type = float64
**************************************************
x_train_band shape = (512, 147, 200), type = float64
x_test_band  shape = (9737, 147, 200), type = float64
x_true_band  shape = (21025, 147, 200), type = float64
**************************************************
y_train: shape = (512,) ,type = int64
y_test: shape = (9737,) ,type = int64
y_true: shape = (21025,) ,type = int64
**************************************************
start training
Epoch: 001 train_loss: 2.5194 train_acc: 20.7031
Epoch: 002 train_loss: 2.3206 train_acc: 26.7578
Epoch: 003 train_loss: 2.1895 train_acc: 36.1328
Epoch: 004 train_loss: 2.0276 train_acc: 36.3281
Epoch: 005 train_loss: 1.8980 train_acc: 37.3047
Epoch: 006 train_loss: 1.8086 train_acc: 39.8438
Epoch: 007 train_loss: 1.7412 train_acc: 39.6484
Epoch: 008 train_loss: 1.6786 train_acc: 41.6016
Epoch: 009 train_loss: 1.6176 train_acc: 43.9453
Epoch: 010 train_loss: 1.5819 train_acc: 43.7500
Epoch: 011 train_loss: 1.5403 train_acc: 45.3125
Epoch: 012 train_loss: 1.5177 train_acc: 43.5547
Epoch: 013 train_loss: 1.4973 train_acc: 47.0703
Epoch: 014 train_loss: 1.4725 train_acc: 47.4609
Epoch: 015 train_loss: 1.4504 train_acc: 47.0703
Epoch: 016 train_loss: 1.4325 train_acc: 47.2656
Epoch: 017 train_loss: 1.4046 train_acc: 49.4141
Epoch: 018 train_loss: 1.3871 train_acc: 48.8281
Epoch: 019 train_loss: 1.3771 train_acc: 49.2188
Epoch: 020 train_loss: 1.3813 train_acc: 48.4375
Epoch: 021 train_loss: 1.3369 train_acc: 51.3672
Epoch: 022 train_loss: 1.3174 train_acc: 51.5625
Epoch: 023 train_loss: 1.3358 train_acc: 52.1484
Epoch: 024 train_loss: 1.3146 train_acc: 51.1719
Epoch: 025 train_loss: 1.2783 train_acc: 54.1016
Epoch: 026 train_loss: 1.2717 train_acc: 52.1484
Epoch: 027 train_loss: 1.2761 train_acc: 51.1719
Epoch: 028 train_loss: 1.2413 train_acc: 53.7109
Epoch: 029 train_loss: 1.2377 train_acc: 54.6875
Epoch: 030 train_loss: 1.2104 train_acc: 55.6641
Epoch: 031 train_loss: 1.1905 train_acc: 56.6406
Epoch: 032 train_loss: 1.1888 train_acc: 57.4219
Epoch: 033 train_loss: 1.2108 train_acc: 54.8828
Epoch: 034 train_loss: 1.2058 train_acc: 54.1016
Epoch: 035 train_loss: 1.1756 train_acc: 54.2969
Epoch: 036 train_loss: 1.1576 train_acc: 56.6406
Epoch: 037 train_loss: 1.1651 train_acc: 57.0312
Epoch: 038 train_loss: 1.1263 train_acc: 57.4219
Epoch: 039 train_loss: 1.1144 train_acc: 58.7891
Epoch: 040 train_loss: 1.1320 train_acc: 56.6406
Epoch: 041 train_loss: 1.1110 train_acc: 57.6172
Epoch: 042 train_loss: 1.1068 train_acc: 58.2031
Epoch: 043 train_loss: 1.1111 train_acc: 58.9844
Epoch: 044 train_loss: 1.1016 train_acc: 59.1797
Epoch: 045 train_loss: 1.0720 train_acc: 59.1797
Epoch: 046 train_loss: 1.0949 train_acc: 58.7891
Epoch: 047 train_loss: 1.0749 train_acc: 57.6172
Epoch: 048 train_loss: 1.0691 train_acc: 60.7422
Epoch: 049 train_loss: 1.1324 train_acc: 58.5938
Epoch: 050 train_loss: 1.1323 train_acc: 56.8359
Epoch: 051 train_loss: 1.0912 train_acc: 60.1562
Epoch: 052 train_loss: 1.0693 train_acc: 58.5938
Epoch: 053 train_loss: 1.0500 train_acc: 58.7891
Epoch: 054 train_loss: 1.0493 train_acc: 58.2031
Epoch: 055 train_loss: 1.0229 train_acc: 58.9844
Epoch: 056 train_loss: 1.0170 train_acc: 61.9141
Epoch: 057 train_loss: 1.0359 train_acc: 59.9609
Epoch: 058 train_loss: 1.0410 train_acc: 58.5938
Epoch: 059 train_loss: 1.0126 train_acc: 62.6953
Epoch: 060 train_loss: 0.9784 train_acc: 63.8672
Epoch: 061 train_loss: 1.0051 train_acc: 60.9375
Epoch: 062 train_loss: 0.9905 train_acc: 62.6953
Epoch: 063 train_loss: 0.9852 train_acc: 61.7188
Epoch: 064 train_loss: 0.9599 train_acc: 61.1328
Epoch: 065 train_loss: 0.9695 train_acc: 62.5000
Epoch: 066 train_loss: 0.9881 train_acc: 60.9375
Epoch: 067 train_loss: 0.9779 train_acc: 62.5000
Epoch: 068 train_loss: 1.0059 train_acc: 60.7422
Epoch: 069 train_loss: 0.9572 train_acc: 64.6484
Epoch: 070 train_loss: 0.9352 train_acc: 64.6484
Epoch: 071 train_loss: 0.8934 train_acc: 66.6016
Epoch: 072 train_loss: 0.8861 train_acc: 64.8438
Epoch: 073 train_loss: 0.9459 train_acc: 63.2812
Epoch: 074 train_loss: 0.8934 train_acc: 66.4062
Epoch: 075 train_loss: 0.8751 train_acc: 66.2109
Epoch: 076 train_loss: 0.8881 train_acc: 67.1875
Epoch: 077 train_loss: 0.8605 train_acc: 64.8438
Epoch: 078 train_loss: 0.8275 train_acc: 67.3828
Epoch: 079 train_loss: 0.8285 train_acc: 68.5547
Epoch: 080 train_loss: 0.8224 train_acc: 66.0156
Epoch: 081 train_loss: 0.8113 train_acc: 69.1406
Epoch: 082 train_loss: 0.8379 train_acc: 69.1406
Epoch: 083 train_loss: 0.8424 train_acc: 66.7969
Epoch: 084 train_loss: 0.7860 train_acc: 68.7500
Epoch: 085 train_loss: 0.7949 train_acc: 68.9453
Epoch: 086 train_loss: 0.7915 train_acc: 68.9453
Epoch: 087 train_loss: 0.7879 train_acc: 67.7734
Epoch: 088 train_loss: 0.8003 train_acc: 69.5312
Epoch: 089 train_loss: 0.7898 train_acc: 67.9688
Epoch: 090 train_loss: 0.7654 train_acc: 72.2656
Epoch: 091 train_loss: 0.7831 train_acc: 67.9688
Epoch: 092 train_loss: 0.7806 train_acc: 68.5547
Epoch: 093 train_loss: 0.7710 train_acc: 71.0938
Epoch: 094 train_loss: 0.7511 train_acc: 72.4609
Epoch: 095 train_loss: 0.6696 train_acc: 76.3672
Epoch: 096 train_loss: 0.6754 train_acc: 74.8047
Epoch: 097 train_loss: 0.7645 train_acc: 71.6797
Epoch: 098 train_loss: 0.7900 train_acc: 71.4844
Epoch: 099 train_loss: 0.7511 train_acc: 72.4609
Epoch: 100 train_loss: 0.7763 train_acc: 70.5078
Epoch: 101 train_loss: 0.7165 train_acc: 73.2422
Epoch: 102 train_loss: 0.6742 train_acc: 74.2188
Epoch: 103 train_loss: 0.6652 train_acc: 75.7812
Epoch: 104 train_loss: 0.6286 train_acc: 77.3438
Epoch: 105 train_loss: 0.6507 train_acc: 77.9297
Epoch: 106 train_loss: 0.6433 train_acc: 75.0000
Epoch: 107 train_loss: 0.6316 train_acc: 78.3203
Epoch: 108 train_loss: 0.6040 train_acc: 77.3438
Epoch: 109 train_loss: 0.5824 train_acc: 78.9062
Epoch: 110 train_loss: 0.6093 train_acc: 79.6875
Epoch: 111 train_loss: 0.6102 train_acc: 79.2969
Epoch: 112 train_loss: 0.5686 train_acc: 79.2969
Epoch: 113 train_loss: 0.5607 train_acc: 82.2266
Epoch: 114 train_loss: 0.5803 train_acc: 79.8828
Epoch: 115 train_loss: 0.5743 train_acc: 79.8828
Epoch: 116 train_loss: 0.5313 train_acc: 82.2266
Epoch: 117 train_loss: 0.5249 train_acc: 82.8125
Epoch: 118 train_loss: 0.5462 train_acc: 82.0312
Epoch: 119 train_loss: 0.5734 train_acc: 78.7109
Epoch: 120 train_loss: 0.5567 train_acc: 80.6641
Epoch: 121 train_loss: 0.5756 train_acc: 81.0547
Epoch: 122 train_loss: 0.5779 train_acc: 79.2969
Epoch: 123 train_loss: 0.5435 train_acc: 82.0312
Epoch: 124 train_loss: 0.4834 train_acc: 85.1562
Epoch: 125 train_loss: 0.5056 train_acc: 83.9844
Epoch: 126 train_loss: 0.5038 train_acc: 83.9844
Epoch: 127 train_loss: 0.5085 train_acc: 82.8125
Epoch: 128 train_loss: 0.4852 train_acc: 82.8125
Epoch: 129 train_loss: 0.4686 train_acc: 85.3516
Epoch: 130 train_loss: 0.4479 train_acc: 85.5469
Epoch: 131 train_loss: 0.4302 train_acc: 85.9375
Epoch: 132 train_loss: 0.3967 train_acc: 86.5234
Epoch: 133 train_loss: 0.4667 train_acc: 84.7656
Epoch: 134 train_loss: 0.4018 train_acc: 88.0859
Epoch: 135 train_loss: 0.4424 train_acc: 84.3750
Epoch: 136 train_loss: 0.3954 train_acc: 87.8906
Epoch: 137 train_loss: 0.3899 train_acc: 86.9141
Epoch: 138 train_loss: 0.4011 train_acc: 87.8906
Epoch: 139 train_loss: 0.4038 train_acc: 87.8906
Epoch: 140 train_loss: 0.3932 train_acc: 88.2812
Epoch: 141 train_loss: 0.3942 train_acc: 87.8906
Epoch: 142 train_loss: 0.3509 train_acc: 88.8672
Epoch: 143 train_loss: 0.3654 train_acc: 89.8438
Epoch: 144 train_loss: 0.3582 train_acc: 89.2578
Epoch: 145 train_loss: 0.3600 train_acc: 89.0625
Epoch: 146 train_loss: 0.3838 train_acc: 88.0859
Epoch: 147 train_loss: 0.3024 train_acc: 91.4062
Epoch: 148 train_loss: 0.2994 train_acc: 92.9688
Epoch: 149 train_loss: 0.2903 train_acc: 92.7734
Epoch: 150 train_loss: 0.3037 train_acc: 91.7969
Epoch: 151 train_loss: 0.2882 train_acc: 92.3828
Epoch: 152 train_loss: 0.3407 train_acc: 89.4531
Epoch: 153 train_loss: 0.3118 train_acc: 90.2344
Epoch: 154 train_loss: 0.3161 train_acc: 90.6250
Epoch: 155 train_loss: 0.2668 train_acc: 93.9453
Epoch: 156 train_loss: 0.2964 train_acc: 92.1875
Epoch: 157 train_loss: 0.3312 train_acc: 88.6719
Epoch: 158 train_loss: 0.2840 train_acc: 91.2109
Epoch: 159 train_loss: 0.2826 train_acc: 92.9688
Epoch: 160 train_loss: 0.3049 train_acc: 90.0391
Epoch: 161 train_loss: 0.2991 train_acc: 90.8203
Epoch: 162 train_loss: 0.3401 train_acc: 86.9141
Epoch: 163 train_loss: 0.2845 train_acc: 91.9922
Epoch: 164 train_loss: 0.2863 train_acc: 90.6250
Epoch: 165 train_loss: 0.2796 train_acc: 92.3828
Epoch: 166 train_loss: 0.2519 train_acc: 94.1406
Epoch: 167 train_loss: 0.2397 train_acc: 93.3594
Epoch: 168 train_loss: 0.2501 train_acc: 92.5781
Epoch: 169 train_loss: 0.2619 train_acc: 91.2109
Epoch: 170 train_loss: 0.2165 train_acc: 95.1172
Epoch: 171 train_loss: 0.2385 train_acc: 93.3594
Epoch: 172 train_loss: 0.2606 train_acc: 91.7969
Epoch: 173 train_loss: 0.2441 train_acc: 92.3828
Epoch: 174 train_loss: 0.2769 train_acc: 92.1875
Epoch: 175 train_loss: 0.2819 train_acc: 92.3828
Epoch: 176 train_loss: 0.2861 train_acc: 90.4297
Epoch: 177 train_loss: 0.2553 train_acc: 92.9688
Epoch: 178 train_loss: 0.2461 train_acc: 92.1875
Epoch: 179 train_loss: 0.2292 train_acc: 93.9453
Epoch: 180 train_loss: 0.2313 train_acc: 93.3594
Epoch: 181 train_loss: 0.2142 train_acc: 93.9453
Epoch: 182 train_loss: 0.2490 train_acc: 93.5547
Epoch: 183 train_loss: 0.2787 train_acc: 91.7969
Epoch: 184 train_loss: 0.2404 train_acc: 94.7266
Epoch: 185 train_loss: 0.2613 train_acc: 91.7969
Epoch: 186 train_loss: 0.3223 train_acc: 90.8203
Epoch: 187 train_loss: 0.2360 train_acc: 93.1641
Epoch: 188 train_loss: 0.2649 train_acc: 92.1875
Epoch: 189 train_loss: 0.2124 train_acc: 94.5312
Epoch: 190 train_loss: 0.2075 train_acc: 93.7500
Epoch: 191 train_loss: 0.1942 train_acc: 95.7031
Epoch: 192 train_loss: 0.1936 train_acc: 94.9219
Epoch: 193 train_loss: 0.2308 train_acc: 93.1641
Epoch: 194 train_loss: 0.2489 train_acc: 92.9688
Epoch: 195 train_loss: 0.2399 train_acc: 93.3594
Epoch: 196 train_loss: 0.2389 train_acc: 92.7734
Epoch: 197 train_loss: 0.3522 train_acc: 88.2812
Epoch: 198 train_loss: 0.2706 train_acc: 91.6016
Epoch: 199 train_loss: 0.1979 train_acc: 95.1172
Epoch: 200 train_loss: 0.2259 train_acc: 92.3828
Epoch: 201 train_loss: 0.1995 train_acc: 95.1172
Epoch: 202 train_loss: 0.2053 train_acc: 95.3125
Epoch: 203 train_loss: 0.2131 train_acc: 94.5312
Epoch: 204 train_loss: 0.1903 train_acc: 94.5312
Epoch: 205 train_loss: 0.1806 train_acc: 95.5078
Epoch: 206 train_loss: 0.1869 train_acc: 94.3359
Epoch: 207 train_loss: 0.2167 train_acc: 94.1406
Epoch: 208 train_loss: 0.1904 train_acc: 94.7266
Epoch: 209 train_loss: 0.1551 train_acc: 96.8750
Epoch: 210 train_loss: 0.1476 train_acc: 97.4609
Epoch: 211 train_loss: 0.1656 train_acc: 95.7031
Epoch: 212 train_loss: 0.1710 train_acc: 95.5078
Epoch: 213 train_loss: 0.1663 train_acc: 96.4844
Epoch: 214 train_loss: 0.1749 train_acc: 95.3125
/home/amax/anaconda3/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
Epoch: 215 train_loss: 0.1546 train_acc: 96.6797
Epoch: 216 train_loss: 0.1678 train_acc: 95.7031
Epoch: 217 train_loss: 0.1423 train_acc: 96.6797
Epoch: 218 train_loss: 0.1524 train_acc: 96.4844
Epoch: 219 train_loss: 0.1686 train_acc: 96.4844
Epoch: 220 train_loss: 0.1940 train_acc: 94.7266
Epoch: 221 train_loss: 0.1715 train_acc: 94.9219
Epoch: 222 train_loss: 0.1678 train_acc: 95.1172
Epoch: 223 train_loss: 0.1334 train_acc: 97.4609
Epoch: 224 train_loss: 0.1489 train_acc: 97.0703
Epoch: 225 train_loss: 0.1909 train_acc: 93.9453
Epoch: 226 train_loss: 0.1434 train_acc: 96.6797
Epoch: 227 train_loss: 0.1558 train_acc: 95.1172
Epoch: 228 train_loss: 0.1317 train_acc: 97.6562
Epoch: 229 train_loss: 0.1839 train_acc: 95.5078
Epoch: 230 train_loss: 0.2042 train_acc: 93.5547
Epoch: 231 train_loss: 0.2354 train_acc: 92.3828
Epoch: 232 train_loss: 0.2300 train_acc: 93.5547
Epoch: 233 train_loss: 0.2076 train_acc: 93.1641
Epoch: 234 train_loss: 0.1615 train_acc: 96.2891
Epoch: 235 train_loss: 0.1582 train_acc: 96.0938
Epoch: 236 train_loss: 0.1736 train_acc: 94.1406
Epoch: 237 train_loss: 0.1384 train_acc: 97.2656
Epoch: 238 train_loss: 0.1578 train_acc: 96.4844
Epoch: 239 train_loss: 0.1645 train_acc: 94.7266
Epoch: 240 train_loss: 0.1621 train_acc: 96.6797
Epoch: 241 train_loss: 0.1262 train_acc: 98.0469
Epoch: 242 train_loss: 0.1542 train_acc: 96.2891
Epoch: 243 train_loss: 0.1456 train_acc: 95.8984
Epoch: 244 train_loss: 0.1548 train_acc: 95.3125
Epoch: 245 train_loss: 0.1365 train_acc: 97.2656
Epoch: 246 train_loss: 0.1152 train_acc: 97.8516
Epoch: 247 train_loss: 0.1197 train_acc: 98.0469
Epoch: 248 train_loss: 0.1566 train_acc: 96.6797
Epoch: 249 train_loss: 0.1528 train_acc: 95.8984
Epoch: 250 train_loss: 0.1515 train_acc: 95.5078
Epoch: 251 train_loss: 0.1153 train_acc: 97.2656
Epoch: 252 train_loss: 0.1225 train_acc: 96.8750
Epoch: 253 train_loss: 0.1634 train_acc: 94.7266
Epoch: 254 train_loss: 0.1375 train_acc: 96.4844
Epoch: 255 train_loss: 0.1605 train_acc: 95.8984
Epoch: 256 train_loss: 0.1486 train_acc: 96.2891
Epoch: 257 train_loss: 0.1297 train_acc: 97.2656
Epoch: 258 train_loss: 0.1184 train_acc: 97.4609
Epoch: 259 train_loss: 0.1102 train_acc: 97.8516
Epoch: 260 train_loss: 0.1158 train_acc: 97.2656
Epoch: 261 train_loss: 0.1290 train_acc: 96.2891
Epoch: 262 train_loss: 0.1336 train_acc: 96.8750
Epoch: 263 train_loss: 0.1488 train_acc: 96.4844
Epoch: 264 train_loss: 0.1273 train_acc: 97.2656
Epoch: 265 train_loss: 0.1414 train_acc: 95.7031
Epoch: 266 train_loss: 0.1124 train_acc: 98.6328
Epoch: 267 train_loss: 0.1119 train_acc: 97.6562
Epoch: 268 train_loss: 0.1120 train_acc: 98.4375
Epoch: 269 train_loss: 0.1142 train_acc: 97.0703
Epoch: 270 train_loss: 0.1136 train_acc: 97.2656
Epoch: 271 train_loss: 0.1071 train_acc: 97.4609
Epoch: 272 train_loss: 0.1158 train_acc: 97.8516
Epoch: 273 train_loss: 0.0977 train_acc: 98.2422
Epoch: 274 train_loss: 0.1191 train_acc: 96.4844
Epoch: 275 train_loss: 0.1036 train_acc: 97.8516
Epoch: 276 train_loss: 0.0999 train_acc: 98.8281
Epoch: 277 train_loss: 0.1349 train_acc: 95.3125
Epoch: 278 train_loss: 0.1399 train_acc: 96.2891
Epoch: 279 train_loss: 0.1210 train_acc: 96.8750
Epoch: 280 train_loss: 0.1196 train_acc: 97.8516
Epoch: 281 train_loss: 0.1159 train_acc: 98.0469
Epoch: 282 train_loss: 0.0913 train_acc: 98.6328
Epoch: 283 train_loss: 0.1051 train_acc: 97.6562
Epoch: 284 train_loss: 0.1085 train_acc: 98.2422
Epoch: 285 train_loss: 0.1120 train_acc: 97.6562
Epoch: 286 train_loss: 0.1162 train_acc: 97.4609
Epoch: 287 train_loss: 0.1404 train_acc: 95.7031
Epoch: 288 train_loss: 0.0963 train_acc: 98.0469
Epoch: 289 train_loss: 0.1030 train_acc: 98.0469
Epoch: 290 train_loss: 0.1061 train_acc: 97.2656
Epoch: 291 train_loss: 0.1055 train_acc: 97.2656
Epoch: 292 train_loss: 0.0991 train_acc: 98.4375
Epoch: 293 train_loss: 0.1080 train_acc: 97.6562
Epoch: 294 train_loss: 0.1251 train_acc: 96.6797
Epoch: 295 train_loss: 0.1245 train_acc: 97.2656
Epoch: 296 train_loss: 0.1431 train_acc: 96.2891
Epoch: 297 train_loss: 0.1515 train_acc: 95.7031
Epoch: 298 train_loss: 0.1100 train_acc: 97.8516
Epoch: 299 train_loss: 0.1151 train_acc: 97.6562
Epoch: 300 train_loss: 0.0897 train_acc: 98.2422
Running Time: 167.98
**************************************************
Final result:
OA: 0.7561 | AA: 0.6302 | Kappa: 0.7228
[0.18181818 0.79882093 0.75888325 0.63555556 0.76252723 0.87175793
 0.22222222 0.98017621 0.05263158 0.84073673 0.74871355 0.4991119
 0.88205128 0.80449251 0.31607629 0.72727273]
**************************************************
Parameter:
dataset: Indian
flag_test: train
mode: CAF
gpu_id: 0
seed: 9
batch_size: 64
test_freq: 5
patches: 7
band_patches: 3
epoches: 300
learning_rate: 0.0005
gamma: 0.9
weight_decay: 0.005
height=145,width=145,band=200
**************************************************
patch is : 7
mirror_image shape : [151,151,200]
**************************************************
x_train shape = (512, 7, 7, 200), type = float64
x_test  shape = (9737, 7, 7, 200), type = float64
x_true  shape = (21025, 7, 7, 200), type = float64
**************************************************
x_train_band shape = (512, 147, 200), type = float64
x_test_band  shape = (9737, 147, 200), type = float64
x_true_band  shape = (21025, 147, 200), type = float64
**************************************************
y_train: shape = (512,) ,type = int64
y_test: shape = (9737,) ,type = int64
y_true: shape = (21025,) ,type = int64
**************************************************
start training
Epoch: 001 train_loss: 2.5513 train_acc: 20.8984
Epoch: 002 train_loss: 2.2763 train_acc: 33.5938
Epoch: 003 train_loss: 2.0862 train_acc: 35.9375
Epoch: 004 train_loss: 1.9242 train_acc: 36.1328
Epoch: 005 train_loss: 1.8269 train_acc: 35.7422
Epoch: 006 train_loss: 1.7827 train_acc: 38.8672
Epoch: 007 train_loss: 1.7323 train_acc: 40.2344
Epoch: 008 train_loss: 1.7123 train_acc: 39.6484
Epoch: 009 train_loss: 1.6649 train_acc: 42.5781
Epoch: 010 train_loss: 1.6520 train_acc: 41.2109
Epoch: 011 train_loss: 1.6313 train_acc: 41.4062
Epoch: 012 train_loss: 1.5967 train_acc: 44.5312
Epoch: 013 train_loss: 1.5767 train_acc: 43.9453
Epoch: 014 train_loss: 1.5482 train_acc: 44.3359
Epoch: 015 train_loss: 1.5363 train_acc: 46.0938
Epoch: 016 train_loss: 1.4794 train_acc: 46.8750
Epoch: 017 train_loss: 1.4622 train_acc: 47.4609
Epoch: 018 train_loss: 1.4372 train_acc: 48.2422
Epoch: 019 train_loss: 1.4232 train_acc: 48.0469
Epoch: 020 train_loss: 1.4091 train_acc: 47.2656
Epoch: 021 train_loss: 1.3922 train_acc: 49.6094
Epoch: 022 train_loss: 1.3912 train_acc: 47.4609
Epoch: 023 train_loss: 1.3763 train_acc: 49.6094
Epoch: 024 train_loss: 1.3547 train_acc: 49.6094
Epoch: 025 train_loss: 1.3731 train_acc: 47.8516
Epoch: 026 train_loss: 1.3516 train_acc: 48.4375
Epoch: 027 train_loss: 1.3279 train_acc: 50.3906
Epoch: 028 train_loss: 1.3179 train_acc: 49.6094
Epoch: 029 train_loss: 1.2941 train_acc: 50.9766
Epoch: 030 train_loss: 1.3055 train_acc: 50.9766
Epoch: 031 train_loss: 1.3256 train_acc: 49.6094
Epoch: 032 train_loss: 1.3122 train_acc: 51.9531
Epoch: 033 train_loss: 1.2938 train_acc: 53.1250
Epoch: 034 train_loss: 1.2599 train_acc: 53.1250
Epoch: 035 train_loss: 1.2362 train_acc: 54.4922
Epoch: 036 train_loss: 1.2537 train_acc: 54.6875
Epoch: 037 train_loss: 1.2457 train_acc: 54.2969
Epoch: 038 train_loss: 1.2577 train_acc: 53.3203
Epoch: 039 train_loss: 1.2156 train_acc: 55.6641
Epoch: 040 train_loss: 1.2319 train_acc: 50.0000
Epoch: 041 train_loss: 1.1926 train_acc: 56.0547
Epoch: 042 train_loss: 1.1906 train_acc: 56.4453
Epoch: 043 train_loss: 1.1989 train_acc: 55.2734
Epoch: 044 train_loss: 1.1663 train_acc: 57.2266
Epoch: 045 train_loss: 1.1780 train_acc: 56.0547
Epoch: 046 train_loss: 1.1694 train_acc: 56.4453
Epoch: 047 train_loss: 1.1660 train_acc: 55.8594
Epoch: 048 train_loss: 1.1464 train_acc: 55.2734
Epoch: 049 train_loss: 1.1163 train_acc: 57.8125
Epoch: 050 train_loss: 1.1138 train_acc: 58.7891
Epoch: 051 train_loss: 1.1176 train_acc: 56.2500
Epoch: 052 train_loss: 1.1405 train_acc: 56.8359
Epoch: 053 train_loss: 1.1075 train_acc: 57.2266
Epoch: 054 train_loss: 1.0783 train_acc: 59.5703
Epoch: 055 train_loss: 1.1070 train_acc: 58.5938
Epoch: 056 train_loss: 1.0896 train_acc: 60.9375
Epoch: 057 train_loss: 1.1062 train_acc: 59.5703
Epoch: 058 train_loss: 1.0702 train_acc: 60.3516
Epoch: 059 train_loss: 1.0578 train_acc: 59.5703
Epoch: 060 train_loss: 1.0253 train_acc: 61.9141
Epoch: 061 train_loss: 1.0166 train_acc: 63.0859
Epoch: 062 train_loss: 1.0044 train_acc: 63.8672
Epoch: 063 train_loss: 1.0376 train_acc: 60.5469
Epoch: 064 train_loss: 1.0645 train_acc: 60.7422
Epoch: 065 train_loss: 1.0142 train_acc: 63.6719
Epoch: 066 train_loss: 0.9779 train_acc: 63.4766
Epoch: 067 train_loss: 0.9574 train_acc: 62.6953
Epoch: 068 train_loss: 1.0312 train_acc: 63.0859
Epoch: 069 train_loss: 0.9700 train_acc: 65.2344
Epoch: 070 train_loss: 0.9477 train_acc: 62.8906
Epoch: 071 train_loss: 0.9556 train_acc: 63.4766
Epoch: 072 train_loss: 0.9412 train_acc: 66.0156
Epoch: 073 train_loss: 1.0398 train_acc: 61.9141
Epoch: 074 train_loss: 1.0048 train_acc: 61.1328
Epoch: 075 train_loss: 1.0276 train_acc: 61.7188
Epoch: 076 train_loss: 0.9312 train_acc: 66.4062
Epoch: 077 train_loss: 0.9359 train_acc: 66.2109
Epoch: 078 train_loss: 0.9377 train_acc: 63.8672
Epoch: 079 train_loss: 0.8945 train_acc: 67.9688
Epoch: 080 train_loss: 0.9129 train_acc: 66.9922
Epoch: 081 train_loss: 0.9057 train_acc: 67.1875
Epoch: 082 train_loss: 0.8765 train_acc: 67.3828
Epoch: 083 train_loss: 0.8908 train_acc: 68.1641
Epoch: 084 train_loss: 0.9130 train_acc: 66.9922
Epoch: 085 train_loss: 0.9149 train_acc: 64.2578
Epoch: 086 train_loss: 0.8927 train_acc: 68.1641
Epoch: 087 train_loss: 0.8594 train_acc: 69.5312
Epoch: 088 train_loss: 0.8828 train_acc: 66.6016
Epoch: 089 train_loss: 0.8530 train_acc: 69.7266
Epoch: 090 train_loss: 0.8262 train_acc: 68.9453
Epoch: 091 train_loss: 0.8393 train_acc: 67.9688
Epoch: 092 train_loss: 0.8441 train_acc: 67.5781
Epoch: 093 train_loss: 0.7962 train_acc: 71.6797
Epoch: 094 train_loss: 0.8495 train_acc: 68.9453
Epoch: 095 train_loss: 0.7899 train_acc: 70.3125
Epoch: 096 train_loss: 0.7688 train_acc: 71.2891
Epoch: 097 train_loss: 0.8267 train_acc: 70.1172
Epoch: 098 train_loss: 0.8057 train_acc: 68.5547
Epoch: 099 train_loss: 0.8039 train_acc: 71.2891
Epoch: 100 train_loss: 0.7559 train_acc: 73.0469
Epoch: 101 train_loss: 0.7470 train_acc: 72.4609
Epoch: 102 train_loss: 0.7834 train_acc: 73.6328
Epoch: 103 train_loss: 0.7920 train_acc: 72.0703
Epoch: 104 train_loss: 0.7685 train_acc: 71.6797
Epoch: 105 train_loss: 0.7645 train_acc: 73.2422
Epoch: 106 train_loss: 0.7358 train_acc: 73.2422
Epoch: 107 train_loss: 0.7140 train_acc: 74.2188
Epoch: 108 train_loss: 0.7254 train_acc: 72.8516
Epoch: 109 train_loss: 0.6854 train_acc: 75.7812
Epoch: 110 train_loss: 0.7094 train_acc: 74.2188
Epoch: 111 train_loss: 0.7020 train_acc: 73.6328
Epoch: 112 train_loss: 0.7616 train_acc: 70.3125
Epoch: 113 train_loss: 0.7220 train_acc: 74.2188
Epoch: 114 train_loss: 0.6520 train_acc: 79.1016
Epoch: 115 train_loss: 0.6326 train_acc: 78.7109
Epoch: 116 train_loss: 0.6211 train_acc: 78.7109
Epoch: 117 train_loss: 0.6578 train_acc: 75.9766
Epoch: 118 train_loss: 0.6493 train_acc: 79.1016
Epoch: 119 train_loss: 0.6249 train_acc: 77.7344
Epoch: 120 train_loss: 0.6844 train_acc: 74.2188
Epoch: 121 train_loss: 0.6623 train_acc: 76.3672
Epoch: 122 train_loss: 0.6225 train_acc: 78.3203
Epoch: 123 train_loss: 0.6170 train_acc: 79.4922
Epoch: 124 train_loss: 0.5724 train_acc: 81.6406
Epoch: 125 train_loss: 0.6329 train_acc: 77.5391
Epoch: 126 train_loss: 0.5901 train_acc: 80.4688
Epoch: 127 train_loss: 0.5629 train_acc: 83.2031
Epoch: 128 train_loss: 0.5777 train_acc: 80.0781
Epoch: 129 train_loss: 0.5137 train_acc: 83.7891
Epoch: 130 train_loss: 0.5420 train_acc: 82.0312
Epoch: 131 train_loss: 0.5074 train_acc: 82.6172
Epoch: 132 train_loss: 0.5176 train_acc: 82.8125
Epoch: 133 train_loss: 0.5988 train_acc: 79.4922
Epoch: 134 train_loss: 0.5459 train_acc: 82.4219
Epoch: 135 train_loss: 0.5506 train_acc: 80.6641
Epoch: 136 train_loss: 0.5289 train_acc: 81.0547
Epoch: 137 train_loss: 0.4909 train_acc: 84.1797
Epoch: 138 train_loss: 0.4797 train_acc: 84.3750
Epoch: 139 train_loss: 0.4800 train_acc: 85.7422
Epoch: 140 train_loss: 0.4635 train_acc: 85.3516
Epoch: 141 train_loss: 0.4591 train_acc: 83.5938
Epoch: 142 train_loss: 0.4462 train_acc: 84.5703
Epoch: 143 train_loss: 0.4253 train_acc: 87.1094
Epoch: 144 train_loss: 0.4590 train_acc: 84.5703
Epoch: 145 train_loss: 0.4748 train_acc: 85.9375
Epoch: 146 train_loss: 0.4221 train_acc: 85.5469
Epoch: 147 train_loss: 0.4460 train_acc: 86.1328
Epoch: 148 train_loss: 0.4648 train_acc: 83.7891
Epoch: 149 train_loss: 0.4666 train_acc: 85.1562
Epoch: 150 train_loss: 0.5064 train_acc: 83.3984
Epoch: 151 train_loss: 0.4838 train_acc: 83.9844
Epoch: 152 train_loss: 0.4503 train_acc: 86.5234
Epoch: 153 train_loss: 0.4235 train_acc: 86.5234
Epoch: 154 train_loss: 0.3759 train_acc: 89.4531
Epoch: 155 train_loss: 0.3738 train_acc: 87.8906
Epoch: 156 train_loss: 0.4219 train_acc: 86.9141
Epoch: 157 train_loss: 0.3801 train_acc: 88.6719
Epoch: 158 train_loss: 0.3900 train_acc: 89.2578
Epoch: 159 train_loss: 0.4137 train_acc: 85.7422
Epoch: 160 train_loss: 0.3936 train_acc: 87.8906
Epoch: 161 train_loss: 0.4833 train_acc: 83.2031
Epoch: 162 train_loss: 0.3629 train_acc: 90.2344
Epoch: 163 train_loss: 0.4306 train_acc: 84.9609
Epoch: 164 train_loss: 0.4839 train_acc: 83.9844
Epoch: 165 train_loss: 0.4404 train_acc: 84.7656
Epoch: 166 train_loss: 0.3820 train_acc: 87.8906
Epoch: 167 train_loss: 0.3299 train_acc: 90.0391
Epoch: 168 train_loss: 0.3862 train_acc: 86.7188
Epoch: 169 train_loss: 0.3183 train_acc: 89.8438
Epoch: 170 train_loss: 0.3170 train_acc: 89.2578
Epoch: 171 train_loss: 0.3051 train_acc: 92.1875
Epoch: 172 train_loss: 0.2996 train_acc: 90.4297
Epoch: 173 train_loss: 0.3737 train_acc: 86.9141
Epoch: 174 train_loss: 0.3717 train_acc: 86.9141
Epoch: 175 train_loss: 0.3012 train_acc: 90.4297
Epoch: 176 train_loss: 0.3186 train_acc: 89.8438
Epoch: 177 train_loss: 0.2872 train_acc: 91.4062
Epoch: 178 train_loss: 0.2784 train_acc: 92.7734
Epoch: 179 train_loss: 0.2834 train_acc: 91.7969
Epoch: 180 train_loss: 0.2698 train_acc: 92.3828
Epoch: 181 train_loss: 0.3106 train_acc: 90.4297
Epoch: 182 train_loss: 0.2933 train_acc: 91.2109
Epoch: 183 train_loss: 0.3156 train_acc: 89.8438
Epoch: 184 train_loss: 0.2657 train_acc: 93.1641
Epoch: 185 train_loss: 0.2656 train_acc: 92.9688
Epoch: 186 train_loss: 0.3339 train_acc: 89.2578
Epoch: 187 train_loss: 0.3716 train_acc: 86.5234
Epoch: 188 train_loss: 0.3222 train_acc: 91.0156
Epoch: 189 train_loss: 0.2702 train_acc: 91.9922
Epoch: 190 train_loss: 0.2431 train_acc: 93.7500
Epoch: 191 train_loss: 0.2592 train_acc: 91.6016
Epoch: 192 train_loss: 0.2475 train_acc: 93.3594
Epoch: 193 train_loss: 0.3350 train_acc: 90.2344
Epoch: 194 train_loss: 0.3499 train_acc: 88.6719
Epoch: 195 train_loss: 0.3634 train_acc: 88.4766
Epoch: 196 train_loss: 0.3350 train_acc: 88.0859
Epoch: 197 train_loss: 0.3283 train_acc: 90.2344
Epoch: 198 train_loss: 0.2582 train_acc: 91.9922
Epoch: 199 train_loss: 0.2446 train_acc: 92.3828
Epoch: 200 train_loss: 0.2410 train_acc: 92.5781
Epoch: 201 train_loss: 0.2435 train_acc: 93.1641
Epoch: 202 train_loss: 0.2322 train_acc: 92.3828
Epoch: 203 train_loss: 0.2711 train_acc: 92.1875
Epoch: 204 train_loss: 0.2324 train_acc: 92.3828
Epoch: 205 train_loss: 0.2349 train_acc: 95.3125
Epoch: 206 train_loss: 0.2164 train_acc: 95.1172
Epoch: 207 train_loss: 0.2310 train_acc: 92.5781
Epoch: 208 train_loss: 0.2219 train_acc: 93.3594
Epoch: 209 train_loss: 0.2539 train_acc: 92.3828
Epoch: 210 train_loss: 0.2298 train_acc: 93.1641
Epoch: 211 train_loss: 0.1979 train_acc: 95.3125
Epoch: 212 train_loss: 0.2123 train_acc: 94.9219
Epoch: 213 train_loss: 0.2426 train_acc: 93.1641
Epoch: 214 train_loss: 0.2504 train_acc: 92.1875
Epoch: 215 train_loss: 0.2629 train_acc: 91.4062
Epoch: 216 train_loss: 0.2200 train_acc: 93.3594
Epoch: 217 train_loss: 0.2440 train_acc: 92.5781
Epoch: 218 train_loss: 0.2305 train_acc: 92.9688
Epoch: 219 train_loss: 0.2569 train_acc: 92.3828
Epoch: 220 train_loss: 0.2238 train_acc: 93.5547
Epoch: 221 train_loss: 0.2932 train_acc: 90.6250
/home/amax/anaconda3/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
Epoch: 222 train_loss: 0.3150 train_acc: 90.2344
Epoch: 223 train_loss: 0.2501 train_acc: 92.3828
Epoch: 224 train_loss: 0.1980 train_acc: 92.9688
Epoch: 225 train_loss: 0.1915 train_acc: 95.3125
Epoch: 226 train_loss: 0.1954 train_acc: 95.5078
Epoch: 227 train_loss: 0.1976 train_acc: 94.5312
Epoch: 228 train_loss: 0.1529 train_acc: 97.0703
Epoch: 229 train_loss: 0.1515 train_acc: 96.6797
Epoch: 230 train_loss: 0.1662 train_acc: 96.2891
Epoch: 231 train_loss: 0.1725 train_acc: 95.5078
Epoch: 232 train_loss: 0.1586 train_acc: 96.8750
Epoch: 233 train_loss: 0.2087 train_acc: 93.3594
Epoch: 234 train_loss: 0.2338 train_acc: 93.7500
Epoch: 235 train_loss: 0.2328 train_acc: 92.9688
Epoch: 236 train_loss: 0.2289 train_acc: 93.5547
Epoch: 237 train_loss: 0.2645 train_acc: 91.4062
Epoch: 238 train_loss: 0.2603 train_acc: 91.0156
Epoch: 239 train_loss: 0.2553 train_acc: 93.1641
Epoch: 240 train_loss: 0.2304 train_acc: 94.5312
Epoch: 241 train_loss: 0.1897 train_acc: 95.5078
Epoch: 242 train_loss: 0.1771 train_acc: 94.5312
Epoch: 243 train_loss: 0.1612 train_acc: 96.2891
Epoch: 244 train_loss: 0.1409 train_acc: 96.8750
Epoch: 245 train_loss: 0.1680 train_acc: 95.3125
Epoch: 246 train_loss: 0.1721 train_acc: 96.4844
Epoch: 247 train_loss: 0.1386 train_acc: 96.4844
Epoch: 248 train_loss: 0.1483 train_acc: 96.2891
Epoch: 249 train_loss: 0.1810 train_acc: 94.7266
Epoch: 250 train_loss: 0.1683 train_acc: 94.9219
Epoch: 251 train_loss: 0.1696 train_acc: 96.2891
Epoch: 252 train_loss: 0.2009 train_acc: 94.5312
Epoch: 253 train_loss: 0.1905 train_acc: 94.7266
Epoch: 254 train_loss: 0.1855 train_acc: 93.9453
Epoch: 255 train_loss: 0.1675 train_acc: 95.3125
Epoch: 256 train_loss: 0.1290 train_acc: 96.6797
Epoch: 257 train_loss: 0.1209 train_acc: 97.4609
Epoch: 258 train_loss: 0.1638 train_acc: 95.3125
Epoch: 259 train_loss: 0.1918 train_acc: 93.7500
Epoch: 260 train_loss: 0.1750 train_acc: 95.3125
Epoch: 261 train_loss: 0.1621 train_acc: 96.0938
Epoch: 262 train_loss: 0.1303 train_acc: 97.0703
Epoch: 263 train_loss: 0.1332 train_acc: 97.6562
Epoch: 264 train_loss: 0.1451 train_acc: 95.7031
Epoch: 265 train_loss: 0.1220 train_acc: 97.8516
Epoch: 266 train_loss: 0.1196 train_acc: 97.4609
Epoch: 267 train_loss: 0.1486 train_acc: 96.0938
Epoch: 268 train_loss: 0.1473 train_acc: 96.4844
Epoch: 269 train_loss: 0.1566 train_acc: 95.8984
Epoch: 270 train_loss: 0.1397 train_acc: 96.2891
Epoch: 271 train_loss: 0.1522 train_acc: 96.2891
Epoch: 272 train_loss: 0.1489 train_acc: 96.2891
Epoch: 273 train_loss: 0.1143 train_acc: 97.2656
Epoch: 274 train_loss: 0.1300 train_acc: 97.0703
Epoch: 275 train_loss: 0.1839 train_acc: 95.3125
Epoch: 276 train_loss: 0.1341 train_acc: 96.4844
Epoch: 277 train_loss: 0.1080 train_acc: 97.8516
Epoch: 278 train_loss: 0.1265 train_acc: 97.2656
Epoch: 279 train_loss: 0.1314 train_acc: 97.6562
Epoch: 280 train_loss: 0.1655 train_acc: 95.1172
Epoch: 281 train_loss: 0.1915 train_acc: 95.1172
Epoch: 282 train_loss: 0.2222 train_acc: 92.7734
Epoch: 283 train_loss: 0.1962 train_acc: 93.7500
Epoch: 284 train_loss: 0.1821 train_acc: 96.0938
Epoch: 285 train_loss: 0.1762 train_acc: 94.9219
Epoch: 286 train_loss: 0.1120 train_acc: 97.8516
Epoch: 287 train_loss: 0.1323 train_acc: 96.4844
Epoch: 288 train_loss: 0.1335 train_acc: 96.6797
Epoch: 289 train_loss: 0.1017 train_acc: 98.2422
Epoch: 290 train_loss: 0.0994 train_acc: 97.4609
Epoch: 291 train_loss: 0.1205 train_acc: 97.8516
Epoch: 292 train_loss: 0.1124 train_acc: 97.0703
Epoch: 293 train_loss: 0.1255 train_acc: 97.0703
Epoch: 294 train_loss: 0.1479 train_acc: 96.4844
Epoch: 295 train_loss: 0.1543 train_acc: 96.4844
Epoch: 296 train_loss: 0.1200 train_acc: 96.6797
Epoch: 297 train_loss: 0.1193 train_acc: 96.8750
Epoch: 298 train_loss: 0.0981 train_acc: 98.2422
Epoch: 299 train_loss: 0.1147 train_acc: 97.8516
Epoch: 300 train_loss: 0.1181 train_acc: 97.2656
Running Time: 168.29
**************************************************
Final result:
OA: 0.7977 | AA: 0.6962 | Kappa: 0.7701
[0.22727273 0.8238762  0.77284264 0.63111111 0.85185185 0.89481268
 0.03703704 0.94933921 0.47368421 0.85157096 0.77744425 0.52397869
 0.99487179 0.87437604 0.60217984 0.85227273]
**************************************************
Parameter:
dataset: Indian
flag_test: train
mode: CAF
gpu_id: 0
seed: 10
batch_size: 64
test_freq: 5
patches: 7
band_patches: 3
epoches: 300
learning_rate: 0.0005
gamma: 0.9
weight_decay: 0.005
height=145,width=145,band=200
**************************************************
patch is : 7
mirror_image shape : [151,151,200]
**************************************************
x_train shape = (512, 7, 7, 200), type = float64
x_test  shape = (9737, 7, 7, 200), type = float64
x_true  shape = (21025, 7, 7, 200), type = float64
**************************************************
x_train_band shape = (512, 147, 200), type = float64
x_test_band  shape = (9737, 147, 200), type = float64
x_true_band  shape = (21025, 147, 200), type = float64
**************************************************
y_train: shape = (512,) ,type = int64
y_test: shape = (9737,) ,type = int64
y_true: shape = (21025,) ,type = int64
**************************************************
start training
Epoch: 001 train_loss: 2.5765 train_acc: 19.7266
Epoch: 002 train_loss: 2.3442 train_acc: 26.1719
Epoch: 003 train_loss: 2.1580 train_acc: 35.7422
Epoch: 004 train_loss: 2.0071 train_acc: 36.3281
Epoch: 005 train_loss: 1.9000 train_acc: 37.3047
Epoch: 006 train_loss: 1.8336 train_acc: 39.2578
Epoch: 007 train_loss: 1.7738 train_acc: 40.0391
Epoch: 008 train_loss: 1.7298 train_acc: 41.9922
Epoch: 009 train_loss: 1.6822 train_acc: 42.3828
Epoch: 010 train_loss: 1.6585 train_acc: 42.5781
Epoch: 011 train_loss: 1.6259 train_acc: 40.8203
Epoch: 012 train_loss: 1.5987 train_acc: 44.1406
Epoch: 013 train_loss: 1.5703 train_acc: 43.9453
Epoch: 014 train_loss: 1.5361 train_acc: 44.5312
Epoch: 015 train_loss: 1.5221 train_acc: 45.8984
Epoch: 016 train_loss: 1.4852 train_acc: 46.2891
Epoch: 017 train_loss: 1.4640 train_acc: 47.4609
Epoch: 018 train_loss: 1.4286 train_acc: 49.4141
Epoch: 019 train_loss: 1.4146 train_acc: 49.6094
Epoch: 020 train_loss: 1.3860 train_acc: 50.0000
Epoch: 021 train_loss: 1.3886 train_acc: 50.3906
Epoch: 022 train_loss: 1.3960 train_acc: 49.4141
Epoch: 023 train_loss: 1.4048 train_acc: 48.4375
Epoch: 024 train_loss: 1.3393 train_acc: 51.9531
Epoch: 025 train_loss: 1.3407 train_acc: 51.9531
Epoch: 026 train_loss: 1.3306 train_acc: 52.7344
Epoch: 027 train_loss: 1.3046 train_acc: 52.9297
Epoch: 028 train_loss: 1.3181 train_acc: 52.7344
Epoch: 029 train_loss: 1.3074 train_acc: 52.7344
Epoch: 030 train_loss: 1.2763 train_acc: 53.1250
Epoch: 031 train_loss: 1.2782 train_acc: 54.2969
Epoch: 032 train_loss: 1.2775 train_acc: 53.1250
Epoch: 033 train_loss: 1.2803 train_acc: 53.5156
Epoch: 034 train_loss: 1.2679 train_acc: 53.9062
Epoch: 035 train_loss: 1.2692 train_acc: 55.2734
Epoch: 036 train_loss: 1.2667 train_acc: 53.9062
Epoch: 037 train_loss: 1.2515 train_acc: 55.2734
Epoch: 038 train_loss: 1.2291 train_acc: 54.6875
Epoch: 039 train_loss: 1.2195 train_acc: 55.2734
Epoch: 040 train_loss: 1.2387 train_acc: 54.1016
Epoch: 041 train_loss: 1.2379 train_acc: 54.2969
Epoch: 042 train_loss: 1.2136 train_acc: 55.6641
Epoch: 043 train_loss: 1.2162 train_acc: 54.6875
Epoch: 044 train_loss: 1.2098 train_acc: 55.8594
Epoch: 045 train_loss: 1.2132 train_acc: 54.8828
Epoch: 046 train_loss: 1.2046 train_acc: 57.0312
Epoch: 047 train_loss: 1.2055 train_acc: 55.0781
Epoch: 048 train_loss: 1.2139 train_acc: 55.0781
Epoch: 049 train_loss: 1.2015 train_acc: 54.8828
Epoch: 050 train_loss: 1.1961 train_acc: 56.8359
Epoch: 051 train_loss: 1.1661 train_acc: 58.3984
Epoch: 052 train_loss: 1.1800 train_acc: 56.0547
Epoch: 053 train_loss: 1.1585 train_acc: 57.2266
Epoch: 054 train_loss: 1.1595 train_acc: 58.5938
Epoch: 055 train_loss: 1.1667 train_acc: 56.0547
Epoch: 056 train_loss: 1.1530 train_acc: 57.6172
Epoch: 057 train_loss: 1.1621 train_acc: 56.6406
Epoch: 058 train_loss: 1.1348 train_acc: 58.0078
Epoch: 059 train_loss: 1.1048 train_acc: 59.3750
Epoch: 060 train_loss: 1.1218 train_acc: 57.4219
Epoch: 061 train_loss: 1.1179 train_acc: 58.7891
Epoch: 062 train_loss: 1.1004 train_acc: 58.5938
Epoch: 063 train_loss: 1.0928 train_acc: 58.9844
Epoch: 064 train_loss: 1.1043 train_acc: 58.2031
Epoch: 065 train_loss: 1.1062 train_acc: 58.2031
Epoch: 066 train_loss: 1.1223 train_acc: 59.1797
Epoch: 067 train_loss: 1.1069 train_acc: 59.1797
Epoch: 068 train_loss: 1.0866 train_acc: 59.7656
Epoch: 069 train_loss: 1.0693 train_acc: 61.3281
Epoch: 070 train_loss: 1.0748 train_acc: 58.9844
Epoch: 071 train_loss: 1.0725 train_acc: 58.5938
Epoch: 072 train_loss: 1.0722 train_acc: 59.9609
Epoch: 073 train_loss: 1.0263 train_acc: 60.1562
Epoch: 074 train_loss: 1.0754 train_acc: 58.7891
Epoch: 075 train_loss: 1.0656 train_acc: 59.1797
Epoch: 076 train_loss: 1.0686 train_acc: 58.5938
Epoch: 077 train_loss: 1.0627 train_acc: 60.5469
Epoch: 078 train_loss: 1.0242 train_acc: 58.7891
Epoch: 079 train_loss: 1.0495 train_acc: 58.7891
Epoch: 080 train_loss: 1.0866 train_acc: 57.4219
Epoch: 081 train_loss: 1.1067 train_acc: 57.6172
Epoch: 082 train_loss: 1.0614 train_acc: 58.7891
Epoch: 083 train_loss: 1.0059 train_acc: 61.5234
Epoch: 084 train_loss: 0.9930 train_acc: 63.6719
Epoch: 085 train_loss: 0.9830 train_acc: 61.7188
Epoch: 086 train_loss: 0.9987 train_acc: 63.4766
Epoch: 087 train_loss: 0.9983 train_acc: 61.9141
Epoch: 088 train_loss: 0.9754 train_acc: 63.4766
Epoch: 089 train_loss: 0.9846 train_acc: 61.7188
Epoch: 090 train_loss: 0.9549 train_acc: 64.2578
Epoch: 091 train_loss: 0.9258 train_acc: 65.2344
Epoch: 092 train_loss: 0.9659 train_acc: 60.5469
Epoch: 093 train_loss: 0.9832 train_acc: 61.1328
Epoch: 094 train_loss: 0.9278 train_acc: 63.8672
Epoch: 095 train_loss: 0.9610 train_acc: 63.8672
Epoch: 096 train_loss: 0.9817 train_acc: 59.9609
Epoch: 097 train_loss: 0.9196 train_acc: 64.8438
Epoch: 098 train_loss: 0.9211 train_acc: 65.2344
Epoch: 099 train_loss: 0.9052 train_acc: 66.4062
Epoch: 100 train_loss: 0.9180 train_acc: 65.6250
Epoch: 101 train_loss: 0.8999 train_acc: 65.6250
Epoch: 102 train_loss: 0.9017 train_acc: 65.0391
Epoch: 103 train_loss: 0.8873 train_acc: 65.8203
Epoch: 104 train_loss: 0.8866 train_acc: 65.4297
Epoch: 105 train_loss: 0.9223 train_acc: 64.6484
Epoch: 106 train_loss: 0.8702 train_acc: 65.8203
Epoch: 107 train_loss: 0.8848 train_acc: 65.8203
Epoch: 108 train_loss: 0.8981 train_acc: 66.2109
Epoch: 109 train_loss: 0.9352 train_acc: 66.4062
Epoch: 110 train_loss: 0.9196 train_acc: 64.8438
Epoch: 111 train_loss: 0.8680 train_acc: 68.5547
Epoch: 112 train_loss: 0.8896 train_acc: 64.8438
Epoch: 113 train_loss: 0.8787 train_acc: 64.4531
Epoch: 114 train_loss: 0.8531 train_acc: 67.3828
Epoch: 115 train_loss: 0.8165 train_acc: 68.7500
Epoch: 116 train_loss: 0.8237 train_acc: 70.3125
Epoch: 117 train_loss: 0.8170 train_acc: 69.5312
Epoch: 118 train_loss: 0.8422 train_acc: 67.5781
Epoch: 119 train_loss: 0.8691 train_acc: 65.2344
Epoch: 120 train_loss: 0.8336 train_acc: 69.3359
Epoch: 121 train_loss: 0.7738 train_acc: 71.4844
Epoch: 122 train_loss: 0.7869 train_acc: 72.2656
Epoch: 123 train_loss: 0.7509 train_acc: 73.0469
Epoch: 124 train_loss: 0.7474 train_acc: 71.6797
Epoch: 125 train_loss: 0.7342 train_acc: 72.4609
Epoch: 126 train_loss: 0.7732 train_acc: 71.8750
Epoch: 127 train_loss: 0.8017 train_acc: 72.2656
Epoch: 128 train_loss: 0.8013 train_acc: 69.5312
Epoch: 129 train_loss: 0.7165 train_acc: 73.2422
Epoch: 130 train_loss: 0.6969 train_acc: 74.4141
Epoch: 131 train_loss: 0.6801 train_acc: 75.9766
Epoch: 132 train_loss: 0.6987 train_acc: 71.2891
Epoch: 133 train_loss: 0.7419 train_acc: 71.8750
Epoch: 134 train_loss: 0.6931 train_acc: 75.1953
Epoch: 135 train_loss: 0.6941 train_acc: 73.6328
Epoch: 136 train_loss: 0.7022 train_acc: 71.6797
Epoch: 137 train_loss: 0.7272 train_acc: 74.0234
Epoch: 138 train_loss: 0.7351 train_acc: 71.2891
Epoch: 139 train_loss: 0.6871 train_acc: 75.3906
Epoch: 140 train_loss: 0.6862 train_acc: 73.8281
Epoch: 141 train_loss: 0.6558 train_acc: 75.5859
Epoch: 142 train_loss: 0.6964 train_acc: 73.0469
Epoch: 143 train_loss: 0.6817 train_acc: 76.1719
Epoch: 144 train_loss: 0.6686 train_acc: 75.9766
Epoch: 145 train_loss: 0.6356 train_acc: 77.5391
Epoch: 146 train_loss: 0.7230 train_acc: 73.2422
Epoch: 147 train_loss: 0.6950 train_acc: 73.2422
Epoch: 148 train_loss: 0.6852 train_acc: 74.6094
Epoch: 149 train_loss: 0.6549 train_acc: 75.5859
Epoch: 150 train_loss: 0.6409 train_acc: 76.1719
Epoch: 151 train_loss: 0.5855 train_acc: 80.6641
Epoch: 152 train_loss: 0.5477 train_acc: 82.0312
Epoch: 153 train_loss: 0.5544 train_acc: 80.8594
Epoch: 154 train_loss: 0.5350 train_acc: 82.2266
Epoch: 155 train_loss: 0.5329 train_acc: 83.3984
Epoch: 156 train_loss: 0.5639 train_acc: 80.8594
Epoch: 157 train_loss: 0.5944 train_acc: 79.8828
Epoch: 158 train_loss: 0.5796 train_acc: 79.2969
Epoch: 159 train_loss: 0.5428 train_acc: 81.6406
Epoch: 160 train_loss: 0.5691 train_acc: 78.5156
Epoch: 161 train_loss: 0.6310 train_acc: 76.5625
Epoch: 162 train_loss: 0.5943 train_acc: 78.1250
Epoch: 163 train_loss: 0.5279 train_acc: 82.8125
Epoch: 164 train_loss: 0.5329 train_acc: 81.2500
Epoch: 165 train_loss: 0.5424 train_acc: 81.2500
Epoch: 166 train_loss: 0.5080 train_acc: 83.2031
Epoch: 167 train_loss: 0.5720 train_acc: 78.7109
Epoch: 168 train_loss: 0.4981 train_acc: 83.9844
Epoch: 169 train_loss: 0.4720 train_acc: 84.5703
Epoch: 170 train_loss: 0.4977 train_acc: 85.1562
Epoch: 171 train_loss: 0.4773 train_acc: 85.7422
Epoch: 172 train_loss: 0.5012 train_acc: 83.7891
Epoch: 173 train_loss: 0.5824 train_acc: 76.1719
Epoch: 174 train_loss: 0.5309 train_acc: 82.2266
Epoch: 175 train_loss: 0.5749 train_acc: 81.0547
Epoch: 176 train_loss: 0.5161 train_acc: 82.8125
Epoch: 177 train_loss: 0.4983 train_acc: 82.8125
Epoch: 178 train_loss: 0.4582 train_acc: 85.5469
Epoch: 179 train_loss: 0.4527 train_acc: 86.3281
Epoch: 180 train_loss: 0.4600 train_acc: 83.7891
Epoch: 181 train_loss: 0.4521 train_acc: 85.3516
Epoch: 182 train_loss: 0.3978 train_acc: 88.8672
Epoch: 183 train_loss: 0.4401 train_acc: 85.7422
Epoch: 184 train_loss: 0.4159 train_acc: 86.7188
Epoch: 185 train_loss: 0.4145 train_acc: 87.3047
Epoch: 186 train_loss: 0.3919 train_acc: 88.4766
Epoch: 187 train_loss: 0.4223 train_acc: 87.1094
Epoch: 188 train_loss: 0.4227 train_acc: 86.9141
Epoch: 189 train_loss: 0.4342 train_acc: 84.3750
Epoch: 190 train_loss: 0.4231 train_acc: 86.1328
Epoch: 191 train_loss: 0.4026 train_acc: 87.3047
Epoch: 192 train_loss: 0.3796 train_acc: 88.4766
Epoch: 193 train_loss: 0.3843 train_acc: 87.1094
Epoch: 194 train_loss: 0.3777 train_acc: 87.3047
Epoch: 195 train_loss: 0.3555 train_acc: 90.6250
Epoch: 196 train_loss: 0.3580 train_acc: 87.3047
Epoch: 197 train_loss: 0.3958 train_acc: 87.3047
Epoch: 198 train_loss: 0.3479 train_acc: 90.6250
Epoch: 199 train_loss: 0.3275 train_acc: 89.6484
Epoch: 200 train_loss: 0.3456 train_acc: 89.2578
Epoch: 201 train_loss: 0.4187 train_acc: 87.5000
Epoch: 202 train_loss: 0.3728 train_acc: 89.4531
Epoch: 203 train_loss: 0.3284 train_acc: 90.4297
Epoch: 204 train_loss: 0.3626 train_acc: 89.8438
Epoch: 205 train_loss: 0.3356 train_acc: 89.6484
Epoch: 206 train_loss: 0.3605 train_acc: 89.6484
Epoch: 207 train_loss: 0.3287 train_acc: 89.6484
Epoch: 208 train_loss: 0.3023 train_acc: 91.2109
Epoch: 209 train_loss: 0.3004 train_acc: 91.4062
Epoch: 210 train_loss: 0.3177 train_acc: 90.4297
Epoch: 211 train_loss: 0.3392 train_acc: 89.4531
Epoch: 212 train_loss: 0.3160 train_acc: 91.6016
Epoch: 213 train_loss: 0.3000 train_acc: 90.4297
Epoch: 214 train_loss: 0.3786 train_acc: 87.5000
Epoch: 215 train_loss: 0.3282 train_acc: 90.4297
Epoch: 216 train_loss: 0.2922 train_acc: 93.1641
Epoch: 217 train_loss: 0.2816 train_acc: 92.3828
Epoch: 218 train_loss: 0.2937 train_acc: 91.2109
Epoch: 219 train_loss: 0.2563 train_acc: 93.1641
Epoch: 220 train_loss: 0.2790 train_acc: 91.6016
Epoch: 221 train_loss: 0.2918 train_acc: 90.4297
Epoch: 222 train_loss: 0.2633 train_acc: 92.7734
Epoch: 223 train_loss: 0.2646 train_acc: 93.3594
Epoch: 224 train_loss: 0.3339 train_acc: 89.4531
Epoch: 225 train_loss: 0.3185 train_acc: 90.2344
Epoch: 226 train_loss: 0.3017 train_acc: 91.0156
Epoch: 227 train_loss: 0.2810 train_acc: 92.3828
Epoch: 228 train_loss: 0.2569 train_acc: 93.1641
/home/amax/anaconda3/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
Epoch: 229 train_loss: 0.2754 train_acc: 92.3828
Epoch: 230 train_loss: 0.2558 train_acc: 91.9922
Epoch: 231 train_loss: 0.2344 train_acc: 94.7266
Epoch: 232 train_loss: 0.2542 train_acc: 93.7500
Epoch: 233 train_loss: 0.2392 train_acc: 93.5547
Epoch: 234 train_loss: 0.2736 train_acc: 91.0156
Epoch: 235 train_loss: 0.2850 train_acc: 90.8203
Epoch: 236 train_loss: 0.2611 train_acc: 92.7734
Epoch: 237 train_loss: 0.2366 train_acc: 93.5547
Epoch: 238 train_loss: 0.2394 train_acc: 93.7500
Epoch: 239 train_loss: 0.2388 train_acc: 93.3594
Epoch: 240 train_loss: 0.1917 train_acc: 96.6797
Epoch: 241 train_loss: 0.2378 train_acc: 93.7500
Epoch: 242 train_loss: 0.2463 train_acc: 93.1641
Epoch: 243 train_loss: 0.2339 train_acc: 92.9688
Epoch: 244 train_loss: 0.2646 train_acc: 92.9688
Epoch: 245 train_loss: 0.2247 train_acc: 93.7500
Epoch: 246 train_loss: 0.2481 train_acc: 93.7500
Epoch: 247 train_loss: 0.2135 train_acc: 93.1641
Epoch: 248 train_loss: 0.2102 train_acc: 94.5312
Epoch: 249 train_loss: 0.2102 train_acc: 94.7266
Epoch: 250 train_loss: 0.2009 train_acc: 95.5078
Epoch: 251 train_loss: 0.2062 train_acc: 94.5312
Epoch: 252 train_loss: 0.2046 train_acc: 95.3125
Epoch: 253 train_loss: 0.2017 train_acc: 94.7266
Epoch: 254 train_loss: 0.2169 train_acc: 93.9453
Epoch: 255 train_loss: 0.2015 train_acc: 94.7266
Epoch: 256 train_loss: 0.2105 train_acc: 93.7500
Epoch: 257 train_loss: 0.2461 train_acc: 91.4062
Epoch: 258 train_loss: 0.2162 train_acc: 94.3359
Epoch: 259 train_loss: 0.1824 train_acc: 95.8984
Epoch: 260 train_loss: 0.2157 train_acc: 93.7500
Epoch: 261 train_loss: 0.2469 train_acc: 92.5781
Epoch: 262 train_loss: 0.1868 train_acc: 95.8984
Epoch: 263 train_loss: 0.1863 train_acc: 95.7031
Epoch: 264 train_loss: 0.2208 train_acc: 93.9453
Epoch: 265 train_loss: 0.2295 train_acc: 93.5547
Epoch: 266 train_loss: 0.2487 train_acc: 92.7734
Epoch: 267 train_loss: 0.1968 train_acc: 94.3359
Epoch: 268 train_loss: 0.2477 train_acc: 92.3828
Epoch: 269 train_loss: 0.1913 train_acc: 94.5312
Epoch: 270 train_loss: 0.2095 train_acc: 94.3359
Epoch: 271 train_loss: 0.1756 train_acc: 95.7031
Epoch: 272 train_loss: 0.1675 train_acc: 96.2891
Epoch: 273 train_loss: 0.1739 train_acc: 94.9219
Epoch: 274 train_loss: 0.1816 train_acc: 96.0938
Epoch: 275 train_loss: 0.1879 train_acc: 95.1172
Epoch: 276 train_loss: 0.1956 train_acc: 95.1172
Epoch: 277 train_loss: 0.1834 train_acc: 96.0938
Epoch: 278 train_loss: 0.1534 train_acc: 96.4844
Epoch: 279 train_loss: 0.1831 train_acc: 95.3125
Epoch: 280 train_loss: 0.1553 train_acc: 97.0703
Epoch: 281 train_loss: 0.1546 train_acc: 95.8984
Epoch: 282 train_loss: 0.1577 train_acc: 96.0938
Epoch: 283 train_loss: 0.1252 train_acc: 98.4375
Epoch: 284 train_loss: 0.1451 train_acc: 96.0938
Epoch: 285 train_loss: 0.1334 train_acc: 97.2656
Epoch: 286 train_loss: 0.1538 train_acc: 97.0703
Epoch: 287 train_loss: 0.1496 train_acc: 96.2891
Epoch: 288 train_loss: 0.1600 train_acc: 95.7031
Epoch: 289 train_loss: 0.1524 train_acc: 95.7031
Epoch: 290 train_loss: 0.1401 train_acc: 97.4609
Epoch: 291 train_loss: 0.1807 train_acc: 94.1406
Epoch: 292 train_loss: 0.1625 train_acc: 95.7031
Epoch: 293 train_loss: 0.1638 train_acc: 96.4844
Epoch: 294 train_loss: 0.1692 train_acc: 95.7031
Epoch: 295 train_loss: 0.1510 train_acc: 96.6797
Epoch: 296 train_loss: 0.1796 train_acc: 94.3359
Epoch: 297 train_loss: 0.1510 train_acc: 96.8750
Epoch: 298 train_loss: 0.1423 train_acc: 97.2656
Epoch: 299 train_loss: 0.1909 train_acc: 94.3359
Epoch: 300 train_loss: 0.1273 train_acc: 98.0469
Running Time: 168.70
**************************************************
Final result:
OA: 0.7668 | AA: 0.6430 | Kappa: 0.7359
[0.09090909 0.6779661  0.76269036 0.65777778 0.83224401 0.87463977
 0.14814815 0.92951542 0.         0.83315276 0.75600343 0.59325044
 0.95384615 0.89267887 0.5013624  0.78409091]
**************************************************
Parameter:
dataset: Indian
flag_test: train
mode: CAF
gpu_id: 0
seed: 11
batch_size: 64
test_freq: 5
patches: 7
band_patches: 3
epoches: 300
learning_rate: 0.0005
gamma: 0.9
weight_decay: 0.005
height=145,width=145,band=200
**************************************************
patch is : 7
mirror_image shape : [151,151,200]
**************************************************
x_train shape = (512, 7, 7, 200), type = float64
x_test  shape = (9737, 7, 7, 200), type = float64
x_true  shape = (21025, 7, 7, 200), type = float64
**************************************************
x_train_band shape = (512, 147, 200), type = float64
x_test_band  shape = (9737, 147, 200), type = float64
x_true_band  shape = (21025, 147, 200), type = float64
**************************************************
y_train: shape = (512,) ,type = int64
y_test: shape = (9737,) ,type = int64
y_true: shape = (21025,) ,type = int64
**************************************************
start training
Epoch: 001 train_loss: 2.4709 train_acc: 18.1641
Epoch: 002 train_loss: 2.2523 train_acc: 32.8125
Epoch: 003 train_loss: 2.0349 train_acc: 35.7422
Epoch: 004 train_loss: 1.8720 train_acc: 36.3281
Epoch: 005 train_loss: 1.8004 train_acc: 39.2578
Epoch: 006 train_loss: 1.7471 train_acc: 40.2344
Epoch: 007 train_loss: 1.7052 train_acc: 41.0156
Epoch: 008 train_loss: 1.6631 train_acc: 42.5781
Epoch: 009 train_loss: 1.6529 train_acc: 42.9688
Epoch: 010 train_loss: 1.6162 train_acc: 44.1406
Epoch: 011 train_loss: 1.5921 train_acc: 43.5547
Epoch: 012 train_loss: 1.5797 train_acc: 43.5547
Epoch: 013 train_loss: 1.5440 train_acc: 44.5312
Epoch: 014 train_loss: 1.5074 train_acc: 47.2656
Epoch: 015 train_loss: 1.4870 train_acc: 45.3125
Epoch: 016 train_loss: 1.4537 train_acc: 48.0469
Epoch: 017 train_loss: 1.4239 train_acc: 47.2656
Epoch: 018 train_loss: 1.4131 train_acc: 47.8516
Epoch: 019 train_loss: 1.4073 train_acc: 48.8281
Epoch: 020 train_loss: 1.3825 train_acc: 49.8047
Epoch: 021 train_loss: 1.3650 train_acc: 49.2188
Epoch: 022 train_loss: 1.3587 train_acc: 48.4375
Epoch: 023 train_loss: 1.3788 train_acc: 48.6328
Epoch: 024 train_loss: 1.3339 train_acc: 49.6094
Epoch: 025 train_loss: 1.3450 train_acc: 49.6094
Epoch: 026 train_loss: 1.3360 train_acc: 50.3906
Epoch: 027 train_loss: 1.3174 train_acc: 51.9531
Epoch: 028 train_loss: 1.2981 train_acc: 52.1484
Epoch: 029 train_loss: 1.3011 train_acc: 54.1016
Epoch: 030 train_loss: 1.2709 train_acc: 53.3203
Epoch: 031 train_loss: 1.2709 train_acc: 51.7578
Epoch: 032 train_loss: 1.2582 train_acc: 52.3438
Epoch: 033 train_loss: 1.2582 train_acc: 53.7109
Epoch: 034 train_loss: 1.2624 train_acc: 53.9062
Epoch: 035 train_loss: 1.2454 train_acc: 51.7578
Epoch: 036 train_loss: 1.2250 train_acc: 54.1016
Epoch: 037 train_loss: 1.2327 train_acc: 54.8828
Epoch: 038 train_loss: 1.2217 train_acc: 54.4922
Epoch: 039 train_loss: 1.2201 train_acc: 54.2969
Epoch: 040 train_loss: 1.2237 train_acc: 52.9297
Epoch: 041 train_loss: 1.2072 train_acc: 57.2266
Epoch: 042 train_loss: 1.2093 train_acc: 53.1250
Epoch: 043 train_loss: 1.2222 train_acc: 54.8828
Epoch: 044 train_loss: 1.2042 train_acc: 53.3203
Epoch: 045 train_loss: 1.1744 train_acc: 58.2031
Epoch: 046 train_loss: 1.1872 train_acc: 54.8828
Epoch: 047 train_loss: 1.1604 train_acc: 56.6406
Epoch: 048 train_loss: 1.1471 train_acc: 57.8125
Epoch: 049 train_loss: 1.1432 train_acc: 58.2031
Epoch: 050 train_loss: 1.1314 train_acc: 58.0078
Epoch: 051 train_loss: 1.1083 train_acc: 58.3984
Epoch: 052 train_loss: 1.0949 train_acc: 60.1562
Epoch: 053 train_loss: 1.1029 train_acc: 58.3984
Epoch: 054 train_loss: 1.1193 train_acc: 57.0312
Epoch: 055 train_loss: 1.1313 train_acc: 58.5938
Epoch: 056 train_loss: 1.1246 train_acc: 57.6172
Epoch: 057 train_loss: 1.0963 train_acc: 58.2031
Epoch: 058 train_loss: 1.1377 train_acc: 58.2031
Epoch: 059 train_loss: 1.1050 train_acc: 59.7656
Epoch: 060 train_loss: 1.0956 train_acc: 57.8125
Epoch: 061 train_loss: 1.0695 train_acc: 60.1562
Epoch: 062 train_loss: 1.0856 train_acc: 58.3984
Epoch: 063 train_loss: 1.0546 train_acc: 60.7422
Epoch: 064 train_loss: 1.0651 train_acc: 61.3281
Epoch: 065 train_loss: 1.0595 train_acc: 58.7891
Epoch: 066 train_loss: 1.0522 train_acc: 61.1328
Epoch: 067 train_loss: 1.0392 train_acc: 59.5703
Epoch: 068 train_loss: 1.0395 train_acc: 60.1562
Epoch: 069 train_loss: 1.0110 train_acc: 62.1094
Epoch: 070 train_loss: 1.0163 train_acc: 61.9141
Epoch: 071 train_loss: 1.0593 train_acc: 62.1094
Epoch: 072 train_loss: 1.0809 train_acc: 60.3516
Epoch: 073 train_loss: 1.0964 train_acc: 57.0312
Epoch: 074 train_loss: 1.0263 train_acc: 60.3516
Epoch: 075 train_loss: 1.0193 train_acc: 61.1328
Epoch: 076 train_loss: 1.0257 train_acc: 60.3516
Epoch: 077 train_loss: 1.0286 train_acc: 61.1328
Epoch: 078 train_loss: 0.9801 train_acc: 62.3047
Epoch: 079 train_loss: 1.0209 train_acc: 61.5234
Epoch: 080 train_loss: 1.0394 train_acc: 59.3750
Epoch: 081 train_loss: 1.0071 train_acc: 61.9141
Epoch: 082 train_loss: 0.9588 train_acc: 63.2812
Epoch: 083 train_loss: 0.9671 train_acc: 63.0859
Epoch: 084 train_loss: 0.9811 train_acc: 64.2578
Epoch: 085 train_loss: 0.9994 train_acc: 64.0625
Epoch: 086 train_loss: 0.9715 train_acc: 61.3281
Epoch: 087 train_loss: 0.9669 train_acc: 61.9141
Epoch: 088 train_loss: 0.9750 train_acc: 62.1094
Epoch: 089 train_loss: 0.9948 train_acc: 62.8906
Epoch: 090 train_loss: 0.9519 train_acc: 64.2578
Epoch: 091 train_loss: 0.9298 train_acc: 64.4531
Epoch: 092 train_loss: 0.9473 train_acc: 63.2812
Epoch: 093 train_loss: 0.9061 train_acc: 65.6250
Epoch: 094 train_loss: 0.9049 train_acc: 64.4531
Epoch: 095 train_loss: 0.8945 train_acc: 66.0156
Epoch: 096 train_loss: 0.8956 train_acc: 65.4297
Epoch: 097 train_loss: 0.8844 train_acc: 66.9922
Epoch: 098 train_loss: 0.9020 train_acc: 66.4062
Epoch: 099 train_loss: 0.8939 train_acc: 65.0391
Epoch: 100 train_loss: 0.9143 train_acc: 64.4531
Epoch: 101 train_loss: 0.8967 train_acc: 64.6484
Epoch: 102 train_loss: 0.8796 train_acc: 65.6250
Epoch: 103 train_loss: 0.9067 train_acc: 63.4766
Epoch: 104 train_loss: 0.9164 train_acc: 63.8672
Epoch: 105 train_loss: 0.8667 train_acc: 67.3828
Epoch: 106 train_loss: 0.8694 train_acc: 65.6250
Epoch: 107 train_loss: 0.8372 train_acc: 67.9688
Epoch: 108 train_loss: 0.8352 train_acc: 67.5781
Epoch: 109 train_loss: 0.8399 train_acc: 67.9688
Epoch: 110 train_loss: 0.8470 train_acc: 69.7266
Epoch: 111 train_loss: 0.8558 train_acc: 68.9453
Epoch: 112 train_loss: 0.8412 train_acc: 66.6016
Epoch: 113 train_loss: 0.8276 train_acc: 66.7969
Epoch: 114 train_loss: 0.8182 train_acc: 66.7969
Epoch: 115 train_loss: 0.8277 train_acc: 68.9453
Epoch: 116 train_loss: 0.8062 train_acc: 69.7266
Epoch: 117 train_loss: 0.8622 train_acc: 66.4062
Epoch: 118 train_loss: 0.8064 train_acc: 70.1172
Epoch: 119 train_loss: 0.7780 train_acc: 70.1172
Epoch: 120 train_loss: 0.7657 train_acc: 69.7266
Epoch: 121 train_loss: 0.7813 train_acc: 69.7266
Epoch: 122 train_loss: 0.7860 train_acc: 69.9219
Epoch: 123 train_loss: 0.7737 train_acc: 68.9453
Epoch: 124 train_loss: 0.7978 train_acc: 68.3594
Epoch: 125 train_loss: 0.7763 train_acc: 70.7031
Epoch: 126 train_loss: 0.7654 train_acc: 70.7031
Epoch: 127 train_loss: 0.7735 train_acc: 71.0938
Epoch: 128 train_loss: 0.7341 train_acc: 72.0703
Epoch: 129 train_loss: 0.7324 train_acc: 70.5078
Epoch: 130 train_loss: 0.7041 train_acc: 72.8516
Epoch: 131 train_loss: 0.6849 train_acc: 71.4844
Epoch: 132 train_loss: 0.7127 train_acc: 73.6328
Epoch: 133 train_loss: 0.6765 train_acc: 72.0703
Epoch: 134 train_loss: 0.6925 train_acc: 72.2656
Epoch: 135 train_loss: 0.6874 train_acc: 74.2188
Epoch: 136 train_loss: 0.6696 train_acc: 74.8047
Epoch: 137 train_loss: 0.6865 train_acc: 72.8516
Epoch: 138 train_loss: 0.6925 train_acc: 74.0234
Epoch: 139 train_loss: 0.7462 train_acc: 70.5078
Epoch: 140 train_loss: 0.6576 train_acc: 76.9531
Epoch: 141 train_loss: 0.7192 train_acc: 72.2656
Epoch: 142 train_loss: 0.6981 train_acc: 72.0703
Epoch: 143 train_loss: 0.7014 train_acc: 73.2422
Epoch: 144 train_loss: 0.6913 train_acc: 73.0469
Epoch: 145 train_loss: 0.6670 train_acc: 73.4375
Epoch: 146 train_loss: 0.6328 train_acc: 75.3906
Epoch: 147 train_loss: 0.6216 train_acc: 76.1719
Epoch: 148 train_loss: 0.6165 train_acc: 75.5859
Epoch: 149 train_loss: 0.6082 train_acc: 79.6875
Epoch: 150 train_loss: 0.6338 train_acc: 75.9766
Epoch: 151 train_loss: 0.6585 train_acc: 72.6562
Epoch: 152 train_loss: 0.6292 train_acc: 76.1719
Epoch: 153 train_loss: 0.6201 train_acc: 77.3438
Epoch: 154 train_loss: 0.6045 train_acc: 75.7812
Epoch: 155 train_loss: 0.6148 train_acc: 75.7812
Epoch: 156 train_loss: 0.6261 train_acc: 75.1953
Epoch: 157 train_loss: 0.5579 train_acc: 79.2969
Epoch: 158 train_loss: 0.5766 train_acc: 78.5156
Epoch: 159 train_loss: 0.5706 train_acc: 78.3203
Epoch: 160 train_loss: 0.6190 train_acc: 76.9531
Epoch: 161 train_loss: 0.6370 train_acc: 74.8047
Epoch: 162 train_loss: 0.6185 train_acc: 76.7578
Epoch: 163 train_loss: 0.6391 train_acc: 75.1953
Epoch: 164 train_loss: 0.5816 train_acc: 79.2969
Epoch: 165 train_loss: 0.5637 train_acc: 77.7344
Epoch: 166 train_loss: 0.5437 train_acc: 78.9062
Epoch: 167 train_loss: 0.5615 train_acc: 80.0781
Epoch: 168 train_loss: 0.5686 train_acc: 78.7109
Epoch: 169 train_loss: 0.5735 train_acc: 79.4922
Epoch: 170 train_loss: 0.5538 train_acc: 80.6641
Epoch: 171 train_loss: 0.5147 train_acc: 82.2266
Epoch: 172 train_loss: 0.5628 train_acc: 78.5156
Epoch: 173 train_loss: 0.5402 train_acc: 81.0547
Epoch: 174 train_loss: 0.4893 train_acc: 83.5938
Epoch: 175 train_loss: 0.4978 train_acc: 83.3984
Epoch: 176 train_loss: 0.5039 train_acc: 81.4453
Epoch: 177 train_loss: 0.5907 train_acc: 76.7578
Epoch: 178 train_loss: 0.5199 train_acc: 82.6172
Epoch: 179 train_loss: 0.4691 train_acc: 84.1797
Epoch: 180 train_loss: 0.4891 train_acc: 82.6172
Epoch: 181 train_loss: 0.4894 train_acc: 83.3984
Epoch: 182 train_loss: 0.4722 train_acc: 84.9609
Epoch: 183 train_loss: 0.4505 train_acc: 85.1562
Epoch: 184 train_loss: 0.4578 train_acc: 84.5703
Epoch: 185 train_loss: 0.4389 train_acc: 84.9609
Epoch: 186 train_loss: 0.4366 train_acc: 85.5469
Epoch: 187 train_loss: 0.4342 train_acc: 85.9375
Epoch: 188 train_loss: 0.4459 train_acc: 85.5469
Epoch: 189 train_loss: 0.4514 train_acc: 85.7422
Epoch: 190 train_loss: 0.4890 train_acc: 84.5703
Epoch: 191 train_loss: 0.4405 train_acc: 85.3516
Epoch: 192 train_loss: 0.4303 train_acc: 85.7422
Epoch: 193 train_loss: 0.4684 train_acc: 85.3516
Epoch: 194 train_loss: 0.5078 train_acc: 82.4219
Epoch: 195 train_loss: 0.4722 train_acc: 84.7656
Epoch: 196 train_loss: 0.4623 train_acc: 85.1562
Epoch: 197 train_loss: 0.4163 train_acc: 87.3047
Epoch: 198 train_loss: 0.4026 train_acc: 88.6719
Epoch: 199 train_loss: 0.3855 train_acc: 88.4766
Epoch: 200 train_loss: 0.3922 train_acc: 88.0859
Epoch: 201 train_loss: 0.3916 train_acc: 88.2812
Epoch: 202 train_loss: 0.4166 train_acc: 86.9141
Epoch: 203 train_loss: 0.3895 train_acc: 86.7188
Epoch: 204 train_loss: 0.3728 train_acc: 87.5000
Epoch: 205 train_loss: 0.4199 train_acc: 86.3281
Epoch: 206 train_loss: 0.4830 train_acc: 84.9609
Epoch: 207 train_loss: 0.4270 train_acc: 86.1328
Epoch: 208 train_loss: 0.3793 train_acc: 87.3047
Epoch: 209 train_loss: 0.4028 train_acc: 86.3281
Epoch: 210 train_loss: 0.3993 train_acc: 87.3047
Epoch: 211 train_loss: 0.3796 train_acc: 88.6719
Epoch: 212 train_loss: 0.4027 train_acc: 86.9141
Epoch: 213 train_loss: 0.3952 train_acc: 87.8906
Epoch: 214 train_loss: 0.3938 train_acc: 87.1094
Epoch: 215 train_loss: 0.3999 train_acc: 86.7188
Epoch: 216 train_loss: 0.3602 train_acc: 90.2344
Epoch: 217 train_loss: 0.3550 train_acc: 89.0625
Epoch: 218 train_loss: 0.3418 train_acc: 91.0156
Epoch: 219 train_loss: 0.3339 train_acc: 89.8438
Epoch: 220 train_loss: 0.3788 train_acc: 86.5234
Epoch: 221 train_loss: 0.3689 train_acc: 88.0859
Epoch: 222 train_loss: 0.3260 train_acc: 90.4297
Epoch: 223 train_loss: 0.3307 train_acc: 90.4297
Epoch: 224 train_loss: 0.3379 train_acc: 89.6484
Epoch: 225 train_loss: 0.3524 train_acc: 87.3047
Epoch: 226 train_loss: 0.3252 train_acc: 91.0156
Epoch: 227 train_loss: 0.3248 train_acc: 90.2344
Epoch: 228 train_loss: 0.3749 train_acc: 88.2812
Epoch: 229 train_loss: 0.3555 train_acc: 88.6719
Epoch: 230 train_loss: 0.3291 train_acc: 89.2578
Epoch: 231 train_loss: 0.3388 train_acc: 90.0391
Epoch: 232 train_loss: 0.3194 train_acc: 90.2344
Epoch: 233 train_loss: 0.2648 train_acc: 92.9688
Epoch: 234 train_loss: 0.2762 train_acc: 93.3594
Epoch: 235 train_loss: 0.3265 train_acc: 91.0156
/home/amax/anaconda3/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
Epoch: 236 train_loss: 0.3248 train_acc: 89.6484
Epoch: 237 train_loss: 0.3401 train_acc: 88.2812
Epoch: 238 train_loss: 0.3770 train_acc: 87.3047
Epoch: 239 train_loss: 0.2767 train_acc: 92.9688
Epoch: 240 train_loss: 0.2802 train_acc: 93.5547
Epoch: 241 train_loss: 0.2662 train_acc: 92.7734
Epoch: 242 train_loss: 0.3017 train_acc: 91.7969
Epoch: 243 train_loss: 0.3318 train_acc: 89.8438
Epoch: 244 train_loss: 0.2530 train_acc: 94.3359
Epoch: 245 train_loss: 0.2797 train_acc: 92.1875
Epoch: 246 train_loss: 0.2946 train_acc: 91.6016
Epoch: 247 train_loss: 0.2722 train_acc: 91.6016
Epoch: 248 train_loss: 0.2813 train_acc: 92.3828
Epoch: 249 train_loss: 0.2667 train_acc: 93.1641
Epoch: 250 train_loss: 0.2581 train_acc: 93.7500
Epoch: 251 train_loss: 0.2656 train_acc: 92.3828
Epoch: 252 train_loss: 0.2333 train_acc: 93.7500
Epoch: 253 train_loss: 0.2264 train_acc: 93.1641
Epoch: 254 train_loss: 0.2549 train_acc: 92.9688
Epoch: 255 train_loss: 0.2280 train_acc: 94.7266
Epoch: 256 train_loss: 0.2653 train_acc: 92.1875
Epoch: 257 train_loss: 0.2541 train_acc: 92.1875
Epoch: 258 train_loss: 0.2492 train_acc: 92.9688
Epoch: 259 train_loss: 0.2397 train_acc: 92.9688
Epoch: 260 train_loss: 0.2798 train_acc: 91.7969
Epoch: 261 train_loss: 0.2397 train_acc: 93.9453
Epoch: 262 train_loss: 0.2201 train_acc: 94.5312
Epoch: 263 train_loss: 0.2355 train_acc: 92.5781
Epoch: 264 train_loss: 0.2475 train_acc: 93.3594
Epoch: 265 train_loss: 0.2541 train_acc: 92.1875
Epoch: 266 train_loss: 0.2389 train_acc: 92.9688
Epoch: 267 train_loss: 0.2086 train_acc: 93.9453
Epoch: 268 train_loss: 0.2074 train_acc: 94.1406
Epoch: 269 train_loss: 0.2368 train_acc: 93.1641
Epoch: 270 train_loss: 0.2172 train_acc: 94.5312
Epoch: 271 train_loss: 0.2415 train_acc: 93.5547
Epoch: 272 train_loss: 0.2043 train_acc: 94.7266
Epoch: 273 train_loss: 0.2015 train_acc: 95.1172
Epoch: 274 train_loss: 0.2080 train_acc: 95.1172
Epoch: 275 train_loss: 0.2210 train_acc: 93.5547
Epoch: 276 train_loss: 0.2380 train_acc: 92.5781
Epoch: 277 train_loss: 0.2251 train_acc: 93.9453
Epoch: 278 train_loss: 0.1988 train_acc: 94.5312
Epoch: 279 train_loss: 0.1778 train_acc: 95.8984
Epoch: 280 train_loss: 0.1992 train_acc: 95.1172
Epoch: 281 train_loss: 0.2155 train_acc: 95.1172
Epoch: 282 train_loss: 0.2219 train_acc: 92.9688
Epoch: 283 train_loss: 0.2323 train_acc: 91.7969
Epoch: 284 train_loss: 0.2581 train_acc: 90.4297
Epoch: 285 train_loss: 0.2305 train_acc: 93.9453
Epoch: 286 train_loss: 0.2133 train_acc: 94.7266
Epoch: 287 train_loss: 0.2294 train_acc: 93.3594
Epoch: 288 train_loss: 0.2248 train_acc: 94.7266
Epoch: 289 train_loss: 0.1708 train_acc: 96.2891
Epoch: 290 train_loss: 0.2004 train_acc: 94.9219
Epoch: 291 train_loss: 0.1945 train_acc: 94.9219
Epoch: 292 train_loss: 0.1844 train_acc: 95.7031
Epoch: 293 train_loss: 0.1845 train_acc: 95.5078
Epoch: 294 train_loss: 0.1748 train_acc: 96.0938
Epoch: 295 train_loss: 0.1838 train_acc: 95.5078
Epoch: 296 train_loss: 0.2038 train_acc: 94.1406
Epoch: 297 train_loss: 0.1628 train_acc: 96.4844
Epoch: 298 train_loss: 0.1671 train_acc: 96.0938
Epoch: 299 train_loss: 0.1971 train_acc: 93.9453
Epoch: 300 train_loss: 0.1866 train_acc: 95.1172
Running Time: 168.89
**************************************************
Final result:
OA: 0.7109 | AA: 0.5794 | Kappa: 0.6720
[0.11363636 0.36624908 0.75380711 0.58666667 0.73202614 0.82276657
 0.         0.93171806 0.05263158 0.81798483 0.76586621 0.49023091
 0.86666667 0.95757072 0.49046322 0.52272727]
**************************************************
Parameter:
dataset: Indian
flag_test: train
mode: CAF
gpu_id: 0
seed: 12
batch_size: 64
test_freq: 5
patches: 7
band_patches: 3
epoches: 300
learning_rate: 0.0005
gamma: 0.9
weight_decay: 0.005
height=145,width=145,band=200
**************************************************
patch is : 7
mirror_image shape : [151,151,200]
**************************************************
x_train shape = (512, 7, 7, 200), type = float64
x_test  shape = (9737, 7, 7, 200), type = float64
x_true  shape = (21025, 7, 7, 200), type = float64
**************************************************
x_train_band shape = (512, 147, 200), type = float64
x_test_band  shape = (9737, 147, 200), type = float64
x_true_band  shape = (21025, 147, 200), type = float64
**************************************************
y_train: shape = (512,) ,type = int64
y_test: shape = (9737,) ,type = int64
y_true: shape = (21025,) ,type = int64
**************************************************
start training
Epoch: 001 train_loss: 2.5877 train_acc: 19.7266
Epoch: 002 train_loss: 2.3847 train_acc: 18.7500
Epoch: 003 train_loss: 2.3271 train_acc: 24.0234
Epoch: 004 train_loss: 2.3012 train_acc: 24.0234
Epoch: 005 train_loss: 2.2739 train_acc: 24.0234
Epoch: 006 train_loss: 2.2310 train_acc: 28.1250
Epoch: 007 train_loss: 2.1042 train_acc: 35.7422
Epoch: 008 train_loss: 1.9486 train_acc: 36.3281
Epoch: 009 train_loss: 1.8450 train_acc: 36.7188
Epoch: 010 train_loss: 1.7683 train_acc: 38.6719
Epoch: 011 train_loss: 1.6990 train_acc: 42.3828
Epoch: 012 train_loss: 1.6907 train_acc: 40.8203
Epoch: 013 train_loss: 1.6654 train_acc: 40.6250
Epoch: 014 train_loss: 1.6574 train_acc: 39.8438
Epoch: 015 train_loss: 1.6287 train_acc: 43.3594
Epoch: 016 train_loss: 1.6099 train_acc: 41.2109
Epoch: 017 train_loss: 1.5702 train_acc: 45.5078
Epoch: 018 train_loss: 1.5384 train_acc: 44.5312
Epoch: 019 train_loss: 1.5157 train_acc: 45.7031
Epoch: 020 train_loss: 1.4959 train_acc: 47.0703
Epoch: 021 train_loss: 1.5072 train_acc: 45.3125
Epoch: 022 train_loss: 1.4764 train_acc: 48.4375
Epoch: 023 train_loss: 1.4385 train_acc: 46.8750
Epoch: 024 train_loss: 1.4268 train_acc: 48.8281
Epoch: 025 train_loss: 1.4031 train_acc: 49.6094
Epoch: 026 train_loss: 1.3899 train_acc: 48.4375
Epoch: 027 train_loss: 1.3675 train_acc: 50.1953
Epoch: 028 train_loss: 1.3564 train_acc: 50.5859
Epoch: 029 train_loss: 1.3527 train_acc: 50.1953
Epoch: 030 train_loss: 1.3254 train_acc: 51.3672
Epoch: 031 train_loss: 1.3075 train_acc: 52.1484
Epoch: 032 train_loss: 1.3179 train_acc: 52.1484
Epoch: 033 train_loss: 1.2935 train_acc: 51.7578
Epoch: 034 train_loss: 1.3103 train_acc: 52.3438
Epoch: 035 train_loss: 1.2716 train_acc: 53.7109
Epoch: 036 train_loss: 1.2585 train_acc: 53.3203
Epoch: 037 train_loss: 1.2810 train_acc: 54.2969
Epoch: 038 train_loss: 1.2472 train_acc: 54.4922
Epoch: 039 train_loss: 1.2275 train_acc: 55.8594
Epoch: 040 train_loss: 1.2151 train_acc: 56.2500
Epoch: 041 train_loss: 1.2086 train_acc: 56.2500
Epoch: 042 train_loss: 1.2197 train_acc: 55.0781
Epoch: 043 train_loss: 1.2002 train_acc: 55.2734
Epoch: 044 train_loss: 1.1954 train_acc: 58.0078
Epoch: 045 train_loss: 1.2098 train_acc: 56.4453
Epoch: 046 train_loss: 1.1918 train_acc: 54.8828
Epoch: 047 train_loss: 1.1884 train_acc: 55.6641
Epoch: 048 train_loss: 1.1363 train_acc: 58.9844
Epoch: 049 train_loss: 1.1413 train_acc: 57.6172
Epoch: 050 train_loss: 1.1476 train_acc: 55.8594
Epoch: 051 train_loss: 1.0983 train_acc: 59.1797
Epoch: 052 train_loss: 1.0855 train_acc: 60.5469
Epoch: 053 train_loss: 1.0818 train_acc: 59.7656
Epoch: 054 train_loss: 1.0692 train_acc: 61.5234
Epoch: 055 train_loss: 1.1041 train_acc: 57.8125
Epoch: 056 train_loss: 1.1053 train_acc: 57.2266
Epoch: 057 train_loss: 1.1513 train_acc: 57.4219
Epoch: 058 train_loss: 1.1179 train_acc: 57.8125
Epoch: 059 train_loss: 1.0255 train_acc: 62.8906
Epoch: 060 train_loss: 1.0201 train_acc: 63.8672
Epoch: 061 train_loss: 1.0134 train_acc: 62.1094
Epoch: 062 train_loss: 1.0383 train_acc: 62.3047
Epoch: 063 train_loss: 1.0420 train_acc: 60.5469
Epoch: 064 train_loss: 1.0118 train_acc: 63.6719
Epoch: 065 train_loss: 1.0130 train_acc: 63.4766
Epoch: 066 train_loss: 0.9843 train_acc: 60.7422
Epoch: 067 train_loss: 0.9842 train_acc: 64.4531
Epoch: 068 train_loss: 0.9624 train_acc: 63.6719
Epoch: 069 train_loss: 0.9862 train_acc: 63.8672
Epoch: 070 train_loss: 0.9682 train_acc: 63.6719
Epoch: 071 train_loss: 0.9130 train_acc: 68.7500
Epoch: 072 train_loss: 0.9169 train_acc: 65.2344
Epoch: 073 train_loss: 0.9381 train_acc: 65.4297
Epoch: 074 train_loss: 0.9126 train_acc: 64.4531
Epoch: 075 train_loss: 0.9332 train_acc: 65.4297
Epoch: 076 train_loss: 0.9114 train_acc: 66.4062
Epoch: 077 train_loss: 0.9219 train_acc: 64.8438
Epoch: 078 train_loss: 0.9447 train_acc: 63.4766
Epoch: 079 train_loss: 0.9084 train_acc: 66.2109
Epoch: 080 train_loss: 0.9216 train_acc: 66.2109
Epoch: 081 train_loss: 0.9108 train_acc: 66.2109
Epoch: 082 train_loss: 0.9119 train_acc: 64.0625
Epoch: 083 train_loss: 0.8166 train_acc: 71.6797
Epoch: 084 train_loss: 0.8915 train_acc: 68.3594
Epoch: 085 train_loss: 0.8298 train_acc: 67.9688
Epoch: 086 train_loss: 0.8112 train_acc: 69.9219
Epoch: 087 train_loss: 0.7941 train_acc: 71.6797
Epoch: 088 train_loss: 0.8596 train_acc: 67.3828
Epoch: 089 train_loss: 0.8783 train_acc: 66.9922
Epoch: 090 train_loss: 0.8818 train_acc: 67.1875
Epoch: 091 train_loss: 0.8509 train_acc: 68.7500
Epoch: 092 train_loss: 0.8732 train_acc: 68.9453
Epoch: 093 train_loss: 0.8407 train_acc: 71.2891
Epoch: 094 train_loss: 0.7869 train_acc: 73.0469
Epoch: 095 train_loss: 0.7590 train_acc: 72.8516
Epoch: 096 train_loss: 0.7527 train_acc: 74.6094
Epoch: 097 train_loss: 0.7127 train_acc: 75.1953
Epoch: 098 train_loss: 0.7290 train_acc: 74.0234
Epoch: 099 train_loss: 0.7425 train_acc: 74.2188
Epoch: 100 train_loss: 0.7541 train_acc: 73.8281
Epoch: 101 train_loss: 0.7603 train_acc: 72.8516
Epoch: 102 train_loss: 0.6783 train_acc: 75.3906
Epoch: 103 train_loss: 0.6674 train_acc: 75.9766
Epoch: 104 train_loss: 0.7313 train_acc: 74.0234
Epoch: 105 train_loss: 0.6855 train_acc: 74.4141
Epoch: 106 train_loss: 0.6821 train_acc: 75.3906
Epoch: 107 train_loss: 0.7029 train_acc: 74.0234
Epoch: 108 train_loss: 0.7320 train_acc: 73.2422
Epoch: 109 train_loss: 0.7016 train_acc: 74.4141
Epoch: 110 train_loss: 0.6981 train_acc: 76.5625
Epoch: 111 train_loss: 0.6687 train_acc: 76.9531
Epoch: 112 train_loss: 0.7049 train_acc: 74.2188
Epoch: 113 train_loss: 0.6684 train_acc: 76.7578
Epoch: 114 train_loss: 0.6372 train_acc: 76.9531
Epoch: 115 train_loss: 0.7638 train_acc: 72.8516
Epoch: 116 train_loss: 0.7177 train_acc: 74.8047
Epoch: 117 train_loss: 0.6303 train_acc: 77.9297
Epoch: 118 train_loss: 0.6510 train_acc: 76.5625
Epoch: 119 train_loss: 0.6285 train_acc: 78.5156
Epoch: 120 train_loss: 0.6441 train_acc: 76.7578
Epoch: 121 train_loss: 0.6179 train_acc: 79.8828
Epoch: 122 train_loss: 0.6047 train_acc: 78.9062
Epoch: 123 train_loss: 0.5914 train_acc: 80.2734
Epoch: 124 train_loss: 0.5915 train_acc: 79.2969
Epoch: 125 train_loss: 0.6111 train_acc: 79.6875
Epoch: 126 train_loss: 0.5780 train_acc: 81.2500
Epoch: 127 train_loss: 0.5605 train_acc: 81.2500
Epoch: 128 train_loss: 0.5408 train_acc: 80.8594
Epoch: 129 train_loss: 0.5161 train_acc: 82.6172
Epoch: 130 train_loss: 0.5372 train_acc: 81.6406
Epoch: 131 train_loss: 0.5646 train_acc: 80.2734
Epoch: 132 train_loss: 0.5461 train_acc: 82.2266
Epoch: 133 train_loss: 0.5539 train_acc: 80.6641
Epoch: 134 train_loss: 0.5964 train_acc: 79.2969
Epoch: 135 train_loss: 0.5675 train_acc: 80.6641
Epoch: 136 train_loss: 0.5974 train_acc: 80.8594
Epoch: 137 train_loss: 0.6028 train_acc: 80.2734
Epoch: 138 train_loss: 0.5859 train_acc: 80.8594
Epoch: 139 train_loss: 0.5701 train_acc: 80.4688
Epoch: 140 train_loss: 0.5576 train_acc: 80.2734
Epoch: 141 train_loss: 0.5297 train_acc: 83.3984
Epoch: 142 train_loss: 0.5349 train_acc: 81.8359
Epoch: 143 train_loss: 0.5401 train_acc: 83.3984
Epoch: 144 train_loss: 0.4992 train_acc: 84.1797
Epoch: 145 train_loss: 0.5234 train_acc: 83.0078
Epoch: 146 train_loss: 0.4879 train_acc: 83.3984
Epoch: 147 train_loss: 0.5160 train_acc: 82.6172
Epoch: 148 train_loss: 0.4929 train_acc: 83.2031
Epoch: 149 train_loss: 0.5065 train_acc: 82.2266
Epoch: 150 train_loss: 0.5455 train_acc: 81.4453
Epoch: 151 train_loss: 0.5088 train_acc: 82.4219
Epoch: 152 train_loss: 0.4696 train_acc: 83.3984
Epoch: 153 train_loss: 0.5165 train_acc: 83.2031
Epoch: 154 train_loss: 0.5030 train_acc: 84.3750
Epoch: 155 train_loss: 0.4734 train_acc: 83.7891
Epoch: 156 train_loss: 0.4636 train_acc: 84.1797
Epoch: 157 train_loss: 0.4947 train_acc: 83.3984
Epoch: 158 train_loss: 0.5398 train_acc: 81.2500
Epoch: 159 train_loss: 0.4293 train_acc: 85.7422
Epoch: 160 train_loss: 0.4203 train_acc: 85.7422
Epoch: 161 train_loss: 0.4354 train_acc: 84.3750
Epoch: 162 train_loss: 0.4006 train_acc: 88.2812
Epoch: 163 train_loss: 0.4364 train_acc: 84.3750
Epoch: 164 train_loss: 0.3844 train_acc: 87.5000
Epoch: 165 train_loss: 0.3966 train_acc: 88.4766
Epoch: 166 train_loss: 0.4052 train_acc: 87.5000
Epoch: 167 train_loss: 0.4193 train_acc: 86.7188
Epoch: 168 train_loss: 0.4458 train_acc: 85.3516
Epoch: 169 train_loss: 0.4223 train_acc: 85.5469
Epoch: 170 train_loss: 0.3689 train_acc: 87.6953
Epoch: 171 train_loss: 0.4118 train_acc: 87.8906
Epoch: 172 train_loss: 0.3818 train_acc: 88.8672
Epoch: 173 train_loss: 0.3958 train_acc: 86.1328
Epoch: 174 train_loss: 0.3895 train_acc: 87.1094
Epoch: 175 train_loss: 0.3490 train_acc: 88.6719
Epoch: 176 train_loss: 0.3850 train_acc: 88.2812
Epoch: 177 train_loss: 0.3975 train_acc: 86.5234
Epoch: 178 train_loss: 0.3717 train_acc: 88.6719
Epoch: 179 train_loss: 0.3597 train_acc: 89.2578
Epoch: 180 train_loss: 0.3515 train_acc: 89.4531
Epoch: 181 train_loss: 0.3763 train_acc: 87.8906
Epoch: 182 train_loss: 0.3992 train_acc: 87.5000
Epoch: 183 train_loss: 0.3943 train_acc: 86.7188
Epoch: 184 train_loss: 0.3812 train_acc: 88.8672
Epoch: 185 train_loss: 0.3298 train_acc: 91.4062
Epoch: 186 train_loss: 0.3238 train_acc: 88.8672
Epoch: 187 train_loss: 0.2903 train_acc: 91.0156
Epoch: 188 train_loss: 0.3083 train_acc: 91.0156
Epoch: 189 train_loss: 0.3486 train_acc: 89.4531
Epoch: 190 train_loss: 0.3107 train_acc: 90.8203
Epoch: 191 train_loss: 0.3521 train_acc: 89.6484
Epoch: 192 train_loss: 0.3341 train_acc: 89.4531
Epoch: 193 train_loss: 0.3268 train_acc: 88.6719
Epoch: 194 train_loss: 0.3188 train_acc: 89.2578
Epoch: 195 train_loss: 0.3230 train_acc: 89.8438
Epoch: 196 train_loss: 0.3119 train_acc: 91.2109
Epoch: 197 train_loss: 0.3795 train_acc: 86.9141
Epoch: 198 train_loss: 0.3507 train_acc: 88.8672
Epoch: 199 train_loss: 0.2909 train_acc: 91.9922
Epoch: 200 train_loss: 0.2706 train_acc: 92.5781
Epoch: 201 train_loss: 0.3485 train_acc: 88.8672
Epoch: 202 train_loss: 0.3554 train_acc: 89.2578
Epoch: 203 train_loss: 0.3351 train_acc: 90.0391
Epoch: 204 train_loss: 0.3144 train_acc: 90.6250
Epoch: 205 train_loss: 0.3444 train_acc: 89.4531
Epoch: 206 train_loss: 0.3286 train_acc: 90.4297
Epoch: 207 train_loss: 0.3232 train_acc: 89.2578
Epoch: 208 train_loss: 0.3507 train_acc: 87.8906
Epoch: 209 train_loss: 0.3250 train_acc: 90.2344
Epoch: 210 train_loss: 0.2979 train_acc: 90.6250
Epoch: 211 train_loss: 0.2871 train_acc: 91.6016
Epoch: 212 train_loss: 0.2865 train_acc: 91.6016
Epoch: 213 train_loss: 0.2854 train_acc: 91.6016
Epoch: 214 train_loss: 0.3251 train_acc: 88.8672
Epoch: 215 train_loss: 0.2911 train_acc: 90.8203
Epoch: 216 train_loss: 0.2811 train_acc: 90.6250
Epoch: 217 train_loss: 0.2488 train_acc: 94.1406
Epoch: 218 train_loss: 0.2275 train_acc: 94.3359
Epoch: 219 train_loss: 0.2475 train_acc: 92.3828
Epoch: 220 train_loss: 0.2541 train_acc: 91.7969
Epoch: 221 train_loss: 0.2312 train_acc: 93.3594
Epoch: 222 train_loss: 0.2493 train_acc: 92.7734
Epoch: 223 train_loss: 0.2402 train_acc: 92.7734
Epoch: 224 train_loss: 0.2419 train_acc: 92.3828
Epoch: 225 train_loss: 0.2672 train_acc: 92.5781
Epoch: 226 train_loss: 0.2371 train_acc: 93.3594
Epoch: 227 train_loss: 0.2414 train_acc: 93.7500
Epoch: 228 train_loss: 0.2471 train_acc: 91.6016
Epoch: 229 train_loss: 0.2359 train_acc: 92.1875
Epoch: 230 train_loss: 0.2380 train_acc: 92.9688
Epoch: 231 train_loss: 0.2384 train_acc: 93.7500
Epoch: 232 train_loss: 0.2633 train_acc: 92.1875
Epoch: 233 train_loss: 0.2263 train_acc: 92.9688
Epoch: 234 train_loss: 0.2449 train_acc: 92.7734
Epoch: 235 train_loss: 0.2415 train_acc: 91.6016
Epoch: 236 train_loss: 0.2639 train_acc: 91.2109
Epoch: 237 train_loss: 0.2279 train_acc: 93.3594
Epoch: 238 train_loss: 0.2376 train_acc: 91.6016
Epoch: 239 train_loss: 0.2626 train_acc: 91.4062
Epoch: 240 train_loss: 0.2864 train_acc: 90.6250
Epoch: 241 train_loss: 0.2353 train_acc: 93.7500
Epoch: 242 train_loss: 0.2893 train_acc: 90.0391
/home/amax/anaconda3/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
Epoch: 243 train_loss: 0.3054 train_acc: 89.8438
Epoch: 244 train_loss: 0.3379 train_acc: 89.2578
Epoch: 245 train_loss: 0.2918 train_acc: 90.6250
Epoch: 246 train_loss: 0.2868 train_acc: 92.5781
Epoch: 247 train_loss: 0.2457 train_acc: 92.5781
Epoch: 248 train_loss: 0.2360 train_acc: 92.5781
Epoch: 249 train_loss: 0.2781 train_acc: 90.8203
Epoch: 250 train_loss: 0.2276 train_acc: 92.7734
Epoch: 251 train_loss: 0.2321 train_acc: 94.3359
Epoch: 252 train_loss: 0.2338 train_acc: 94.1406
Epoch: 253 train_loss: 0.2714 train_acc: 91.6016
Epoch: 254 train_loss: 0.2035 train_acc: 94.3359
Epoch: 255 train_loss: 0.2290 train_acc: 93.7500
Epoch: 256 train_loss: 0.2252 train_acc: 91.6016
Epoch: 257 train_loss: 0.2797 train_acc: 91.4062
Epoch: 258 train_loss: 0.2542 train_acc: 90.6250
Epoch: 259 train_loss: 0.2248 train_acc: 93.1641
Epoch: 260 train_loss: 0.2008 train_acc: 95.5078
Epoch: 261 train_loss: 0.1865 train_acc: 94.3359
Epoch: 262 train_loss: 0.1969 train_acc: 94.5312
Epoch: 263 train_loss: 0.1814 train_acc: 95.1172
Epoch: 264 train_loss: 0.1706 train_acc: 95.1172
Epoch: 265 train_loss: 0.1974 train_acc: 93.7500
Epoch: 266 train_loss: 0.2187 train_acc: 93.9453
Epoch: 267 train_loss: 0.2167 train_acc: 93.3594
Epoch: 268 train_loss: 0.1647 train_acc: 95.5078
Epoch: 269 train_loss: 0.2254 train_acc: 93.1641
Epoch: 270 train_loss: 0.2157 train_acc: 93.5547
Epoch: 271 train_loss: 0.2102 train_acc: 93.9453
Epoch: 272 train_loss: 0.2292 train_acc: 93.5547
Epoch: 273 train_loss: 0.1922 train_acc: 94.1406
Epoch: 274 train_loss: 0.1953 train_acc: 94.5312
Epoch: 275 train_loss: 0.1924 train_acc: 93.9453
Epoch: 276 train_loss: 0.1592 train_acc: 96.2891
Epoch: 277 train_loss: 0.1558 train_acc: 94.9219
Epoch: 278 train_loss: 0.1703 train_acc: 95.3125
Epoch: 279 train_loss: 0.1779 train_acc: 95.8984
Epoch: 280 train_loss: 0.1872 train_acc: 94.7266
Epoch: 281 train_loss: 0.1994 train_acc: 94.7266
Epoch: 282 train_loss: 0.2077 train_acc: 94.3359
Epoch: 283 train_loss: 0.1979 train_acc: 94.3359
Epoch: 284 train_loss: 0.3347 train_acc: 89.2578
Epoch: 285 train_loss: 0.2546 train_acc: 91.6016
Epoch: 286 train_loss: 0.2209 train_acc: 93.3594
Epoch: 287 train_loss: 0.1791 train_acc: 95.1172
Epoch: 288 train_loss: 0.1697 train_acc: 95.7031
Epoch: 289 train_loss: 0.1599 train_acc: 96.2891
Epoch: 290 train_loss: 0.1453 train_acc: 96.2891
Epoch: 291 train_loss: 0.1664 train_acc: 95.8984
Epoch: 292 train_loss: 0.1610 train_acc: 95.1172
Epoch: 293 train_loss: 0.1595 train_acc: 95.8984
Epoch: 294 train_loss: 0.1670 train_acc: 94.9219
Epoch: 295 train_loss: 0.1767 train_acc: 94.5312
Epoch: 296 train_loss: 0.1625 train_acc: 96.8750
Epoch: 297 train_loss: 0.1833 train_acc: 94.5312
Epoch: 298 train_loss: 0.1644 train_acc: 95.1172
Epoch: 299 train_loss: 0.1677 train_acc: 96.0938
Epoch: 300 train_loss: 0.1547 train_acc: 94.9219
Running Time: 167.55
**************************************************
Final result:
OA: 0.7725 | AA: 0.6304 | Kappa: 0.7385
[0.5        0.69565217 0.6357868  0.51111111 0.78431373 0.81268012
 0.         0.94933921 0.10526316 0.8255688  0.88936535 0.4937833
 0.78974359 0.91680532 0.39237057 0.78409091]
**************************************************
Parameter:
dataset: Indian
flag_test: train
mode: CAF
gpu_id: 0
seed: 13
batch_size: 64
test_freq: 5
patches: 7
band_patches: 3
epoches: 300
learning_rate: 0.0005
gamma: 0.9
weight_decay: 0.005
height=145,width=145,band=200
**************************************************
patch is : 7
mirror_image shape : [151,151,200]
**************************************************
x_train shape = (512, 7, 7, 200), type = float64
x_test  shape = (9737, 7, 7, 200), type = float64
x_true  shape = (21025, 7, 7, 200), type = float64
**************************************************
x_train_band shape = (512, 147, 200), type = float64
x_test_band  shape = (9737, 147, 200), type = float64
x_true_band  shape = (21025, 147, 200), type = float64
**************************************************
y_train: shape = (512,) ,type = int64
y_test: shape = (9737,) ,type = int64
y_true: shape = (21025,) ,type = int64
**************************************************
start training
Epoch: 001 train_loss: 2.6189 train_acc: 16.9922
Epoch: 002 train_loss: 2.3512 train_acc: 24.0234
Epoch: 003 train_loss: 2.2613 train_acc: 26.7578
Epoch: 004 train_loss: 2.1060 train_acc: 36.1328
Epoch: 005 train_loss: 1.9447 train_acc: 35.5469
Epoch: 006 train_loss: 1.8483 train_acc: 36.9141
Epoch: 007 train_loss: 1.7826 train_acc: 39.0625
Epoch: 008 train_loss: 1.7421 train_acc: 41.7969
Epoch: 009 train_loss: 1.7027 train_acc: 42.7734
Epoch: 010 train_loss: 1.6856 train_acc: 43.5547
Epoch: 011 train_loss: 1.6296 train_acc: 44.5312
Epoch: 012 train_loss: 1.5960 train_acc: 45.3125
Epoch: 013 train_loss: 1.5687 train_acc: 44.7266
Epoch: 014 train_loss: 1.5175 train_acc: 47.4609
Epoch: 015 train_loss: 1.4970 train_acc: 47.4609
Epoch: 016 train_loss: 1.4614 train_acc: 47.2656
Epoch: 017 train_loss: 1.4359 train_acc: 47.8516
Epoch: 018 train_loss: 1.4223 train_acc: 49.0234
Epoch: 019 train_loss: 1.4059 train_acc: 49.0234
Epoch: 020 train_loss: 1.4048 train_acc: 48.8281
Epoch: 021 train_loss: 1.3890 train_acc: 49.0234
Epoch: 022 train_loss: 1.3740 train_acc: 49.4141
Epoch: 023 train_loss: 1.3627 train_acc: 51.1719
Epoch: 024 train_loss: 1.3458 train_acc: 49.8047
Epoch: 025 train_loss: 1.3319 train_acc: 50.3906
Epoch: 026 train_loss: 1.3210 train_acc: 51.5625
Epoch: 027 train_loss: 1.3189 train_acc: 50.7812
Epoch: 028 train_loss: 1.3040 train_acc: 52.5391
Epoch: 029 train_loss: 1.3050 train_acc: 51.7578
Epoch: 030 train_loss: 1.3092 train_acc: 52.7344
Epoch: 031 train_loss: 1.2771 train_acc: 52.1484
Epoch: 032 train_loss: 1.2846 train_acc: 50.7812
Epoch: 033 train_loss: 1.2611 train_acc: 53.1250
Epoch: 034 train_loss: 1.2500 train_acc: 54.1016
Epoch: 035 train_loss: 1.2367 train_acc: 54.6875
Epoch: 036 train_loss: 1.2496 train_acc: 54.1016
Epoch: 037 train_loss: 1.2576 train_acc: 53.5156
Epoch: 038 train_loss: 1.2347 train_acc: 53.1250
Epoch: 039 train_loss: 1.2312 train_acc: 53.1250
Epoch: 040 train_loss: 1.2213 train_acc: 55.0781
Epoch: 041 train_loss: 1.2209 train_acc: 53.7109
Epoch: 042 train_loss: 1.1729 train_acc: 56.6406
Epoch: 043 train_loss: 1.1835 train_acc: 55.8594
Epoch: 044 train_loss: 1.1748 train_acc: 56.0547
Epoch: 045 train_loss: 1.2206 train_acc: 54.6875
Epoch: 046 train_loss: 1.2027 train_acc: 54.2969
Epoch: 047 train_loss: 1.1767 train_acc: 57.0312
Epoch: 048 train_loss: 1.1970 train_acc: 54.4922
Epoch: 049 train_loss: 1.1814 train_acc: 56.2500
Epoch: 050 train_loss: 1.1913 train_acc: 55.2734
Epoch: 051 train_loss: 1.1542 train_acc: 58.3984
Epoch: 052 train_loss: 1.1274 train_acc: 56.2500
Epoch: 053 train_loss: 1.1407 train_acc: 57.4219
Epoch: 054 train_loss: 1.1404 train_acc: 57.6172
Epoch: 055 train_loss: 1.1250 train_acc: 58.0078
Epoch: 056 train_loss: 1.1428 train_acc: 58.3984
Epoch: 057 train_loss: 1.1208 train_acc: 58.2031
Epoch: 058 train_loss: 1.1220 train_acc: 57.8125
Epoch: 059 train_loss: 1.1037 train_acc: 58.7891
Epoch: 060 train_loss: 1.0677 train_acc: 59.7656
Epoch: 061 train_loss: 1.0831 train_acc: 57.2266
Epoch: 062 train_loss: 1.0698 train_acc: 59.7656
Epoch: 063 train_loss: 1.0772 train_acc: 62.5000
Epoch: 064 train_loss: 1.1026 train_acc: 58.9844
Epoch: 065 train_loss: 1.0819 train_acc: 60.1562
Epoch: 066 train_loss: 1.0649 train_acc: 60.5469
Epoch: 067 train_loss: 1.0829 train_acc: 56.6406
Epoch: 068 train_loss: 1.1320 train_acc: 59.3750
Epoch: 069 train_loss: 1.0806 train_acc: 58.2031
Epoch: 070 train_loss: 1.0355 train_acc: 62.1094
Epoch: 071 train_loss: 1.0373 train_acc: 60.5469
Epoch: 072 train_loss: 1.0329 train_acc: 61.5234
Epoch: 073 train_loss: 1.0553 train_acc: 61.3281
Epoch: 074 train_loss: 1.0109 train_acc: 60.7422
Epoch: 075 train_loss: 1.0106 train_acc: 64.2578
Epoch: 076 train_loss: 1.0030 train_acc: 61.9141
Epoch: 077 train_loss: 1.0183 train_acc: 62.1094
Epoch: 078 train_loss: 1.0300 train_acc: 61.1328
Epoch: 079 train_loss: 1.0105 train_acc: 63.4766
Epoch: 080 train_loss: 1.0212 train_acc: 62.5000
Epoch: 081 train_loss: 1.0011 train_acc: 62.5000
Epoch: 082 train_loss: 1.0164 train_acc: 63.2812
Epoch: 083 train_loss: 0.9873 train_acc: 62.5000
Epoch: 084 train_loss: 1.0076 train_acc: 60.3516
Epoch: 085 train_loss: 0.9599 train_acc: 65.2344
Epoch: 086 train_loss: 0.9699 train_acc: 63.6719
Epoch: 087 train_loss: 0.9638 train_acc: 64.0625
Epoch: 088 train_loss: 0.9422 train_acc: 64.4531
Epoch: 089 train_loss: 0.9320 train_acc: 64.8438
Epoch: 090 train_loss: 0.9229 train_acc: 65.8203
Epoch: 091 train_loss: 0.9283 train_acc: 64.0625
Epoch: 092 train_loss: 0.9571 train_acc: 62.8906
Epoch: 093 train_loss: 0.9527 train_acc: 65.6250
Epoch: 094 train_loss: 0.9555 train_acc: 63.8672
Epoch: 095 train_loss: 0.8943 train_acc: 67.9688
Epoch: 096 train_loss: 0.9110 train_acc: 66.7969
Epoch: 097 train_loss: 0.9264 train_acc: 63.8672
Epoch: 098 train_loss: 0.9307 train_acc: 66.7969
Epoch: 099 train_loss: 0.9237 train_acc: 66.0156
Epoch: 100 train_loss: 0.8894 train_acc: 66.7969
Epoch: 101 train_loss: 0.9023 train_acc: 67.7734
Epoch: 102 train_loss: 0.8931 train_acc: 66.7969
Epoch: 103 train_loss: 0.8832 train_acc: 65.8203
Epoch: 104 train_loss: 0.8735 train_acc: 67.7734
Epoch: 105 train_loss: 0.8579 train_acc: 67.7734
Epoch: 106 train_loss: 0.8829 train_acc: 67.7734
Epoch: 107 train_loss: 0.8511 train_acc: 67.1875
Epoch: 108 train_loss: 0.8476 train_acc: 67.9688
Epoch: 109 train_loss: 0.9194 train_acc: 66.4062
Epoch: 110 train_loss: 0.8768 train_acc: 67.1875
Epoch: 111 train_loss: 0.8343 train_acc: 70.5078
Epoch: 112 train_loss: 0.8339 train_acc: 68.9453
Epoch: 113 train_loss: 0.8158 train_acc: 70.1172
Epoch: 114 train_loss: 0.8300 train_acc: 68.1641
Epoch: 115 train_loss: 0.8285 train_acc: 68.1641
Epoch: 116 train_loss: 0.8192 train_acc: 69.5312
Epoch: 117 train_loss: 0.8089 train_acc: 70.8984
Epoch: 118 train_loss: 0.7938 train_acc: 68.7500
Epoch: 119 train_loss: 0.7755 train_acc: 73.0469
Epoch: 120 train_loss: 0.8389 train_acc: 68.5547
Epoch: 121 train_loss: 0.7801 train_acc: 69.5312
Epoch: 122 train_loss: 0.7625 train_acc: 70.8984
Epoch: 123 train_loss: 0.7596 train_acc: 71.6797
Epoch: 124 train_loss: 0.7221 train_acc: 73.4375
Epoch: 125 train_loss: 0.8018 train_acc: 69.1406
Epoch: 126 train_loss: 0.7929 train_acc: 70.3125
Epoch: 127 train_loss: 0.7852 train_acc: 71.8750
Epoch: 128 train_loss: 0.7421 train_acc: 70.3125
Epoch: 129 train_loss: 0.7132 train_acc: 74.4141
Epoch: 130 train_loss: 0.7346 train_acc: 73.0469
Epoch: 131 train_loss: 0.7218 train_acc: 73.2422
Epoch: 132 train_loss: 0.6970 train_acc: 73.4375
Epoch: 133 train_loss: 0.6894 train_acc: 74.0234
Epoch: 134 train_loss: 0.7130 train_acc: 72.2656
Epoch: 135 train_loss: 0.6740 train_acc: 75.1953
Epoch: 136 train_loss: 0.6765 train_acc: 74.8047
Epoch: 137 train_loss: 0.7365 train_acc: 73.4375
Epoch: 138 train_loss: 0.7050 train_acc: 74.4141
Epoch: 139 train_loss: 0.7511 train_acc: 71.0938
Epoch: 140 train_loss: 0.7452 train_acc: 72.8516
Epoch: 141 train_loss: 0.7141 train_acc: 75.0000
Epoch: 142 train_loss: 0.6928 train_acc: 72.6562
Epoch: 143 train_loss: 0.6423 train_acc: 77.7344
Epoch: 144 train_loss: 0.6614 train_acc: 76.1719
Epoch: 145 train_loss: 0.6698 train_acc: 75.9766
Epoch: 146 train_loss: 0.6933 train_acc: 74.0234
Epoch: 147 train_loss: 0.7201 train_acc: 73.0469
Epoch: 148 train_loss: 0.6905 train_acc: 73.2422
Epoch: 149 train_loss: 0.6364 train_acc: 77.3438
Epoch: 150 train_loss: 0.6246 train_acc: 78.1250
Epoch: 151 train_loss: 0.6579 train_acc: 74.2188
Epoch: 152 train_loss: 0.6322 train_acc: 74.8047
Epoch: 153 train_loss: 0.6379 train_acc: 77.3438
Epoch: 154 train_loss: 0.6294 train_acc: 76.3672
Epoch: 155 train_loss: 0.6096 train_acc: 77.1484
Epoch: 156 train_loss: 0.6209 train_acc: 77.5391
Epoch: 157 train_loss: 0.6122 train_acc: 78.3203
Epoch: 158 train_loss: 0.6344 train_acc: 77.7344
Epoch: 159 train_loss: 0.6857 train_acc: 72.8516
Epoch: 160 train_loss: 0.6484 train_acc: 77.1484
Epoch: 161 train_loss: 0.6051 train_acc: 78.1250
Epoch: 162 train_loss: 0.5969 train_acc: 77.3438
Epoch: 163 train_loss: 0.5940 train_acc: 79.1016
Epoch: 164 train_loss: 0.5659 train_acc: 79.1016
Epoch: 165 train_loss: 0.5316 train_acc: 82.0312
Epoch: 166 train_loss: 0.5739 train_acc: 79.1016
Epoch: 167 train_loss: 0.5657 train_acc: 80.2734
Epoch: 168 train_loss: 0.6362 train_acc: 76.1719
Epoch: 169 train_loss: 0.5970 train_acc: 78.1250
Epoch: 170 train_loss: 0.6101 train_acc: 77.3438
Epoch: 171 train_loss: 0.5839 train_acc: 76.1719
Epoch: 172 train_loss: 0.5575 train_acc: 79.2969
Epoch: 173 train_loss: 0.5189 train_acc: 81.4453
Epoch: 174 train_loss: 0.5543 train_acc: 80.2734
Epoch: 175 train_loss: 0.5374 train_acc: 81.2500
Epoch: 176 train_loss: 0.5290 train_acc: 82.2266
Epoch: 177 train_loss: 0.5243 train_acc: 81.2500
Epoch: 178 train_loss: 0.5465 train_acc: 80.4688
Epoch: 179 train_loss: 0.5961 train_acc: 78.3203
Epoch: 180 train_loss: 0.5257 train_acc: 83.5938
Epoch: 181 train_loss: 0.5264 train_acc: 81.8359
Epoch: 182 train_loss: 0.5279 train_acc: 81.4453
Epoch: 183 train_loss: 0.5168 train_acc: 80.6641
Epoch: 184 train_loss: 0.4896 train_acc: 84.1797
Epoch: 185 train_loss: 0.5167 train_acc: 82.4219
Epoch: 186 train_loss: 0.5321 train_acc: 83.2031
Epoch: 187 train_loss: 0.4939 train_acc: 81.8359
Epoch: 188 train_loss: 0.5021 train_acc: 80.8594
Epoch: 189 train_loss: 0.4677 train_acc: 83.0078
Epoch: 190 train_loss: 0.4922 train_acc: 83.5938
Epoch: 191 train_loss: 0.4793 train_acc: 82.8125
Epoch: 192 train_loss: 0.4487 train_acc: 84.5703
Epoch: 193 train_loss: 0.4285 train_acc: 87.8906
Epoch: 194 train_loss: 0.4359 train_acc: 83.7891
Epoch: 195 train_loss: 0.4115 train_acc: 85.3516
Epoch: 196 train_loss: 0.4257 train_acc: 87.6953
Epoch: 197 train_loss: 0.4313 train_acc: 84.3750
Epoch: 198 train_loss: 0.4441 train_acc: 85.3516
Epoch: 199 train_loss: 0.4684 train_acc: 83.3984
Epoch: 200 train_loss: 0.4809 train_acc: 82.6172
Epoch: 201 train_loss: 0.4783 train_acc: 82.2266
Epoch: 202 train_loss: 0.4715 train_acc: 82.6172
Epoch: 203 train_loss: 0.4703 train_acc: 84.3750
Epoch: 204 train_loss: 0.4142 train_acc: 87.3047
Epoch: 205 train_loss: 0.4523 train_acc: 84.5703
Epoch: 206 train_loss: 0.4796 train_acc: 82.2266
Epoch: 207 train_loss: 0.4235 train_acc: 85.3516
Epoch: 208 train_loss: 0.4339 train_acc: 85.1562
Epoch: 209 train_loss: 0.4533 train_acc: 83.7891
Epoch: 210 train_loss: 0.4057 train_acc: 87.1094
Epoch: 211 train_loss: 0.4141 train_acc: 86.1328
Epoch: 212 train_loss: 0.4216 train_acc: 86.7188
Epoch: 213 train_loss: 0.4199 train_acc: 86.7188
Epoch: 214 train_loss: 0.3855 train_acc: 87.8906
Epoch: 215 train_loss: 0.3766 train_acc: 87.8906
Epoch: 216 train_loss: 0.3778 train_acc: 88.0859
Epoch: 217 train_loss: 0.3482 train_acc: 88.6719
Epoch: 218 train_loss: 0.3506 train_acc: 89.2578
Epoch: 219 train_loss: 0.3387 train_acc: 89.4531
Epoch: 220 train_loss: 0.3722 train_acc: 86.9141
Epoch: 221 train_loss: 0.3671 train_acc: 87.8906
Epoch: 222 train_loss: 0.3715 train_acc: 87.6953
Epoch: 223 train_loss: 0.3730 train_acc: 88.4766
Epoch: 224 train_loss: 0.4150 train_acc: 85.5469
Epoch: 225 train_loss: 0.3408 train_acc: 88.6719
Epoch: 226 train_loss: 0.3334 train_acc: 88.6719
Epoch: 227 train_loss: 0.3514 train_acc: 89.0625
Epoch: 228 train_loss: 0.3610 train_acc: 87.8906
Epoch: 229 train_loss: 0.3747 train_acc: 88.0859
Epoch: 230 train_loss: 0.3396 train_acc: 89.8438
Epoch: 231 train_loss: 0.3369 train_acc: 89.2578
Epoch: 232 train_loss: 0.3013 train_acc: 90.8203
Epoch: 233 train_loss: 0.3407 train_acc: 89.2578
Epoch: 234 train_loss: 0.2936 train_acc: 91.9922
Epoch: 235 train_loss: 0.2995 train_acc: 91.6016
Epoch: 236 train_loss: 0.3117 train_acc: 90.4297
Epoch: 237 train_loss: 0.3367 train_acc: 89.6484
Epoch: 238 train_loss: 0.3405 train_acc: 89.0625
Epoch: 239 train_loss: 0.3600 train_acc: 87.6953
Epoch: 240 train_loss: 0.3496 train_acc: 87.6953
Epoch: 241 train_loss: 0.3139 train_acc: 90.4297
Epoch: 242 train_loss: 0.3118 train_acc: 90.6250
Epoch: 243 train_loss: 0.3031 train_acc: 89.8438
Epoch: 244 train_loss: 0.3271 train_acc: 89.6484
Epoch: 245 train_loss: 0.3220 train_acc: 90.8203
Epoch: 246 train_loss: 0.3240 train_acc: 90.2344
Epoch: 247 train_loss: 0.3221 train_acc: 90.8203
Epoch: 248 train_loss: 0.3017 train_acc: 91.6016
Epoch: 249 train_loss: 0.3123 train_acc: 91.2109
/home/amax/anaconda3/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
Epoch: 250 train_loss: 0.2914 train_acc: 91.6016
Epoch: 251 train_loss: 0.2952 train_acc: 89.4531
Epoch: 252 train_loss: 0.2805 train_acc: 91.6016
Epoch: 253 train_loss: 0.2832 train_acc: 90.6250
Epoch: 254 train_loss: 0.2679 train_acc: 91.9922
Epoch: 255 train_loss: 0.2789 train_acc: 91.0156
Epoch: 256 train_loss: 0.3294 train_acc: 88.6719
Epoch: 257 train_loss: 0.2880 train_acc: 90.6250
Epoch: 258 train_loss: 0.2976 train_acc: 90.4297
Epoch: 259 train_loss: 0.2975 train_acc: 90.8203
Epoch: 260 train_loss: 0.2560 train_acc: 92.3828
Epoch: 261 train_loss: 0.2853 train_acc: 91.2109
Epoch: 262 train_loss: 0.3009 train_acc: 90.0391
Epoch: 263 train_loss: 0.2868 train_acc: 91.0156
Epoch: 264 train_loss: 0.2742 train_acc: 93.1641
Epoch: 265 train_loss: 0.2553 train_acc: 92.5781
Epoch: 266 train_loss: 0.2797 train_acc: 90.6250
Epoch: 267 train_loss: 0.3488 train_acc: 89.0625
Epoch: 268 train_loss: 0.3059 train_acc: 88.4766
Epoch: 269 train_loss: 0.2792 train_acc: 90.2344
Epoch: 270 train_loss: 0.3036 train_acc: 90.0391
Epoch: 271 train_loss: 0.2745 train_acc: 90.6250
Epoch: 272 train_loss: 0.2226 train_acc: 94.7266
Epoch: 273 train_loss: 0.2627 train_acc: 93.1641
Epoch: 274 train_loss: 0.2673 train_acc: 91.2109
Epoch: 275 train_loss: 0.2591 train_acc: 92.1875
Epoch: 276 train_loss: 0.2521 train_acc: 92.9688
Epoch: 277 train_loss: 0.2618 train_acc: 92.1875
Epoch: 278 train_loss: 0.2592 train_acc: 92.3828
Epoch: 279 train_loss: 0.2336 train_acc: 92.7734
Epoch: 280 train_loss: 0.2469 train_acc: 93.5547
Epoch: 281 train_loss: 0.2545 train_acc: 91.7969
Epoch: 282 train_loss: 0.2647 train_acc: 91.2109
Epoch: 283 train_loss: 0.2651 train_acc: 90.8203
Epoch: 284 train_loss: 0.2364 train_acc: 92.7734
Epoch: 285 train_loss: 0.2340 train_acc: 93.7500
Epoch: 286 train_loss: 0.2195 train_acc: 93.5547
Epoch: 287 train_loss: 0.2325 train_acc: 94.3359
Epoch: 288 train_loss: 0.2414 train_acc: 92.7734
Epoch: 289 train_loss: 0.2381 train_acc: 92.7734
Epoch: 290 train_loss: 0.2785 train_acc: 91.7969
Epoch: 291 train_loss: 0.2513 train_acc: 93.5547
Epoch: 292 train_loss: 0.2281 train_acc: 92.9688
Epoch: 293 train_loss: 0.2331 train_acc: 92.3828
Epoch: 294 train_loss: 0.2077 train_acc: 93.7500
Epoch: 295 train_loss: 0.2537 train_acc: 91.6016
Epoch: 296 train_loss: 0.2256 train_acc: 93.3594
Epoch: 297 train_loss: 0.2443 train_acc: 92.5781
Epoch: 298 train_loss: 0.2475 train_acc: 93.5547
Epoch: 299 train_loss: 0.2629 train_acc: 91.4062
Epoch: 300 train_loss: 0.2385 train_acc: 93.3594
Running Time: 168.47
**************************************************
Final result:
OA: 0.6582 | AA: 0.5206 | Kappa: 0.6072
[0.31818182 0.60722181 0.49873096 0.47111111 0.35076253 0.83285303
 0.07407407 0.93832599 0.         0.62080173 0.75128645 0.28241563
 0.51794872 0.91930116 0.40871935 0.73863636]
**************************************************
Parameter:
dataset: Indian
flag_test: train
mode: CAF
gpu_id: 0
seed: 14
batch_size: 64
test_freq: 5
patches: 7
band_patches: 3
epoches: 300
learning_rate: 0.0005
gamma: 0.9
weight_decay: 0.005
height=145,width=145,band=200
**************************************************
patch is : 7
mirror_image shape : [151,151,200]
**************************************************
x_train shape = (512, 7, 7, 200), type = float64
x_test  shape = (9737, 7, 7, 200), type = float64
x_true  shape = (21025, 7, 7, 200), type = float64
**************************************************
x_train_band shape = (512, 147, 200), type = float64
x_test_band  shape = (9737, 147, 200), type = float64
x_true_band  shape = (21025, 147, 200), type = float64
**************************************************
y_train: shape = (512,) ,type = int64
y_test: shape = (9737,) ,type = int64
y_true: shape = (21025,) ,type = int64
**************************************************
start training
Epoch: 001 train_loss: 2.4643 train_acc: 20.8984
Epoch: 002 train_loss: 2.2622 train_acc: 27.7344
Epoch: 003 train_loss: 2.1051 train_acc: 36.3281
Epoch: 004 train_loss: 1.9506 train_acc: 36.1328
Epoch: 005 train_loss: 1.8602 train_acc: 38.0859
Epoch: 006 train_loss: 1.7860 train_acc: 39.8438
Epoch: 007 train_loss: 1.7441 train_acc: 40.4297
Epoch: 008 train_loss: 1.6958 train_acc: 41.6016
Epoch: 009 train_loss: 1.6626 train_acc: 43.1641
Epoch: 010 train_loss: 1.6517 train_acc: 41.7969
Epoch: 011 train_loss: 1.6132 train_acc: 42.5781
Epoch: 012 train_loss: 1.5639 train_acc: 42.9688
Epoch: 013 train_loss: 1.5386 train_acc: 45.3125
Epoch: 014 train_loss: 1.5120 train_acc: 44.3359
Epoch: 015 train_loss: 1.5116 train_acc: 44.9219
Epoch: 016 train_loss: 1.4819 train_acc: 47.8516
Epoch: 017 train_loss: 1.4700 train_acc: 46.0938
Epoch: 018 train_loss: 1.4312 train_acc: 49.0234
Epoch: 019 train_loss: 1.4089 train_acc: 49.2188
Epoch: 020 train_loss: 1.3933 train_acc: 49.8047
Epoch: 021 train_loss: 1.3840 train_acc: 48.8281
Epoch: 022 train_loss: 1.3683 train_acc: 50.0000
Epoch: 023 train_loss: 1.3457 train_acc: 50.7812
Epoch: 024 train_loss: 1.3376 train_acc: 51.5625
Epoch: 025 train_loss: 1.3502 train_acc: 51.9531
Epoch: 026 train_loss: 1.3306 train_acc: 50.0000
Epoch: 027 train_loss: 1.3565 train_acc: 50.9766
Epoch: 028 train_loss: 1.3418 train_acc: 52.1484
Epoch: 029 train_loss: 1.3196 train_acc: 51.9531
Epoch: 030 train_loss: 1.3160 train_acc: 51.9531
Epoch: 031 train_loss: 1.2682 train_acc: 54.2969
Epoch: 032 train_loss: 1.2696 train_acc: 52.9297
Epoch: 033 train_loss: 1.2774 train_acc: 54.6875
Epoch: 034 train_loss: 1.2666 train_acc: 54.1016
Epoch: 035 train_loss: 1.2542 train_acc: 56.0547
Epoch: 036 train_loss: 1.2548 train_acc: 54.4922
Epoch: 037 train_loss: 1.2329 train_acc: 55.2734
Epoch: 038 train_loss: 1.2392 train_acc: 54.6875
Epoch: 039 train_loss: 1.2508 train_acc: 54.6875
Epoch: 040 train_loss: 1.2127 train_acc: 53.7109
Epoch: 041 train_loss: 1.2130 train_acc: 55.0781
Epoch: 042 train_loss: 1.1884 train_acc: 57.4219
Epoch: 043 train_loss: 1.1948 train_acc: 54.6875
Epoch: 044 train_loss: 1.1714 train_acc: 56.8359
Epoch: 045 train_loss: 1.1988 train_acc: 55.6641
Epoch: 046 train_loss: 1.1953 train_acc: 54.1016
Epoch: 047 train_loss: 1.1659 train_acc: 58.3984
Epoch: 048 train_loss: 1.1739 train_acc: 58.3984
Epoch: 049 train_loss: 1.1684 train_acc: 57.0312
Epoch: 050 train_loss: 1.1649 train_acc: 55.0781
Epoch: 051 train_loss: 1.2025 train_acc: 54.1016
Epoch: 052 train_loss: 1.1543 train_acc: 57.8125
Epoch: 053 train_loss: 1.1314 train_acc: 57.4219
Epoch: 054 train_loss: 1.1184 train_acc: 59.7656
Epoch: 055 train_loss: 1.1091 train_acc: 58.7891
Epoch: 056 train_loss: 1.1118 train_acc: 60.7422
Epoch: 057 train_loss: 1.0913 train_acc: 59.1797
Epoch: 058 train_loss: 1.0825 train_acc: 61.1328
Epoch: 059 train_loss: 1.0721 train_acc: 59.9609
Epoch: 060 train_loss: 1.0657 train_acc: 61.1328
Epoch: 061 train_loss: 1.0610 train_acc: 62.5000
Epoch: 062 train_loss: 1.0518 train_acc: 62.5000
Epoch: 063 train_loss: 1.0557 train_acc: 59.7656
Epoch: 064 train_loss: 1.0531 train_acc: 61.1328
Epoch: 065 train_loss: 1.0533 train_acc: 62.3047
Epoch: 066 train_loss: 1.0372 train_acc: 62.8906
Epoch: 067 train_loss: 1.0377 train_acc: 60.9375
Epoch: 068 train_loss: 1.0620 train_acc: 61.5234
Epoch: 069 train_loss: 1.0337 train_acc: 62.5000
Epoch: 070 train_loss: 0.9817 train_acc: 64.0625
Epoch: 071 train_loss: 0.9714 train_acc: 65.6250
Epoch: 072 train_loss: 0.9566 train_acc: 65.0391
Epoch: 073 train_loss: 0.9556 train_acc: 66.7969
Epoch: 074 train_loss: 0.9493 train_acc: 65.6250
Epoch: 075 train_loss: 0.9439 train_acc: 66.0156
Epoch: 076 train_loss: 0.9811 train_acc: 63.6719
Epoch: 077 train_loss: 0.9548 train_acc: 65.0391
Epoch: 078 train_loss: 0.9354 train_acc: 67.3828
Epoch: 079 train_loss: 0.9705 train_acc: 64.6484
Epoch: 080 train_loss: 0.9602 train_acc: 65.0391
Epoch: 081 train_loss: 0.8768 train_acc: 68.9453
Epoch: 082 train_loss: 0.9124 train_acc: 68.1641
Epoch: 083 train_loss: 0.9417 train_acc: 65.6250
Epoch: 084 train_loss: 0.8778 train_acc: 68.5547
Epoch: 085 train_loss: 0.8840 train_acc: 70.8984
Epoch: 086 train_loss: 0.8487 train_acc: 70.3125
Epoch: 087 train_loss: 0.8657 train_acc: 69.5312
Epoch: 088 train_loss: 0.8339 train_acc: 70.5078
Epoch: 089 train_loss: 0.8289 train_acc: 71.0938
Epoch: 090 train_loss: 0.8078 train_acc: 71.8750
Epoch: 091 train_loss: 0.7968 train_acc: 70.7031
Epoch: 092 train_loss: 0.8328 train_acc: 70.5078
Epoch: 093 train_loss: 0.8137 train_acc: 71.0938
Epoch: 094 train_loss: 0.8352 train_acc: 68.7500
Epoch: 095 train_loss: 0.7727 train_acc: 72.2656
Epoch: 096 train_loss: 0.7976 train_acc: 71.4844
Epoch: 097 train_loss: 0.7354 train_acc: 73.2422
Epoch: 098 train_loss: 0.7223 train_acc: 73.6328
Epoch: 099 train_loss: 0.7301 train_acc: 72.6562
Epoch: 100 train_loss: 0.7350 train_acc: 75.3906
Epoch: 101 train_loss: 0.7436 train_acc: 72.4609
Epoch: 102 train_loss: 0.7316 train_acc: 75.0000
Epoch: 103 train_loss: 0.7241 train_acc: 74.4141
Epoch: 104 train_loss: 0.7713 train_acc: 73.4375
Epoch: 105 train_loss: 0.7438 train_acc: 72.0703
Epoch: 106 train_loss: 0.7187 train_acc: 74.6094
Epoch: 107 train_loss: 0.6969 train_acc: 74.0234
Epoch: 108 train_loss: 0.7009 train_acc: 75.5859
Epoch: 109 train_loss: 0.6645 train_acc: 77.3438
Epoch: 110 train_loss: 0.6149 train_acc: 78.1250
Epoch: 111 train_loss: 0.7252 train_acc: 73.8281
Epoch: 112 train_loss: 0.8591 train_acc: 69.1406
Epoch: 113 train_loss: 0.7066 train_acc: 75.0000
Epoch: 114 train_loss: 0.6559 train_acc: 76.7578
Epoch: 115 train_loss: 0.6645 train_acc: 75.7812
Epoch: 116 train_loss: 0.6250 train_acc: 79.1016
Epoch: 117 train_loss: 0.5692 train_acc: 81.2500
Epoch: 118 train_loss: 0.5757 train_acc: 79.2969
Epoch: 119 train_loss: 0.5473 train_acc: 81.2500
Epoch: 120 train_loss: 0.6052 train_acc: 77.9297
Epoch: 121 train_loss: 0.5641 train_acc: 81.0547
Epoch: 122 train_loss: 0.6119 train_acc: 77.3438
Epoch: 123 train_loss: 0.5681 train_acc: 80.0781
Epoch: 124 train_loss: 0.5956 train_acc: 78.5156
Epoch: 125 train_loss: 0.5673 train_acc: 79.4922
Epoch: 126 train_loss: 0.5356 train_acc: 82.0312
Epoch: 127 train_loss: 0.5339 train_acc: 82.0312
Epoch: 128 train_loss: 0.5507 train_acc: 80.0781
Epoch: 129 train_loss: 0.5524 train_acc: 81.0547
Epoch: 130 train_loss: 0.5576 train_acc: 79.8828
Epoch: 131 train_loss: 0.5616 train_acc: 80.0781
Epoch: 132 train_loss: 0.5325 train_acc: 82.0312
Epoch: 133 train_loss: 0.5451 train_acc: 81.2500
Epoch: 134 train_loss: 0.5353 train_acc: 81.8359
Epoch: 135 train_loss: 0.5079 train_acc: 83.2031
Epoch: 136 train_loss: 0.4964 train_acc: 83.0078
Epoch: 137 train_loss: 0.5379 train_acc: 81.0547
Epoch: 138 train_loss: 0.4945 train_acc: 83.5938
Epoch: 139 train_loss: 0.4811 train_acc: 84.7656
Epoch: 140 train_loss: 0.4376 train_acc: 86.3281
Epoch: 141 train_loss: 0.4628 train_acc: 84.9609
Epoch: 142 train_loss: 0.4574 train_acc: 85.9375
Epoch: 143 train_loss: 0.4796 train_acc: 84.3750
Epoch: 144 train_loss: 0.5386 train_acc: 78.9062
Epoch: 145 train_loss: 0.5001 train_acc: 83.2031
Epoch: 146 train_loss: 0.5038 train_acc: 82.2266
Epoch: 147 train_loss: 0.4799 train_acc: 83.5938
Epoch: 148 train_loss: 0.5020 train_acc: 82.2266
Epoch: 149 train_loss: 0.4414 train_acc: 85.3516
Epoch: 150 train_loss: 0.4304 train_acc: 85.9375
Epoch: 151 train_loss: 0.4441 train_acc: 84.7656
Epoch: 152 train_loss: 0.4094 train_acc: 88.8672
Epoch: 153 train_loss: 0.3789 train_acc: 86.5234
Epoch: 154 train_loss: 0.3706 train_acc: 88.4766
Epoch: 155 train_loss: 0.3638 train_acc: 89.2578
Epoch: 156 train_loss: 0.4216 train_acc: 85.7422
Epoch: 157 train_loss: 0.4209 train_acc: 85.1562
Epoch: 158 train_loss: 0.4419 train_acc: 84.1797
Epoch: 159 train_loss: 0.4046 train_acc: 85.9375
Epoch: 160 train_loss: 0.3772 train_acc: 86.5234
Epoch: 161 train_loss: 0.3667 train_acc: 88.8672
Epoch: 162 train_loss: 0.3725 train_acc: 87.6953
Epoch: 163 train_loss: 0.3501 train_acc: 88.6719
Epoch: 164 train_loss: 0.3621 train_acc: 87.8906
Epoch: 165 train_loss: 0.3792 train_acc: 87.5000
Epoch: 166 train_loss: 0.3438 train_acc: 90.2344
Epoch: 167 train_loss: 0.3428 train_acc: 88.6719
Epoch: 168 train_loss: 0.3514 train_acc: 88.8672
Epoch: 169 train_loss: 0.3813 train_acc: 87.6953
Epoch: 170 train_loss: 0.3548 train_acc: 89.4531
Epoch: 171 train_loss: 0.3664 train_acc: 88.2812
Epoch: 172 train_loss: 0.3369 train_acc: 88.2812
Epoch: 173 train_loss: 0.3315 train_acc: 89.2578
Epoch: 174 train_loss: 0.3729 train_acc: 87.3047
Epoch: 175 train_loss: 0.3764 train_acc: 87.5000
Epoch: 176 train_loss: 0.3703 train_acc: 88.0859
Epoch: 177 train_loss: 0.3932 train_acc: 86.1328
Epoch: 178 train_loss: 0.3514 train_acc: 89.6484
Epoch: 179 train_loss: 0.3302 train_acc: 88.8672
Epoch: 180 train_loss: 0.3086 train_acc: 91.2109
Epoch: 181 train_loss: 0.3327 train_acc: 89.4531
Epoch: 182 train_loss: 0.3411 train_acc: 89.0625
Epoch: 183 train_loss: 0.3466 train_acc: 87.8906
Epoch: 184 train_loss: 0.3566 train_acc: 88.0859
Epoch: 185 train_loss: 0.3301 train_acc: 89.4531
Epoch: 186 train_loss: 0.3124 train_acc: 89.4531
Epoch: 187 train_loss: 0.2970 train_acc: 90.4297
Epoch: 188 train_loss: 0.2677 train_acc: 92.3828
Epoch: 189 train_loss: 0.2301 train_acc: 93.1641
Epoch: 190 train_loss: 0.2585 train_acc: 91.2109
Epoch: 191 train_loss: 0.2750 train_acc: 91.7969
Epoch: 192 train_loss: 0.3032 train_acc: 89.8438
Epoch: 193 train_loss: 0.3111 train_acc: 88.6719
Epoch: 194 train_loss: 0.3098 train_acc: 90.0391
Epoch: 195 train_loss: 0.2654 train_acc: 91.2109
Epoch: 196 train_loss: 0.2714 train_acc: 90.0391
Epoch: 197 train_loss: 0.2507 train_acc: 91.9922
Epoch: 198 train_loss: 0.2425 train_acc: 92.9688
Epoch: 199 train_loss: 0.2871 train_acc: 90.0391
Epoch: 200 train_loss: 0.2894 train_acc: 90.6250
Epoch: 201 train_loss: 0.2890 train_acc: 90.2344
Epoch: 202 train_loss: 0.2797 train_acc: 89.4531
Epoch: 203 train_loss: 0.2715 train_acc: 91.7969
Epoch: 204 train_loss: 0.2720 train_acc: 90.8203
Epoch: 205 train_loss: 0.2504 train_acc: 92.3828
Epoch: 206 train_loss: 0.2152 train_acc: 93.7500
Epoch: 207 train_loss: 0.2327 train_acc: 92.3828
Epoch: 208 train_loss: 0.2099 train_acc: 94.3359
Epoch: 209 train_loss: 0.2310 train_acc: 92.1875
Epoch: 210 train_loss: 0.2482 train_acc: 93.3594
Epoch: 211 train_loss: 0.2942 train_acc: 90.0391
Epoch: 212 train_loss: 0.2237 train_acc: 92.5781
Epoch: 213 train_loss: 0.2428 train_acc: 92.3828
Epoch: 214 train_loss: 0.2291 train_acc: 91.9922
Epoch: 215 train_loss: 0.2143 train_acc: 94.3359
Epoch: 216 train_loss: 0.2744 train_acc: 91.2109
Epoch: 217 train_loss: 0.2686 train_acc: 91.2109
Epoch: 218 train_loss: 0.2514 train_acc: 92.5781
Epoch: 219 train_loss: 0.3086 train_acc: 90.0391
Epoch: 220 train_loss: 0.2820 train_acc: 89.8438
Epoch: 221 train_loss: 0.2851 train_acc: 90.2344
Epoch: 222 train_loss: 0.2391 train_acc: 93.1641
Epoch: 223 train_loss: 0.2320 train_acc: 92.3828
Epoch: 224 train_loss: 0.2345 train_acc: 93.5547
Epoch: 225 train_loss: 0.2288 train_acc: 93.1641
Epoch: 226 train_loss: 0.2207 train_acc: 93.3594
Epoch: 227 train_loss: 0.2428 train_acc: 92.5781
Epoch: 228 train_loss: 0.2133 train_acc: 94.5312
Epoch: 229 train_loss: 0.2293 train_acc: 92.7734
Epoch: 230 train_loss: 0.2100 train_acc: 94.5312
Epoch: 231 train_loss: 0.1952 train_acc: 94.5312
Epoch: 232 train_loss: 0.1798 train_acc: 94.9219
Epoch: 233 train_loss: 0.1831 train_acc: 94.1406
Epoch: 234 train_loss: 0.2117 train_acc: 93.5547
Epoch: 235 train_loss: 0.2510 train_acc: 92.3828
Epoch: 236 train_loss: 0.2200 train_acc: 92.9688
Epoch: 237 train_loss: 0.1992 train_acc: 93.7500
Epoch: 238 train_loss: 0.1972 train_acc: 94.5312
Epoch: 239 train_loss: 0.2015 train_acc: 93.9453
Epoch: 240 train_loss: 0.1741 train_acc: 95.5078
Epoch: 241 train_loss: 0.1866 train_acc: 94.5312
Epoch: 242 train_loss: 0.1664 train_acc: 95.5078
Epoch: 243 train_loss: 0.1956 train_acc: 94.1406
Epoch: 244 train_loss: 0.1717 train_acc: 94.9219
Epoch: 245 train_loss: 0.2083 train_acc: 93.9453
Epoch: 246 train_loss: 0.1877 train_acc: 94.7266
Epoch: 247 train_loss: 0.2163 train_acc: 94.1406
Epoch: 248 train_loss: 0.2049 train_acc: 94.5312
Epoch: 249 train_loss: 0.1820 train_acc: 94.1406
Epoch: 250 train_loss: 0.1697 train_acc: 94.1406
Epoch: 251 train_loss: 0.1683 train_acc: 95.1172
Epoch: 252 train_loss: 0.1868 train_acc: 94.3359
Epoch: 253 train_loss: 0.1587 train_acc: 95.5078
Epoch: 254 train_loss: 0.1617 train_acc: 94.9219
Epoch: 255 train_loss: 0.1739 train_acc: 95.3125
Epoch: 256 train_loss: 0.1691 train_acc: 94.9219
/home/amax/anaconda3/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
Epoch: 257 train_loss: 0.1759 train_acc: 95.7031
Epoch: 258 train_loss: 0.1626 train_acc: 95.5078
Epoch: 259 train_loss: 0.1672 train_acc: 95.7031
Epoch: 260 train_loss: 0.1678 train_acc: 94.7266
Epoch: 261 train_loss: 0.1456 train_acc: 96.6797
Epoch: 262 train_loss: 0.1410 train_acc: 97.0703
Epoch: 263 train_loss: 0.1551 train_acc: 95.1172
Epoch: 264 train_loss: 0.1621 train_acc: 95.7031
Epoch: 265 train_loss: 0.1301 train_acc: 97.0703
Epoch: 266 train_loss: 0.1666 train_acc: 95.1172
Epoch: 267 train_loss: 0.1538 train_acc: 95.5078
Epoch: 268 train_loss: 0.1448 train_acc: 96.0938
Epoch: 269 train_loss: 0.1517 train_acc: 96.0938
Epoch: 270 train_loss: 0.1442 train_acc: 96.8750
Epoch: 271 train_loss: 0.1204 train_acc: 97.4609
Epoch: 272 train_loss: 0.1311 train_acc: 96.4844
Epoch: 273 train_loss: 0.1268 train_acc: 97.2656
Epoch: 274 train_loss: 0.1528 train_acc: 96.4844
Epoch: 275 train_loss: 0.1513 train_acc: 96.2891
Epoch: 276 train_loss: 0.1743 train_acc: 95.1172
Epoch: 277 train_loss: 0.1372 train_acc: 96.4844
Epoch: 278 train_loss: 0.1346 train_acc: 96.8750
Epoch: 279 train_loss: 0.1564 train_acc: 95.7031
Epoch: 280 train_loss: 0.1366 train_acc: 96.4844
Epoch: 281 train_loss: 0.1254 train_acc: 97.6562
Epoch: 282 train_loss: 0.1609 train_acc: 96.0938
Epoch: 283 train_loss: 0.1774 train_acc: 93.5547
Epoch: 284 train_loss: 0.1665 train_acc: 95.1172
Epoch: 285 train_loss: 0.1757 train_acc: 94.9219
Epoch: 286 train_loss: 0.1603 train_acc: 96.0938
Epoch: 287 train_loss: 0.1682 train_acc: 94.1406
Epoch: 288 train_loss: 0.1593 train_acc: 95.3125
Epoch: 289 train_loss: 0.1584 train_acc: 94.5312
Epoch: 290 train_loss: 0.1466 train_acc: 95.1172
Epoch: 291 train_loss: 0.1481 train_acc: 95.7031
Epoch: 292 train_loss: 0.1554 train_acc: 96.4844
Epoch: 293 train_loss: 0.1748 train_acc: 95.7031
Epoch: 294 train_loss: 0.1803 train_acc: 94.1406
Epoch: 295 train_loss: 0.1575 train_acc: 95.8984
Epoch: 296 train_loss: 0.1827 train_acc: 94.3359
Epoch: 297 train_loss: 0.1448 train_acc: 96.8750
Epoch: 298 train_loss: 0.1374 train_acc: 97.0703
Epoch: 299 train_loss: 0.1452 train_acc: 96.0938
Epoch: 300 train_loss: 0.1242 train_acc: 97.2656
Running Time: 166.90
**************************************************
Final result:
OA: 0.7290 | AA: 0.5817 | Kappa: 0.6918
[0.06818182 0.6440678  0.74873096 0.36       0.76252723 0.80979827
 0.         0.91629956 0.31578947 0.79956663 0.77958834 0.55239787
 0.64102564 0.85856905 0.35694823 0.69318182]
**************************************************
Parameter:
dataset: Indian
flag_test: train
mode: CAF
gpu_id: 0
seed: 15
batch_size: 64
test_freq: 5
patches: 7
band_patches: 3
epoches: 300
learning_rate: 0.0005
gamma: 0.9
weight_decay: 0.005
height=145,width=145,band=200
**************************************************
patch is : 7
mirror_image shape : [151,151,200]
**************************************************
x_train shape = (512, 7, 7, 200), type = float64
x_test  shape = (9737, 7, 7, 200), type = float64
x_true  shape = (21025, 7, 7, 200), type = float64
**************************************************
x_train_band shape = (512, 147, 200), type = float64
x_test_band  shape = (9737, 147, 200), type = float64
x_true_band  shape = (21025, 147, 200), type = float64
**************************************************
y_train: shape = (512,) ,type = int64
y_test: shape = (9737,) ,type = int64
y_true: shape = (21025,) ,type = int64
**************************************************
start training
Epoch: 001 train_loss: 2.4945 train_acc: 21.2891
Epoch: 002 train_loss: 2.2990 train_acc: 23.4375
Epoch: 003 train_loss: 2.1433 train_acc: 35.3516
Epoch: 004 train_loss: 1.9713 train_acc: 35.1562
Epoch: 005 train_loss: 1.8950 train_acc: 36.1328
Epoch: 006 train_loss: 1.8336 train_acc: 36.7188
Epoch: 007 train_loss: 1.7733 train_acc: 39.8438
Epoch: 008 train_loss: 1.7123 train_acc: 40.2344
Epoch: 009 train_loss: 1.6443 train_acc: 44.5312
Epoch: 010 train_loss: 1.6121 train_acc: 44.1406
Epoch: 011 train_loss: 1.5721 train_acc: 44.3359
Epoch: 012 train_loss: 1.5416 train_acc: 46.4844
Epoch: 013 train_loss: 1.5238 train_acc: 45.7031
Epoch: 014 train_loss: 1.5144 train_acc: 46.2891
Epoch: 015 train_loss: 1.4825 train_acc: 47.4609
Epoch: 016 train_loss: 1.4521 train_acc: 48.2422
Epoch: 017 train_loss: 1.4391 train_acc: 47.0703
Epoch: 018 train_loss: 1.4253 train_acc: 48.2422
Epoch: 019 train_loss: 1.4134 train_acc: 48.2422
Epoch: 020 train_loss: 1.4170 train_acc: 47.8516
Epoch: 021 train_loss: 1.3933 train_acc: 49.6094
Epoch: 022 train_loss: 1.3705 train_acc: 50.1953
Epoch: 023 train_loss: 1.3684 train_acc: 50.5859
Epoch: 024 train_loss: 1.3808 train_acc: 49.4141
Epoch: 025 train_loss: 1.3711 train_acc: 49.8047
Epoch: 026 train_loss: 1.3787 train_acc: 49.8047
Epoch: 027 train_loss: 1.3560 train_acc: 46.2891
Epoch: 028 train_loss: 1.3371 train_acc: 51.7578
Epoch: 029 train_loss: 1.3381 train_acc: 50.7812
Epoch: 030 train_loss: 1.3216 train_acc: 50.9766
Epoch: 031 train_loss: 1.3063 train_acc: 50.7812
Epoch: 032 train_loss: 1.2963 train_acc: 52.5391
Epoch: 033 train_loss: 1.3029 train_acc: 50.9766
Epoch: 034 train_loss: 1.3025 train_acc: 51.3672
Epoch: 035 train_loss: 1.3157 train_acc: 51.5625
Epoch: 036 train_loss: 1.2921 train_acc: 53.1250
Epoch: 037 train_loss: 1.3217 train_acc: 50.9766
Epoch: 038 train_loss: 1.2899 train_acc: 51.7578
Epoch: 039 train_loss: 1.2664 train_acc: 52.9297
Epoch: 040 train_loss: 1.2815 train_acc: 51.7578
Epoch: 041 train_loss: 1.2659 train_acc: 51.3672
Epoch: 042 train_loss: 1.2743 train_acc: 51.7578
Epoch: 043 train_loss: 1.2573 train_acc: 52.7344
Epoch: 044 train_loss: 1.2611 train_acc: 53.1250
Epoch: 045 train_loss: 1.2537 train_acc: 52.7344
Epoch: 046 train_loss: 1.2194 train_acc: 55.6641
Epoch: 047 train_loss: 1.2307 train_acc: 53.5156
Epoch: 048 train_loss: 1.2312 train_acc: 53.5156
Epoch: 049 train_loss: 1.2050 train_acc: 54.4922
Epoch: 050 train_loss: 1.2067 train_acc: 54.2969
Epoch: 051 train_loss: 1.2186 train_acc: 53.1250
Epoch: 052 train_loss: 1.2106 train_acc: 53.5156
Epoch: 053 train_loss: 1.1887 train_acc: 54.4922
Epoch: 054 train_loss: 1.2127 train_acc: 53.5156
Epoch: 055 train_loss: 1.1965 train_acc: 52.5391
Epoch: 056 train_loss: 1.2083 train_acc: 55.0781
Epoch: 057 train_loss: 1.1961 train_acc: 54.4922
Epoch: 058 train_loss: 1.2067 train_acc: 54.6875
Epoch: 059 train_loss: 1.2015 train_acc: 53.7109
Epoch: 060 train_loss: 1.1885 train_acc: 55.8594
Epoch: 061 train_loss: 1.1807 train_acc: 54.8828
Epoch: 062 train_loss: 1.1397 train_acc: 55.0781
Epoch: 063 train_loss: 1.1120 train_acc: 56.0547
Epoch: 064 train_loss: 1.1185 train_acc: 56.8359
Epoch: 065 train_loss: 1.1249 train_acc: 54.6875
Epoch: 066 train_loss: 1.1029 train_acc: 56.4453
Epoch: 067 train_loss: 1.0943 train_acc: 57.6172
Epoch: 068 train_loss: 1.0999 train_acc: 56.4453
Epoch: 069 train_loss: 1.1132 train_acc: 57.6172
Epoch: 070 train_loss: 1.1047 train_acc: 58.3984
Epoch: 071 train_loss: 1.0889 train_acc: 58.0078
Epoch: 072 train_loss: 1.1083 train_acc: 57.4219
Epoch: 073 train_loss: 1.0965 train_acc: 57.0312
Epoch: 074 train_loss: 1.0483 train_acc: 60.3516
Epoch: 075 train_loss: 1.0407 train_acc: 59.7656
Epoch: 076 train_loss: 1.0614 train_acc: 60.1562
Epoch: 077 train_loss: 1.0453 train_acc: 58.5938
Epoch: 078 train_loss: 1.0069 train_acc: 61.5234
Epoch: 079 train_loss: 1.0138 train_acc: 60.1562
Epoch: 080 train_loss: 1.0176 train_acc: 61.9141
Epoch: 081 train_loss: 1.0175 train_acc: 62.5000
Epoch: 082 train_loss: 1.0295 train_acc: 60.1562
Epoch: 083 train_loss: 1.0740 train_acc: 58.5938
Epoch: 084 train_loss: 1.0293 train_acc: 60.1562
Epoch: 085 train_loss: 0.9953 train_acc: 61.1328
Epoch: 086 train_loss: 1.0087 train_acc: 60.5469
Epoch: 087 train_loss: 0.9549 train_acc: 63.2812
Epoch: 088 train_loss: 0.9621 train_acc: 63.4766
Epoch: 089 train_loss: 0.9438 train_acc: 62.3047
Epoch: 090 train_loss: 0.9300 train_acc: 62.5000
Epoch: 091 train_loss: 0.9215 train_acc: 64.4531
Epoch: 092 train_loss: 0.9142 train_acc: 65.2344
Epoch: 093 train_loss: 0.9276 train_acc: 64.6484
Epoch: 094 train_loss: 0.9161 train_acc: 65.8203
Epoch: 095 train_loss: 0.9260 train_acc: 64.6484
Epoch: 096 train_loss: 0.8811 train_acc: 65.6250
Epoch: 097 train_loss: 0.9224 train_acc: 66.7969
Epoch: 098 train_loss: 0.9201 train_acc: 64.0625
Epoch: 099 train_loss: 0.8901 train_acc: 67.7734
Epoch: 100 train_loss: 0.9056 train_acc: 66.2109
Epoch: 101 train_loss: 0.8857 train_acc: 66.4062
Epoch: 102 train_loss: 0.8685 train_acc: 68.1641
Epoch: 103 train_loss: 0.8587 train_acc: 69.1406
Epoch: 104 train_loss: 0.8736 train_acc: 66.9922
Epoch: 105 train_loss: 0.8282 train_acc: 70.3125
Epoch: 106 train_loss: 0.8372 train_acc: 69.1406
Epoch: 107 train_loss: 0.8430 train_acc: 68.5547
Epoch: 108 train_loss: 0.8051 train_acc: 71.4844
Epoch: 109 train_loss: 0.8337 train_acc: 70.3125
Epoch: 110 train_loss: 0.8118 train_acc: 70.1172
Epoch: 111 train_loss: 0.8855 train_acc: 66.7969
Epoch: 112 train_loss: 0.9225 train_acc: 64.6484
Epoch: 113 train_loss: 0.9020 train_acc: 63.6719
Epoch: 114 train_loss: 0.8487 train_acc: 68.1641
Epoch: 115 train_loss: 0.8065 train_acc: 71.2891
Epoch: 116 train_loss: 0.8289 train_acc: 69.5312
Epoch: 117 train_loss: 0.8262 train_acc: 67.9688
Epoch: 118 train_loss: 0.7528 train_acc: 71.0938
Epoch: 119 train_loss: 0.7549 train_acc: 72.2656
Epoch: 120 train_loss: 0.7155 train_acc: 73.2422
Epoch: 121 train_loss: 0.7395 train_acc: 73.2422
Epoch: 122 train_loss: 0.7370 train_acc: 73.0469
Epoch: 123 train_loss: 0.7432 train_acc: 71.4844
Epoch: 124 train_loss: 0.7507 train_acc: 72.4609
Epoch: 125 train_loss: 0.7627 train_acc: 70.5078
Epoch: 126 train_loss: 0.7576 train_acc: 69.7266
Epoch: 127 train_loss: 0.7233 train_acc: 73.4375
Epoch: 128 train_loss: 0.7137 train_acc: 74.6094
Epoch: 129 train_loss: 0.7570 train_acc: 72.0703
Epoch: 130 train_loss: 0.7204 train_acc: 73.6328
Epoch: 131 train_loss: 0.6881 train_acc: 76.5625
Epoch: 132 train_loss: 0.6939 train_acc: 76.3672
Epoch: 133 train_loss: 0.6833 train_acc: 75.1953
Epoch: 134 train_loss: 0.6647 train_acc: 76.5625
Epoch: 135 train_loss: 0.6318 train_acc: 79.1016
Epoch: 136 train_loss: 0.5917 train_acc: 79.2969
Epoch: 137 train_loss: 0.5887 train_acc: 78.7109
Epoch: 138 train_loss: 0.5869 train_acc: 80.0781
Epoch: 139 train_loss: 0.5644 train_acc: 80.2734
Epoch: 140 train_loss: 0.5869 train_acc: 78.7109
Epoch: 141 train_loss: 0.6166 train_acc: 77.9297
Epoch: 142 train_loss: 0.6543 train_acc: 73.4375
Epoch: 143 train_loss: 0.6351 train_acc: 77.9297
Epoch: 144 train_loss: 0.5674 train_acc: 81.6406
Epoch: 145 train_loss: 0.5516 train_acc: 80.4688
Epoch: 146 train_loss: 0.6306 train_acc: 77.7344
Epoch: 147 train_loss: 0.5691 train_acc: 80.4688
Epoch: 148 train_loss: 0.5552 train_acc: 80.2734
Epoch: 149 train_loss: 0.5586 train_acc: 78.9062
Epoch: 150 train_loss: 0.5756 train_acc: 80.0781
Epoch: 151 train_loss: 0.6228 train_acc: 75.9766
Epoch: 152 train_loss: 0.5557 train_acc: 80.8594
Epoch: 153 train_loss: 0.5816 train_acc: 77.9297
Epoch: 154 train_loss: 0.5571 train_acc: 81.8359
Epoch: 155 train_loss: 0.5273 train_acc: 79.8828
Epoch: 156 train_loss: 0.5168 train_acc: 82.0312
Epoch: 157 train_loss: 0.4909 train_acc: 83.3984
Epoch: 158 train_loss: 0.5107 train_acc: 81.2500
Epoch: 159 train_loss: 0.4572 train_acc: 86.1328
Epoch: 160 train_loss: 0.5028 train_acc: 82.8125
Epoch: 161 train_loss: 0.4922 train_acc: 82.6172
Epoch: 162 train_loss: 0.4876 train_acc: 82.8125
Epoch: 163 train_loss: 0.4768 train_acc: 83.2031
Epoch: 164 train_loss: 0.4553 train_acc: 86.5234
Epoch: 165 train_loss: 0.5042 train_acc: 81.4453
Epoch: 166 train_loss: 0.4806 train_acc: 84.1797
Epoch: 167 train_loss: 0.5028 train_acc: 81.6406
Epoch: 168 train_loss: 0.4683 train_acc: 84.1797
Epoch: 169 train_loss: 0.4512 train_acc: 84.5703
Epoch: 170 train_loss: 0.4583 train_acc: 83.2031
Epoch: 171 train_loss: 0.4761 train_acc: 83.3984
Epoch: 172 train_loss: 0.4527 train_acc: 85.7422
Epoch: 173 train_loss: 0.4335 train_acc: 85.3516
Epoch: 174 train_loss: 0.4836 train_acc: 83.5938
Epoch: 175 train_loss: 0.4347 train_acc: 85.5469
Epoch: 176 train_loss: 0.4970 train_acc: 82.8125
Epoch: 177 train_loss: 0.4292 train_acc: 86.5234
Epoch: 178 train_loss: 0.3837 train_acc: 87.3047
Epoch: 179 train_loss: 0.4219 train_acc: 85.5469
Epoch: 180 train_loss: 0.3921 train_acc: 86.5234
Epoch: 181 train_loss: 0.4231 train_acc: 85.7422
Epoch: 182 train_loss: 0.3980 train_acc: 86.3281
Epoch: 183 train_loss: 0.3885 train_acc: 87.5000
Epoch: 184 train_loss: 0.3933 train_acc: 88.0859
Epoch: 185 train_loss: 0.4356 train_acc: 85.7422
Epoch: 186 train_loss: 0.4872 train_acc: 82.6172
Epoch: 187 train_loss: 0.4003 train_acc: 87.5000
Epoch: 188 train_loss: 0.3766 train_acc: 86.7188
Epoch: 189 train_loss: 0.3877 train_acc: 88.0859
Epoch: 190 train_loss: 0.4065 train_acc: 86.3281
Epoch: 191 train_loss: 0.3681 train_acc: 88.6719
Epoch: 192 train_loss: 0.3757 train_acc: 86.9141
Epoch: 193 train_loss: 0.3476 train_acc: 88.4766
Epoch: 194 train_loss: 0.3914 train_acc: 86.1328
Epoch: 195 train_loss: 0.3579 train_acc: 88.4766
Epoch: 196 train_loss: 0.3512 train_acc: 88.8672
Epoch: 197 train_loss: 0.3351 train_acc: 89.2578
Epoch: 198 train_loss: 0.3391 train_acc: 88.2812
Epoch: 199 train_loss: 0.3209 train_acc: 89.8438
Epoch: 200 train_loss: 0.3385 train_acc: 88.8672
Epoch: 201 train_loss: 0.3486 train_acc: 88.4766
Epoch: 202 train_loss: 0.3978 train_acc: 86.5234
Epoch: 203 train_loss: 0.3541 train_acc: 89.0625
Epoch: 204 train_loss: 0.3213 train_acc: 91.6016
Epoch: 205 train_loss: 0.3341 train_acc: 89.8438
Epoch: 206 train_loss: 0.3138 train_acc: 90.8203
Epoch: 207 train_loss: 0.3116 train_acc: 90.4297
Epoch: 208 train_loss: 0.3404 train_acc: 87.6953
Epoch: 209 train_loss: 0.3134 train_acc: 89.8438
Epoch: 210 train_loss: 0.3072 train_acc: 89.0625
Epoch: 211 train_loss: 0.3467 train_acc: 88.4766
Epoch: 212 train_loss: 0.3476 train_acc: 87.6953
Epoch: 213 train_loss: 0.3174 train_acc: 90.4297
Epoch: 214 train_loss: 0.3451 train_acc: 88.2812
Epoch: 215 train_loss: 0.3381 train_acc: 88.8672
Epoch: 216 train_loss: 0.3155 train_acc: 90.6250
Epoch: 217 train_loss: 0.3105 train_acc: 90.0391
Epoch: 218 train_loss: 0.3098 train_acc: 90.0391
Epoch: 219 train_loss: 0.2953 train_acc: 90.6250
Epoch: 220 train_loss: 0.3102 train_acc: 91.4062
Epoch: 221 train_loss: 0.2944 train_acc: 90.4297
Epoch: 222 train_loss: 0.3084 train_acc: 89.6484
Epoch: 223 train_loss: 0.2771 train_acc: 92.1875
Epoch: 224 train_loss: 0.3007 train_acc: 89.8438
Epoch: 225 train_loss: 0.3119 train_acc: 90.0391
Epoch: 226 train_loss: 0.2916 train_acc: 91.9922
Epoch: 227 train_loss: 0.2795 train_acc: 91.2109
Epoch: 228 train_loss: 0.2671 train_acc: 91.9922
Epoch: 229 train_loss: 0.2442 train_acc: 92.1875
Epoch: 230 train_loss: 0.2893 train_acc: 91.4062
Epoch: 231 train_loss: 0.2670 train_acc: 91.7969
Epoch: 232 train_loss: 0.2497 train_acc: 92.3828
Epoch: 233 train_loss: 0.2821 train_acc: 90.8203
Epoch: 234 train_loss: 0.2830 train_acc: 89.8438
Epoch: 235 train_loss: 0.2510 train_acc: 91.7969
Epoch: 236 train_loss: 0.2385 train_acc: 93.1641
Epoch: 237 train_loss: 0.2702 train_acc: 91.9922
Epoch: 238 train_loss: 0.2911 train_acc: 91.4062
Epoch: 239 train_loss: 0.2570 train_acc: 92.1875
Epoch: 240 train_loss: 0.2357 train_acc: 93.5547
Epoch: 241 train_loss: 0.2611 train_acc: 92.5781
Epoch: 242 train_loss: 0.2368 train_acc: 93.7500
Epoch: 243 train_loss: 0.2711 train_acc: 91.9922
Epoch: 244 train_loss: 0.3117 train_acc: 90.0391
Epoch: 245 train_loss: 0.2597 train_acc: 91.9922
Epoch: 246 train_loss: 0.2551 train_acc: 92.9688
Epoch: 247 train_loss: 0.2506 train_acc: 92.7734
Epoch: 248 train_loss: 0.2647 train_acc: 92.5781
Epoch: 249 train_loss: 0.2815 train_acc: 91.4062
Epoch: 250 train_loss: 0.2524 train_acc: 92.3828
Epoch: 251 train_loss: 0.2849 train_acc: 90.2344
Epoch: 252 train_loss: 0.2585 train_acc: 93.1641
Epoch: 253 train_loss: 0.2685 train_acc: 92.5781
Epoch: 254 train_loss: 0.2479 train_acc: 91.6016
Epoch: 255 train_loss: 0.2248 train_acc: 93.7500
Epoch: 256 train_loss: 0.2547 train_acc: 91.2109
Epoch: 257 train_loss: 0.2346 train_acc: 93.5547
Epoch: 258 train_loss: 0.2650 train_acc: 92.7734
Epoch: 259 train_loss: 0.3082 train_acc: 90.2344
Epoch: 260 train_loss: 0.2353 train_acc: 93.9453
Epoch: 261 train_loss: 0.2296 train_acc: 94.1406
Epoch: 262 train_loss: 0.2165 train_acc: 93.3594
Epoch: 263 train_loss: 0.2240 train_acc: 94.7266
/home/amax/anaconda3/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
Epoch: 264 train_loss: 0.2325 train_acc: 93.3594
Epoch: 265 train_loss: 0.2213 train_acc: 94.3359
Epoch: 266 train_loss: 0.2455 train_acc: 92.5781
Epoch: 267 train_loss: 0.2048 train_acc: 94.9219
Epoch: 268 train_loss: 0.2393 train_acc: 92.5781
Epoch: 269 train_loss: 0.2263 train_acc: 94.9219
Epoch: 270 train_loss: 0.2172 train_acc: 92.7734
Epoch: 271 train_loss: 0.2334 train_acc: 93.1641
Epoch: 272 train_loss: 0.2171 train_acc: 92.9688
Epoch: 273 train_loss: 0.2150 train_acc: 93.9453
Epoch: 274 train_loss: 0.1809 train_acc: 95.3125
Epoch: 275 train_loss: 0.2070 train_acc: 93.7500
Epoch: 276 train_loss: 0.2074 train_acc: 94.3359
Epoch: 277 train_loss: 0.1622 train_acc: 96.0938
Epoch: 278 train_loss: 0.1717 train_acc: 96.2891
Epoch: 279 train_loss: 0.1989 train_acc: 94.3359
Epoch: 280 train_loss: 0.1875 train_acc: 96.4844
Epoch: 281 train_loss: 0.2058 train_acc: 93.1641
Epoch: 282 train_loss: 0.1953 train_acc: 95.7031
Epoch: 283 train_loss: 0.2446 train_acc: 92.1875
Epoch: 284 train_loss: 0.2180 train_acc: 92.9688
Epoch: 285 train_loss: 0.1982 train_acc: 94.3359
Epoch: 286 train_loss: 0.2412 train_acc: 93.3594
Epoch: 287 train_loss: 0.2205 train_acc: 93.3594
Epoch: 288 train_loss: 0.2184 train_acc: 92.9688
Epoch: 289 train_loss: 0.2268 train_acc: 93.3594
Epoch: 290 train_loss: 0.1991 train_acc: 94.5312
Epoch: 291 train_loss: 0.1884 train_acc: 95.1172
Epoch: 292 train_loss: 0.1949 train_acc: 94.3359
Epoch: 293 train_loss: 0.2150 train_acc: 95.1172
Epoch: 294 train_loss: 0.2113 train_acc: 93.5547
Epoch: 295 train_loss: 0.2091 train_acc: 93.9453
Epoch: 296 train_loss: 0.1735 train_acc: 96.4844
Epoch: 297 train_loss: 0.1802 train_acc: 95.1172
Epoch: 298 train_loss: 0.1851 train_acc: 94.3359
Epoch: 299 train_loss: 0.1896 train_acc: 95.7031
Epoch: 300 train_loss: 0.1875 train_acc: 94.7266
Running Time: 167.77
**************************************************
Final result:
OA: 0.7407 | AA: 0.6353 | Kappa: 0.7043
[0.25       0.82092852 0.64974619 0.58666667 0.68845316 0.80835735
 0.22222222 0.95374449 0.15789474 0.63380282 0.73713551 0.5044405
 1.         0.92262895 0.44414169 0.78409091]
**************************************************
Parameter:
dataset: Indian
flag_test: train
mode: CAF
gpu_id: 0
seed: 16
batch_size: 64
test_freq: 5
patches: 7
band_patches: 3
epoches: 300
learning_rate: 0.0005
gamma: 0.9
weight_decay: 0.005
height=145,width=145,band=200
**************************************************
patch is : 7
mirror_image shape : [151,151,200]
**************************************************
x_train shape = (512, 7, 7, 200), type = float64
x_test  shape = (9737, 7, 7, 200), type = float64
x_true  shape = (21025, 7, 7, 200), type = float64
**************************************************
x_train_band shape = (512, 147, 200), type = float64
x_test_band  shape = (9737, 147, 200), type = float64
x_true_band  shape = (21025, 147, 200), type = float64
**************************************************
y_train: shape = (512,) ,type = int64
y_test: shape = (9737,) ,type = int64
y_true: shape = (21025,) ,type = int64
**************************************************
start training
Epoch: 001 train_loss: 2.5685 train_acc: 20.3125
Epoch: 002 train_loss: 2.3751 train_acc: 23.6328
Epoch: 003 train_loss: 2.3295 train_acc: 24.0234
Epoch: 004 train_loss: 2.2714 train_acc: 25.7812
Epoch: 005 train_loss: 2.1195 train_acc: 36.3281
Epoch: 006 train_loss: 1.9258 train_acc: 36.3281
Epoch: 007 train_loss: 1.8303 train_acc: 38.0859
Epoch: 008 train_loss: 1.7621 train_acc: 40.0391
Epoch: 009 train_loss: 1.7246 train_acc: 40.4297
Epoch: 010 train_loss: 1.6876 train_acc: 40.4297
Epoch: 011 train_loss: 1.6538 train_acc: 41.9922
Epoch: 012 train_loss: 1.6160 train_acc: 43.5547
Epoch: 013 train_loss: 1.5848 train_acc: 43.5547
Epoch: 014 train_loss: 1.5540 train_acc: 44.7266
Epoch: 015 train_loss: 1.5145 train_acc: 45.5078
Epoch: 016 train_loss: 1.4854 train_acc: 46.2891
Epoch: 017 train_loss: 1.4711 train_acc: 46.6797
Epoch: 018 train_loss: 1.4340 train_acc: 47.6562
Epoch: 019 train_loss: 1.4231 train_acc: 47.4609
Epoch: 020 train_loss: 1.4099 train_acc: 47.8516
Epoch: 021 train_loss: 1.3804 train_acc: 49.4141
Epoch: 022 train_loss: 1.3796 train_acc: 50.3906
Epoch: 023 train_loss: 1.3621 train_acc: 50.7812
Epoch: 024 train_loss: 1.3690 train_acc: 48.8281
Epoch: 025 train_loss: 1.3357 train_acc: 50.0000
Epoch: 026 train_loss: 1.3461 train_acc: 51.9531
Epoch: 027 train_loss: 1.3343 train_acc: 50.7812
Epoch: 028 train_loss: 1.3085 train_acc: 51.7578
Epoch: 029 train_loss: 1.3119 train_acc: 51.7578
Epoch: 030 train_loss: 1.2913 train_acc: 50.7812
Epoch: 031 train_loss: 1.2809 train_acc: 52.1484
Epoch: 032 train_loss: 1.3035 train_acc: 51.5625
Epoch: 033 train_loss: 1.2938 train_acc: 52.1484
Epoch: 034 train_loss: 1.2711 train_acc: 52.3438
Epoch: 035 train_loss: 1.2612 train_acc: 53.9062
Epoch: 036 train_loss: 1.2584 train_acc: 52.9297
Epoch: 037 train_loss: 1.2587 train_acc: 53.7109
Epoch: 038 train_loss: 1.2499 train_acc: 54.4922
Epoch: 039 train_loss: 1.2453 train_acc: 54.6875
Epoch: 040 train_loss: 1.2436 train_acc: 53.9062
Epoch: 041 train_loss: 1.2560 train_acc: 52.5391
Epoch: 042 train_loss: 1.2824 train_acc: 51.3672
Epoch: 043 train_loss: 1.2240 train_acc: 54.1016
Epoch: 044 train_loss: 1.2129 train_acc: 55.0781
Epoch: 045 train_loss: 1.1982 train_acc: 57.2266
Epoch: 046 train_loss: 1.1833 train_acc: 55.4688
Epoch: 047 train_loss: 1.1956 train_acc: 57.0312
Epoch: 048 train_loss: 1.1825 train_acc: 56.4453
Epoch: 049 train_loss: 1.1694 train_acc: 56.4453
Epoch: 050 train_loss: 1.1657 train_acc: 58.3984
Epoch: 051 train_loss: 1.1786 train_acc: 58.0078
Epoch: 052 train_loss: 1.1527 train_acc: 56.6406
Epoch: 053 train_loss: 1.1416 train_acc: 59.3750
Epoch: 054 train_loss: 1.1404 train_acc: 57.6172
Epoch: 055 train_loss: 1.1496 train_acc: 56.6406
Epoch: 056 train_loss: 1.1571 train_acc: 56.6406
Epoch: 057 train_loss: 1.1491 train_acc: 58.2031
Epoch: 058 train_loss: 1.1429 train_acc: 56.4453
Epoch: 059 train_loss: 1.1251 train_acc: 58.5938
Epoch: 060 train_loss: 1.1162 train_acc: 57.4219
Epoch: 061 train_loss: 1.0827 train_acc: 60.7422
Epoch: 062 train_loss: 1.0855 train_acc: 60.1562
Epoch: 063 train_loss: 1.0490 train_acc: 60.7422
Epoch: 064 train_loss: 1.0542 train_acc: 61.3281
Epoch: 065 train_loss: 1.0256 train_acc: 63.2812
Epoch: 066 train_loss: 1.0232 train_acc: 63.4766
Epoch: 067 train_loss: 1.0130 train_acc: 60.5469
Epoch: 068 train_loss: 1.0229 train_acc: 60.7422
Epoch: 069 train_loss: 1.0280 train_acc: 62.5000
Epoch: 070 train_loss: 1.0311 train_acc: 61.5234
Epoch: 071 train_loss: 1.0345 train_acc: 62.3047
Epoch: 072 train_loss: 0.9740 train_acc: 65.0391
Epoch: 073 train_loss: 1.0194 train_acc: 62.3047
Epoch: 074 train_loss: 1.0223 train_acc: 62.5000
Epoch: 075 train_loss: 1.0115 train_acc: 62.3047
Epoch: 076 train_loss: 0.9917 train_acc: 63.0859
Epoch: 077 train_loss: 0.9974 train_acc: 63.8672
Epoch: 078 train_loss: 0.9739 train_acc: 63.4766
Epoch: 079 train_loss: 0.9593 train_acc: 65.4297
Epoch: 080 train_loss: 0.9463 train_acc: 64.0625
Epoch: 081 train_loss: 0.9345 train_acc: 63.8672
Epoch: 082 train_loss: 0.9446 train_acc: 64.8438
Epoch: 083 train_loss: 0.9230 train_acc: 66.4062
Epoch: 084 train_loss: 0.9343 train_acc: 64.6484
Epoch: 085 train_loss: 0.9486 train_acc: 66.4062
Epoch: 086 train_loss: 0.9069 train_acc: 66.9922
Epoch: 087 train_loss: 0.9227 train_acc: 63.8672
Epoch: 088 train_loss: 0.9317 train_acc: 65.8203
Epoch: 089 train_loss: 0.8579 train_acc: 66.6016
Epoch: 090 train_loss: 0.9022 train_acc: 67.3828
Epoch: 091 train_loss: 0.9142 train_acc: 65.8203
Epoch: 092 train_loss: 0.8634 train_acc: 67.9688
Epoch: 093 train_loss: 0.8707 train_acc: 67.5781
Epoch: 094 train_loss: 0.8377 train_acc: 69.3359
Epoch: 095 train_loss: 0.8272 train_acc: 69.5312
Epoch: 096 train_loss: 0.8237 train_acc: 68.3594
Epoch: 097 train_loss: 0.8356 train_acc: 69.5312
Epoch: 098 train_loss: 0.7820 train_acc: 70.7031
Epoch: 099 train_loss: 0.7630 train_acc: 72.8516
Epoch: 100 train_loss: 0.7627 train_acc: 72.8516
Epoch: 101 train_loss: 0.8007 train_acc: 69.7266
Epoch: 102 train_loss: 0.7769 train_acc: 71.2891
Epoch: 103 train_loss: 0.7656 train_acc: 72.2656
Epoch: 104 train_loss: 0.7402 train_acc: 73.0469
Epoch: 105 train_loss: 0.7286 train_acc: 73.8281
Epoch: 106 train_loss: 0.7443 train_acc: 74.0234
Epoch: 107 train_loss: 0.7373 train_acc: 74.4141
Epoch: 108 train_loss: 0.6961 train_acc: 76.1719
Epoch: 109 train_loss: 0.7574 train_acc: 72.4609
Epoch: 110 train_loss: 0.6935 train_acc: 74.8047
Epoch: 111 train_loss: 0.6929 train_acc: 75.1953
Epoch: 112 train_loss: 0.6878 train_acc: 75.3906
Epoch: 113 train_loss: 0.6967 train_acc: 74.0234
Epoch: 114 train_loss: 0.7261 train_acc: 74.8047
Epoch: 115 train_loss: 0.7105 train_acc: 75.5859
Epoch: 116 train_loss: 0.6993 train_acc: 74.8047
Epoch: 117 train_loss: 0.6248 train_acc: 79.4922
Epoch: 118 train_loss: 0.6486 train_acc: 78.3203
Epoch: 119 train_loss: 0.6656 train_acc: 77.5391
Epoch: 120 train_loss: 0.6799 train_acc: 73.0469
Epoch: 121 train_loss: 0.6227 train_acc: 78.7109
Epoch: 122 train_loss: 0.5669 train_acc: 81.4453
Epoch: 123 train_loss: 0.5569 train_acc: 82.0312
Epoch: 124 train_loss: 0.6275 train_acc: 77.7344
Epoch: 125 train_loss: 0.6681 train_acc: 75.1953
Epoch: 126 train_loss: 0.5898 train_acc: 80.6641
Epoch: 127 train_loss: 0.6134 train_acc: 78.1250
Epoch: 128 train_loss: 0.5607 train_acc: 80.8594
Epoch: 129 train_loss: 0.5590 train_acc: 79.2969
Epoch: 130 train_loss: 0.5158 train_acc: 83.2031
Epoch: 131 train_loss: 0.5305 train_acc: 82.6172
Epoch: 132 train_loss: 0.5462 train_acc: 80.6641
Epoch: 133 train_loss: 0.5648 train_acc: 79.1016
Epoch: 134 train_loss: 0.6060 train_acc: 78.1250
Epoch: 135 train_loss: 0.5521 train_acc: 80.6641
Epoch: 136 train_loss: 0.4878 train_acc: 84.5703
Epoch: 137 train_loss: 0.4710 train_acc: 85.7422
Epoch: 138 train_loss: 0.5048 train_acc: 83.0078
Epoch: 139 train_loss: 0.4984 train_acc: 82.4219
Epoch: 140 train_loss: 0.4964 train_acc: 85.1562
Epoch: 141 train_loss: 0.5022 train_acc: 82.6172
Epoch: 142 train_loss: 0.4977 train_acc: 83.7891
Epoch: 143 train_loss: 0.4748 train_acc: 83.0078
Epoch: 144 train_loss: 0.4603 train_acc: 84.9609
Epoch: 145 train_loss: 0.4998 train_acc: 82.8125
Epoch: 146 train_loss: 0.5690 train_acc: 79.2969
Epoch: 147 train_loss: 0.4386 train_acc: 85.9375
Epoch: 148 train_loss: 0.4423 train_acc: 85.3516
Epoch: 149 train_loss: 0.4417 train_acc: 83.9844
Epoch: 150 train_loss: 0.4438 train_acc: 85.3516
Epoch: 151 train_loss: 0.4336 train_acc: 86.1328
Epoch: 152 train_loss: 0.4082 train_acc: 85.9375
Epoch: 153 train_loss: 0.3988 train_acc: 86.5234
Epoch: 154 train_loss: 0.4175 train_acc: 83.7891
Epoch: 155 train_loss: 0.4046 train_acc: 85.5469
Epoch: 156 train_loss: 0.4352 train_acc: 85.9375
Epoch: 157 train_loss: 0.3840 train_acc: 87.1094
Epoch: 158 train_loss: 0.3919 train_acc: 86.7188
Epoch: 159 train_loss: 0.4170 train_acc: 86.3281
Epoch: 160 train_loss: 0.4536 train_acc: 83.5938
Epoch: 161 train_loss: 0.4526 train_acc: 84.9609
Epoch: 162 train_loss: 0.4512 train_acc: 84.9609
Epoch: 163 train_loss: 0.4015 train_acc: 87.3047
Epoch: 164 train_loss: 0.3842 train_acc: 87.8906
Epoch: 165 train_loss: 0.3805 train_acc: 86.5234
Epoch: 166 train_loss: 0.3609 train_acc: 88.0859
Epoch: 167 train_loss: 0.3557 train_acc: 89.0625
Epoch: 168 train_loss: 0.3637 train_acc: 87.1094
Epoch: 169 train_loss: 0.3099 train_acc: 91.9922
Epoch: 170 train_loss: 0.3185 train_acc: 89.4531
Epoch: 171 train_loss: 0.3338 train_acc: 88.8672
Epoch: 172 train_loss: 0.3039 train_acc: 89.2578
Epoch: 173 train_loss: 0.3053 train_acc: 91.4062
Epoch: 174 train_loss: 0.2843 train_acc: 91.6016
Epoch: 175 train_loss: 0.2653 train_acc: 92.3828
Epoch: 176 train_loss: 0.2922 train_acc: 91.4062
Epoch: 177 train_loss: 0.2746 train_acc: 91.4062
Epoch: 178 train_loss: 0.2849 train_acc: 91.6016
Epoch: 179 train_loss: 0.3074 train_acc: 91.2109
Epoch: 180 train_loss: 0.3231 train_acc: 89.8438
Epoch: 181 train_loss: 0.2887 train_acc: 90.6250
Epoch: 182 train_loss: 0.2802 train_acc: 92.1875
Epoch: 183 train_loss: 0.2883 train_acc: 90.2344
Epoch: 184 train_loss: 0.2815 train_acc: 91.7969
Epoch: 185 train_loss: 0.2730 train_acc: 91.2109
Epoch: 186 train_loss: 0.2450 train_acc: 93.1641
Epoch: 187 train_loss: 0.2582 train_acc: 91.6016
Epoch: 188 train_loss: 0.2538 train_acc: 91.9922
Epoch: 189 train_loss: 0.2445 train_acc: 92.9688
Epoch: 190 train_loss: 0.2484 train_acc: 91.6016
Epoch: 191 train_loss: 0.2464 train_acc: 94.3359
Epoch: 192 train_loss: 0.2625 train_acc: 92.1875
Epoch: 193 train_loss: 0.2848 train_acc: 91.0156
Epoch: 194 train_loss: 0.3011 train_acc: 88.8672
Epoch: 195 train_loss: 0.2313 train_acc: 93.7500
Epoch: 196 train_loss: 0.2362 train_acc: 93.5547
Epoch: 197 train_loss: 0.2404 train_acc: 93.3594
Epoch: 198 train_loss: 0.2595 train_acc: 92.5781
Epoch: 199 train_loss: 0.2728 train_acc: 91.6016
Epoch: 200 train_loss: 0.2657 train_acc: 90.6250
Epoch: 201 train_loss: 0.2346 train_acc: 92.7734
Epoch: 202 train_loss: 0.2561 train_acc: 92.1875
Epoch: 203 train_loss: 0.2974 train_acc: 89.6484
Epoch: 204 train_loss: 0.2630 train_acc: 92.7734
Epoch: 205 train_loss: 0.2619 train_acc: 91.9922
Epoch: 206 train_loss: 0.2559 train_acc: 91.9922
Epoch: 207 train_loss: 0.2488 train_acc: 92.5781
Epoch: 208 train_loss: 0.2542 train_acc: 91.6016
Epoch: 209 train_loss: 0.2259 train_acc: 94.1406
Epoch: 210 train_loss: 0.2111 train_acc: 94.3359
Epoch: 211 train_loss: 0.2101 train_acc: 93.9453
Epoch: 212 train_loss: 0.2089 train_acc: 93.9453
Epoch: 213 train_loss: 0.1908 train_acc: 94.5312
Epoch: 214 train_loss: 0.2135 train_acc: 94.9219
Epoch: 215 train_loss: 0.2097 train_acc: 93.9453
Epoch: 216 train_loss: 0.2196 train_acc: 93.1641
Epoch: 217 train_loss: 0.1896 train_acc: 94.1406
Epoch: 218 train_loss: 0.1956 train_acc: 93.9453
Epoch: 219 train_loss: 0.1978 train_acc: 94.9219
Epoch: 220 train_loss: 0.2042 train_acc: 93.9453
Epoch: 221 train_loss: 0.2178 train_acc: 93.7500
Epoch: 222 train_loss: 0.2127 train_acc: 93.5547
Epoch: 223 train_loss: 0.1929 train_acc: 94.3359
Epoch: 224 train_loss: 0.2132 train_acc: 94.3359
Epoch: 225 train_loss: 0.2056 train_acc: 94.7266
Epoch: 226 train_loss: 0.1834 train_acc: 95.3125
Epoch: 227 train_loss: 0.2186 train_acc: 93.5547
Epoch: 228 train_loss: 0.2384 train_acc: 93.3594
Epoch: 229 train_loss: 0.2045 train_acc: 93.9453
Epoch: 230 train_loss: 0.1874 train_acc: 95.8984
Epoch: 231 train_loss: 0.1866 train_acc: 95.5078
Epoch: 232 train_loss: 0.1763 train_acc: 95.8984
Epoch: 233 train_loss: 0.1640 train_acc: 95.3125
Epoch: 234 train_loss: 0.1769 train_acc: 95.8984
Epoch: 235 train_loss: 0.1914 train_acc: 94.1406
Epoch: 236 train_loss: 0.2037 train_acc: 93.1641
Epoch: 237 train_loss: 0.2062 train_acc: 92.5781
Epoch: 238 train_loss: 0.2130 train_acc: 94.1406
Epoch: 239 train_loss: 0.2120 train_acc: 93.9453
Epoch: 240 train_loss: 0.1668 train_acc: 95.3125
Epoch: 241 train_loss: 0.1619 train_acc: 95.5078
Epoch: 242 train_loss: 0.1892 train_acc: 94.7266
Epoch: 243 train_loss: 0.1849 train_acc: 95.5078
Epoch: 244 train_loss: 0.1406 train_acc: 96.8750
Epoch: 245 train_loss: 0.1592 train_acc: 96.0938
Epoch: 246 train_loss: 0.1330 train_acc: 97.0703
Epoch: 247 train_loss: 0.1517 train_acc: 95.5078
Epoch: 248 train_loss: 0.1527 train_acc: 95.5078
Epoch: 249 train_loss: 0.1851 train_acc: 94.5312
Epoch: 250 train_loss: 0.1462 train_acc: 96.4844
Epoch: 251 train_loss: 0.1348 train_acc: 96.6797
Epoch: 252 train_loss: 0.1388 train_acc: 96.4844
Epoch: 253 train_loss: 0.1740 train_acc: 95.1172
Epoch: 254 train_loss: 0.1701 train_acc: 94.7266
Epoch: 255 train_loss: 0.1634 train_acc: 95.1172
Epoch: 256 train_loss: 0.1609 train_acc: 95.7031
Epoch: 257 train_loss: 0.1483 train_acc: 96.2891
Epoch: 258 train_loss: 0.1521 train_acc: 95.7031
Epoch: 259 train_loss: 0.1316 train_acc: 97.6562
Epoch: 260 train_loss: 0.1304 train_acc: 96.4844
Epoch: 261 train_loss: 0.1723 train_acc: 94.9219
Epoch: 262 train_loss: 0.1638 train_acc: 95.7031
Epoch: 263 train_loss: 0.1349 train_acc: 97.6562
Epoch: 264 train_loss: 0.1453 train_acc: 97.2656
Epoch: 265 train_loss: 0.1543 train_acc: 96.0938
Epoch: 266 train_loss: 0.1354 train_acc: 97.6562
Epoch: 267 train_loss: 0.1298 train_acc: 96.0938
Epoch: 268 train_loss: 0.1218 train_acc: 98.4375
Epoch: 269 train_loss: 0.1894 train_acc: 94.3359
Epoch: 270 train_loss: 0.1761 train_acc: 95.5078
/home/amax/anaconda3/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
Epoch: 271 train_loss: 0.1686 train_acc: 96.0938
Epoch: 272 train_loss: 0.1726 train_acc: 95.7031
Epoch: 273 train_loss: 0.1620 train_acc: 95.8984
Epoch: 274 train_loss: 0.1322 train_acc: 96.8750
Epoch: 275 train_loss: 0.1741 train_acc: 95.7031
Epoch: 276 train_loss: 0.1740 train_acc: 95.3125
Epoch: 277 train_loss: 0.1510 train_acc: 94.9219
Epoch: 278 train_loss: 0.1259 train_acc: 97.2656
Epoch: 279 train_loss: 0.1091 train_acc: 98.0469
Epoch: 280 train_loss: 0.1269 train_acc: 97.2656
Epoch: 281 train_loss: 0.1268 train_acc: 96.8750
Epoch: 282 train_loss: 0.1234 train_acc: 97.2656
Epoch: 283 train_loss: 0.1294 train_acc: 96.0938
Epoch: 284 train_loss: 0.1286 train_acc: 96.8750
Epoch: 285 train_loss: 0.1037 train_acc: 98.2422
Epoch: 286 train_loss: 0.1282 train_acc: 96.4844
Epoch: 287 train_loss: 0.1095 train_acc: 97.6562
Epoch: 288 train_loss: 0.1080 train_acc: 98.0469
Epoch: 289 train_loss: 0.1284 train_acc: 96.8750
Epoch: 290 train_loss: 0.1257 train_acc: 97.2656
Epoch: 291 train_loss: 0.1519 train_acc: 95.7031
Epoch: 292 train_loss: 0.1247 train_acc: 96.6797
Epoch: 293 train_loss: 0.1967 train_acc: 94.1406
Epoch: 294 train_loss: 0.1239 train_acc: 97.2656
Epoch: 295 train_loss: 0.1093 train_acc: 98.4375
Epoch: 296 train_loss: 0.1156 train_acc: 97.0703
Epoch: 297 train_loss: 0.1082 train_acc: 97.8516
Epoch: 298 train_loss: 0.0952 train_acc: 98.4375
Epoch: 299 train_loss: 0.1192 train_acc: 97.8516
Epoch: 300 train_loss: 0.1229 train_acc: 96.4844
Running Time: 167.98
**************************************************
Final result:
OA: 0.7621 | AA: 0.6498 | Kappa: 0.7302
[0.15909091 0.73249816 0.67766497 0.60444444 0.75816993 0.90201729
 0.03703704 0.95594714 0.36842105 0.8624052  0.7161235  0.68383659
 0.92307692 0.86772047 0.56948229 0.57954545]
**************************************************
Parameter:
dataset: Indian
flag_test: train
mode: CAF
gpu_id: 0
seed: 17
batch_size: 64
test_freq: 5
patches: 7
band_patches: 3
epoches: 300
learning_rate: 0.0005
gamma: 0.9
weight_decay: 0.005
height=145,width=145,band=200
**************************************************
patch is : 7
mirror_image shape : [151,151,200]
**************************************************
x_train shape = (512, 7, 7, 200), type = float64
x_test  shape = (9737, 7, 7, 200), type = float64
x_true  shape = (21025, 7, 7, 200), type = float64
**************************************************
x_train_band shape = (512, 147, 200), type = float64
x_test_band  shape = (9737, 147, 200), type = float64
x_true_band  shape = (21025, 147, 200), type = float64
**************************************************
y_train: shape = (512,) ,type = int64
y_test: shape = (9737,) ,type = int64
y_true: shape = (21025,) ,type = int64
**************************************************
start training
Epoch: 001 train_loss: 2.5276 train_acc: 22.0703
Epoch: 002 train_loss: 2.3590 train_acc: 24.0234
Epoch: 003 train_loss: 2.2941 train_acc: 24.8047
Epoch: 004 train_loss: 2.1776 train_acc: 34.7656
Epoch: 005 train_loss: 2.0177 train_acc: 35.7422
Epoch: 006 train_loss: 1.9007 train_acc: 36.3281
Epoch: 007 train_loss: 1.8169 train_acc: 38.6719
Epoch: 008 train_loss: 1.7728 train_acc: 40.4297
Epoch: 009 train_loss: 1.7258 train_acc: 42.1875
Epoch: 010 train_loss: 1.6873 train_acc: 42.3828
Epoch: 011 train_loss: 1.6603 train_acc: 41.9922
Epoch: 012 train_loss: 1.6380 train_acc: 43.1641
Epoch: 013 train_loss: 1.5993 train_acc: 45.3125
Epoch: 014 train_loss: 1.5579 train_acc: 45.5078
Epoch: 015 train_loss: 1.5516 train_acc: 45.1172
Epoch: 016 train_loss: 1.5192 train_acc: 46.0938
Epoch: 017 train_loss: 1.4769 train_acc: 46.8750
Epoch: 018 train_loss: 1.4609 train_acc: 48.4375
Epoch: 019 train_loss: 1.4447 train_acc: 48.2422
Epoch: 020 train_loss: 1.4103 train_acc: 48.8281
Epoch: 021 train_loss: 1.4059 train_acc: 49.4141
Epoch: 022 train_loss: 1.3795 train_acc: 50.7812
Epoch: 023 train_loss: 1.3694 train_acc: 49.6094
Epoch: 024 train_loss: 1.3881 train_acc: 48.6328
Epoch: 025 train_loss: 1.3576 train_acc: 51.5625
Epoch: 026 train_loss: 1.3347 train_acc: 50.3906
Epoch: 027 train_loss: 1.3267 train_acc: 54.1016
Epoch: 028 train_loss: 1.3040 train_acc: 52.7344
Epoch: 029 train_loss: 1.2964 train_acc: 53.1250
Epoch: 030 train_loss: 1.2791 train_acc: 53.9062
Epoch: 031 train_loss: 1.2802 train_acc: 54.8828
Epoch: 032 train_loss: 1.2563 train_acc: 55.8594
Epoch: 033 train_loss: 1.2499 train_acc: 56.2500
Epoch: 034 train_loss: 1.2589 train_acc: 55.4688
Epoch: 035 train_loss: 1.2657 train_acc: 52.7344
Epoch: 036 train_loss: 1.2644 train_acc: 53.7109
Epoch: 037 train_loss: 1.2680 train_acc: 54.2969
Epoch: 038 train_loss: 1.2256 train_acc: 56.6406
Epoch: 039 train_loss: 1.2196 train_acc: 56.6406
Epoch: 040 train_loss: 1.2066 train_acc: 57.0312
Epoch: 041 train_loss: 1.1976 train_acc: 58.2031
Epoch: 042 train_loss: 1.2077 train_acc: 57.8125
Epoch: 043 train_loss: 1.1960 train_acc: 56.2500
Epoch: 044 train_loss: 1.2000 train_acc: 55.6641
Epoch: 045 train_loss: 1.2093 train_acc: 54.8828
Epoch: 046 train_loss: 1.1379 train_acc: 59.9609
Epoch: 047 train_loss: 1.1460 train_acc: 59.9609
Epoch: 048 train_loss: 1.1262 train_acc: 60.7422
Epoch: 049 train_loss: 1.1188 train_acc: 59.7656
Epoch: 050 train_loss: 1.0987 train_acc: 61.7188
Epoch: 051 train_loss: 1.1086 train_acc: 58.3984
Epoch: 052 train_loss: 1.0851 train_acc: 60.7422
Epoch: 053 train_loss: 1.1090 train_acc: 59.3750
Epoch: 054 train_loss: 1.0999 train_acc: 60.3516
Epoch: 055 train_loss: 1.0839 train_acc: 60.9375
Epoch: 056 train_loss: 1.0848 train_acc: 61.3281
Epoch: 057 train_loss: 1.0806 train_acc: 60.9375
Epoch: 058 train_loss: 1.1148 train_acc: 58.9844
Epoch: 059 train_loss: 1.0933 train_acc: 59.1797
Epoch: 060 train_loss: 1.0623 train_acc: 61.1328
Epoch: 061 train_loss: 1.0447 train_acc: 61.5234
Epoch: 062 train_loss: 1.0488 train_acc: 61.9141
Epoch: 063 train_loss: 1.0187 train_acc: 63.8672
Epoch: 064 train_loss: 1.0074 train_acc: 63.8672
Epoch: 065 train_loss: 1.0252 train_acc: 63.8672
Epoch: 066 train_loss: 1.0086 train_acc: 63.6719
Epoch: 067 train_loss: 1.0078 train_acc: 62.3047
Epoch: 068 train_loss: 1.0173 train_acc: 63.8672
Epoch: 069 train_loss: 1.0029 train_acc: 62.6953
Epoch: 070 train_loss: 0.9805 train_acc: 65.0391
Epoch: 071 train_loss: 1.0158 train_acc: 63.6719
Epoch: 072 train_loss: 0.9471 train_acc: 67.9688
Epoch: 073 train_loss: 0.9494 train_acc: 66.0156
Epoch: 074 train_loss: 0.9383 train_acc: 66.7969
Epoch: 075 train_loss: 0.9624 train_acc: 64.6484
Epoch: 076 train_loss: 0.9219 train_acc: 65.8203
Epoch: 077 train_loss: 0.9286 train_acc: 65.0391
Epoch: 078 train_loss: 0.9481 train_acc: 66.2109
Epoch: 079 train_loss: 0.9622 train_acc: 63.6719
Epoch: 080 train_loss: 0.9167 train_acc: 68.7500
Epoch: 081 train_loss: 0.9038 train_acc: 67.3828
Epoch: 082 train_loss: 0.8893 train_acc: 65.6250
Epoch: 083 train_loss: 0.8804 train_acc: 66.7969
Epoch: 084 train_loss: 0.9010 train_acc: 66.2109
Epoch: 085 train_loss: 0.8540 train_acc: 67.9688
Epoch: 086 train_loss: 0.8558 train_acc: 68.5547
Epoch: 087 train_loss: 0.8866 train_acc: 67.1875
Epoch: 088 train_loss: 0.8760 train_acc: 68.1641
Epoch: 089 train_loss: 0.8503 train_acc: 69.7266
Epoch: 090 train_loss: 0.8136 train_acc: 69.9219
Epoch: 091 train_loss: 0.8629 train_acc: 67.3828
Epoch: 092 train_loss: 0.8153 train_acc: 71.2891
Epoch: 093 train_loss: 0.8221 train_acc: 69.5312
Epoch: 094 train_loss: 0.8273 train_acc: 70.3125
Epoch: 095 train_loss: 0.8079 train_acc: 70.1172
Epoch: 096 train_loss: 0.7993 train_acc: 72.0703
Epoch: 097 train_loss: 0.8403 train_acc: 69.1406
Epoch: 098 train_loss: 0.8368 train_acc: 68.3594
Epoch: 099 train_loss: 0.7948 train_acc: 71.0938
Epoch: 100 train_loss: 0.8306 train_acc: 71.8750
Epoch: 101 train_loss: 0.7474 train_acc: 72.2656
Epoch: 102 train_loss: 0.7783 train_acc: 74.2188
Epoch: 103 train_loss: 0.7896 train_acc: 71.8750
Epoch: 104 train_loss: 0.7540 train_acc: 72.8516
Epoch: 105 train_loss: 0.7029 train_acc: 77.3438
Epoch: 106 train_loss: 0.6997 train_acc: 74.6094
Epoch: 107 train_loss: 0.7341 train_acc: 74.0234
Epoch: 108 train_loss: 0.7436 train_acc: 72.8516
Epoch: 109 train_loss: 0.7083 train_acc: 75.5859
Epoch: 110 train_loss: 0.7000 train_acc: 74.6094
Epoch: 111 train_loss: 0.6480 train_acc: 79.6875
Epoch: 112 train_loss: 0.6789 train_acc: 77.1484
Epoch: 113 train_loss: 0.7366 train_acc: 72.8516
Epoch: 114 train_loss: 0.7016 train_acc: 74.2188
Epoch: 115 train_loss: 0.6906 train_acc: 76.9531
Epoch: 116 train_loss: 0.6122 train_acc: 79.1016
Epoch: 117 train_loss: 0.6731 train_acc: 75.9766
Epoch: 118 train_loss: 0.6790 train_acc: 74.6094
Epoch: 119 train_loss: 0.6872 train_acc: 74.8047
Epoch: 120 train_loss: 0.6734 train_acc: 76.1719
Epoch: 121 train_loss: 0.6515 train_acc: 77.7344
Epoch: 122 train_loss: 0.6835 train_acc: 74.6094
Epoch: 123 train_loss: 0.6769 train_acc: 75.9766
Epoch: 124 train_loss: 0.5975 train_acc: 79.4922
Epoch: 125 train_loss: 0.6281 train_acc: 78.3203
Epoch: 126 train_loss: 0.5605 train_acc: 81.6406
Epoch: 127 train_loss: 0.5669 train_acc: 80.6641
Epoch: 128 train_loss: 0.5735 train_acc: 82.6172
Epoch: 129 train_loss: 0.5510 train_acc: 82.0312
Epoch: 130 train_loss: 0.5828 train_acc: 78.7109
Epoch: 131 train_loss: 0.5705 train_acc: 81.6406
Epoch: 132 train_loss: 0.5845 train_acc: 79.8828
Epoch: 133 train_loss: 0.5416 train_acc: 82.6172
Epoch: 134 train_loss: 0.5481 train_acc: 82.6172
Epoch: 135 train_loss: 0.5172 train_acc: 83.0078
Epoch: 136 train_loss: 0.5009 train_acc: 83.9844
Epoch: 137 train_loss: 0.5243 train_acc: 81.8359
Epoch: 138 train_loss: 0.5328 train_acc: 83.0078
Epoch: 139 train_loss: 0.5194 train_acc: 82.4219
Epoch: 140 train_loss: 0.5812 train_acc: 79.4922
Epoch: 141 train_loss: 0.6114 train_acc: 79.2969
Epoch: 142 train_loss: 0.5804 train_acc: 80.6641
Epoch: 143 train_loss: 0.5554 train_acc: 82.2266
Epoch: 144 train_loss: 0.4820 train_acc: 83.3984
Epoch: 145 train_loss: 0.5061 train_acc: 84.3750
Epoch: 146 train_loss: 0.4551 train_acc: 86.9141
Epoch: 147 train_loss: 0.4853 train_acc: 85.7422
Epoch: 148 train_loss: 0.4544 train_acc: 85.9375
Epoch: 149 train_loss: 0.4419 train_acc: 85.3516
Epoch: 150 train_loss: 0.4783 train_acc: 83.3984
Epoch: 151 train_loss: 0.4574 train_acc: 84.1797
Epoch: 152 train_loss: 0.4465 train_acc: 86.9141
Epoch: 153 train_loss: 0.4745 train_acc: 83.7891
Epoch: 154 train_loss: 0.4361 train_acc: 86.1328
Epoch: 155 train_loss: 0.4383 train_acc: 86.1328
Epoch: 156 train_loss: 0.4208 train_acc: 86.9141
Epoch: 157 train_loss: 0.4177 train_acc: 86.5234
Epoch: 158 train_loss: 0.4402 train_acc: 88.2812
Epoch: 159 train_loss: 0.4106 train_acc: 86.1328
Epoch: 160 train_loss: 0.4572 train_acc: 83.5938
Epoch: 161 train_loss: 0.4361 train_acc: 86.3281
Epoch: 162 train_loss: 0.4190 train_acc: 87.1094
Epoch: 163 train_loss: 0.3858 train_acc: 87.3047
Epoch: 164 train_loss: 0.4084 train_acc: 88.2812
Epoch: 165 train_loss: 0.3733 train_acc: 88.6719
Epoch: 166 train_loss: 0.3567 train_acc: 89.4531
Epoch: 167 train_loss: 0.3732 train_acc: 89.0625
Epoch: 168 train_loss: 0.3862 train_acc: 87.6953
Epoch: 169 train_loss: 0.3603 train_acc: 89.6484
Epoch: 170 train_loss: 0.4045 train_acc: 87.6953
Epoch: 171 train_loss: 0.3859 train_acc: 87.8906
Epoch: 172 train_loss: 0.3798 train_acc: 87.3047
Epoch: 173 train_loss: 0.3671 train_acc: 89.2578
Epoch: 174 train_loss: 0.3775 train_acc: 89.2578
Epoch: 175 train_loss: 0.3928 train_acc: 86.9141
Epoch: 176 train_loss: 0.3688 train_acc: 87.6953
Epoch: 177 train_loss: 0.3555 train_acc: 88.4766
Epoch: 178 train_loss: 0.3476 train_acc: 89.8438
Epoch: 179 train_loss: 0.3567 train_acc: 90.2344
Epoch: 180 train_loss: 0.3232 train_acc: 91.9922
Epoch: 181 train_loss: 0.3248 train_acc: 90.8203
Epoch: 182 train_loss: 0.3102 train_acc: 90.6250
Epoch: 183 train_loss: 0.3089 train_acc: 91.2109
Epoch: 184 train_loss: 0.3344 train_acc: 90.2344
Epoch: 185 train_loss: 0.3248 train_acc: 89.0625
Epoch: 186 train_loss: 0.3141 train_acc: 89.4531
Epoch: 187 train_loss: 0.3296 train_acc: 91.0156
Epoch: 188 train_loss: 0.3182 train_acc: 90.0391
Epoch: 189 train_loss: 0.2931 train_acc: 91.9922
Epoch: 190 train_loss: 0.2936 train_acc: 90.8203
Epoch: 191 train_loss: 0.3237 train_acc: 88.4766
Epoch: 192 train_loss: 0.2781 train_acc: 92.5781
Epoch: 193 train_loss: 0.2656 train_acc: 93.7500
Epoch: 194 train_loss: 0.2968 train_acc: 91.0156
Epoch: 195 train_loss: 0.2869 train_acc: 92.1875
Epoch: 196 train_loss: 0.2940 train_acc: 89.6484
Epoch: 197 train_loss: 0.2611 train_acc: 93.3594
Epoch: 198 train_loss: 0.3148 train_acc: 90.0391
Epoch: 199 train_loss: 0.2704 train_acc: 93.1641
Epoch: 200 train_loss: 0.2817 train_acc: 90.2344
Epoch: 201 train_loss: 0.3055 train_acc: 92.3828
Epoch: 202 train_loss: 0.2646 train_acc: 91.9922
Epoch: 203 train_loss: 0.3066 train_acc: 91.9922
Epoch: 204 train_loss: 0.2788 train_acc: 92.5781
Epoch: 205 train_loss: 0.2612 train_acc: 91.7969
Epoch: 206 train_loss: 0.2720 train_acc: 91.2109
Epoch: 207 train_loss: 0.2678 train_acc: 92.1875
Epoch: 208 train_loss: 0.2508 train_acc: 92.5781
Epoch: 209 train_loss: 0.2962 train_acc: 90.8203
Epoch: 210 train_loss: 0.2612 train_acc: 91.4062
Epoch: 211 train_loss: 0.2574 train_acc: 92.5781
Epoch: 212 train_loss: 0.2613 train_acc: 93.3594
Epoch: 213 train_loss: 0.2481 train_acc: 93.1641
Epoch: 214 train_loss: 0.2373 train_acc: 94.1406
Epoch: 215 train_loss: 0.2246 train_acc: 95.1172
Epoch: 216 train_loss: 0.2203 train_acc: 94.1406
Epoch: 217 train_loss: 0.2355 train_acc: 93.1641
Epoch: 218 train_loss: 0.2381 train_acc: 93.7500
Epoch: 219 train_loss: 0.2225 train_acc: 95.3125
Epoch: 220 train_loss: 0.2503 train_acc: 92.7734
Epoch: 221 train_loss: 0.2254 train_acc: 94.1406
Epoch: 222 train_loss: 0.2333 train_acc: 92.3828
Epoch: 223 train_loss: 0.2145 train_acc: 93.7500
Epoch: 224 train_loss: 0.2161 train_acc: 94.9219
Epoch: 225 train_loss: 0.1818 train_acc: 95.3125
Epoch: 226 train_loss: 0.2194 train_acc: 93.9453
Epoch: 227 train_loss: 0.2119 train_acc: 94.5312
Epoch: 228 train_loss: 0.1904 train_acc: 94.7266
Epoch: 229 train_loss: 0.1840 train_acc: 94.5312
Epoch: 230 train_loss: 0.1897 train_acc: 94.9219
Epoch: 231 train_loss: 0.2118 train_acc: 93.9453
Epoch: 232 train_loss: 0.2293 train_acc: 92.9688
Epoch: 233 train_loss: 0.2288 train_acc: 92.9688
Epoch: 234 train_loss: 0.2478 train_acc: 92.5781
Epoch: 235 train_loss: 0.2369 train_acc: 93.9453
Epoch: 236 train_loss: 0.2364 train_acc: 93.3594
Epoch: 237 train_loss: 0.2112 train_acc: 94.5312
Epoch: 238 train_loss: 0.2124 train_acc: 94.1406
Epoch: 239 train_loss: 0.2206 train_acc: 93.7500
Epoch: 240 train_loss: 0.2320 train_acc: 93.1641
Epoch: 241 train_loss: 0.2105 train_acc: 95.1172
Epoch: 242 train_loss: 0.2168 train_acc: 93.9453
Epoch: 243 train_loss: 0.1987 train_acc: 94.7266
Epoch: 244 train_loss: 0.1727 train_acc: 95.3125
Epoch: 245 train_loss: 0.1856 train_acc: 94.3359
Epoch: 246 train_loss: 0.1994 train_acc: 94.5312
Epoch: 247 train_loss: 0.1812 train_acc: 95.5078
Epoch: 248 train_loss: 0.1803 train_acc: 95.5078
Epoch: 249 train_loss: 0.1782 train_acc: 95.7031
Epoch: 250 train_loss: 0.1680 train_acc: 96.4844
Epoch: 251 train_loss: 0.1900 train_acc: 95.1172
Epoch: 252 train_loss: 0.1968 train_acc: 93.7500
Epoch: 253 train_loss: 0.1888 train_acc: 96.2891
Epoch: 254 train_loss: 0.1819 train_acc: 96.6797
Epoch: 255 train_loss: 0.1833 train_acc: 95.5078
Epoch: 256 train_loss: 0.1718 train_acc: 95.3125
Epoch: 257 train_loss: 0.2224 train_acc: 93.5547
Epoch: 258 train_loss: 0.1939 train_acc: 94.9219
Epoch: 259 train_loss: 0.2207 train_acc: 93.1641
Epoch: 260 train_loss: 0.1779 train_acc: 95.8984
Epoch: 261 train_loss: 0.1778 train_acc: 94.9219
Epoch: 262 train_loss: 0.1354 train_acc: 97.4609
Epoch: 263 train_loss: 0.1279 train_acc: 97.4609
Epoch: 264 train_loss: 0.1385 train_acc: 96.8750
Epoch: 265 train_loss: 0.1498 train_acc: 95.7031
Epoch: 266 train_loss: 0.1417 train_acc: 96.8750
Epoch: 267 train_loss: 0.1637 train_acc: 95.8984
Epoch: 268 train_loss: 0.1815 train_acc: 94.9219
Epoch: 269 train_loss: 0.1804 train_acc: 95.7031
Epoch: 270 train_loss: 0.1510 train_acc: 96.4844
Epoch: 271 train_loss: 0.1440 train_acc: 97.2656
Epoch: 272 train_loss: 0.1297 train_acc: 97.0703
Epoch: 273 train_loss: 0.1303 train_acc: 97.2656
Epoch: 274 train_loss: 0.1407 train_acc: 96.6797
Epoch: 275 train_loss: 0.1217 train_acc: 97.6562
Epoch: 276 train_loss: 0.1335 train_acc: 96.8750
Epoch: 277 train_loss: 0.1475 train_acc: 96.4844
/home/amax/anaconda3/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
Epoch: 278 train_loss: 0.1462 train_acc: 95.7031
Epoch: 279 train_loss: 0.1705 train_acc: 95.3125
Epoch: 280 train_loss: 0.1661 train_acc: 95.8984
Epoch: 281 train_loss: 0.1581 train_acc: 95.8984
Epoch: 282 train_loss: 0.1574 train_acc: 95.7031
Epoch: 283 train_loss: 0.1691 train_acc: 95.8984
Epoch: 284 train_loss: 0.1929 train_acc: 94.1406
Epoch: 285 train_loss: 0.1361 train_acc: 97.0703
Epoch: 286 train_loss: 0.1531 train_acc: 96.8750
Epoch: 287 train_loss: 0.1517 train_acc: 96.2891
Epoch: 288 train_loss: 0.1488 train_acc: 96.6797
Epoch: 289 train_loss: 0.1388 train_acc: 96.0938
Epoch: 290 train_loss: 0.1557 train_acc: 95.8984
Epoch: 291 train_loss: 0.1340 train_acc: 97.2656
Epoch: 292 train_loss: 0.1255 train_acc: 97.2656
Epoch: 293 train_loss: 0.1019 train_acc: 98.2422
Epoch: 294 train_loss: 0.1074 train_acc: 98.0469
Epoch: 295 train_loss: 0.1354 train_acc: 96.4844
Epoch: 296 train_loss: 0.1573 train_acc: 95.8984
Epoch: 297 train_loss: 0.2061 train_acc: 94.1406
Epoch: 298 train_loss: 0.1620 train_acc: 94.1406
Epoch: 299 train_loss: 0.1609 train_acc: 95.7031
Epoch: 300 train_loss: 0.1495 train_acc: 96.4844
Running Time: 168.47
**************************************************
Final result:
OA: 0.7881 | AA: 0.6543 | Kappa: 0.7592
[0.09090909 0.78850405 0.71573604 0.32888889 0.79738562 0.89481268
 0.11111111 0.99118943 0.21052632 0.94907909 0.76801029 0.64298401
 0.99487179 0.87936772 0.44141689 0.86363636]
**************************************************
Parameter:
dataset: Indian
flag_test: train
mode: CAF
gpu_id: 0
seed: 18
batch_size: 64
test_freq: 5
patches: 7
band_patches: 3
epoches: 300
learning_rate: 0.0005
gamma: 0.9
weight_decay: 0.005
height=145,width=145,band=200
**************************************************
patch is : 7
mirror_image shape : [151,151,200]
**************************************************
x_train shape = (512, 7, 7, 200), type = float64
x_test  shape = (9737, 7, 7, 200), type = float64
x_true  shape = (21025, 7, 7, 200), type = float64
**************************************************
x_train_band shape = (512, 147, 200), type = float64
x_test_band  shape = (9737, 147, 200), type = float64
x_true_band  shape = (21025, 147, 200), type = float64
**************************************************
y_train: shape = (512,) ,type = int64
y_test: shape = (9737,) ,type = int64
y_true: shape = (21025,) ,type = int64
**************************************************
start training
Epoch: 001 train_loss: 2.5175 train_acc: 20.5078
Epoch: 002 train_loss: 2.3621 train_acc: 24.4141
Epoch: 003 train_loss: 2.2007 train_acc: 34.7656
Epoch: 004 train_loss: 2.0056 train_acc: 35.5469
Epoch: 005 train_loss: 1.8697 train_acc: 36.5234
Epoch: 006 train_loss: 1.8072 train_acc: 38.0859
Epoch: 007 train_loss: 1.7526 train_acc: 38.2812
Epoch: 008 train_loss: 1.7062 train_acc: 40.4297
Epoch: 009 train_loss: 1.6778 train_acc: 41.2109
Epoch: 010 train_loss: 1.6336 train_acc: 42.7734
Epoch: 011 train_loss: 1.6126 train_acc: 41.7969
Epoch: 012 train_loss: 1.5779 train_acc: 43.1641
Epoch: 013 train_loss: 1.5456 train_acc: 45.1172
Epoch: 014 train_loss: 1.5173 train_acc: 44.5312
Epoch: 015 train_loss: 1.4983 train_acc: 45.8984
Epoch: 016 train_loss: 1.4569 train_acc: 46.6797
Epoch: 017 train_loss: 1.4385 train_acc: 46.6797
Epoch: 018 train_loss: 1.3985 train_acc: 48.2422
Epoch: 019 train_loss: 1.3836 train_acc: 48.4375
Epoch: 020 train_loss: 1.3669 train_acc: 48.6328
Epoch: 021 train_loss: 1.3529 train_acc: 50.5859
Epoch: 022 train_loss: 1.3538 train_acc: 49.6094
Epoch: 023 train_loss: 1.3311 train_acc: 49.0234
Epoch: 024 train_loss: 1.3166 train_acc: 50.0000
Epoch: 025 train_loss: 1.3242 train_acc: 49.6094
Epoch: 026 train_loss: 1.2891 train_acc: 50.9766
Epoch: 027 train_loss: 1.2901 train_acc: 50.3906
Epoch: 028 train_loss: 1.2470 train_acc: 51.1719
Epoch: 029 train_loss: 1.2791 train_acc: 52.9297
Epoch: 030 train_loss: 1.2548 train_acc: 52.1484
Epoch: 031 train_loss: 1.2461 train_acc: 52.7344
Epoch: 032 train_loss: 1.2251 train_acc: 51.9531
Epoch: 033 train_loss: 1.2416 train_acc: 51.7578
Epoch: 034 train_loss: 1.2071 train_acc: 53.3203
Epoch: 035 train_loss: 1.2074 train_acc: 53.3203
Epoch: 036 train_loss: 1.2016 train_acc: 55.0781
Epoch: 037 train_loss: 1.1782 train_acc: 55.2734
Epoch: 038 train_loss: 1.1880 train_acc: 55.4688
Epoch: 039 train_loss: 1.1718 train_acc: 56.0547
Epoch: 040 train_loss: 1.1614 train_acc: 55.2734
Epoch: 041 train_loss: 1.1599 train_acc: 55.6641
Epoch: 042 train_loss: 1.1468 train_acc: 56.0547
Epoch: 043 train_loss: 1.1317 train_acc: 56.4453
Epoch: 044 train_loss: 1.1410 train_acc: 54.2969
Epoch: 045 train_loss: 1.1252 train_acc: 56.2500
Epoch: 046 train_loss: 1.1550 train_acc: 55.6641
Epoch: 047 train_loss: 1.1303 train_acc: 55.2734
Epoch: 048 train_loss: 1.1132 train_acc: 56.4453
Epoch: 049 train_loss: 1.1036 train_acc: 57.6172
Epoch: 050 train_loss: 1.1154 train_acc: 55.8594
Epoch: 051 train_loss: 1.0988 train_acc: 58.5938
Epoch: 052 train_loss: 1.1013 train_acc: 57.0312
Epoch: 053 train_loss: 1.0866 train_acc: 56.4453
Epoch: 054 train_loss: 1.0604 train_acc: 58.7891
Epoch: 055 train_loss: 1.0710 train_acc: 59.3750
Epoch: 056 train_loss: 1.0367 train_acc: 61.5234
Epoch: 057 train_loss: 1.0326 train_acc: 60.7422
Epoch: 058 train_loss: 1.0562 train_acc: 59.3750
Epoch: 059 train_loss: 1.0517 train_acc: 58.9844
Epoch: 060 train_loss: 1.0477 train_acc: 59.9609
Epoch: 061 train_loss: 1.0213 train_acc: 59.9609
Epoch: 062 train_loss: 1.0251 train_acc: 60.5469
Epoch: 063 train_loss: 1.0194 train_acc: 60.1562
Epoch: 064 train_loss: 1.0134 train_acc: 60.3516
Epoch: 065 train_loss: 0.9815 train_acc: 63.6719
Epoch: 066 train_loss: 1.0199 train_acc: 59.7656
Epoch: 067 train_loss: 0.9967 train_acc: 60.5469
Epoch: 068 train_loss: 1.0110 train_acc: 58.5938
Epoch: 069 train_loss: 1.0112 train_acc: 60.9375
Epoch: 070 train_loss: 0.9862 train_acc: 60.7422
Epoch: 071 train_loss: 0.9975 train_acc: 59.7656
Epoch: 072 train_loss: 0.9713 train_acc: 60.5469
Epoch: 073 train_loss: 1.0067 train_acc: 58.7891
Epoch: 074 train_loss: 0.9954 train_acc: 60.3516
Epoch: 075 train_loss: 0.9948 train_acc: 62.5000
Epoch: 076 train_loss: 0.9293 train_acc: 63.8672
Epoch: 077 train_loss: 0.9669 train_acc: 61.5234
Epoch: 078 train_loss: 0.9593 train_acc: 61.9141
Epoch: 079 train_loss: 0.9402 train_acc: 64.0625
Epoch: 080 train_loss: 0.9392 train_acc: 65.6250
Epoch: 081 train_loss: 0.9542 train_acc: 62.1094
Epoch: 082 train_loss: 0.9291 train_acc: 62.6953
Epoch: 083 train_loss: 0.8824 train_acc: 65.8203
Epoch: 084 train_loss: 0.8945 train_acc: 64.6484
Epoch: 085 train_loss: 0.8855 train_acc: 65.6250
Epoch: 086 train_loss: 0.8777 train_acc: 67.7734
Epoch: 087 train_loss: 0.8559 train_acc: 66.9922
Epoch: 088 train_loss: 0.8691 train_acc: 66.4062
Epoch: 089 train_loss: 0.8308 train_acc: 67.1875
Epoch: 090 train_loss: 0.7959 train_acc: 70.5078
Epoch: 091 train_loss: 0.8209 train_acc: 68.3594
Epoch: 092 train_loss: 0.8014 train_acc: 67.3828
Epoch: 093 train_loss: 0.8522 train_acc: 63.2812
Epoch: 094 train_loss: 0.8195 train_acc: 70.1172
Epoch: 095 train_loss: 0.7880 train_acc: 68.5547
Epoch: 096 train_loss: 0.7595 train_acc: 70.5078
Epoch: 097 train_loss: 0.8041 train_acc: 66.9922
Epoch: 098 train_loss: 0.7938 train_acc: 69.3359
Epoch: 099 train_loss: 0.7417 train_acc: 71.2891
Epoch: 100 train_loss: 0.7928 train_acc: 70.7031
Epoch: 101 train_loss: 0.7719 train_acc: 71.4844
Epoch: 102 train_loss: 0.7490 train_acc: 74.4141
Epoch: 103 train_loss: 0.7840 train_acc: 70.8984
Epoch: 104 train_loss: 0.7420 train_acc: 72.4609
Epoch: 105 train_loss: 0.7127 train_acc: 75.1953
Epoch: 106 train_loss: 0.7061 train_acc: 74.8047
Epoch: 107 train_loss: 0.6775 train_acc: 77.3438
Epoch: 108 train_loss: 0.6521 train_acc: 76.3672
Epoch: 109 train_loss: 0.6529 train_acc: 75.9766
Epoch: 110 train_loss: 0.6571 train_acc: 76.3672
Epoch: 111 train_loss: 0.6449 train_acc: 75.0000
Epoch: 112 train_loss: 0.6524 train_acc: 76.9531
Epoch: 113 train_loss: 0.6475 train_acc: 79.8828
Epoch: 114 train_loss: 0.6242 train_acc: 79.4922
Epoch: 115 train_loss: 0.6452 train_acc: 75.0000
Epoch: 116 train_loss: 0.6226 train_acc: 78.5156
Epoch: 117 train_loss: 0.6314 train_acc: 77.7344
Epoch: 118 train_loss: 0.6198 train_acc: 78.5156
Epoch: 119 train_loss: 0.6217 train_acc: 79.6875
Epoch: 120 train_loss: 0.6578 train_acc: 75.9766
Epoch: 121 train_loss: 0.6184 train_acc: 78.5156
Epoch: 122 train_loss: 0.6066 train_acc: 76.9531
Epoch: 123 train_loss: 0.6174 train_acc: 76.9531
Epoch: 124 train_loss: 0.5891 train_acc: 77.1484
Epoch: 125 train_loss: 0.5810 train_acc: 80.6641
Epoch: 126 train_loss: 0.5924 train_acc: 78.7109
Epoch: 127 train_loss: 0.5460 train_acc: 82.0312
Epoch: 128 train_loss: 0.5407 train_acc: 82.2266
Epoch: 129 train_loss: 0.5543 train_acc: 81.4453
Epoch: 130 train_loss: 0.5449 train_acc: 79.6875
Epoch: 131 train_loss: 0.5249 train_acc: 82.8125
Epoch: 132 train_loss: 0.5799 train_acc: 77.3438
Epoch: 133 train_loss: 0.5795 train_acc: 78.9062
Epoch: 134 train_loss: 0.5292 train_acc: 82.0312
Epoch: 135 train_loss: 0.5042 train_acc: 82.8125
Epoch: 136 train_loss: 0.5169 train_acc: 83.3984
Epoch: 137 train_loss: 0.5029 train_acc: 82.0312
Epoch: 138 train_loss: 0.5275 train_acc: 83.2031
Epoch: 139 train_loss: 0.5331 train_acc: 79.6875
Epoch: 140 train_loss: 0.4975 train_acc: 82.2266
Epoch: 141 train_loss: 0.4938 train_acc: 84.3750
Epoch: 142 train_loss: 0.4862 train_acc: 83.7891
Epoch: 143 train_loss: 0.5649 train_acc: 78.7109
Epoch: 144 train_loss: 0.5124 train_acc: 83.3984
Epoch: 145 train_loss: 0.5101 train_acc: 81.6406
Epoch: 146 train_loss: 0.4866 train_acc: 83.3984
Epoch: 147 train_loss: 0.4742 train_acc: 85.5469
Epoch: 148 train_loss: 0.4971 train_acc: 84.1797
Epoch: 149 train_loss: 0.4566 train_acc: 84.5703
Epoch: 150 train_loss: 0.4648 train_acc: 84.1797
Epoch: 151 train_loss: 0.4461 train_acc: 84.5703
Epoch: 152 train_loss: 0.5113 train_acc: 83.0078
Epoch: 153 train_loss: 0.5785 train_acc: 78.3203
Epoch: 154 train_loss: 0.6318 train_acc: 77.3438
Epoch: 155 train_loss: 0.5296 train_acc: 82.2266
Epoch: 156 train_loss: 0.4651 train_acc: 83.3984
Epoch: 157 train_loss: 0.4912 train_acc: 84.1797
Epoch: 158 train_loss: 0.4636 train_acc: 85.9375
Epoch: 159 train_loss: 0.4457 train_acc: 84.9609
Epoch: 160 train_loss: 0.4374 train_acc: 85.5469
Epoch: 161 train_loss: 0.4372 train_acc: 85.5469
Epoch: 162 train_loss: 0.4572 train_acc: 84.1797
Epoch: 163 train_loss: 0.4333 train_acc: 84.7656
Epoch: 164 train_loss: 0.4415 train_acc: 84.3750
Epoch: 165 train_loss: 0.4061 train_acc: 86.5234
Epoch: 166 train_loss: 0.3993 train_acc: 85.7422
Epoch: 167 train_loss: 0.3932 train_acc: 87.6953
Epoch: 168 train_loss: 0.3753 train_acc: 90.0391
Epoch: 169 train_loss: 0.3955 train_acc: 86.3281
Epoch: 170 train_loss: 0.3824 train_acc: 86.9141
Epoch: 171 train_loss: 0.3856 train_acc: 88.2812
Epoch: 172 train_loss: 0.4209 train_acc: 87.8906
Epoch: 173 train_loss: 0.3637 train_acc: 88.6719
Epoch: 174 train_loss: 0.3855 train_acc: 88.0859
Epoch: 175 train_loss: 0.3718 train_acc: 89.6484
Epoch: 176 train_loss: 0.3960 train_acc: 87.6953
Epoch: 177 train_loss: 0.4118 train_acc: 85.9375
Epoch: 178 train_loss: 0.3722 train_acc: 89.4531
Epoch: 179 train_loss: 0.4039 train_acc: 88.2812
Epoch: 180 train_loss: 0.3470 train_acc: 91.2109
Epoch: 181 train_loss: 0.3756 train_acc: 86.9141
Epoch: 182 train_loss: 0.3488 train_acc: 90.2344
Epoch: 183 train_loss: 0.3618 train_acc: 87.8906
Epoch: 184 train_loss: 0.3361 train_acc: 89.4531
Epoch: 185 train_loss: 0.3296 train_acc: 89.8438
Epoch: 186 train_loss: 0.3645 train_acc: 87.1094
Epoch: 187 train_loss: 0.3394 train_acc: 90.8203
Epoch: 188 train_loss: 0.3451 train_acc: 90.4297
Epoch: 189 train_loss: 0.3473 train_acc: 90.8203
Epoch: 190 train_loss: 0.3825 train_acc: 89.0625
Epoch: 191 train_loss: 0.3695 train_acc: 88.0859
Epoch: 192 train_loss: 0.3182 train_acc: 91.7969
Epoch: 193 train_loss: 0.3774 train_acc: 88.2812
Epoch: 194 train_loss: 0.3616 train_acc: 89.4531
Epoch: 195 train_loss: 0.3801 train_acc: 86.7188
Epoch: 196 train_loss: 0.3347 train_acc: 90.8203
Epoch: 197 train_loss: 0.3118 train_acc: 92.1875
Epoch: 198 train_loss: 0.3312 train_acc: 90.2344
Epoch: 199 train_loss: 0.3270 train_acc: 91.7969
Epoch: 200 train_loss: 0.3407 train_acc: 89.2578
Epoch: 201 train_loss: 0.3328 train_acc: 91.4062
Epoch: 202 train_loss: 0.3002 train_acc: 91.6016
Epoch: 203 train_loss: 0.2818 train_acc: 91.7969
Epoch: 204 train_loss: 0.3226 train_acc: 90.8203
Epoch: 205 train_loss: 0.2928 train_acc: 92.5781
Epoch: 206 train_loss: 0.3349 train_acc: 90.8203
Epoch: 207 train_loss: 0.2922 train_acc: 92.1875
Epoch: 208 train_loss: 0.3568 train_acc: 89.8438
Epoch: 209 train_loss: 0.3284 train_acc: 87.8906
Epoch: 210 train_loss: 0.2948 train_acc: 91.9922
Epoch: 211 train_loss: 0.2723 train_acc: 92.1875
Epoch: 212 train_loss: 0.2879 train_acc: 92.3828
Epoch: 213 train_loss: 0.2651 train_acc: 93.5547
Epoch: 214 train_loss: 0.2670 train_acc: 91.7969
Epoch: 215 train_loss: 0.2375 train_acc: 93.9453
Epoch: 216 train_loss: 0.2579 train_acc: 93.5547
Epoch: 217 train_loss: 0.2562 train_acc: 92.7734
Epoch: 218 train_loss: 0.2428 train_acc: 93.9453
Epoch: 219 train_loss: 0.2598 train_acc: 92.7734
Epoch: 220 train_loss: 0.2835 train_acc: 92.3828
Epoch: 221 train_loss: 0.2746 train_acc: 92.3828
Epoch: 222 train_loss: 0.2489 train_acc: 93.1641
Epoch: 223 train_loss: 0.2456 train_acc: 93.7500
Epoch: 224 train_loss: 0.2361 train_acc: 93.7500
Epoch: 225 train_loss: 0.2673 train_acc: 92.5781
Epoch: 226 train_loss: 0.2796 train_acc: 92.1875
Epoch: 227 train_loss: 0.2723 train_acc: 91.9922
Epoch: 228 train_loss: 0.3742 train_acc: 88.4766
Epoch: 229 train_loss: 0.3880 train_acc: 88.4766
Epoch: 230 train_loss: 0.3001 train_acc: 91.4062
Epoch: 231 train_loss: 0.2986 train_acc: 90.6250
Epoch: 232 train_loss: 0.2688 train_acc: 93.3594
Epoch: 233 train_loss: 0.2481 train_acc: 93.3594
Epoch: 234 train_loss: 0.2485 train_acc: 92.5781
Epoch: 235 train_loss: 0.2586 train_acc: 94.3359
Epoch: 236 train_loss: 0.2488 train_acc: 93.1641
Epoch: 237 train_loss: 0.2470 train_acc: 94.1406
Epoch: 238 train_loss: 0.2115 train_acc: 93.9453
Epoch: 239 train_loss: 0.2275 train_acc: 94.1406
Epoch: 240 train_loss: 0.2471 train_acc: 92.5781
Epoch: 241 train_loss: 0.2831 train_acc: 90.6250
Epoch: 242 train_loss: 0.2524 train_acc: 92.5781
Epoch: 243 train_loss: 0.2416 train_acc: 93.7500
Epoch: 244 train_loss: 0.2333 train_acc: 92.9688
Epoch: 245 train_loss: 0.2431 train_acc: 92.7734
Epoch: 246 train_loss: 0.2559 train_acc: 92.9688
Epoch: 247 train_loss: 0.2301 train_acc: 93.5547
Epoch: 248 train_loss: 0.2416 train_acc: 92.3828
Epoch: 249 train_loss: 0.2283 train_acc: 93.9453
Epoch: 250 train_loss: 0.2333 train_acc: 93.7500
Epoch: 251 train_loss: 0.2138 train_acc: 93.7500
Epoch: 252 train_loss: 0.2018 train_acc: 94.5312
Epoch: 253 train_loss: 0.1937 train_acc: 96.0938
Epoch: 254 train_loss: 0.1848 train_acc: 96.2891
Epoch: 255 train_loss: 0.2102 train_acc: 94.5312
Epoch: 256 train_loss: 0.1914 train_acc: 95.5078
Epoch: 257 train_loss: 0.1785 train_acc: 95.8984
Epoch: 258 train_loss: 0.2177 train_acc: 93.7500
Epoch: 259 train_loss: 0.2510 train_acc: 91.9922
Epoch: 260 train_loss: 0.2225 train_acc: 93.5547
Epoch: 261 train_loss: 0.2172 train_acc: 93.9453
Epoch: 262 train_loss: 0.2163 train_acc: 94.3359
Epoch: 263 train_loss: 0.1986 train_acc: 95.3125
Epoch: 264 train_loss: 0.1888 train_acc: 94.9219
Epoch: 265 train_loss: 0.1552 train_acc: 96.4844
Epoch: 266 train_loss: 0.1983 train_acc: 94.5312
Epoch: 267 train_loss: 0.1758 train_acc: 95.3125
Epoch: 268 train_loss: 0.1871 train_acc: 95.3125
Epoch: 269 train_loss: 0.2094 train_acc: 94.5312
Epoch: 270 train_loss: 0.1912 train_acc: 96.4844
Epoch: 271 train_loss: 0.1713 train_acc: 94.9219
Epoch: 272 train_loss: 0.1841 train_acc: 94.1406
Epoch: 273 train_loss: 0.1943 train_acc: 94.5312
Epoch: 274 train_loss: 0.1975 train_acc: 95.3125
Epoch: 275 train_loss: 0.1754 train_acc: 96.0938
Epoch: 276 train_loss: 0.1769 train_acc: 96.0938
Epoch: 277 train_loss: 0.1804 train_acc: 95.1172
Epoch: 278 train_loss: 0.2015 train_acc: 95.1172
Epoch: 279 train_loss: 0.1866 train_acc: 95.5078
Epoch: 280 train_loss: 0.1789 train_acc: 95.1172
Epoch: 281 train_loss: 0.1802 train_acc: 95.3125
Epoch: 282 train_loss: 0.2001 train_acc: 94.1406
Epoch: 283 train_loss: 0.1708 train_acc: 96.2891
Epoch: 284 train_loss: 0.1615 train_acc: 96.0938
/home/amax/anaconda3/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
Epoch: 285 train_loss: 0.1778 train_acc: 95.3125
Epoch: 286 train_loss: 0.2345 train_acc: 93.7500
Epoch: 287 train_loss: 0.2182 train_acc: 93.7500
Epoch: 288 train_loss: 0.1740 train_acc: 95.7031
Epoch: 289 train_loss: 0.1864 train_acc: 95.3125
Epoch: 290 train_loss: 0.1860 train_acc: 95.5078
Epoch: 291 train_loss: 0.1462 train_acc: 96.6797
Epoch: 292 train_loss: 0.1506 train_acc: 96.6797
Epoch: 293 train_loss: 0.1610 train_acc: 96.0938
Epoch: 294 train_loss: 0.2048 train_acc: 95.3125
Epoch: 295 train_loss: 0.2270 train_acc: 92.5781
Epoch: 296 train_loss: 0.1711 train_acc: 95.1172
Epoch: 297 train_loss: 0.1451 train_acc: 97.2656
Epoch: 298 train_loss: 0.1532 train_acc: 96.4844
Epoch: 299 train_loss: 0.1581 train_acc: 95.7031
Epoch: 300 train_loss: 0.1663 train_acc: 95.3125
Running Time: 166.19
**************************************************
Final result:
OA: 0.7339 | AA: 0.6001 | Kappa: 0.6960
[0.18181818 0.62859248 0.66878173 0.35555556 0.79738562 0.82708934
 0.14814815 0.95814978 0.05263158 0.76923077 0.81818182 0.38188277
 0.97435897 0.88103161 0.40871935 0.75      ]
**************************************************
Parameter:
dataset: Indian
flag_test: train
mode: CAF
gpu_id: 0
seed: 19
batch_size: 64
test_freq: 5
patches: 7
band_patches: 3
epoches: 300
learning_rate: 0.0005
gamma: 0.9
weight_decay: 0.005
height=145,width=145,band=200
**************************************************
patch is : 7
mirror_image shape : [151,151,200]
**************************************************
x_train shape = (512, 7, 7, 200), type = float64
x_test  shape = (9737, 7, 7, 200), type = float64
x_true  shape = (21025, 7, 7, 200), type = float64
**************************************************
x_train_band shape = (512, 147, 200), type = float64
x_test_band  shape = (9737, 147, 200), type = float64
x_true_band  shape = (21025, 147, 200), type = float64
**************************************************
y_train: shape = (512,) ,type = int64
y_test: shape = (9737,) ,type = int64
y_true: shape = (21025,) ,type = int64
**************************************************
start training
Epoch: 001 train_loss: 2.5973 train_acc: 16.9922
Epoch: 002 train_loss: 2.3601 train_acc: 23.0469
Epoch: 003 train_loss: 2.2956 train_acc: 24.0234
Epoch: 004 train_loss: 2.1476 train_acc: 33.9844
Epoch: 005 train_loss: 2.0078 train_acc: 35.9375
Epoch: 006 train_loss: 1.9097 train_acc: 35.9375
Epoch: 007 train_loss: 1.8472 train_acc: 37.1094
Epoch: 008 train_loss: 1.7929 train_acc: 39.0625
Epoch: 009 train_loss: 1.7445 train_acc: 38.6719
Epoch: 010 train_loss: 1.6978 train_acc: 39.8438
Epoch: 011 train_loss: 1.6498 train_acc: 42.1875
Epoch: 012 train_loss: 1.6072 train_acc: 42.1875
Epoch: 013 train_loss: 1.6060 train_acc: 41.6016
Epoch: 014 train_loss: 1.5639 train_acc: 43.9453
Epoch: 015 train_loss: 1.5734 train_acc: 43.1641
Epoch: 016 train_loss: 1.5287 train_acc: 44.1406
Epoch: 017 train_loss: 1.5134 train_acc: 46.0938
Epoch: 018 train_loss: 1.4892 train_acc: 45.1172
Epoch: 019 train_loss: 1.4845 train_acc: 41.6016
Epoch: 020 train_loss: 1.4527 train_acc: 46.4844
Epoch: 021 train_loss: 1.4299 train_acc: 46.0938
Epoch: 022 train_loss: 1.4282 train_acc: 47.2656
Epoch: 023 train_loss: 1.4243 train_acc: 48.8281
Epoch: 024 train_loss: 1.4033 train_acc: 47.6562
Epoch: 025 train_loss: 1.3869 train_acc: 47.8516
Epoch: 026 train_loss: 1.3840 train_acc: 48.0469
Epoch: 027 train_loss: 1.3586 train_acc: 49.0234
Epoch: 028 train_loss: 1.3552 train_acc: 48.8281
Epoch: 029 train_loss: 1.3302 train_acc: 50.5859
Epoch: 030 train_loss: 1.3300 train_acc: 49.2188
Epoch: 031 train_loss: 1.3287 train_acc: 49.8047
Epoch: 032 train_loss: 1.3212 train_acc: 49.6094
Epoch: 033 train_loss: 1.3435 train_acc: 49.8047
Epoch: 034 train_loss: 1.3114 train_acc: 51.1719
Epoch: 035 train_loss: 1.2917 train_acc: 51.9531
Epoch: 036 train_loss: 1.3031 train_acc: 52.5391
Epoch: 037 train_loss: 1.3125 train_acc: 50.3906
Epoch: 038 train_loss: 1.3207 train_acc: 51.1719
Epoch: 039 train_loss: 1.2843 train_acc: 53.5156
Epoch: 040 train_loss: 1.2722 train_acc: 52.3438
Epoch: 041 train_loss: 1.2587 train_acc: 52.9297
Epoch: 042 train_loss: 1.2750 train_acc: 51.3672
Epoch: 043 train_loss: 1.2270 train_acc: 53.1250
Epoch: 044 train_loss: 1.2415 train_acc: 55.8594
Epoch: 045 train_loss: 1.2144 train_acc: 54.1016
Epoch: 046 train_loss: 1.1821 train_acc: 58.0078
Epoch: 047 train_loss: 1.2057 train_acc: 55.8594
Epoch: 048 train_loss: 1.2041 train_acc: 54.1016
Epoch: 049 train_loss: 1.1608 train_acc: 56.4453
Epoch: 050 train_loss: 1.1786 train_acc: 56.6406
Epoch: 051 train_loss: 1.1156 train_acc: 58.3984
Epoch: 052 train_loss: 1.1486 train_acc: 57.2266
Epoch: 053 train_loss: 1.1301 train_acc: 58.0078
Epoch: 054 train_loss: 1.1572 train_acc: 55.8594
Epoch: 055 train_loss: 1.1100 train_acc: 58.0078
Epoch: 056 train_loss: 1.0572 train_acc: 60.3516
Epoch: 057 train_loss: 1.1118 train_acc: 56.2500
Epoch: 058 train_loss: 1.0806 train_acc: 56.6406
Epoch: 059 train_loss: 1.0579 train_acc: 60.7422
Epoch: 060 train_loss: 1.0502 train_acc: 60.1562
Epoch: 061 train_loss: 1.0843 train_acc: 58.5938
Epoch: 062 train_loss: 1.1119 train_acc: 56.4453
Epoch: 063 train_loss: 1.0559 train_acc: 61.9141
Epoch: 064 train_loss: 1.0528 train_acc: 60.3516
Epoch: 065 train_loss: 1.0135 train_acc: 60.3516
Epoch: 066 train_loss: 1.0412 train_acc: 61.7188
Epoch: 067 train_loss: 1.0182 train_acc: 60.9375
Epoch: 068 train_loss: 1.0274 train_acc: 61.1328
Epoch: 069 train_loss: 1.0542 train_acc: 57.8125
Epoch: 070 train_loss: 1.0438 train_acc: 61.3281
Epoch: 071 train_loss: 0.9928 train_acc: 59.9609
Epoch: 072 train_loss: 0.9621 train_acc: 61.9141
Epoch: 073 train_loss: 0.9667 train_acc: 62.3047
Epoch: 074 train_loss: 0.9677 train_acc: 60.1562
Epoch: 075 train_loss: 0.9407 train_acc: 63.6719
Epoch: 076 train_loss: 0.9457 train_acc: 64.2578
Epoch: 077 train_loss: 0.9603 train_acc: 61.1328
Epoch: 078 train_loss: 0.9385 train_acc: 63.6719
Epoch: 079 train_loss: 0.9699 train_acc: 61.5234
Epoch: 080 train_loss: 0.9567 train_acc: 62.1094
Epoch: 081 train_loss: 0.9461 train_acc: 63.0859
Epoch: 082 train_loss: 0.9403 train_acc: 62.1094
Epoch: 083 train_loss: 0.9548 train_acc: 61.7188
Epoch: 084 train_loss: 0.9851 train_acc: 62.5000
Epoch: 085 train_loss: 0.9395 train_acc: 63.4766
Epoch: 086 train_loss: 0.9359 train_acc: 64.4531
Epoch: 087 train_loss: 0.9417 train_acc: 63.8672
Epoch: 088 train_loss: 0.9148 train_acc: 64.4531
Epoch: 089 train_loss: 0.9069 train_acc: 64.8438
Epoch: 090 train_loss: 0.8776 train_acc: 66.6016
Epoch: 091 train_loss: 0.8880 train_acc: 66.0156
Epoch: 092 train_loss: 0.8963 train_acc: 65.6250
Epoch: 093 train_loss: 0.8786 train_acc: 65.0391
Epoch: 094 train_loss: 0.8596 train_acc: 66.4062
Epoch: 095 train_loss: 0.8332 train_acc: 69.1406
Epoch: 096 train_loss: 0.8433 train_acc: 68.1641
Epoch: 097 train_loss: 0.8329 train_acc: 67.5781
Epoch: 098 train_loss: 0.8283 train_acc: 69.1406
Epoch: 099 train_loss: 0.8975 train_acc: 67.3828
Epoch: 100 train_loss: 0.8727 train_acc: 64.8438
Epoch: 101 train_loss: 0.8523 train_acc: 65.6250
Epoch: 102 train_loss: 0.8108 train_acc: 69.1406
Epoch: 103 train_loss: 0.8273 train_acc: 68.9453
Epoch: 104 train_loss: 0.8007 train_acc: 68.3594
Epoch: 105 train_loss: 0.7729 train_acc: 70.7031
Epoch: 106 train_loss: 0.7802 train_acc: 71.0938
Epoch: 107 train_loss: 0.7954 train_acc: 70.3125
Epoch: 108 train_loss: 0.8234 train_acc: 69.1406
Epoch: 109 train_loss: 0.8209 train_acc: 67.9688
Epoch: 110 train_loss: 0.7901 train_acc: 68.7500
Epoch: 111 train_loss: 0.7584 train_acc: 71.2891
Epoch: 112 train_loss: 0.7280 train_acc: 73.4375
Epoch: 113 train_loss: 0.7394 train_acc: 73.6328
Epoch: 114 train_loss: 0.7609 train_acc: 71.4844
Epoch: 115 train_loss: 0.7227 train_acc: 72.6562
Epoch: 116 train_loss: 0.7324 train_acc: 73.6328
Epoch: 117 train_loss: 0.7598 train_acc: 72.4609
Epoch: 118 train_loss: 0.7130 train_acc: 74.2188
Epoch: 119 train_loss: 0.6762 train_acc: 76.7578
Epoch: 120 train_loss: 0.7120 train_acc: 75.1953
Epoch: 121 train_loss: 0.6711 train_acc: 77.1484
Epoch: 122 train_loss: 0.6714 train_acc: 75.9766
Epoch: 123 train_loss: 0.6837 train_acc: 75.5859
Epoch: 124 train_loss: 0.6746 train_acc: 75.5859
Epoch: 125 train_loss: 0.6781 train_acc: 74.8047
Epoch: 126 train_loss: 0.6590 train_acc: 77.9297
Epoch: 127 train_loss: 0.6920 train_acc: 75.9766
Epoch: 128 train_loss: 0.6308 train_acc: 76.9531
Epoch: 129 train_loss: 0.6533 train_acc: 77.7344
Epoch: 130 train_loss: 0.6234 train_acc: 76.3672
Epoch: 131 train_loss: 0.6869 train_acc: 75.7812
Epoch: 132 train_loss: 0.6034 train_acc: 79.6875
Epoch: 133 train_loss: 0.5960 train_acc: 80.6641
Epoch: 134 train_loss: 0.5974 train_acc: 79.6875
Epoch: 135 train_loss: 0.5753 train_acc: 79.6875
Epoch: 136 train_loss: 0.5891 train_acc: 79.2969
Epoch: 137 train_loss: 0.5697 train_acc: 80.2734
Epoch: 138 train_loss: 0.5520 train_acc: 81.2500
Epoch: 139 train_loss: 0.5571 train_acc: 83.2031
Epoch: 140 train_loss: 0.5191 train_acc: 83.5938
Epoch: 141 train_loss: 0.5471 train_acc: 81.4453
Epoch: 142 train_loss: 0.5255 train_acc: 83.3984
Epoch: 143 train_loss: 0.5132 train_acc: 80.2734
Epoch: 144 train_loss: 0.5451 train_acc: 81.4453
Epoch: 145 train_loss: 0.5313 train_acc: 83.0078
Epoch: 146 train_loss: 0.5616 train_acc: 79.8828
Epoch: 147 train_loss: 0.4928 train_acc: 84.1797
Epoch: 148 train_loss: 0.4743 train_acc: 83.5938
Epoch: 149 train_loss: 0.5081 train_acc: 81.8359
Epoch: 150 train_loss: 0.5850 train_acc: 77.9297
Epoch: 151 train_loss: 0.4888 train_acc: 84.9609
Epoch: 152 train_loss: 0.4803 train_acc: 83.7891
Epoch: 153 train_loss: 0.4757 train_acc: 84.9609
Epoch: 154 train_loss: 0.4359 train_acc: 84.1797
Epoch: 155 train_loss: 0.4491 train_acc: 86.1328
Epoch: 156 train_loss: 0.4582 train_acc: 85.9375
Epoch: 157 train_loss: 0.4252 train_acc: 86.9141
Epoch: 158 train_loss: 0.4672 train_acc: 83.7891
Epoch: 159 train_loss: 0.4923 train_acc: 82.6172
Epoch: 160 train_loss: 0.4593 train_acc: 86.7188
Epoch: 161 train_loss: 0.4382 train_acc: 84.5703
Epoch: 162 train_loss: 0.3977 train_acc: 88.4766
Epoch: 163 train_loss: 0.3981 train_acc: 87.1094
Epoch: 164 train_loss: 0.4288 train_acc: 88.0859
Epoch: 165 train_loss: 0.4544 train_acc: 84.9609
Epoch: 166 train_loss: 0.4541 train_acc: 83.7891
Epoch: 167 train_loss: 0.4538 train_acc: 85.1562
Epoch: 168 train_loss: 0.4834 train_acc: 83.5938
Epoch: 169 train_loss: 0.3919 train_acc: 87.1094
Epoch: 170 train_loss: 0.3798 train_acc: 87.5000
Epoch: 171 train_loss: 0.3935 train_acc: 87.6953
Epoch: 172 train_loss: 0.3919 train_acc: 88.8672
Epoch: 173 train_loss: 0.4182 train_acc: 86.5234
Epoch: 174 train_loss: 0.4051 train_acc: 86.9141
Epoch: 175 train_loss: 0.4193 train_acc: 86.1328
Epoch: 176 train_loss: 0.3761 train_acc: 87.6953
Epoch: 177 train_loss: 0.3728 train_acc: 88.0859
Epoch: 178 train_loss: 0.3398 train_acc: 90.0391
Epoch: 179 train_loss: 0.3374 train_acc: 89.2578
Epoch: 180 train_loss: 0.3426 train_acc: 88.6719
Epoch: 181 train_loss: 0.3299 train_acc: 89.8438
Epoch: 182 train_loss: 0.3176 train_acc: 90.6250
Epoch: 183 train_loss: 0.3366 train_acc: 88.6719
Epoch: 184 train_loss: 0.2868 train_acc: 91.4062
Epoch: 185 train_loss: 0.3146 train_acc: 91.9922
Epoch: 186 train_loss: 0.2929 train_acc: 91.9922
Epoch: 187 train_loss: 0.2851 train_acc: 91.9922
Epoch: 188 train_loss: 0.2880 train_acc: 92.9688
Epoch: 189 train_loss: 0.3256 train_acc: 91.2109
Epoch: 190 train_loss: 0.3116 train_acc: 90.0391
Epoch: 191 train_loss: 0.3207 train_acc: 91.0156
Epoch: 192 train_loss: 0.2843 train_acc: 92.1875
Epoch: 193 train_loss: 0.3079 train_acc: 90.4297
Epoch: 194 train_loss: 0.2733 train_acc: 92.1875
Epoch: 195 train_loss: 0.2647 train_acc: 92.7734
Epoch: 196 train_loss: 0.2965 train_acc: 92.1875
Epoch: 197 train_loss: 0.2603 train_acc: 92.7734
Epoch: 198 train_loss: 0.2563 train_acc: 92.5781
Epoch: 199 train_loss: 0.2588 train_acc: 92.9688
Epoch: 200 train_loss: 0.2343 train_acc: 94.3359
Epoch: 201 train_loss: 0.2771 train_acc: 91.7969
Epoch: 202 train_loss: 0.2353 train_acc: 94.3359
Epoch: 203 train_loss: 0.2316 train_acc: 93.1641
Epoch: 204 train_loss: 0.2315 train_acc: 93.5547
Epoch: 205 train_loss: 0.2492 train_acc: 93.3594
Epoch: 206 train_loss: 0.2743 train_acc: 92.1875
Epoch: 207 train_loss: 0.2568 train_acc: 92.7734
Epoch: 208 train_loss: 0.2283 train_acc: 93.7500
Epoch: 209 train_loss: 0.2519 train_acc: 94.3359
Epoch: 210 train_loss: 0.2560 train_acc: 91.7969
Epoch: 211 train_loss: 0.2655 train_acc: 92.5781
Epoch: 212 train_loss: 0.2452 train_acc: 92.5781
Epoch: 213 train_loss: 0.2368 train_acc: 93.5547
Epoch: 214 train_loss: 0.2359 train_acc: 94.5312
Epoch: 215 train_loss: 0.1972 train_acc: 95.1172
Epoch: 216 train_loss: 0.1954 train_acc: 95.1172
Epoch: 217 train_loss: 0.2160 train_acc: 94.5312
Epoch: 218 train_loss: 0.2026 train_acc: 94.5312
Epoch: 219 train_loss: 0.2187 train_acc: 93.5547
Epoch: 220 train_loss: 0.2031 train_acc: 94.9219
Epoch: 221 train_loss: 0.2134 train_acc: 93.7500
Epoch: 222 train_loss: 0.2108 train_acc: 95.5078
Epoch: 223 train_loss: 0.1814 train_acc: 95.3125
Epoch: 224 train_loss: 0.2169 train_acc: 94.7266
Epoch: 225 train_loss: 0.1841 train_acc: 95.8984
Epoch: 226 train_loss: 0.1822 train_acc: 95.3125
Epoch: 227 train_loss: 0.1787 train_acc: 95.5078
Epoch: 228 train_loss: 0.1665 train_acc: 95.7031
Epoch: 229 train_loss: 0.2132 train_acc: 94.3359
Epoch: 230 train_loss: 0.2139 train_acc: 94.7266
Epoch: 231 train_loss: 0.1660 train_acc: 96.0938
Epoch: 232 train_loss: 0.1830 train_acc: 94.9219
Epoch: 233 train_loss: 0.2230 train_acc: 92.9688
Epoch: 234 train_loss: 0.2373 train_acc: 91.6016
Epoch: 235 train_loss: 0.2735 train_acc: 91.4062
Epoch: 236 train_loss: 0.2669 train_acc: 92.1875
Epoch: 237 train_loss: 0.2826 train_acc: 90.6250
Epoch: 238 train_loss: 0.2143 train_acc: 93.9453
Epoch: 239 train_loss: 0.2006 train_acc: 94.1406
Epoch: 240 train_loss: 0.1748 train_acc: 95.3125
Epoch: 241 train_loss: 0.1665 train_acc: 95.7031
Epoch: 242 train_loss: 0.1893 train_acc: 95.3125
Epoch: 243 train_loss: 0.1561 train_acc: 96.4844
Epoch: 244 train_loss: 0.1429 train_acc: 97.6562
Epoch: 245 train_loss: 0.1485 train_acc: 96.8750
Epoch: 246 train_loss: 0.1594 train_acc: 95.7031
Epoch: 247 train_loss: 0.1644 train_acc: 94.7266
Epoch: 248 train_loss: 0.1446 train_acc: 97.2656
Epoch: 249 train_loss: 0.1319 train_acc: 97.2656
Epoch: 250 train_loss: 0.1531 train_acc: 96.8750
Epoch: 251 train_loss: 0.1422 train_acc: 96.8750
Epoch: 252 train_loss: 0.1705 train_acc: 94.5312
Epoch: 253 train_loss: 0.1936 train_acc: 95.5078
Epoch: 254 train_loss: 0.1694 train_acc: 95.1172
Epoch: 255 train_loss: 0.1540 train_acc: 96.0938
Epoch: 256 train_loss: 0.1629 train_acc: 96.4844
Epoch: 257 train_loss: 0.1602 train_acc: 96.0938
Epoch: 258 train_loss: 0.1668 train_acc: 95.8984
Epoch: 259 train_loss: 0.2243 train_acc: 94.3359
Epoch: 260 train_loss: 0.1790 train_acc: 94.5312
Epoch: 261 train_loss: 0.1837 train_acc: 95.5078
Epoch: 262 train_loss: 0.1832 train_acc: 95.5078
Epoch: 263 train_loss: 0.1355 train_acc: 97.6562
Epoch: 264 train_loss: 0.1361 train_acc: 97.0703
Epoch: 265 train_loss: 0.1472 train_acc: 96.6797
Epoch: 266 train_loss: 0.1466 train_acc: 97.0703
Epoch: 267 train_loss: 0.1209 train_acc: 97.4609
Epoch: 268 train_loss: 0.1347 train_acc: 97.4609
Epoch: 269 train_loss: 0.1493 train_acc: 97.0703
Epoch: 270 train_loss: 0.1364 train_acc: 97.0703
Epoch: 271 train_loss: 0.1398 train_acc: 96.6797
Epoch: 272 train_loss: 0.1552 train_acc: 96.0938
Epoch: 273 train_loss: 0.1352 train_acc: 97.0703
Epoch: 274 train_loss: 0.1253 train_acc: 96.8750
Epoch: 275 train_loss: 0.1286 train_acc: 97.2656
Epoch: 276 train_loss: 0.1363 train_acc: 96.0938
Epoch: 277 train_loss: 0.1729 train_acc: 95.8984
Epoch: 278 train_loss: 0.1535 train_acc: 96.8750
Epoch: 279 train_loss: 0.1288 train_acc: 97.2656
Epoch: 280 train_loss: 0.1633 train_acc: 94.9219
Epoch: 281 train_loss: 0.1453 train_acc: 96.2891
Epoch: 282 train_loss: 0.1608 train_acc: 95.7031
Epoch: 283 train_loss: 0.1252 train_acc: 97.6562
Epoch: 284 train_loss: 0.1239 train_acc: 97.4609
Epoch: 285 train_loss: 0.1203 train_acc: 96.8750
Epoch: 286 train_loss: 0.1298 train_acc: 97.0703
Epoch: 287 train_loss: 0.1258 train_acc: 97.8516
Epoch: 288 train_loss: 0.1275 train_acc: 97.4609
Epoch: 289 train_loss: 0.1093 train_acc: 97.8516
Epoch: 290 train_loss: 0.1087 train_acc: 97.6562
Epoch: 291 train_loss: 0.1188 train_acc: 97.6562
/home/amax/anaconda3/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
Epoch: 292 train_loss: 0.1324 train_acc: 96.8750
Epoch: 293 train_loss: 0.1323 train_acc: 97.4609
Epoch: 294 train_loss: 0.1790 train_acc: 93.9453
Epoch: 295 train_loss: 0.1353 train_acc: 96.8750
Epoch: 296 train_loss: 0.1248 train_acc: 97.2656
Epoch: 297 train_loss: 0.1120 train_acc: 97.6562
Epoch: 298 train_loss: 0.1049 train_acc: 98.6328
Epoch: 299 train_loss: 0.1066 train_acc: 98.4375
Epoch: 300 train_loss: 0.1244 train_acc: 97.4609
Running Time: 166.23
**************************************************
Final result:
OA: 0.8242 | AA: 0.7077 | Kappa: 0.7999
[0.09090909 0.80029477 0.79695431 0.71555556 0.93246187 0.92074928
 0.14814815 0.99779736 0.21052632 0.87540628 0.79931389 0.58436945
 0.97948718 0.94425957 0.5613079  0.96590909]
**************************************************
Parameter:
dataset: Indian
flag_test: train
mode: CAF
gpu_id: 0
seed: 20
batch_size: 64
test_freq: 5
patches: 7
band_patches: 3
epoches: 300
learning_rate: 0.0005
gamma: 0.9
weight_decay: 0.005
height=145,width=145,band=200
**************************************************
patch is : 7
mirror_image shape : [151,151,200]
**************************************************
x_train shape = (512, 7, 7, 200), type = float64
x_test  shape = (9737, 7, 7, 200), type = float64
x_true  shape = (21025, 7, 7, 200), type = float64
**************************************************
x_train_band shape = (512, 147, 200), type = float64
x_test_band  shape = (9737, 147, 200), type = float64
x_true_band  shape = (21025, 147, 200), type = float64
**************************************************
y_train: shape = (512,) ,type = int64
y_test: shape = (9737,) ,type = int64
y_true: shape = (21025,) ,type = int64
**************************************************
start training
Epoch: 001 train_loss: 2.6578 train_acc: 18.1641
Epoch: 002 train_loss: 2.3881 train_acc: 24.2188
Epoch: 003 train_loss: 2.3466 train_acc: 24.0234
Epoch: 004 train_loss: 2.3205 train_acc: 24.2188
Epoch: 005 train_loss: 2.2708 train_acc: 25.7812
Epoch: 006 train_loss: 2.1745 train_acc: 35.9375
Epoch: 007 train_loss: 2.0250 train_acc: 35.9375
Epoch: 008 train_loss: 1.9354 train_acc: 35.7422
Epoch: 009 train_loss: 1.8687 train_acc: 37.1094
Epoch: 010 train_loss: 1.8005 train_acc: 39.8438
Epoch: 011 train_loss: 1.7698 train_acc: 40.0391
Epoch: 012 train_loss: 1.7294 train_acc: 40.4297
Epoch: 013 train_loss: 1.6821 train_acc: 41.2109
Epoch: 014 train_loss: 1.6668 train_acc: 43.3594
Epoch: 015 train_loss: 1.6219 train_acc: 42.5781
Epoch: 016 train_loss: 1.5684 train_acc: 43.5547
Epoch: 017 train_loss: 1.5427 train_acc: 44.9219
Epoch: 018 train_loss: 1.4920 train_acc: 46.2891
Epoch: 019 train_loss: 1.4779 train_acc: 46.8750
Epoch: 020 train_loss: 1.4863 train_acc: 46.6797
Epoch: 021 train_loss: 1.4482 train_acc: 46.6797
Epoch: 022 train_loss: 1.4189 train_acc: 48.0469
Epoch: 023 train_loss: 1.4069 train_acc: 50.1953
Epoch: 024 train_loss: 1.3690 train_acc: 49.4141
Epoch: 025 train_loss: 1.3333 train_acc: 50.0000
Epoch: 026 train_loss: 1.3210 train_acc: 53.1250
Epoch: 027 train_loss: 1.3213 train_acc: 51.9531
Epoch: 028 train_loss: 1.3229 train_acc: 51.3672
Epoch: 029 train_loss: 1.2583 train_acc: 54.6875
Epoch: 030 train_loss: 1.3121 train_acc: 51.7578
Epoch: 031 train_loss: 1.2790 train_acc: 51.9531
Epoch: 032 train_loss: 1.2826 train_acc: 51.5625
Epoch: 033 train_loss: 1.2406 train_acc: 52.7344
Epoch: 034 train_loss: 1.2480 train_acc: 53.7109
Epoch: 035 train_loss: 1.2293 train_acc: 55.6641
Epoch: 036 train_loss: 1.2045 train_acc: 56.8359
Epoch: 037 train_loss: 1.2140 train_acc: 55.8594
Epoch: 038 train_loss: 1.2179 train_acc: 55.0781
Epoch: 039 train_loss: 1.1901 train_acc: 56.2500
Epoch: 040 train_loss: 1.1610 train_acc: 57.0312
Epoch: 041 train_loss: 1.2099 train_acc: 57.2266
Epoch: 042 train_loss: 1.1765 train_acc: 56.4453
Epoch: 043 train_loss: 1.1561 train_acc: 59.9609
Epoch: 044 train_loss: 1.1603 train_acc: 58.2031
Epoch: 045 train_loss: 1.1711 train_acc: 56.4453
Epoch: 046 train_loss: 1.1200 train_acc: 59.5703
Epoch: 047 train_loss: 1.1574 train_acc: 57.0312
Epoch: 048 train_loss: 1.1206 train_acc: 58.5938
Epoch: 049 train_loss: 1.1081 train_acc: 60.9375
Epoch: 050 train_loss: 1.0993 train_acc: 58.5938
Epoch: 051 train_loss: 1.0922 train_acc: 59.1797
Epoch: 052 train_loss: 1.1202 train_acc: 58.2031
Epoch: 053 train_loss: 1.1362 train_acc: 57.4219
Epoch: 054 train_loss: 1.1080 train_acc: 58.7891
Epoch: 055 train_loss: 1.0886 train_acc: 58.9844
Epoch: 056 train_loss: 1.1164 train_acc: 59.9609
Epoch: 057 train_loss: 1.0603 train_acc: 61.3281
Epoch: 058 train_loss: 1.0432 train_acc: 61.7188
Epoch: 059 train_loss: 1.0383 train_acc: 62.8906
Epoch: 060 train_loss: 1.0114 train_acc: 63.6719
Epoch: 061 train_loss: 1.0190 train_acc: 65.2344
Epoch: 062 train_loss: 1.0246 train_acc: 62.3047
Epoch: 063 train_loss: 1.0163 train_acc: 63.0859
Epoch: 064 train_loss: 1.0022 train_acc: 64.8438
Epoch: 065 train_loss: 0.9806 train_acc: 63.6719
Epoch: 066 train_loss: 1.0098 train_acc: 63.4766
Epoch: 067 train_loss: 0.9647 train_acc: 66.0156
Epoch: 068 train_loss: 0.9623 train_acc: 64.6484
Epoch: 069 train_loss: 0.9172 train_acc: 66.2109
Epoch: 070 train_loss: 0.9661 train_acc: 66.4062
Epoch: 071 train_loss: 0.9973 train_acc: 63.8672
Epoch: 072 train_loss: 0.9312 train_acc: 66.4062
Epoch: 073 train_loss: 0.9337 train_acc: 65.0391
Epoch: 074 train_loss: 0.8872 train_acc: 68.3594
Epoch: 075 train_loss: 0.9529 train_acc: 63.0859
Epoch: 076 train_loss: 0.8899 train_acc: 67.3828
Epoch: 077 train_loss: 0.9141 train_acc: 65.8203
Epoch: 078 train_loss: 0.9030 train_acc: 67.5781
Epoch: 079 train_loss: 0.8898 train_acc: 68.1641
Epoch: 080 train_loss: 0.8579 train_acc: 68.9453
Epoch: 081 train_loss: 0.9434 train_acc: 65.8203
Epoch: 082 train_loss: 0.9164 train_acc: 64.8438
Epoch: 083 train_loss: 0.9192 train_acc: 64.8438
Epoch: 084 train_loss: 0.8821 train_acc: 67.3828
Epoch: 085 train_loss: 0.8450 train_acc: 68.9453
Epoch: 086 train_loss: 0.8436 train_acc: 70.1172
Epoch: 087 train_loss: 0.8317 train_acc: 70.1172
Epoch: 088 train_loss: 0.8019 train_acc: 69.3359
Epoch: 089 train_loss: 0.7935 train_acc: 71.4844
Epoch: 090 train_loss: 0.8029 train_acc: 70.7031
Epoch: 091 train_loss: 0.8204 train_acc: 68.9453
Epoch: 092 train_loss: 0.7912 train_acc: 72.4609
Epoch: 093 train_loss: 0.7865 train_acc: 70.8984
Epoch: 094 train_loss: 0.7873 train_acc: 69.5312
Epoch: 095 train_loss: 0.8414 train_acc: 66.9922
Epoch: 096 train_loss: 0.8070 train_acc: 70.7031
Epoch: 097 train_loss: 0.7771 train_acc: 73.2422
Epoch: 098 train_loss: 0.7389 train_acc: 73.0469
Epoch: 099 train_loss: 0.7181 train_acc: 73.6328
Epoch: 100 train_loss: 0.7454 train_acc: 73.6328
Epoch: 101 train_loss: 0.7158 train_acc: 74.2188
Epoch: 102 train_loss: 0.7409 train_acc: 73.4375
Epoch: 103 train_loss: 0.7233 train_acc: 75.1953
Epoch: 104 train_loss: 0.7262 train_acc: 73.4375
Epoch: 105 train_loss: 0.7292 train_acc: 75.0000
Epoch: 106 train_loss: 0.7543 train_acc: 72.2656
Epoch: 107 train_loss: 0.7754 train_acc: 72.4609
Epoch: 108 train_loss: 0.7204 train_acc: 75.0000
Epoch: 109 train_loss: 0.7208 train_acc: 73.4375
Epoch: 110 train_loss: 0.7424 train_acc: 74.4141
Epoch: 111 train_loss: 0.7295 train_acc: 73.8281
Epoch: 112 train_loss: 0.7016 train_acc: 74.6094
Epoch: 113 train_loss: 0.6663 train_acc: 77.7344
Epoch: 114 train_loss: 0.6619 train_acc: 76.9531
Epoch: 115 train_loss: 0.6054 train_acc: 79.2969
Epoch: 116 train_loss: 0.6191 train_acc: 79.4922
Epoch: 117 train_loss: 0.6452 train_acc: 75.7812
Epoch: 118 train_loss: 0.6545 train_acc: 74.6094
Epoch: 119 train_loss: 0.6367 train_acc: 77.1484
Epoch: 120 train_loss: 0.6014 train_acc: 79.8828
Epoch: 121 train_loss: 0.5766 train_acc: 80.4688
Epoch: 122 train_loss: 0.6397 train_acc: 78.7109
Epoch: 123 train_loss: 0.6177 train_acc: 79.4922
Epoch: 124 train_loss: 0.5782 train_acc: 79.8828
Epoch: 125 train_loss: 0.5730 train_acc: 80.2734
Epoch: 126 train_loss: 0.6275 train_acc: 78.9062
Epoch: 127 train_loss: 0.6213 train_acc: 81.2500
Epoch: 128 train_loss: 0.5702 train_acc: 82.4219
Epoch: 129 train_loss: 0.6152 train_acc: 79.6875
Epoch: 130 train_loss: 0.5932 train_acc: 79.2969
Epoch: 131 train_loss: 0.5937 train_acc: 80.6641
Epoch: 132 train_loss: 0.5402 train_acc: 81.6406
Epoch: 133 train_loss: 0.6196 train_acc: 77.7344
Epoch: 134 train_loss: 0.5520 train_acc: 83.2031
Epoch: 135 train_loss: 0.5375 train_acc: 82.0312
Epoch: 136 train_loss: 0.5409 train_acc: 80.8594
Epoch: 137 train_loss: 0.5565 train_acc: 80.0781
Epoch: 138 train_loss: 0.5651 train_acc: 80.2734
Epoch: 139 train_loss: 0.5109 train_acc: 83.2031
Epoch: 140 train_loss: 0.5120 train_acc: 83.0078
Epoch: 141 train_loss: 0.5508 train_acc: 82.6172
Epoch: 142 train_loss: 0.5511 train_acc: 80.2734
Epoch: 143 train_loss: 0.5356 train_acc: 80.4688
Epoch: 144 train_loss: 0.5085 train_acc: 83.7891
Epoch: 145 train_loss: 0.5145 train_acc: 83.9844
Epoch: 146 train_loss: 0.4941 train_acc: 85.7422
Epoch: 147 train_loss: 0.4655 train_acc: 85.7422
Epoch: 148 train_loss: 0.4789 train_acc: 85.3516
Epoch: 149 train_loss: 0.4995 train_acc: 82.8125
Epoch: 150 train_loss: 0.4878 train_acc: 84.5703
Epoch: 151 train_loss: 0.5234 train_acc: 82.2266
Epoch: 152 train_loss: 0.4909 train_acc: 84.3750
Epoch: 153 train_loss: 0.5230 train_acc: 82.4219
Epoch: 154 train_loss: 0.4772 train_acc: 86.5234
Epoch: 155 train_loss: 0.4342 train_acc: 85.7422
Epoch: 156 train_loss: 0.4553 train_acc: 85.9375
Epoch: 157 train_loss: 0.5105 train_acc: 83.7891
Epoch: 158 train_loss: 0.5612 train_acc: 81.0547
Epoch: 159 train_loss: 0.5259 train_acc: 81.8359
Epoch: 160 train_loss: 0.4766 train_acc: 83.9844
Epoch: 161 train_loss: 0.4365 train_acc: 85.5469
Epoch: 162 train_loss: 0.4702 train_acc: 83.5938
Epoch: 163 train_loss: 0.5841 train_acc: 79.6875
Epoch: 164 train_loss: 0.5193 train_acc: 81.0547
Epoch: 165 train_loss: 0.4690 train_acc: 85.1562
Epoch: 166 train_loss: 0.4359 train_acc: 85.5469
Epoch: 167 train_loss: 0.4196 train_acc: 88.4766
Epoch: 168 train_loss: 0.5046 train_acc: 84.5703
Epoch: 169 train_loss: 0.4396 train_acc: 84.3750
Epoch: 170 train_loss: 0.4303 train_acc: 86.7188
Epoch: 171 train_loss: 0.4608 train_acc: 84.7656
Epoch: 172 train_loss: 0.4178 train_acc: 86.7188
Epoch: 173 train_loss: 0.3972 train_acc: 87.8906
Epoch: 174 train_loss: 0.3803 train_acc: 89.8438
Epoch: 175 train_loss: 0.3307 train_acc: 91.9922
Epoch: 176 train_loss: 0.3341 train_acc: 88.6719
Epoch: 177 train_loss: 0.3598 train_acc: 89.4531
Epoch: 178 train_loss: 0.3464 train_acc: 89.2578
Epoch: 179 train_loss: 0.3099 train_acc: 90.6250
Epoch: 180 train_loss: 0.3114 train_acc: 90.8203
Epoch: 181 train_loss: 0.3213 train_acc: 91.2109
Epoch: 182 train_loss: 0.3673 train_acc: 90.6250
Epoch: 183 train_loss: 0.3461 train_acc: 90.4297
Epoch: 184 train_loss: 0.3579 train_acc: 88.2812
Epoch: 185 train_loss: 0.3544 train_acc: 88.8672
Epoch: 186 train_loss: 0.3862 train_acc: 87.8906
Epoch: 187 train_loss: 0.3251 train_acc: 89.8438
Epoch: 188 train_loss: 0.2924 train_acc: 92.3828
Epoch: 189 train_loss: 0.2879 train_acc: 91.9922
Epoch: 190 train_loss: 0.3195 train_acc: 91.2109
Epoch: 191 train_loss: 0.3265 train_acc: 90.6250
Epoch: 192 train_loss: 0.3204 train_acc: 90.4297
Epoch: 193 train_loss: 0.3383 train_acc: 89.0625
Epoch: 194 train_loss: 0.3233 train_acc: 89.8438
Epoch: 195 train_loss: 0.3259 train_acc: 89.6484
Epoch: 196 train_loss: 0.3252 train_acc: 90.0391
Epoch: 197 train_loss: 0.3044 train_acc: 91.4062
Epoch: 198 train_loss: 0.2983 train_acc: 91.4062
Epoch: 199 train_loss: 0.3532 train_acc: 87.6953
Epoch: 200 train_loss: 0.3040 train_acc: 90.8203
Epoch: 201 train_loss: 0.3014 train_acc: 89.2578
Epoch: 202 train_loss: 0.2585 train_acc: 93.5547
Epoch: 203 train_loss: 0.3026 train_acc: 91.2109
Epoch: 204 train_loss: 0.2820 train_acc: 92.1875
Epoch: 205 train_loss: 0.2786 train_acc: 91.7969
Epoch: 206 train_loss: 0.2954 train_acc: 90.8203
Epoch: 207 train_loss: 0.2806 train_acc: 93.1641
Epoch: 208 train_loss: 0.2856 train_acc: 91.4062
Epoch: 209 train_loss: 0.2768 train_acc: 92.3828
Epoch: 210 train_loss: 0.2710 train_acc: 92.7734
Epoch: 211 train_loss: 0.2857 train_acc: 91.4062
Epoch: 212 train_loss: 0.2987 train_acc: 91.7969
Epoch: 213 train_loss: 0.2930 train_acc: 91.0156
Epoch: 214 train_loss: 0.3050 train_acc: 89.6484
Epoch: 215 train_loss: 0.2854 train_acc: 90.6250
Epoch: 216 train_loss: 0.2645 train_acc: 92.1875
Epoch: 217 train_loss: 0.2813 train_acc: 91.2109
Epoch: 218 train_loss: 0.2682 train_acc: 92.3828
Epoch: 219 train_loss: 0.2629 train_acc: 91.2109
Epoch: 220 train_loss: 0.2386 train_acc: 93.1641
Epoch: 221 train_loss: 0.2435 train_acc: 91.9922
Epoch: 222 train_loss: 0.2082 train_acc: 94.7266
Epoch: 223 train_loss: 0.2297 train_acc: 94.1406
Epoch: 224 train_loss: 0.2534 train_acc: 91.9922
Epoch: 225 train_loss: 0.2496 train_acc: 93.5547
Epoch: 226 train_loss: 0.3123 train_acc: 89.8438
Epoch: 227 train_loss: 0.2981 train_acc: 90.4297
Epoch: 228 train_loss: 0.2851 train_acc: 91.0156
Epoch: 229 train_loss: 0.2738 train_acc: 92.9688
Epoch: 230 train_loss: 0.2625 train_acc: 91.9922
Epoch: 231 train_loss: 0.2319 train_acc: 93.1641
Epoch: 232 train_loss: 0.2386 train_acc: 92.7734
Epoch: 233 train_loss: 0.2183 train_acc: 94.3359
Epoch: 234 train_loss: 0.2283 train_acc: 93.3594
Epoch: 235 train_loss: 0.2545 train_acc: 92.3828
Epoch: 236 train_loss: 0.2658 train_acc: 91.9922
Epoch: 237 train_loss: 0.2445 train_acc: 92.5781
Epoch: 238 train_loss: 0.2597 train_acc: 91.7969
Epoch: 239 train_loss: 0.2287 train_acc: 94.1406
Epoch: 240 train_loss: 0.2641 train_acc: 92.1875
Epoch: 241 train_loss: 0.1939 train_acc: 96.2891
Epoch: 242 train_loss: 0.2021 train_acc: 94.5312
Epoch: 243 train_loss: 0.1720 train_acc: 96.0938
Epoch: 244 train_loss: 0.1753 train_acc: 95.1172
Epoch: 245 train_loss: 0.1963 train_acc: 94.3359
Epoch: 246 train_loss: 0.1752 train_acc: 96.4844
Epoch: 247 train_loss: 0.1776 train_acc: 95.7031
Epoch: 248 train_loss: 0.2042 train_acc: 94.3359
Epoch: 249 train_loss: 0.1930 train_acc: 93.7500
Epoch: 250 train_loss: 0.1818 train_acc: 94.3359
Epoch: 251 train_loss: 0.1678 train_acc: 96.4844
Epoch: 252 train_loss: 0.1794 train_acc: 95.8984
Epoch: 253 train_loss: 0.1795 train_acc: 95.7031
Epoch: 254 train_loss: 0.1764 train_acc: 95.7031
Epoch: 255 train_loss: 0.1983 train_acc: 94.5312
Epoch: 256 train_loss: 0.1570 train_acc: 95.3125
Epoch: 257 train_loss: 0.1900 train_acc: 95.3125
Epoch: 258 train_loss: 0.1619 train_acc: 96.2891
Epoch: 259 train_loss: 0.1615 train_acc: 96.4844
Epoch: 260 train_loss: 0.1770 train_acc: 95.5078
Epoch: 261 train_loss: 0.1717 train_acc: 96.8750
Epoch: 262 train_loss: 0.1403 train_acc: 96.2891
Epoch: 263 train_loss: 0.1653 train_acc: 95.7031
Epoch: 264 train_loss: 0.1819 train_acc: 95.7031
Epoch: 265 train_loss: 0.1802 train_acc: 95.5078
Epoch: 266 train_loss: 0.1729 train_acc: 95.3125
Epoch: 267 train_loss: 0.1563 train_acc: 96.4844
Epoch: 268 train_loss: 0.1535 train_acc: 95.8984
Epoch: 269 train_loss: 0.1649 train_acc: 95.5078
Epoch: 270 train_loss: 0.1592 train_acc: 95.8984
Epoch: 271 train_loss: 0.1720 train_acc: 95.5078
Epoch: 272 train_loss: 0.1617 train_acc: 95.7031
Epoch: 273 train_loss: 0.1484 train_acc: 96.4844
Epoch: 274 train_loss: 0.1569 train_acc: 96.6797
Epoch: 275 train_loss: 0.1564 train_acc: 96.2891
Epoch: 276 train_loss: 0.1582 train_acc: 95.8984
Epoch: 277 train_loss: 0.1537 train_acc: 96.0938
Epoch: 278 train_loss: 0.1589 train_acc: 95.8984
Epoch: 279 train_loss: 0.1332 train_acc: 96.8750
Epoch: 280 train_loss: 0.1388 train_acc: 95.8984
Epoch: 281 train_loss: 0.1330 train_acc: 97.4609
Epoch: 282 train_loss: 0.1393 train_acc: 96.2891
Epoch: 283 train_loss: 0.1189 train_acc: 97.4609
Epoch: 284 train_loss: 0.1332 train_acc: 96.8750
Epoch: 285 train_loss: 0.1210 train_acc: 98.6328
Epoch: 286 train_loss: 0.1356 train_acc: 96.6797
Epoch: 287 train_loss: 0.1316 train_acc: 97.2656
Epoch: 288 train_loss: 0.1307 train_acc: 96.6797
Epoch: 289 train_loss: 0.1333 train_acc: 96.2891
Epoch: 290 train_loss: 0.1158 train_acc: 98.2422
Epoch: 291 train_loss: 0.1368 train_acc: 95.8984
Epoch: 292 train_loss: 0.1041 train_acc: 98.6328
Epoch: 293 train_loss: 0.1101 train_acc: 98.0469
Epoch: 294 train_loss: 0.1184 train_acc: 96.6797
Epoch: 295 train_loss: 0.0980 train_acc: 98.4375
Epoch: 296 train_loss: 0.1164 train_acc: 97.8516
Epoch: 297 train_loss: 0.1318 train_acc: 96.0938
Epoch: 298 train_loss: 0.1407 train_acc: 95.7031
/home/amax/anaconda3/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
Epoch: 299 train_loss: 0.1618 train_acc: 95.8984
Epoch: 300 train_loss: 0.1258 train_acc: 97.4609
Running Time: 167.32
**************************************************
Final result:
OA: 0.7908 | AA: 0.6581 | Kappa: 0.7597
[0.18181818 0.75239499 0.52791878 0.40888889 0.89542484 0.93948127
 0.07407407 0.92290749 0.26315789 0.75189599 0.8670669  0.6749556
 1.         0.94342762 0.47411444 0.85227273]
**************************************************
Parameter:
dataset: Indian
flag_test: train
mode: CAF
gpu_id: 0
seed: 21
batch_size: 64
test_freq: 5
patches: 7
band_patches: 3
epoches: 300
learning_rate: 0.0005
gamma: 0.9
weight_decay: 0.005
height=145,width=145,band=200
**************************************************
patch is : 7
mirror_image shape : [151,151,200]
**************************************************
x_train shape = (512, 7, 7, 200), type = float64
x_test  shape = (9737, 7, 7, 200), type = float64
x_true  shape = (21025, 7, 7, 200), type = float64
**************************************************
x_train_band shape = (512, 147, 200), type = float64
x_test_band  shape = (9737, 147, 200), type = float64
x_true_band  shape = (21025, 147, 200), type = float64
**************************************************
y_train: shape = (512,) ,type = int64
y_test: shape = (9737,) ,type = int64
y_true: shape = (21025,) ,type = int64
**************************************************
start training
Epoch: 001 train_loss: 2.4870 train_acc: 23.4375
Epoch: 002 train_loss: 2.2192 train_acc: 35.9375
Epoch: 003 train_loss: 1.9885 train_acc: 36.3281
Epoch: 004 train_loss: 1.8545 train_acc: 38.8672
Epoch: 005 train_loss: 1.7872 train_acc: 38.4766
Epoch: 006 train_loss: 1.7414 train_acc: 39.4531
Epoch: 007 train_loss: 1.7123 train_acc: 41.7969
Epoch: 008 train_loss: 1.6685 train_acc: 42.7734
Epoch: 009 train_loss: 1.6374 train_acc: 42.5781
Epoch: 010 train_loss: 1.6140 train_acc: 43.3594
Epoch: 011 train_loss: 1.5808 train_acc: 44.7266
Epoch: 012 train_loss: 1.5465 train_acc: 43.5547
Epoch: 013 train_loss: 1.5102 train_acc: 44.9219
Epoch: 014 train_loss: 1.4958 train_acc: 46.8750
Epoch: 015 train_loss: 1.4687 train_acc: 46.4844
Epoch: 016 train_loss: 1.4527 train_acc: 47.6562
Epoch: 017 train_loss: 1.4374 train_acc: 47.8516
Epoch: 018 train_loss: 1.4089 train_acc: 48.0469
Epoch: 019 train_loss: 1.4031 train_acc: 48.4375
Epoch: 020 train_loss: 1.3872 train_acc: 49.0234
Epoch: 021 train_loss: 1.3934 train_acc: 48.0469
Epoch: 022 train_loss: 1.3614 train_acc: 50.1953
Epoch: 023 train_loss: 1.3497 train_acc: 49.4141
Epoch: 024 train_loss: 1.3419 train_acc: 48.4375
Epoch: 025 train_loss: 1.3379 train_acc: 50.5859
Epoch: 026 train_loss: 1.3111 train_acc: 48.8281
Epoch: 027 train_loss: 1.3234 train_acc: 49.8047
Epoch: 028 train_loss: 1.3224 train_acc: 50.9766
Epoch: 029 train_loss: 1.3007 train_acc: 52.7344
Epoch: 030 train_loss: 1.2888 train_acc: 52.9297
Epoch: 031 train_loss: 1.2863 train_acc: 53.1250
Epoch: 032 train_loss: 1.2710 train_acc: 51.9531
Epoch: 033 train_loss: 1.2672 train_acc: 50.7812
Epoch: 034 train_loss: 1.2594 train_acc: 53.5156
Epoch: 035 train_loss: 1.2555 train_acc: 53.5156
Epoch: 036 train_loss: 1.2634 train_acc: 51.9531
Epoch: 037 train_loss: 1.2466 train_acc: 52.5391
Epoch: 038 train_loss: 1.2487 train_acc: 52.9297
Epoch: 039 train_loss: 1.2312 train_acc: 52.5391
Epoch: 040 train_loss: 1.2342 train_acc: 53.9062
Epoch: 041 train_loss: 1.2436 train_acc: 54.4922
Epoch: 042 train_loss: 1.2456 train_acc: 53.1250
Epoch: 043 train_loss: 1.2249 train_acc: 52.7344
Epoch: 044 train_loss: 1.2018 train_acc: 55.2734
Epoch: 045 train_loss: 1.1957 train_acc: 55.2734
Epoch: 046 train_loss: 1.1931 train_acc: 55.4688
Epoch: 047 train_loss: 1.2012 train_acc: 55.8594
Epoch: 048 train_loss: 1.1848 train_acc: 54.8828
Epoch: 049 train_loss: 1.1822 train_acc: 55.0781
Epoch: 050 train_loss: 1.1693 train_acc: 55.2734
Epoch: 051 train_loss: 1.1806 train_acc: 53.9062
Epoch: 052 train_loss: 1.1628 train_acc: 55.6641
Epoch: 053 train_loss: 1.1427 train_acc: 56.8359
Epoch: 054 train_loss: 1.1379 train_acc: 57.4219
Epoch: 055 train_loss: 1.1394 train_acc: 56.4453
Epoch: 056 train_loss: 1.1840 train_acc: 56.6406
Epoch: 057 train_loss: 1.1331 train_acc: 58.2031
Epoch: 058 train_loss: 1.1124 train_acc: 57.0312
Epoch: 059 train_loss: 1.1208 train_acc: 57.2266
Epoch: 060 train_loss: 1.1196 train_acc: 57.0312
Epoch: 061 train_loss: 1.1184 train_acc: 58.3984
Epoch: 062 train_loss: 1.1306 train_acc: 57.4219
Epoch: 063 train_loss: 1.1043 train_acc: 57.4219
Epoch: 064 train_loss: 1.1012 train_acc: 58.0078
Epoch: 065 train_loss: 1.0908 train_acc: 60.3516
Epoch: 066 train_loss: 1.0873 train_acc: 59.5703
Epoch: 067 train_loss: 1.0896 train_acc: 56.4453
Epoch: 068 train_loss: 1.0882 train_acc: 57.4219
Epoch: 069 train_loss: 1.0719 train_acc: 59.7656
Epoch: 070 train_loss: 1.0669 train_acc: 58.2031
Epoch: 071 train_loss: 1.0701 train_acc: 59.5703
Epoch: 072 train_loss: 1.0523 train_acc: 59.9609
Epoch: 073 train_loss: 1.0265 train_acc: 60.7422
Epoch: 074 train_loss: 1.0328 train_acc: 61.1328
Epoch: 075 train_loss: 1.0437 train_acc: 60.1562
Epoch: 076 train_loss: 1.0379 train_acc: 58.5938
Epoch: 077 train_loss: 1.0412 train_acc: 58.5938
Epoch: 078 train_loss: 1.0387 train_acc: 60.9375
Epoch: 079 train_loss: 1.0258 train_acc: 60.5469
Epoch: 080 train_loss: 1.0294 train_acc: 60.9375
Epoch: 081 train_loss: 0.9987 train_acc: 63.6719
Epoch: 082 train_loss: 0.9907 train_acc: 59.3750
Epoch: 083 train_loss: 0.9660 train_acc: 62.5000
Epoch: 084 train_loss: 0.9855 train_acc: 61.5234
Epoch: 085 train_loss: 0.9528 train_acc: 62.1094
Epoch: 086 train_loss: 0.9284 train_acc: 64.0625
Epoch: 087 train_loss: 0.9712 train_acc: 61.7188
Epoch: 088 train_loss: 0.9932 train_acc: 62.8906
Epoch: 089 train_loss: 0.9651 train_acc: 62.6953
Epoch: 090 train_loss: 0.9596 train_acc: 62.1094
Epoch: 091 train_loss: 0.9403 train_acc: 63.0859
Epoch: 092 train_loss: 0.9311 train_acc: 65.8203
Epoch: 093 train_loss: 0.9061 train_acc: 66.6016
Epoch: 094 train_loss: 0.8945 train_acc: 65.4297
Epoch: 095 train_loss: 0.8732 train_acc: 68.7500
Epoch: 096 train_loss: 0.8724 train_acc: 67.1875
Epoch: 097 train_loss: 0.8656 train_acc: 67.5781
Epoch: 098 train_loss: 0.8643 train_acc: 66.4062
Epoch: 099 train_loss: 0.8385 train_acc: 67.7734
Epoch: 100 train_loss: 0.8435 train_acc: 69.9219
Epoch: 101 train_loss: 0.8741 train_acc: 67.5781
Epoch: 102 train_loss: 0.8665 train_acc: 68.1641
Epoch: 103 train_loss: 0.8209 train_acc: 68.1641
Epoch: 104 train_loss: 0.8275 train_acc: 69.7266
Epoch: 105 train_loss: 0.8631 train_acc: 67.7734
Epoch: 106 train_loss: 0.8725 train_acc: 66.4062
Epoch: 107 train_loss: 0.8600 train_acc: 66.9922
Epoch: 108 train_loss: 0.8893 train_acc: 65.0391
Epoch: 109 train_loss: 0.8638 train_acc: 67.9688
Epoch: 110 train_loss: 0.8287 train_acc: 68.7500
Epoch: 111 train_loss: 0.7769 train_acc: 71.2891
Epoch: 112 train_loss: 0.8117 train_acc: 69.1406
Epoch: 113 train_loss: 0.7488 train_acc: 73.6328
Epoch: 114 train_loss: 0.7663 train_acc: 70.7031
Epoch: 115 train_loss: 0.8289 train_acc: 68.7500
Epoch: 116 train_loss: 0.7820 train_acc: 71.0938
Epoch: 117 train_loss: 0.7614 train_acc: 72.2656
Epoch: 118 train_loss: 0.7448 train_acc: 74.0234
Epoch: 119 train_loss: 0.7599 train_acc: 75.5859
Epoch: 120 train_loss: 0.7863 train_acc: 72.2656
Epoch: 121 train_loss: 0.7234 train_acc: 76.1719
Epoch: 122 train_loss: 0.7371 train_acc: 75.1953
Epoch: 123 train_loss: 0.7094 train_acc: 73.8281
Epoch: 124 train_loss: 0.6880 train_acc: 75.0000
Epoch: 125 train_loss: 0.7050 train_acc: 74.6094
Epoch: 126 train_loss: 0.6957 train_acc: 75.5859
Epoch: 127 train_loss: 0.6776 train_acc: 75.7812
Epoch: 128 train_loss: 0.7292 train_acc: 74.6094
Epoch: 129 train_loss: 0.7161 train_acc: 74.4141
Epoch: 130 train_loss: 0.6951 train_acc: 74.6094
Epoch: 131 train_loss: 0.6819 train_acc: 76.1719
Epoch: 132 train_loss: 0.6663 train_acc: 77.3438
Epoch: 133 train_loss: 0.6708 train_acc: 76.1719
Epoch: 134 train_loss: 0.6932 train_acc: 75.1953
Epoch: 135 train_loss: 0.6513 train_acc: 77.5391
Epoch: 136 train_loss: 0.6429 train_acc: 78.1250
Epoch: 137 train_loss: 0.6037 train_acc: 79.8828
Epoch: 138 train_loss: 0.6546 train_acc: 76.9531
Epoch: 139 train_loss: 0.6649 train_acc: 76.9531
Epoch: 140 train_loss: 0.6152 train_acc: 78.5156
Epoch: 141 train_loss: 0.6034 train_acc: 78.5156
Epoch: 142 train_loss: 0.5947 train_acc: 79.2969
Epoch: 143 train_loss: 0.6124 train_acc: 78.3203
Epoch: 144 train_loss: 0.6293 train_acc: 78.1250
Epoch: 145 train_loss: 0.5950 train_acc: 79.8828
Epoch: 146 train_loss: 0.5814 train_acc: 80.8594
Epoch: 147 train_loss: 0.6114 train_acc: 79.2969
Epoch: 148 train_loss: 0.6317 train_acc: 78.1250
Epoch: 149 train_loss: 0.5890 train_acc: 80.2734
Epoch: 150 train_loss: 0.5942 train_acc: 76.7578
Epoch: 151 train_loss: 0.6062 train_acc: 77.9297
Epoch: 152 train_loss: 0.6251 train_acc: 77.1484
Epoch: 153 train_loss: 0.5791 train_acc: 78.7109
Epoch: 154 train_loss: 0.5565 train_acc: 80.8594
Epoch: 155 train_loss: 0.5696 train_acc: 77.7344
Epoch: 156 train_loss: 0.5478 train_acc: 81.0547
Epoch: 157 train_loss: 0.5338 train_acc: 81.6406
Epoch: 158 train_loss: 0.5424 train_acc: 81.8359
Epoch: 159 train_loss: 0.5595 train_acc: 81.2500
Epoch: 160 train_loss: 0.5148 train_acc: 83.0078
Epoch: 161 train_loss: 0.5113 train_acc: 80.6641
Epoch: 162 train_loss: 0.4853 train_acc: 83.9844
Epoch: 163 train_loss: 0.4849 train_acc: 84.5703
Epoch: 164 train_loss: 0.4858 train_acc: 83.0078
Epoch: 165 train_loss: 0.5082 train_acc: 80.4688
Epoch: 166 train_loss: 0.5194 train_acc: 80.0781
Epoch: 167 train_loss: 0.4942 train_acc: 81.2500
Epoch: 168 train_loss: 0.4658 train_acc: 83.7891
Epoch: 169 train_loss: 0.4681 train_acc: 84.5703
Epoch: 170 train_loss: 0.4350 train_acc: 85.3516
Epoch: 171 train_loss: 0.4299 train_acc: 85.9375
Epoch: 172 train_loss: 0.4303 train_acc: 85.9375
Epoch: 173 train_loss: 0.4499 train_acc: 84.5703
Epoch: 174 train_loss: 0.4458 train_acc: 83.9844
Epoch: 175 train_loss: 0.4458 train_acc: 85.1562
Epoch: 176 train_loss: 0.4320 train_acc: 86.3281
Epoch: 177 train_loss: 0.4853 train_acc: 82.2266
Epoch: 178 train_loss: 0.4474 train_acc: 84.5703
Epoch: 179 train_loss: 0.4198 train_acc: 85.5469
Epoch: 180 train_loss: 0.4297 train_acc: 84.9609
Epoch: 181 train_loss: 0.4202 train_acc: 84.9609
Epoch: 182 train_loss: 0.4481 train_acc: 83.7891
Epoch: 183 train_loss: 0.4311 train_acc: 86.1328
Epoch: 184 train_loss: 0.4433 train_acc: 86.3281
Epoch: 185 train_loss: 0.4278 train_acc: 84.7656
Epoch: 186 train_loss: 0.4190 train_acc: 85.9375
Epoch: 187 train_loss: 0.3905 train_acc: 85.5469
Epoch: 188 train_loss: 0.3807 train_acc: 86.9141
Epoch: 189 train_loss: 0.3493 train_acc: 89.4531
Epoch: 190 train_loss: 0.3726 train_acc: 86.9141
Epoch: 191 train_loss: 0.3690 train_acc: 86.7188
Epoch: 192 train_loss: 0.3640 train_acc: 87.8906
Epoch: 193 train_loss: 0.3634 train_acc: 88.2812
Epoch: 194 train_loss: 0.3750 train_acc: 88.2812
Epoch: 195 train_loss: 0.3895 train_acc: 86.1328
Epoch: 196 train_loss: 0.3883 train_acc: 87.5000
Epoch: 197 train_loss: 0.3933 train_acc: 87.6953
Epoch: 198 train_loss: 0.3784 train_acc: 87.5000
Epoch: 199 train_loss: 0.3775 train_acc: 86.5234
Epoch: 200 train_loss: 0.3639 train_acc: 88.0859
Epoch: 201 train_loss: 0.3797 train_acc: 86.1328
Epoch: 202 train_loss: 0.4067 train_acc: 86.3281
Epoch: 203 train_loss: 0.3450 train_acc: 87.5000
Epoch: 204 train_loss: 0.3948 train_acc: 86.1328
Epoch: 205 train_loss: 0.4042 train_acc: 86.9141
Epoch: 206 train_loss: 0.3556 train_acc: 88.4766
Epoch: 207 train_loss: 0.3307 train_acc: 89.4531
Epoch: 208 train_loss: 0.3377 train_acc: 88.6719
Epoch: 209 train_loss: 0.3312 train_acc: 88.8672
Epoch: 210 train_loss: 0.3412 train_acc: 89.6484
Epoch: 211 train_loss: 0.3107 train_acc: 89.0625
Epoch: 212 train_loss: 0.3217 train_acc: 88.2812
Epoch: 213 train_loss: 0.3337 train_acc: 89.2578
Epoch: 214 train_loss: 0.3261 train_acc: 90.0391
Epoch: 215 train_loss: 0.3318 train_acc: 89.2578
Epoch: 216 train_loss: 0.3078 train_acc: 90.4297
Epoch: 217 train_loss: 0.2834 train_acc: 91.2109
Epoch: 218 train_loss: 0.3012 train_acc: 90.4297
Epoch: 219 train_loss: 0.3106 train_acc: 90.0391
Epoch: 220 train_loss: 0.2987 train_acc: 92.1875
Epoch: 221 train_loss: 0.2924 train_acc: 91.2109
Epoch: 222 train_loss: 0.2566 train_acc: 93.3594
Epoch: 223 train_loss: 0.2460 train_acc: 93.9453
Epoch: 224 train_loss: 0.2775 train_acc: 91.9922
Epoch: 225 train_loss: 0.2973 train_acc: 90.2344
Epoch: 226 train_loss: 0.3062 train_acc: 89.8438
Epoch: 227 train_loss: 0.2864 train_acc: 91.9922
Epoch: 228 train_loss: 0.3019 train_acc: 90.0391
Epoch: 229 train_loss: 0.2600 train_acc: 92.7734
Epoch: 230 train_loss: 0.2706 train_acc: 91.4062
Epoch: 231 train_loss: 0.2653 train_acc: 91.7969
Epoch: 232 train_loss: 0.2756 train_acc: 91.4062
Epoch: 233 train_loss: 0.2422 train_acc: 92.5781
Epoch: 234 train_loss: 0.2530 train_acc: 92.1875
Epoch: 235 train_loss: 0.2810 train_acc: 91.7969
Epoch: 236 train_loss: 0.2907 train_acc: 90.8203
Epoch: 237 train_loss: 0.2901 train_acc: 90.4297
Epoch: 238 train_loss: 0.2659 train_acc: 92.5781
Epoch: 239 train_loss: 0.2637 train_acc: 92.1875
Epoch: 240 train_loss: 0.2633 train_acc: 92.1875
Epoch: 241 train_loss: 0.2552 train_acc: 92.5781
Epoch: 242 train_loss: 0.2505 train_acc: 92.7734
Epoch: 243 train_loss: 0.2654 train_acc: 92.3828
Epoch: 244 train_loss: 0.2521 train_acc: 93.1641
Epoch: 245 train_loss: 0.2295 train_acc: 93.3594
Epoch: 246 train_loss: 0.2159 train_acc: 94.7266
Epoch: 247 train_loss: 0.2292 train_acc: 93.3594
Epoch: 248 train_loss: 0.2463 train_acc: 92.3828
Epoch: 249 train_loss: 0.2433 train_acc: 93.5547
Epoch: 250 train_loss: 0.2309 train_acc: 93.7500
Epoch: 251 train_loss: 0.2117 train_acc: 94.5312
Epoch: 252 train_loss: 0.2353 train_acc: 92.9688
Epoch: 253 train_loss: 0.2740 train_acc: 91.0156
Epoch: 254 train_loss: 0.2523 train_acc: 92.3828
Epoch: 255 train_loss: 0.2474 train_acc: 92.5781
Epoch: 256 train_loss: 0.2313 train_acc: 93.7500
Epoch: 257 train_loss: 0.2306 train_acc: 94.3359
Epoch: 258 train_loss: 0.2082 train_acc: 95.3125
Epoch: 259 train_loss: 0.2390 train_acc: 93.1641
Epoch: 260 train_loss: 0.2443 train_acc: 90.6250
Epoch: 261 train_loss: 0.2822 train_acc: 89.2578
Epoch: 262 train_loss: 0.2586 train_acc: 91.4062
Epoch: 263 train_loss: 0.2378 train_acc: 93.7500
Epoch: 264 train_loss: 0.2485 train_acc: 93.3594
Epoch: 265 train_loss: 0.2182 train_acc: 94.1406
Epoch: 266 train_loss: 0.2351 train_acc: 93.1641
Epoch: 267 train_loss: 0.2396 train_acc: 92.5781
Epoch: 268 train_loss: 0.2441 train_acc: 92.5781
Epoch: 269 train_loss: 0.1923 train_acc: 95.7031
Epoch: 270 train_loss: 0.2275 train_acc: 93.7500
Epoch: 271 train_loss: 0.1991 train_acc: 93.9453
Epoch: 272 train_loss: 0.1960 train_acc: 94.7266
Epoch: 273 train_loss: 0.2377 train_acc: 92.3828
Epoch: 274 train_loss: 0.2579 train_acc: 92.5781
Epoch: 275 train_loss: 0.2415 train_acc: 94.1406
Epoch: 276 train_loss: 0.2429 train_acc: 92.3828
Epoch: 277 train_loss: 0.2123 train_acc: 92.7734
Epoch: 278 train_loss: 0.1994 train_acc: 95.7031
Epoch: 279 train_loss: 0.2124 train_acc: 94.3359
Epoch: 280 train_loss: 0.2200 train_acc: 92.5781
Epoch: 281 train_loss: 0.1743 train_acc: 95.8984
Epoch: 282 train_loss: 0.1635 train_acc: 96.4844
Epoch: 283 train_loss: 0.2056 train_acc: 95.3125
Epoch: 284 train_loss: 0.1906 train_acc: 95.1172
Epoch: 285 train_loss: 0.1793 train_acc: 96.0938
Epoch: 286 train_loss: 0.1705 train_acc: 96.0938
Epoch: 287 train_loss: 0.1713 train_acc: 96.0938
Epoch: 288 train_loss: 0.1732 train_acc: 96.0938
Epoch: 289 train_loss: 0.1389 train_acc: 97.4609
Epoch: 290 train_loss: 0.1655 train_acc: 95.5078
Epoch: 291 train_loss: 0.1950 train_acc: 93.7500
Epoch: 292 train_loss: 0.1959 train_acc: 93.9453
Epoch: 293 train_loss: 0.2064 train_acc: 94.9219
Epoch: 294 train_loss: 0.1658 train_acc: 95.8984
Epoch: 295 train_loss: 0.2009 train_acc: 93.9453
Epoch: 296 train_loss: 0.1810 train_acc: 95.5078
Epoch: 297 train_loss: 0.1860 train_acc: 94.7266
Epoch: 298 train_loss: 0.1666 train_acc: 94.3359
Epoch: 299 train_loss: 0.1757 train_acc: 96.8750
Epoch: 300 train_loss: 0.1696 train_acc: 96.4844
Running Time: 167.97
**************************************************
Final result:
OA: 0.7327 | AA: 0.6002 | Kappa: 0.6958
/home/amax/anaconda3/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
[0.27272727 0.76639646 0.72715736 0.41777778 0.54030501 0.75216138
 0.07407407 0.93171806 0.52631579 0.78223185 0.72084048 0.58792185
 0.80512821 0.94342762 0.42506812 0.32954545]
**************************************************
Parameter:
dataset: Indian
flag_test: train
mode: CAF
gpu_id: 0
seed: 22
batch_size: 64
test_freq: 5
patches: 7
band_patches: 3
epoches: 300
learning_rate: 0.0005
gamma: 0.9
weight_decay: 0.005
height=145,width=145,band=200
**************************************************
patch is : 7
mirror_image shape : [151,151,200]
**************************************************
x_train shape = (512, 7, 7, 200), type = float64
x_test  shape = (9737, 7, 7, 200), type = float64
x_true  shape = (21025, 7, 7, 200), type = float64
**************************************************
x_train_band shape = (512, 147, 200), type = float64
x_test_band  shape = (9737, 147, 200), type = float64
x_true_band  shape = (21025, 147, 200), type = float64
**************************************************
y_train: shape = (512,) ,type = int64
y_test: shape = (9737,) ,type = int64
y_true: shape = (21025,) ,type = int64
**************************************************
start training
Epoch: 001 train_loss: 2.4710 train_acc: 20.3125
Epoch: 002 train_loss: 2.2560 train_acc: 29.1016
Epoch: 003 train_loss: 2.0472 train_acc: 33.9844
Epoch: 004 train_loss: 1.9041 train_acc: 37.5000
Epoch: 005 train_loss: 1.8163 train_acc: 38.2812
Epoch: 006 train_loss: 1.7507 train_acc: 41.2109
Epoch: 007 train_loss: 1.6969 train_acc: 41.2109
Epoch: 008 train_loss: 1.6443 train_acc: 42.1875
Epoch: 009 train_loss: 1.6077 train_acc: 43.9453
Epoch: 010 train_loss: 1.5789 train_acc: 44.5312
Epoch: 011 train_loss: 1.5379 train_acc: 46.0938
Epoch: 012 train_loss: 1.5069 train_acc: 47.2656
Epoch: 013 train_loss: 1.4857 train_acc: 47.0703
Epoch: 014 train_loss: 1.4718 train_acc: 47.2656
Epoch: 015 train_loss: 1.4592 train_acc: 47.8516
Epoch: 016 train_loss: 1.4299 train_acc: 48.0469
Epoch: 017 train_loss: 1.4207 train_acc: 48.4375
Epoch: 018 train_loss: 1.3970 train_acc: 50.1953
Epoch: 019 train_loss: 1.3847 train_acc: 50.0000
Epoch: 020 train_loss: 1.3571 train_acc: 50.7812
Epoch: 021 train_loss: 1.3533 train_acc: 51.1719
Epoch: 022 train_loss: 1.3461 train_acc: 50.7812
Epoch: 023 train_loss: 1.3333 train_acc: 52.5391
Epoch: 024 train_loss: 1.3283 train_acc: 51.9531
Epoch: 025 train_loss: 1.3224 train_acc: 52.3438
Epoch: 026 train_loss: 1.3036 train_acc: 50.0000
Epoch: 027 train_loss: 1.3240 train_acc: 50.7812
Epoch: 028 train_loss: 1.3384 train_acc: 51.1719
Epoch: 029 train_loss: 1.3018 train_acc: 52.1484
Epoch: 030 train_loss: 1.2818 train_acc: 51.3672
Epoch: 031 train_loss: 1.2639 train_acc: 52.9297
Epoch: 032 train_loss: 1.2731 train_acc: 55.8594
Epoch: 033 train_loss: 1.2744 train_acc: 52.3438
Epoch: 034 train_loss: 1.2596 train_acc: 55.2734
Epoch: 035 train_loss: 1.2564 train_acc: 53.5156
Epoch: 036 train_loss: 1.2354 train_acc: 54.4922
Epoch: 037 train_loss: 1.2183 train_acc: 57.0312
Epoch: 038 train_loss: 1.2428 train_acc: 52.9297
Epoch: 039 train_loss: 1.2332 train_acc: 55.6641
Epoch: 040 train_loss: 1.2400 train_acc: 55.8594
Epoch: 041 train_loss: 1.2390 train_acc: 53.7109
Epoch: 042 train_loss: 1.2192 train_acc: 55.8594
Epoch: 043 train_loss: 1.2116 train_acc: 56.8359
Epoch: 044 train_loss: 1.2092 train_acc: 54.4922
Epoch: 045 train_loss: 1.2199 train_acc: 55.6641
Epoch: 046 train_loss: 1.2054 train_acc: 54.1016
Epoch: 047 train_loss: 1.2102 train_acc: 55.8594
Epoch: 048 train_loss: 1.1810 train_acc: 55.2734
Epoch: 049 train_loss: 1.1896 train_acc: 56.6406
Epoch: 050 train_loss: 1.1995 train_acc: 56.2500
Epoch: 051 train_loss: 1.1515 train_acc: 57.8125
Epoch: 052 train_loss: 1.1558 train_acc: 57.4219
Epoch: 053 train_loss: 1.1537 train_acc: 58.2031
Epoch: 054 train_loss: 1.1578 train_acc: 56.4453
Epoch: 055 train_loss: 1.1546 train_acc: 56.4453
Epoch: 056 train_loss: 1.1606 train_acc: 57.8125
Epoch: 057 train_loss: 1.1521 train_acc: 58.0078
Epoch: 058 train_loss: 1.1357 train_acc: 58.3984
Epoch: 059 train_loss: 1.1477 train_acc: 58.2031
Epoch: 060 train_loss: 1.1064 train_acc: 59.1797
Epoch: 061 train_loss: 1.1344 train_acc: 58.9844
Epoch: 062 train_loss: 1.1132 train_acc: 58.7891
Epoch: 063 train_loss: 1.1085 train_acc: 59.1797
Epoch: 064 train_loss: 1.1005 train_acc: 60.7422
Epoch: 065 train_loss: 1.1062 train_acc: 57.6172
Epoch: 066 train_loss: 1.1285 train_acc: 59.3750
Epoch: 067 train_loss: 1.1101 train_acc: 57.2266
Epoch: 068 train_loss: 1.0852 train_acc: 59.3750
Epoch: 069 train_loss: 1.0954 train_acc: 58.9844
Epoch: 070 train_loss: 1.0847 train_acc: 58.2031
Epoch: 071 train_loss: 1.0674 train_acc: 58.3984
Epoch: 072 train_loss: 1.0491 train_acc: 61.9141
Epoch: 073 train_loss: 1.0654 train_acc: 59.7656
Epoch: 074 train_loss: 1.0936 train_acc: 58.0078
Epoch: 075 train_loss: 1.0312 train_acc: 62.1094
Epoch: 076 train_loss: 1.0112 train_acc: 61.9141
Epoch: 077 train_loss: 1.0415 train_acc: 59.3750
Epoch: 078 train_loss: 1.0273 train_acc: 62.5000
Epoch: 079 train_loss: 1.0749 train_acc: 59.7656
Epoch: 080 train_loss: 1.0572 train_acc: 60.3516
Epoch: 081 train_loss: 1.0665 train_acc: 60.1562
Epoch: 082 train_loss: 1.0275 train_acc: 61.1328
Epoch: 083 train_loss: 0.9983 train_acc: 62.3047
Epoch: 084 train_loss: 0.9924 train_acc: 62.6953
Epoch: 085 train_loss: 1.0012 train_acc: 61.9141
Epoch: 086 train_loss: 1.0126 train_acc: 60.3516
Epoch: 087 train_loss: 1.0102 train_acc: 62.3047
Epoch: 088 train_loss: 1.0567 train_acc: 59.7656
Epoch: 089 train_loss: 1.0100 train_acc: 63.0859
Epoch: 090 train_loss: 0.9801 train_acc: 64.0625
Epoch: 091 train_loss: 0.9856 train_acc: 62.5000
Epoch: 092 train_loss: 0.9562 train_acc: 61.7188
Epoch: 093 train_loss: 0.9642 train_acc: 64.6484
Epoch: 094 train_loss: 1.0174 train_acc: 61.5234
Epoch: 095 train_loss: 0.9671 train_acc: 63.2812
Epoch: 096 train_loss: 0.9476 train_acc: 64.8438
Epoch: 097 train_loss: 0.9410 train_acc: 65.4297
Epoch: 098 train_loss: 0.9296 train_acc: 65.8203
Epoch: 099 train_loss: 0.9730 train_acc: 61.5234
Epoch: 100 train_loss: 0.9883 train_acc: 62.6953
Epoch: 101 train_loss: 0.9707 train_acc: 63.4766
Epoch: 102 train_loss: 0.9393 train_acc: 64.4531
Epoch: 103 train_loss: 0.9195 train_acc: 66.0156
Epoch: 104 train_loss: 0.9330 train_acc: 64.6484
Epoch: 105 train_loss: 0.8984 train_acc: 66.9922
Epoch: 106 train_loss: 0.8789 train_acc: 67.1875
Epoch: 107 train_loss: 0.8786 train_acc: 66.9922
Epoch: 108 train_loss: 0.8830 train_acc: 68.5547
Epoch: 109 train_loss: 0.8666 train_acc: 69.1406
Epoch: 110 train_loss: 0.8915 train_acc: 68.3594
Epoch: 111 train_loss: 0.9247 train_acc: 66.7969
Epoch: 112 train_loss: 0.9071 train_acc: 64.6484
Epoch: 113 train_loss: 0.8990 train_acc: 67.1875
Epoch: 114 train_loss: 0.8836 train_acc: 66.7969
Epoch: 115 train_loss: 0.8531 train_acc: 69.5312
Epoch: 116 train_loss: 0.8486 train_acc: 69.3359
Epoch: 117 train_loss: 0.8225 train_acc: 70.5078
Epoch: 118 train_loss: 0.8557 train_acc: 68.9453
Epoch: 119 train_loss: 0.8092 train_acc: 72.0703
Epoch: 120 train_loss: 0.8099 train_acc: 70.8984
Epoch: 121 train_loss: 0.8152 train_acc: 69.1406
Epoch: 122 train_loss: 0.8187 train_acc: 69.3359
Epoch: 123 train_loss: 0.8290 train_acc: 68.5547
Epoch: 124 train_loss: 0.8148 train_acc: 69.9219
Epoch: 125 train_loss: 0.7924 train_acc: 71.6797
Epoch: 126 train_loss: 0.8045 train_acc: 71.4844
Epoch: 127 train_loss: 0.7810 train_acc: 72.6562
Epoch: 128 train_loss: 0.7808 train_acc: 71.4844
Epoch: 129 train_loss: 0.7834 train_acc: 70.7031
Epoch: 130 train_loss: 0.7782 train_acc: 73.4375
Epoch: 131 train_loss: 0.7656 train_acc: 73.8281
Epoch: 132 train_loss: 0.7668 train_acc: 72.2656
Epoch: 133 train_loss: 0.7553 train_acc: 71.6797
Epoch: 134 train_loss: 0.7797 train_acc: 73.4375
Epoch: 135 train_loss: 0.8062 train_acc: 71.4844
Epoch: 136 train_loss: 0.7782 train_acc: 70.7031
Epoch: 137 train_loss: 0.7997 train_acc: 70.5078
Epoch: 138 train_loss: 0.7974 train_acc: 71.6797
Epoch: 139 train_loss: 0.7445 train_acc: 72.2656
Epoch: 140 train_loss: 0.7081 train_acc: 73.6328
Epoch: 141 train_loss: 0.7190 train_acc: 74.0234
Epoch: 142 train_loss: 0.7086 train_acc: 74.6094
Epoch: 143 train_loss: 0.7028 train_acc: 75.3906
Epoch: 144 train_loss: 0.6963 train_acc: 75.0000
Epoch: 145 train_loss: 0.6960 train_acc: 75.3906
Epoch: 146 train_loss: 0.6885 train_acc: 76.1719
Epoch: 147 train_loss: 0.6604 train_acc: 74.8047
Epoch: 148 train_loss: 0.7062 train_acc: 74.4141
Epoch: 149 train_loss: 0.6756 train_acc: 75.0000
Epoch: 150 train_loss: 0.7123 train_acc: 75.3906
Epoch: 151 train_loss: 0.7019 train_acc: 72.4609
Epoch: 152 train_loss: 0.6843 train_acc: 74.0234
Epoch: 153 train_loss: 0.6457 train_acc: 76.9531
Epoch: 154 train_loss: 0.6149 train_acc: 76.9531
Epoch: 155 train_loss: 0.6232 train_acc: 77.9297
Epoch: 156 train_loss: 0.5791 train_acc: 81.4453
Epoch: 157 train_loss: 0.6218 train_acc: 78.5156
Epoch: 158 train_loss: 0.6005 train_acc: 79.1016
Epoch: 159 train_loss: 0.5997 train_acc: 78.9062
Epoch: 160 train_loss: 0.5889 train_acc: 77.9297
Epoch: 161 train_loss: 0.6257 train_acc: 77.7344
Epoch: 162 train_loss: 0.6277 train_acc: 77.7344
Epoch: 163 train_loss: 0.5878 train_acc: 81.2500
Epoch: 164 train_loss: 0.5907 train_acc: 78.3203
Epoch: 165 train_loss: 0.5942 train_acc: 80.0781
Epoch: 166 train_loss: 0.5513 train_acc: 80.8594
Epoch: 167 train_loss: 0.5465 train_acc: 81.0547
Epoch: 168 train_loss: 0.5488 train_acc: 81.2500
Epoch: 169 train_loss: 0.5591 train_acc: 81.6406
Epoch: 170 train_loss: 0.5930 train_acc: 79.8828
Epoch: 171 train_loss: 0.5612 train_acc: 80.6641
Epoch: 172 train_loss: 0.5721 train_acc: 79.6875
Epoch: 173 train_loss: 0.5297 train_acc: 82.6172
Epoch: 174 train_loss: 0.5345 train_acc: 81.2500
Epoch: 175 train_loss: 0.4903 train_acc: 83.2031
Epoch: 176 train_loss: 0.4854 train_acc: 85.5469
Epoch: 177 train_loss: 0.6147 train_acc: 77.9297
Epoch: 178 train_loss: 0.6379 train_acc: 77.3438
Epoch: 179 train_loss: 0.5915 train_acc: 78.3203
Epoch: 180 train_loss: 0.5137 train_acc: 82.6172
Epoch: 181 train_loss: 0.4680 train_acc: 84.5703
Epoch: 182 train_loss: 0.5030 train_acc: 83.5938
Epoch: 183 train_loss: 0.4665 train_acc: 83.3984
Epoch: 184 train_loss: 0.4596 train_acc: 87.3047
Epoch: 185 train_loss: 0.4909 train_acc: 84.5703
Epoch: 186 train_loss: 0.4707 train_acc: 83.5938
Epoch: 187 train_loss: 0.5083 train_acc: 83.3984
Epoch: 188 train_loss: 0.4984 train_acc: 82.0312
Epoch: 189 train_loss: 0.4802 train_acc: 84.5703
Epoch: 190 train_loss: 0.4444 train_acc: 85.9375
Epoch: 191 train_loss: 0.4779 train_acc: 82.4219
Epoch: 192 train_loss: 0.5283 train_acc: 81.8359
Epoch: 193 train_loss: 0.4699 train_acc: 84.3750
Epoch: 194 train_loss: 0.4723 train_acc: 83.2031
Epoch: 195 train_loss: 0.4593 train_acc: 85.3516
Epoch: 196 train_loss: 0.4438 train_acc: 86.5234
Epoch: 197 train_loss: 0.4410 train_acc: 87.1094
Epoch: 198 train_loss: 0.4358 train_acc: 84.1797
Epoch: 199 train_loss: 0.4637 train_acc: 83.2031
Epoch: 200 train_loss: 0.4341 train_acc: 87.5000
Epoch: 201 train_loss: 0.4719 train_acc: 85.5469
Epoch: 202 train_loss: 0.4238 train_acc: 85.9375
Epoch: 203 train_loss: 0.4203 train_acc: 86.1328
Epoch: 204 train_loss: 0.4573 train_acc: 84.5703
Epoch: 205 train_loss: 0.4283 train_acc: 86.1328
Epoch: 206 train_loss: 0.4405 train_acc: 85.3516
Epoch: 207 train_loss: 0.4101 train_acc: 86.1328
Epoch: 208 train_loss: 0.4361 train_acc: 86.5234
Epoch: 209 train_loss: 0.4476 train_acc: 84.5703
Epoch: 210 train_loss: 0.4149 train_acc: 87.5000
Epoch: 211 train_loss: 0.3716 train_acc: 88.4766
Epoch: 212 train_loss: 0.3892 train_acc: 87.5000
Epoch: 213 train_loss: 0.3744 train_acc: 88.4766
Epoch: 214 train_loss: 0.3378 train_acc: 89.0625
Epoch: 215 train_loss: 0.3611 train_acc: 89.6484
Epoch: 216 train_loss: 0.3413 train_acc: 89.2578
Epoch: 217 train_loss: 0.3850 train_acc: 88.0859
Epoch: 218 train_loss: 0.3669 train_acc: 89.0625
Epoch: 219 train_loss: 0.3443 train_acc: 91.4062
Epoch: 220 train_loss: 0.3899 train_acc: 87.5000
Epoch: 221 train_loss: 0.3362 train_acc: 91.2109
Epoch: 222 train_loss: 0.3548 train_acc: 89.2578
Epoch: 223 train_loss: 0.3296 train_acc: 90.2344
Epoch: 224 train_loss: 0.3323 train_acc: 90.2344
Epoch: 225 train_loss: 0.3453 train_acc: 88.8672
Epoch: 226 train_loss: 0.3502 train_acc: 89.0625
Epoch: 227 train_loss: 0.4058 train_acc: 86.9141
Epoch: 228 train_loss: 0.3416 train_acc: 90.6250
Epoch: 229 train_loss: 0.3009 train_acc: 93.1641
Epoch: 230 train_loss: 0.3302 train_acc: 91.2109
Epoch: 231 train_loss: 0.3697 train_acc: 89.0625
Epoch: 232 train_loss: 0.3266 train_acc: 90.4297
Epoch: 233 train_loss: 0.3441 train_acc: 90.2344
Epoch: 234 train_loss: 0.3232 train_acc: 90.8203
Epoch: 235 train_loss: 0.3152 train_acc: 89.8438
Epoch: 236 train_loss: 0.3288 train_acc: 90.6250
Epoch: 237 train_loss: 0.3228 train_acc: 90.6250
Epoch: 238 train_loss: 0.2933 train_acc: 93.1641
Epoch: 239 train_loss: 0.3099 train_acc: 90.8203
Epoch: 240 train_loss: 0.2706 train_acc: 92.3828
Epoch: 241 train_loss: 0.2775 train_acc: 91.4062
Epoch: 242 train_loss: 0.3291 train_acc: 89.2578
Epoch: 243 train_loss: 0.3003 train_acc: 91.4062
Epoch: 244 train_loss: 0.2813 train_acc: 91.9922
Epoch: 245 train_loss: 0.2774 train_acc: 92.7734
Epoch: 246 train_loss: 0.2629 train_acc: 92.9688
Epoch: 247 train_loss: 0.2991 train_acc: 90.8203
Epoch: 248 train_loss: 0.2916 train_acc: 92.1875
Epoch: 249 train_loss: 0.3137 train_acc: 89.2578
Epoch: 250 train_loss: 0.3152 train_acc: 90.8203
Epoch: 251 train_loss: 0.2708 train_acc: 93.1641
Epoch: 252 train_loss: 0.2495 train_acc: 93.7500
Epoch: 253 train_loss: 0.2521 train_acc: 94.1406
Epoch: 254 train_loss: 0.2161 train_acc: 93.7500
Epoch: 255 train_loss: 0.2521 train_acc: 93.3594
Epoch: 256 train_loss: 0.2319 train_acc: 94.7266
Epoch: 257 train_loss: 0.2227 train_acc: 95.3125
Epoch: 258 train_loss: 0.2462 train_acc: 92.9688
Epoch: 259 train_loss: 0.2566 train_acc: 92.3828
Epoch: 260 train_loss: 0.3113 train_acc: 91.2109
Epoch: 261 train_loss: 0.2818 train_acc: 91.0156
Epoch: 262 train_loss: 0.3035 train_acc: 92.1875
Epoch: 263 train_loss: 0.2735 train_acc: 91.9922
Epoch: 264 train_loss: 0.2655 train_acc: 92.7734
Epoch: 265 train_loss: 0.2446 train_acc: 93.7500
Epoch: 266 train_loss: 0.2245 train_acc: 94.5312
Epoch: 267 train_loss: 0.2343 train_acc: 93.7500
Epoch: 268 train_loss: 0.2518 train_acc: 93.1641
Epoch: 269 train_loss: 0.2530 train_acc: 92.3828
Epoch: 270 train_loss: 0.2170 train_acc: 95.3125
Epoch: 271 train_loss: 0.2263 train_acc: 93.3594
Epoch: 272 train_loss: 0.2448 train_acc: 94.5312
Epoch: 273 train_loss: 0.2307 train_acc: 93.5547
Epoch: 274 train_loss: 0.2205 train_acc: 93.3594
Epoch: 275 train_loss: 0.2231 train_acc: 93.3594
Epoch: 276 train_loss: 0.2571 train_acc: 92.9688
Epoch: 277 train_loss: 0.2379 train_acc: 93.5547
Epoch: 278 train_loss: 0.2468 train_acc: 91.9922
Epoch: 279 train_loss: 0.2776 train_acc: 92.7734
Epoch: 280 train_loss: 0.2209 train_acc: 94.3359
Epoch: 281 train_loss: 0.2435 train_acc: 93.5547
Epoch: 282 train_loss: 0.2375 train_acc: 93.1641
Epoch: 283 train_loss: 0.2058 train_acc: 95.7031
Epoch: 284 train_loss: 0.2251 train_acc: 94.3359
Epoch: 285 train_loss: 0.2079 train_acc: 94.5312
Epoch: 286 train_loss: 0.1864 train_acc: 96.0938
Epoch: 287 train_loss: 0.2098 train_acc: 93.7500
Epoch: 288 train_loss: 0.2099 train_acc: 94.5312
Epoch: 289 train_loss: 0.2630 train_acc: 90.8203
Epoch: 290 train_loss: 0.2032 train_acc: 95.1172
Epoch: 291 train_loss: 0.1971 train_acc: 95.3125
Epoch: 292 train_loss: 0.2185 train_acc: 92.7734
Epoch: 293 train_loss: 0.2341 train_acc: 93.3594
Epoch: 294 train_loss: 0.2162 train_acc: 93.7500
Epoch: 295 train_loss: 0.1981 train_acc: 96.6797
Epoch: 296 train_loss: 0.2337 train_acc: 93.1641
Epoch: 297 train_loss: 0.2380 train_acc: 93.9453
Epoch: 298 train_loss: 0.2156 train_acc: 94.3359
Epoch: 299 train_loss: 0.1901 train_acc: 94.9219
Epoch: 300 train_loss: 0.1879 train_acc: 95.3125
Running Time: 165.92
**************************************************
Final result:
OA: 0.7048 | AA: 0.6249 | Kappa: 0.6678
[0.29545455 0.71849668 0.80076142 0.47111111 0.83442266 0.80403458
 0.07407407 0.94933921 0.42105263 0.76489707 0.59991424 0.47069272
 0.81538462 0.86189684 0.33242507 0.78409091]
**************************************************
Parameter:
dataset: Indian
flag_test: train
mode: CAF
gpu_id: 0
seed: 23
batch_size: 64
/home/amax/anaconda3/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
test_freq: 5
patches: 7
band_patches: 3
epoches: 300
learning_rate: 0.0005
gamma: 0.9
weight_decay: 0.005
height=145,width=145,band=200
**************************************************
patch is : 7
mirror_image shape : [151,151,200]
**************************************************
x_train shape = (512, 7, 7, 200), type = float64
x_test  shape = (9737, 7, 7, 200), type = float64
x_true  shape = (21025, 7, 7, 200), type = float64
**************************************************
x_train_band shape = (512, 147, 200), type = float64
x_test_band  shape = (9737, 147, 200), type = float64
x_true_band  shape = (21025, 147, 200), type = float64
**************************************************
y_train: shape = (512,) ,type = int64
y_test: shape = (9737,) ,type = int64
y_true: shape = (21025,) ,type = int64
**************************************************
start training
Epoch: 001 train_loss: 2.5187 train_acc: 22.0703
Epoch: 002 train_loss: 2.3434 train_acc: 24.0234
Epoch: 003 train_loss: 2.1601 train_acc: 33.7891
Epoch: 004 train_loss: 1.9428 train_acc: 35.9375
Epoch: 005 train_loss: 1.8496 train_acc: 37.6953
Epoch: 006 train_loss: 1.7626 train_acc: 40.6250
Epoch: 007 train_loss: 1.7250 train_acc: 41.4062
Epoch: 008 train_loss: 1.6784 train_acc: 41.0156
Epoch: 009 train_loss: 1.6780 train_acc: 40.4297
Epoch: 010 train_loss: 1.6604 train_acc: 41.4062
Epoch: 011 train_loss: 1.6119 train_acc: 42.7734
Epoch: 012 train_loss: 1.5808 train_acc: 41.4062
Epoch: 013 train_loss: 1.5284 train_acc: 45.8984
Epoch: 014 train_loss: 1.5043 train_acc: 46.0938
Epoch: 015 train_loss: 1.4600 train_acc: 45.7031
Epoch: 016 train_loss: 1.4383 train_acc: 48.8281
Epoch: 017 train_loss: 1.4315 train_acc: 48.6328
Epoch: 018 train_loss: 1.4061 train_acc: 49.2188
Epoch: 019 train_loss: 1.3832 train_acc: 50.0000
Epoch: 020 train_loss: 1.3897 train_acc: 48.8281
Epoch: 021 train_loss: 1.3503 train_acc: 52.7344
Epoch: 022 train_loss: 1.3513 train_acc: 50.9766
Epoch: 023 train_loss: 1.3353 train_acc: 50.9766
Epoch: 024 train_loss: 1.3297 train_acc: 50.5859
Epoch: 025 train_loss: 1.3100 train_acc: 50.7812
Epoch: 026 train_loss: 1.3086 train_acc: 52.1484
Epoch: 027 train_loss: 1.3040 train_acc: 52.5391
Epoch: 028 train_loss: 1.3036 train_acc: 52.1484
Epoch: 029 train_loss: 1.3206 train_acc: 50.7812
Epoch: 030 train_loss: 1.2884 train_acc: 55.4688
Epoch: 031 train_loss: 1.2961 train_acc: 51.9531
Epoch: 032 train_loss: 1.2646 train_acc: 52.7344
Epoch: 033 train_loss: 1.2557 train_acc: 52.9297
Epoch: 034 train_loss: 1.2466 train_acc: 53.1250
Epoch: 035 train_loss: 1.2472 train_acc: 52.9297
Epoch: 036 train_loss: 1.2284 train_acc: 54.4922
Epoch: 037 train_loss: 1.2343 train_acc: 54.2969
Epoch: 038 train_loss: 1.2169 train_acc: 54.1016
Epoch: 039 train_loss: 1.2206 train_acc: 53.9062
Epoch: 040 train_loss: 1.2408 train_acc: 54.4922
Epoch: 041 train_loss: 1.2180 train_acc: 54.2969
Epoch: 042 train_loss: 1.1945 train_acc: 55.8594
Epoch: 043 train_loss: 1.2084 train_acc: 54.6875
Epoch: 044 train_loss: 1.2391 train_acc: 52.7344
Epoch: 045 train_loss: 1.2343 train_acc: 52.7344
Epoch: 046 train_loss: 1.2060 train_acc: 54.2969
Epoch: 047 train_loss: 1.1897 train_acc: 55.4688
Epoch: 048 train_loss: 1.1531 train_acc: 56.8359
Epoch: 049 train_loss: 1.1484 train_acc: 58.2031
Epoch: 050 train_loss: 1.1240 train_acc: 59.1797
Epoch: 051 train_loss: 1.1415 train_acc: 56.0547
Epoch: 052 train_loss: 1.1326 train_acc: 58.3984
Epoch: 053 train_loss: 1.1314 train_acc: 59.7656
Epoch: 054 train_loss: 1.0950 train_acc: 59.5703
Epoch: 055 train_loss: 1.1240 train_acc: 58.5938
Epoch: 056 train_loss: 1.0975 train_acc: 60.5469
Epoch: 057 train_loss: 1.1162 train_acc: 59.7656
Epoch: 058 train_loss: 1.0919 train_acc: 60.7422
Epoch: 059 train_loss: 1.0843 train_acc: 60.5469
Epoch: 060 train_loss: 1.0583 train_acc: 59.5703
Epoch: 061 train_loss: 1.0725 train_acc: 59.9609
Epoch: 062 train_loss: 1.0601 train_acc: 62.5000
Epoch: 063 train_loss: 1.0408 train_acc: 60.5469
Epoch: 064 train_loss: 1.0339 train_acc: 62.3047
Epoch: 065 train_loss: 1.0321 train_acc: 60.7422
Epoch: 066 train_loss: 1.0879 train_acc: 58.3984
Epoch: 067 train_loss: 1.0985 train_acc: 57.4219
Epoch: 068 train_loss: 1.0443 train_acc: 59.1797
Epoch: 069 train_loss: 1.0513 train_acc: 60.3516
Epoch: 070 train_loss: 1.0307 train_acc: 60.1562
Epoch: 071 train_loss: 1.0168 train_acc: 59.9609
Epoch: 072 train_loss: 1.0042 train_acc: 60.7422
Epoch: 073 train_loss: 0.9923 train_acc: 64.0625
Epoch: 074 train_loss: 0.9986 train_acc: 62.5000
Epoch: 075 train_loss: 0.9991 train_acc: 61.3281
Epoch: 076 train_loss: 0.9580 train_acc: 64.8438
Epoch: 077 train_loss: 0.9737 train_acc: 63.2812
Epoch: 078 train_loss: 0.9599 train_acc: 63.2812
Epoch: 079 train_loss: 0.9253 train_acc: 65.8203
Epoch: 080 train_loss: 0.9430 train_acc: 64.4531
Epoch: 081 train_loss: 0.9468 train_acc: 64.4531
Epoch: 082 train_loss: 0.9932 train_acc: 63.2812
Epoch: 083 train_loss: 0.9484 train_acc: 64.2578
Epoch: 084 train_loss: 0.9393 train_acc: 65.4297
Epoch: 085 train_loss: 0.9875 train_acc: 64.0625
Epoch: 086 train_loss: 0.9441 train_acc: 62.1094
Epoch: 087 train_loss: 0.9155 train_acc: 65.0391
Epoch: 088 train_loss: 0.8846 train_acc: 65.0391
Epoch: 089 train_loss: 0.9110 train_acc: 65.2344
Epoch: 090 train_loss: 0.9158 train_acc: 65.4297
Epoch: 091 train_loss: 0.8752 train_acc: 67.5781
Epoch: 092 train_loss: 0.8495 train_acc: 69.7266
Epoch: 093 train_loss: 0.8525 train_acc: 68.5547
Epoch: 094 train_loss: 0.8892 train_acc: 67.7734
Epoch: 095 train_loss: 0.9239 train_acc: 65.6250
Epoch: 096 train_loss: 0.8595 train_acc: 68.3594
Epoch: 097 train_loss: 0.8474 train_acc: 67.3828
Epoch: 098 train_loss: 0.8494 train_acc: 69.5312
Epoch: 099 train_loss: 0.8457 train_acc: 67.9688
Epoch: 100 train_loss: 0.8219 train_acc: 69.9219
Epoch: 101 train_loss: 0.8358 train_acc: 69.5312
Epoch: 102 train_loss: 0.8392 train_acc: 67.3828
Epoch: 103 train_loss: 0.8282 train_acc: 69.7266
Epoch: 104 train_loss: 0.8105 train_acc: 71.6797
Epoch: 105 train_loss: 0.7879 train_acc: 71.6797
Epoch: 106 train_loss: 0.8400 train_acc: 68.7500
Epoch: 107 train_loss: 0.8462 train_acc: 70.7031
Epoch: 108 train_loss: 0.8137 train_acc: 68.7500
Epoch: 109 train_loss: 0.8006 train_acc: 72.2656
Epoch: 110 train_loss: 0.7605 train_acc: 72.4609
Epoch: 111 train_loss: 0.7428 train_acc: 72.8516
Epoch: 112 train_loss: 0.7668 train_acc: 71.6797
Epoch: 113 train_loss: 0.8051 train_acc: 69.1406
Epoch: 114 train_loss: 0.8106 train_acc: 70.5078
Epoch: 115 train_loss: 0.7807 train_acc: 70.8984
Epoch: 116 train_loss: 0.7797 train_acc: 69.3359
Epoch: 117 train_loss: 0.7734 train_acc: 70.1172
Epoch: 118 train_loss: 0.7634 train_acc: 70.8984
Epoch: 119 train_loss: 0.7160 train_acc: 76.1719
Epoch: 120 train_loss: 0.7138 train_acc: 74.8047
Epoch: 121 train_loss: 0.6942 train_acc: 76.5625
Epoch: 122 train_loss: 0.6902 train_acc: 77.5391
Epoch: 123 train_loss: 0.6968 train_acc: 75.0000
Epoch: 124 train_loss: 0.6989 train_acc: 75.5859
Epoch: 125 train_loss: 0.6282 train_acc: 80.2734
Epoch: 126 train_loss: 0.6289 train_acc: 77.7344
Epoch: 127 train_loss: 0.7024 train_acc: 75.5859
Epoch: 128 train_loss: 0.6852 train_acc: 77.9297
Epoch: 129 train_loss: 0.6851 train_acc: 75.3906
Epoch: 130 train_loss: 0.6826 train_acc: 75.3906
Epoch: 131 train_loss: 0.6326 train_acc: 78.1250
Epoch: 132 train_loss: 0.6228 train_acc: 78.5156
Epoch: 133 train_loss: 0.6268 train_acc: 76.9531
Epoch: 134 train_loss: 0.6254 train_acc: 76.9531
Epoch: 135 train_loss: 0.6012 train_acc: 81.0547
Epoch: 136 train_loss: 0.6059 train_acc: 79.4922
Epoch: 137 train_loss: 0.5904 train_acc: 78.5156
Epoch: 138 train_loss: 0.5871 train_acc: 80.2734
Epoch: 139 train_loss: 0.6011 train_acc: 80.6641
Epoch: 140 train_loss: 0.5688 train_acc: 80.0781
Epoch: 141 train_loss: 0.5837 train_acc: 80.0781
Epoch: 142 train_loss: 0.5517 train_acc: 80.8594
Epoch: 143 train_loss: 0.5753 train_acc: 80.0781
Epoch: 144 train_loss: 0.5669 train_acc: 79.4922
Epoch: 145 train_loss: 0.5611 train_acc: 81.8359
Epoch: 146 train_loss: 0.4971 train_acc: 84.9609
Epoch: 147 train_loss: 0.4682 train_acc: 84.7656
Epoch: 148 train_loss: 0.6156 train_acc: 80.4688
Epoch: 149 train_loss: 0.5684 train_acc: 80.6641
Epoch: 150 train_loss: 0.5024 train_acc: 83.7891
Epoch: 151 train_loss: 0.4647 train_acc: 83.9844
Epoch: 152 train_loss: 0.4784 train_acc: 84.1797
Epoch: 153 train_loss: 0.5034 train_acc: 82.8125
Epoch: 154 train_loss: 0.4689 train_acc: 84.5703
Epoch: 155 train_loss: 0.4959 train_acc: 83.5938
Epoch: 156 train_loss: 0.5279 train_acc: 82.8125
Epoch: 157 train_loss: 0.5214 train_acc: 83.5938
Epoch: 158 train_loss: 0.4782 train_acc: 84.1797
Epoch: 159 train_loss: 0.4618 train_acc: 85.1562
Epoch: 160 train_loss: 0.4123 train_acc: 89.0625
Epoch: 161 train_loss: 0.3918 train_acc: 87.8906
Epoch: 162 train_loss: 0.3926 train_acc: 88.6719
Epoch: 163 train_loss: 0.4334 train_acc: 84.7656
Epoch: 164 train_loss: 0.4760 train_acc: 83.5938
Epoch: 165 train_loss: 0.4590 train_acc: 84.3750
Epoch: 166 train_loss: 0.4471 train_acc: 83.5938
Epoch: 167 train_loss: 0.4238 train_acc: 87.8906
Epoch: 168 train_loss: 0.4432 train_acc: 85.9375
Epoch: 169 train_loss: 0.3983 train_acc: 87.5000
Epoch: 170 train_loss: 0.3832 train_acc: 86.9141
Epoch: 171 train_loss: 0.3736 train_acc: 88.0859
Epoch: 172 train_loss: 0.3688 train_acc: 89.0625
Epoch: 173 train_loss: 0.3377 train_acc: 90.2344
Epoch: 174 train_loss: 0.3599 train_acc: 87.1094
Epoch: 175 train_loss: 0.3908 train_acc: 86.9141
Epoch: 176 train_loss: 0.3543 train_acc: 89.0625
Epoch: 177 train_loss: 0.3640 train_acc: 88.0859
Epoch: 178 train_loss: 0.3752 train_acc: 86.9141
Epoch: 179 train_loss: 0.3892 train_acc: 86.1328
Epoch: 180 train_loss: 0.3749 train_acc: 87.6953
Epoch: 181 train_loss: 0.3303 train_acc: 90.4297
Epoch: 182 train_loss: 0.3515 train_acc: 89.0625
Epoch: 183 train_loss: 0.3995 train_acc: 87.5000
Epoch: 184 train_loss: 0.3525 train_acc: 89.6484
Epoch: 185 train_loss: 0.3319 train_acc: 89.6484
Epoch: 186 train_loss: 0.3505 train_acc: 88.6719
Epoch: 187 train_loss: 0.4399 train_acc: 82.8125
Epoch: 188 train_loss: 0.3824 train_acc: 88.2812
Epoch: 189 train_loss: 0.3741 train_acc: 87.8906
Epoch: 190 train_loss: 0.3417 train_acc: 90.0391
Epoch: 191 train_loss: 0.3409 train_acc: 90.0391
Epoch: 192 train_loss: 0.2989 train_acc: 89.8438
Epoch: 193 train_loss: 0.2978 train_acc: 90.6250
Epoch: 194 train_loss: 0.3171 train_acc: 90.6250
Epoch: 195 train_loss: 0.2828 train_acc: 91.0156
Epoch: 196 train_loss: 0.3575 train_acc: 87.3047
Epoch: 197 train_loss: 0.3593 train_acc: 89.0625
Epoch: 198 train_loss: 0.3558 train_acc: 89.2578
Epoch: 199 train_loss: 0.3164 train_acc: 91.0156
Epoch: 200 train_loss: 0.3214 train_acc: 88.0859
Epoch: 201 train_loss: 0.3121 train_acc: 90.2344
Epoch: 202 train_loss: 0.3423 train_acc: 87.3047
Epoch: 203 train_loss: 0.3807 train_acc: 86.9141
Epoch: 204 train_loss: 0.3385 train_acc: 89.6484
Epoch: 205 train_loss: 0.3235 train_acc: 88.2812
Epoch: 206 train_loss: 0.2705 train_acc: 92.5781
Epoch: 207 train_loss: 0.2818 train_acc: 91.6016
Epoch: 208 train_loss: 0.2642 train_acc: 92.7734
Epoch: 209 train_loss: 0.2527 train_acc: 93.5547
Epoch: 210 train_loss: 0.2663 train_acc: 91.9922
Epoch: 211 train_loss: 0.2745 train_acc: 91.4062
Epoch: 212 train_loss: 0.2650 train_acc: 92.1875
Epoch: 213 train_loss: 0.2645 train_acc: 90.2344
Epoch: 214 train_loss: 0.2731 train_acc: 91.2109
Epoch: 215 train_loss: 0.2802 train_acc: 91.4062
Epoch: 216 train_loss: 0.2593 train_acc: 92.7734
Epoch: 217 train_loss: 0.2379 train_acc: 94.1406
Epoch: 218 train_loss: 0.2361 train_acc: 94.5312
Epoch: 219 train_loss: 0.2468 train_acc: 93.5547
Epoch: 220 train_loss: 0.2447 train_acc: 92.5781
Epoch: 221 train_loss: 0.2376 train_acc: 93.3594
Epoch: 222 train_loss: 0.2435 train_acc: 92.1875
Epoch: 223 train_loss: 0.2366 train_acc: 93.5547
Epoch: 224 train_loss: 0.2432 train_acc: 94.1406
Epoch: 225 train_loss: 0.2536 train_acc: 93.1641
Epoch: 226 train_loss: 0.2576 train_acc: 91.4062
Epoch: 227 train_loss: 0.2342 train_acc: 93.7500
Epoch: 228 train_loss: 0.2219 train_acc: 93.7500
Epoch: 229 train_loss: 0.2180 train_acc: 93.7500
Epoch: 230 train_loss: 0.2430 train_acc: 92.3828
Epoch: 231 train_loss: 0.2406 train_acc: 91.9922
Epoch: 232 train_loss: 0.2002 train_acc: 94.3359
Epoch: 233 train_loss: 0.2141 train_acc: 94.5312
Epoch: 234 train_loss: 0.1970 train_acc: 94.1406
Epoch: 235 train_loss: 0.2004 train_acc: 93.7500
Epoch: 236 train_loss: 0.1799 train_acc: 95.8984
Epoch: 237 train_loss: 0.2112 train_acc: 94.1406
Epoch: 238 train_loss: 0.2413 train_acc: 92.3828
Epoch: 239 train_loss: 0.1983 train_acc: 94.5312
Epoch: 240 train_loss: 0.2002 train_acc: 95.7031
Epoch: 241 train_loss: 0.2086 train_acc: 93.7500
Epoch: 242 train_loss: 0.1976 train_acc: 93.5547
Epoch: 243 train_loss: 0.1929 train_acc: 96.0938
Epoch: 244 train_loss: 0.2078 train_acc: 94.1406
Epoch: 245 train_loss: 0.2083 train_acc: 93.9453
Epoch: 246 train_loss: 0.1973 train_acc: 94.7266
Epoch: 247 train_loss: 0.2012 train_acc: 94.3359
Epoch: 248 train_loss: 0.1725 train_acc: 95.8984
Epoch: 249 train_loss: 0.2123 train_acc: 92.5781
Epoch: 250 train_loss: 0.2375 train_acc: 93.1641
Epoch: 251 train_loss: 0.2533 train_acc: 92.5781
Epoch: 252 train_loss: 0.2271 train_acc: 93.9453
Epoch: 253 train_loss: 0.1999 train_acc: 94.7266
Epoch: 254 train_loss: 0.2056 train_acc: 95.1172
Epoch: 255 train_loss: 0.1920 train_acc: 95.5078
Epoch: 256 train_loss: 0.2019 train_acc: 94.7266
Epoch: 257 train_loss: 0.1795 train_acc: 95.3125
Epoch: 258 train_loss: 0.2052 train_acc: 94.5312
Epoch: 259 train_loss: 0.1900 train_acc: 94.3359
Epoch: 260 train_loss: 0.1630 train_acc: 96.0938
Epoch: 261 train_loss: 0.1640 train_acc: 95.8984
Epoch: 262 train_loss: 0.1872 train_acc: 95.1172
Epoch: 263 train_loss: 0.1699 train_acc: 94.7266
Epoch: 264 train_loss: 0.1606 train_acc: 95.5078
Epoch: 265 train_loss: 0.1684 train_acc: 94.7266
Epoch: 266 train_loss: 0.2237 train_acc: 92.9688
Epoch: 267 train_loss: 0.2194 train_acc: 93.3594
Epoch: 268 train_loss: 0.1787 train_acc: 95.8984
Epoch: 269 train_loss: 0.1817 train_acc: 95.3125
Epoch: 270 train_loss: 0.1774 train_acc: 94.9219
Epoch: 271 train_loss: 0.1956 train_acc: 94.3359
Epoch: 272 train_loss: 0.1599 train_acc: 96.2891
Epoch: 273 train_loss: 0.1501 train_acc: 95.7031
Epoch: 274 train_loss: 0.1343 train_acc: 96.6797
Epoch: 275 train_loss: 0.1812 train_acc: 95.1172
Epoch: 276 train_loss: 0.1587 train_acc: 95.3125
Epoch: 277 train_loss: 0.1677 train_acc: 95.1172
Epoch: 278 train_loss: 0.1570 train_acc: 96.0938
Epoch: 279 train_loss: 0.1358 train_acc: 97.4609
Epoch: 280 train_loss: 0.1406 train_acc: 97.2656
Epoch: 281 train_loss: 0.1487 train_acc: 95.8984
Epoch: 282 train_loss: 0.1474 train_acc: 95.8984
Epoch: 283 train_loss: 0.1356 train_acc: 95.7031
Epoch: 284 train_loss: 0.1393 train_acc: 96.6797
Epoch: 285 train_loss: 0.1384 train_acc: 96.2891
Epoch: 286 train_loss: 0.1301 train_acc: 97.8516
Epoch: 287 train_loss: 0.1387 train_acc: 96.4844
Epoch: 288 train_loss: 0.1233 train_acc: 96.6797
Epoch: 289 train_loss: 0.1262 train_acc: 97.2656
Epoch: 290 train_loss: 0.1361 train_acc: 96.4844
Epoch: 291 train_loss: 0.1158 train_acc: 98.2422
Epoch: 292 train_loss: 0.1485 train_acc: 96.6797
Epoch: 293 train_loss: 0.1442 train_acc: 96.2891
Epoch: 294 train_loss: 0.1420 train_acc: 96.8750
Epoch: 295 train_loss: 0.1227 train_acc: 97.0703
Epoch: 296 train_loss: 0.1332 train_acc: 96.6797
Epoch: 297 train_loss: 0.1545 train_acc: 96.0938
Epoch: 298 train_loss: 0.1600 train_acc: 95.8984
Epoch: 299 train_loss: 0.1798 train_acc: 94.3359
Epoch: 300 train_loss: 0.1440 train_acc: 97.0703
Running Time: 167.34
**************************************************
Final result:
OA: 0.7645 | AA: 0.6233 | Kappa: 0.7312
[0.34090909 0.56079587 0.8248731  0.28444444 0.76906318 0.92363112
 0.03703704 0.95814978 0.21052632 0.7659805  0.84691252 0.56483126
 0.96410256 0.91763727 0.50408719 0.5       ]
**************************************************
Parameter:
dataset: Indian
flag_test: train
mode: CAF
gpu_id: 0
seed: 24
batch_size: 64
test_freq: 5
patches: 7
band_patches: 3
epoches: 300
learning_rate: 0.0005
gamma: 0.9
weight_decay: 0.005
height=145,width=145,band=200
**************************************************
patch is : 7
mirror_image shape : [151,151,200]
**************************************************
x_train shape = (512, 7, 7, 200), type = float64
/home/amax/anaconda3/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
x_test  shape = (9737, 7, 7, 200), type = float64
x_true  shape = (21025, 7, 7, 200), type = float64
**************************************************
x_train_band shape = (512, 147, 200), type = float64
x_test_band  shape = (9737, 147, 200), type = float64
x_true_band  shape = (21025, 147, 200), type = float64
**************************************************
y_train: shape = (512,) ,type = int64
y_test: shape = (9737,) ,type = int64
y_true: shape = (21025,) ,type = int64
**************************************************
start training
Epoch: 001 train_loss: 2.5212 train_acc: 20.7031
Epoch: 002 train_loss: 2.3495 train_acc: 18.3594
Epoch: 003 train_loss: 2.2568 train_acc: 28.5156
Epoch: 004 train_loss: 2.0742 train_acc: 35.9375
Epoch: 005 train_loss: 1.9283 train_acc: 35.9375
Epoch: 006 train_loss: 1.8498 train_acc: 38.8672
Epoch: 007 train_loss: 1.7864 train_acc: 39.4531
Epoch: 008 train_loss: 1.7549 train_acc: 40.0391
Epoch: 009 train_loss: 1.6882 train_acc: 41.4062
Epoch: 010 train_loss: 1.6525 train_acc: 44.1406
Epoch: 011 train_loss: 1.5970 train_acc: 43.3594
Epoch: 012 train_loss: 1.5587 train_acc: 45.1172
Epoch: 013 train_loss: 1.5256 train_acc: 46.8750
Epoch: 014 train_loss: 1.4891 train_acc: 47.4609
Epoch: 015 train_loss: 1.4790 train_acc: 48.6328
Epoch: 016 train_loss: 1.4596 train_acc: 48.2422
Epoch: 017 train_loss: 1.4603 train_acc: 47.4609
Epoch: 018 train_loss: 1.4366 train_acc: 50.3906
Epoch: 019 train_loss: 1.4418 train_acc: 48.2422
Epoch: 020 train_loss: 1.4000 train_acc: 50.0000
Epoch: 021 train_loss: 1.3736 train_acc: 50.1953
Epoch: 022 train_loss: 1.3694 train_acc: 52.7344
Epoch: 023 train_loss: 1.3628 train_acc: 51.3672
Epoch: 024 train_loss: 1.3394 train_acc: 51.3672
Epoch: 025 train_loss: 1.3397 train_acc: 50.9766
Epoch: 026 train_loss: 1.3785 train_acc: 50.5859
Epoch: 027 train_loss: 1.3354 train_acc: 51.3672
Epoch: 028 train_loss: 1.3147 train_acc: 52.9297
Epoch: 029 train_loss: 1.3125 train_acc: 53.1250
Epoch: 030 train_loss: 1.2900 train_acc: 53.5156
Epoch: 031 train_loss: 1.3064 train_acc: 53.5156
Epoch: 032 train_loss: 1.2859 train_acc: 53.1250
Epoch: 033 train_loss: 1.2808 train_acc: 55.2734
Epoch: 034 train_loss: 1.2712 train_acc: 55.4688
Epoch: 035 train_loss: 1.2532 train_acc: 54.6875
Epoch: 036 train_loss: 1.2530 train_acc: 54.4922
Epoch: 037 train_loss: 1.2611 train_acc: 53.5156
Epoch: 038 train_loss: 1.2565 train_acc: 54.2969
Epoch: 039 train_loss: 1.2504 train_acc: 55.6641
Epoch: 040 train_loss: 1.2386 train_acc: 55.2734
Epoch: 041 train_loss: 1.2387 train_acc: 55.4688
Epoch: 042 train_loss: 1.2178 train_acc: 54.4922
Epoch: 043 train_loss: 1.1992 train_acc: 56.4453
Epoch: 044 train_loss: 1.2048 train_acc: 57.0312
Epoch: 045 train_loss: 1.2018 train_acc: 56.2500
Epoch: 046 train_loss: 1.1818 train_acc: 57.4219
Epoch: 047 train_loss: 1.2284 train_acc: 55.2734
Epoch: 048 train_loss: 1.1764 train_acc: 55.2734
Epoch: 049 train_loss: 1.1852 train_acc: 58.5938
Epoch: 050 train_loss: 1.1566 train_acc: 58.9844
Epoch: 051 train_loss: 1.1344 train_acc: 58.0078
Epoch: 052 train_loss: 1.1525 train_acc: 57.6172
Epoch: 053 train_loss: 1.1544 train_acc: 59.1797
Epoch: 054 train_loss: 1.1240 train_acc: 59.9609
Epoch: 055 train_loss: 1.1522 train_acc: 59.1797
Epoch: 056 train_loss: 1.1356 train_acc: 57.6172
Epoch: 057 train_loss: 1.1322 train_acc: 57.8125
Epoch: 058 train_loss: 1.1004 train_acc: 60.7422
Epoch: 059 train_loss: 1.1011 train_acc: 60.1562
Epoch: 060 train_loss: 1.1096 train_acc: 58.7891
Epoch: 061 train_loss: 1.0643 train_acc: 62.1094
Epoch: 062 train_loss: 1.0921 train_acc: 60.9375
Epoch: 063 train_loss: 1.1150 train_acc: 58.5938
Epoch: 064 train_loss: 1.0778 train_acc: 59.5703
Epoch: 065 train_loss: 1.0804 train_acc: 60.5469
Epoch: 066 train_loss: 1.0921 train_acc: 59.5703
Epoch: 067 train_loss: 1.0924 train_acc: 61.5234
Epoch: 068 train_loss: 1.0697 train_acc: 59.9609
Epoch: 069 train_loss: 1.0638 train_acc: 59.7656
Epoch: 070 train_loss: 1.0302 train_acc: 63.4766
Epoch: 071 train_loss: 1.0367 train_acc: 62.1094
Epoch: 072 train_loss: 1.0112 train_acc: 64.2578
Epoch: 073 train_loss: 0.9892 train_acc: 62.5000
Epoch: 074 train_loss: 1.0181 train_acc: 62.6953
Epoch: 075 train_loss: 1.0055 train_acc: 61.9141
Epoch: 076 train_loss: 1.0147 train_acc: 64.4531
Epoch: 077 train_loss: 1.0373 train_acc: 62.3047
Epoch: 078 train_loss: 1.0085 train_acc: 63.4766
Epoch: 079 train_loss: 0.9916 train_acc: 61.7188
Epoch: 080 train_loss: 0.9813 train_acc: 65.8203
Epoch: 081 train_loss: 1.0033 train_acc: 63.2812
Epoch: 082 train_loss: 0.9630 train_acc: 65.8203
Epoch: 083 train_loss: 0.9978 train_acc: 63.4766
Epoch: 084 train_loss: 0.9798 train_acc: 64.4531
Epoch: 085 train_loss: 0.9383 train_acc: 64.6484
Epoch: 086 train_loss: 0.9521 train_acc: 63.8672
Epoch: 087 train_loss: 0.9463 train_acc: 63.0859
Epoch: 088 train_loss: 0.9463 train_acc: 66.2109
Epoch: 089 train_loss: 0.9456 train_acc: 65.2344
Epoch: 090 train_loss: 0.9631 train_acc: 63.4766
Epoch: 091 train_loss: 0.9432 train_acc: 64.4531
Epoch: 092 train_loss: 0.9923 train_acc: 61.3281
Epoch: 093 train_loss: 0.9424 train_acc: 63.4766
Epoch: 094 train_loss: 0.9342 train_acc: 65.2344
Epoch: 095 train_loss: 0.9063 train_acc: 66.0156
Epoch: 096 train_loss: 0.9048 train_acc: 65.2344
Epoch: 097 train_loss: 0.9217 train_acc: 66.4062
Epoch: 098 train_loss: 0.8797 train_acc: 67.7734
Epoch: 099 train_loss: 0.9051 train_acc: 66.0156
Epoch: 100 train_loss: 0.9306 train_acc: 65.8203
Epoch: 101 train_loss: 0.8934 train_acc: 66.9922
Epoch: 102 train_loss: 0.9089 train_acc: 66.0156
Epoch: 103 train_loss: 0.8779 train_acc: 66.9922
Epoch: 104 train_loss: 0.8714 train_acc: 67.7734
Epoch: 105 train_loss: 0.8444 train_acc: 67.5781
Epoch: 106 train_loss: 0.8498 train_acc: 66.7969
Epoch: 107 train_loss: 0.8568 train_acc: 68.5547
Epoch: 108 train_loss: 0.8549 train_acc: 68.5547
Epoch: 109 train_loss: 0.8750 train_acc: 65.4297
Epoch: 110 train_loss: 0.8712 train_acc: 67.3828
Epoch: 111 train_loss: 0.8768 train_acc: 66.0156
Epoch: 112 train_loss: 0.8329 train_acc: 70.5078
Epoch: 113 train_loss: 0.8536 train_acc: 66.7969
Epoch: 114 train_loss: 0.8264 train_acc: 70.1172
Epoch: 115 train_loss: 0.8121 train_acc: 69.5312
Epoch: 116 train_loss: 0.8124 train_acc: 70.3125
Epoch: 117 train_loss: 0.8250 train_acc: 70.3125
Epoch: 118 train_loss: 0.8181 train_acc: 68.7500
Epoch: 119 train_loss: 0.8000 train_acc: 70.7031
Epoch: 120 train_loss: 0.7685 train_acc: 71.2891
Epoch: 121 train_loss: 0.7359 train_acc: 72.0703
Epoch: 122 train_loss: 0.7670 train_acc: 70.8984
Epoch: 123 train_loss: 0.8204 train_acc: 69.1406
Epoch: 124 train_loss: 0.7964 train_acc: 68.1641
Epoch: 125 train_loss: 0.8024 train_acc: 70.1172
Epoch: 126 train_loss: 0.8003 train_acc: 68.9453
Epoch: 127 train_loss: 0.7492 train_acc: 73.4375
Epoch: 128 train_loss: 0.7211 train_acc: 73.8281
Epoch: 129 train_loss: 0.7656 train_acc: 71.4844
Epoch: 130 train_loss: 0.7374 train_acc: 73.0469
Epoch: 131 train_loss: 0.7309 train_acc: 71.6797
Epoch: 132 train_loss: 0.7163 train_acc: 73.6328
Epoch: 133 train_loss: 0.6900 train_acc: 75.1953
Epoch: 134 train_loss: 0.7497 train_acc: 72.0703
Epoch: 135 train_loss: 0.7785 train_acc: 68.9453
Epoch: 136 train_loss: 0.6787 train_acc: 75.5859
Epoch: 137 train_loss: 0.6626 train_acc: 73.8281
Epoch: 138 train_loss: 0.6576 train_acc: 77.1484
Epoch: 139 train_loss: 0.6624 train_acc: 76.7578
Epoch: 140 train_loss: 0.6184 train_acc: 77.3438
Epoch: 141 train_loss: 0.6017 train_acc: 78.3203
Epoch: 142 train_loss: 0.6053 train_acc: 78.9062
Epoch: 143 train_loss: 0.5891 train_acc: 78.1250
Epoch: 144 train_loss: 0.6045 train_acc: 78.5156
Epoch: 145 train_loss: 0.6213 train_acc: 78.7109
Epoch: 146 train_loss: 0.6365 train_acc: 76.7578
Epoch: 147 train_loss: 0.6067 train_acc: 79.4922
Epoch: 148 train_loss: 0.5880 train_acc: 79.2969
Epoch: 149 train_loss: 0.5833 train_acc: 80.2734
Epoch: 150 train_loss: 0.5773 train_acc: 78.7109
Epoch: 151 train_loss: 0.5982 train_acc: 78.3203
Epoch: 152 train_loss: 0.6216 train_acc: 77.3438
Epoch: 153 train_loss: 0.6529 train_acc: 78.3203
Epoch: 154 train_loss: 0.6178 train_acc: 79.4922
Epoch: 155 train_loss: 0.5514 train_acc: 80.0781
Epoch: 156 train_loss: 0.5264 train_acc: 83.0078
Epoch: 157 train_loss: 0.5031 train_acc: 83.7891
Epoch: 158 train_loss: 0.5557 train_acc: 82.0312
Epoch: 159 train_loss: 0.5419 train_acc: 81.4453
Epoch: 160 train_loss: 0.5563 train_acc: 78.9062
Epoch: 161 train_loss: 0.5168 train_acc: 82.6172
Epoch: 162 train_loss: 0.4853 train_acc: 83.5938
Epoch: 163 train_loss: 0.5018 train_acc: 82.8125
Epoch: 164 train_loss: 0.4839 train_acc: 82.8125
Epoch: 165 train_loss: 0.5096 train_acc: 83.0078
Epoch: 166 train_loss: 0.5134 train_acc: 82.8125
Epoch: 167 train_loss: 0.5277 train_acc: 81.4453
Epoch: 168 train_loss: 0.5478 train_acc: 81.4453
Epoch: 169 train_loss: 0.5366 train_acc: 81.0547
Epoch: 170 train_loss: 0.5130 train_acc: 81.0547
Epoch: 171 train_loss: 0.5099 train_acc: 81.6406
Epoch: 172 train_loss: 0.5353 train_acc: 83.0078
Epoch: 173 train_loss: 0.5273 train_acc: 83.7891
Epoch: 174 train_loss: 0.4746 train_acc: 83.3984
Epoch: 175 train_loss: 0.4635 train_acc: 85.1562
Epoch: 176 train_loss: 0.4405 train_acc: 85.7422
Epoch: 177 train_loss: 0.4327 train_acc: 85.9375
Epoch: 178 train_loss: 0.4272 train_acc: 85.7422
Epoch: 179 train_loss: 0.4113 train_acc: 87.6953
Epoch: 180 train_loss: 0.3855 train_acc: 89.0625
Epoch: 181 train_loss: 0.4233 train_acc: 87.1094
Epoch: 182 train_loss: 0.4886 train_acc: 83.0078
Epoch: 183 train_loss: 0.4395 train_acc: 84.9609
Epoch: 184 train_loss: 0.4038 train_acc: 87.6953
Epoch: 185 train_loss: 0.3861 train_acc: 87.3047
Epoch: 186 train_loss: 0.3927 train_acc: 87.8906
Epoch: 187 train_loss: 0.3578 train_acc: 88.8672
Epoch: 188 train_loss: 0.3737 train_acc: 90.0391
Epoch: 189 train_loss: 0.3941 train_acc: 87.1094
Epoch: 190 train_loss: 0.3570 train_acc: 89.6484
Epoch: 191 train_loss: 0.3576 train_acc: 88.2812
Epoch: 192 train_loss: 0.3477 train_acc: 90.2344
Epoch: 193 train_loss: 0.3697 train_acc: 88.6719
Epoch: 194 train_loss: 0.3596 train_acc: 88.6719
Epoch: 195 train_loss: 0.4302 train_acc: 86.5234
Epoch: 196 train_loss: 0.4174 train_acc: 85.9375
Epoch: 197 train_loss: 0.4173 train_acc: 85.9375
Epoch: 198 train_loss: 0.3938 train_acc: 87.6953
Epoch: 199 train_loss: 0.3587 train_acc: 87.8906
Epoch: 200 train_loss: 0.3109 train_acc: 92.5781
Epoch: 201 train_loss: 0.3594 train_acc: 90.0391
Epoch: 202 train_loss: 0.3524 train_acc: 88.6719
Epoch: 203 train_loss: 0.4066 train_acc: 88.4766
Epoch: 204 train_loss: 0.3595 train_acc: 87.8906
Epoch: 205 train_loss: 0.3461 train_acc: 90.6250
Epoch: 206 train_loss: 0.3134 train_acc: 90.0391
Epoch: 207 train_loss: 0.3520 train_acc: 88.8672
Epoch: 208 train_loss: 0.3719 train_acc: 86.9141
Epoch: 209 train_loss: 0.3015 train_acc: 92.1875
Epoch: 210 train_loss: 0.3290 train_acc: 89.0625
Epoch: 211 train_loss: 0.3051 train_acc: 91.2109
Epoch: 212 train_loss: 0.3027 train_acc: 91.4062
Epoch: 213 train_loss: 0.2893 train_acc: 91.4062
Epoch: 214 train_loss: 0.3030 train_acc: 92.1875
Epoch: 215 train_loss: 0.3149 train_acc: 90.8203
Epoch: 216 train_loss: 0.3279 train_acc: 90.4297
Epoch: 217 train_loss: 0.3455 train_acc: 89.0625
Epoch: 218 train_loss: 0.3307 train_acc: 91.6016
Epoch: 219 train_loss: 0.2916 train_acc: 91.7969
Epoch: 220 train_loss: 0.2985 train_acc: 90.2344
Epoch: 221 train_loss: 0.3041 train_acc: 90.4297
Epoch: 222 train_loss: 0.3203 train_acc: 90.2344
Epoch: 223 train_loss: 0.2921 train_acc: 91.2109
Epoch: 224 train_loss: 0.2765 train_acc: 91.6016
Epoch: 225 train_loss: 0.2771 train_acc: 91.6016
Epoch: 226 train_loss: 0.2259 train_acc: 93.9453
Epoch: 227 train_loss: 0.2828 train_acc: 92.1875
Epoch: 228 train_loss: 0.2414 train_acc: 93.7500
Epoch: 229 train_loss: 0.2778 train_acc: 93.1641
Epoch: 230 train_loss: 0.2404 train_acc: 92.9688
Epoch: 231 train_loss: 0.2637 train_acc: 91.6016
Epoch: 232 train_loss: 0.2375 train_acc: 93.7500
Epoch: 233 train_loss: 0.2117 train_acc: 94.3359
Epoch: 234 train_loss: 0.2602 train_acc: 93.1641
Epoch: 235 train_loss: 0.2789 train_acc: 91.7969
Epoch: 236 train_loss: 0.2790 train_acc: 92.3828
Epoch: 237 train_loss: 0.3034 train_acc: 90.2344
Epoch: 238 train_loss: 0.2980 train_acc: 91.2109
Epoch: 239 train_loss: 0.2423 train_acc: 93.9453
Epoch: 240 train_loss: 0.2459 train_acc: 92.5781
Epoch: 241 train_loss: 0.2230 train_acc: 94.9219
Epoch: 242 train_loss: 0.2414 train_acc: 93.5547
Epoch: 243 train_loss: 0.2339 train_acc: 93.7500
Epoch: 244 train_loss: 0.2715 train_acc: 91.4062
Epoch: 245 train_loss: 0.2229 train_acc: 93.3594
Epoch: 246 train_loss: 0.2561 train_acc: 92.3828
Epoch: 247 train_loss: 0.2986 train_acc: 91.0156
Epoch: 248 train_loss: 0.2770 train_acc: 92.3828
Epoch: 249 train_loss: 0.2643 train_acc: 91.6016
Epoch: 250 train_loss: 0.2626 train_acc: 92.7734
Epoch: 251 train_loss: 0.2445 train_acc: 93.9453
Epoch: 252 train_loss: 0.2187 train_acc: 94.1406
Epoch: 253 train_loss: 0.2259 train_acc: 93.7500
Epoch: 254 train_loss: 0.1930 train_acc: 96.0938
Epoch: 255 train_loss: 0.1786 train_acc: 96.6797
Epoch: 256 train_loss: 0.1812 train_acc: 96.2891
Epoch: 257 train_loss: 0.2009 train_acc: 94.3359
Epoch: 258 train_loss: 0.2135 train_acc: 93.9453
Epoch: 259 train_loss: 0.2291 train_acc: 93.9453
Epoch: 260 train_loss: 0.2329 train_acc: 93.1641
Epoch: 261 train_loss: 0.2324 train_acc: 93.7500
Epoch: 262 train_loss: 0.2352 train_acc: 92.5781
Epoch: 263 train_loss: 0.2303 train_acc: 93.1641
Epoch: 264 train_loss: 0.1961 train_acc: 94.1406
Epoch: 265 train_loss: 0.2062 train_acc: 94.9219
Epoch: 266 train_loss: 0.2331 train_acc: 93.3594
Epoch: 267 train_loss: 0.2262 train_acc: 92.9688
Epoch: 268 train_loss: 0.2106 train_acc: 94.9219
Epoch: 269 train_loss: 0.2327 train_acc: 94.1406
Epoch: 270 train_loss: 0.2368 train_acc: 93.9453
Epoch: 271 train_loss: 0.2076 train_acc: 95.3125
Epoch: 272 train_loss: 0.2221 train_acc: 94.1406
Epoch: 273 train_loss: 0.1994 train_acc: 94.3359
Epoch: 274 train_loss: 0.2848 train_acc: 91.2109
Epoch: 275 train_loss: 0.2003 train_acc: 94.3359
Epoch: 276 train_loss: 0.1669 train_acc: 96.8750
Epoch: 277 train_loss: 0.1714 train_acc: 96.2891
Epoch: 278 train_loss: 0.1813 train_acc: 96.0938
Epoch: 279 train_loss: 0.1872 train_acc: 95.8984
Epoch: 280 train_loss: 0.1717 train_acc: 96.0938
Epoch: 281 train_loss: 0.1893 train_acc: 95.1172
Epoch: 282 train_loss: 0.2046 train_acc: 94.5312
Epoch: 283 train_loss: 0.2221 train_acc: 92.9688
Epoch: 284 train_loss: 0.1919 train_acc: 95.7031
Epoch: 285 train_loss: 0.1968 train_acc: 94.3359
Epoch: 286 train_loss: 0.2035 train_acc: 94.3359
Epoch: 287 train_loss: 0.1729 train_acc: 94.7266
Epoch: 288 train_loss: 0.1691 train_acc: 95.3125
Epoch: 289 train_loss: 0.2092 train_acc: 94.5312
Epoch: 290 train_loss: 0.1865 train_acc: 94.9219
Epoch: 291 train_loss: 0.1535 train_acc: 96.4844
Epoch: 292 train_loss: 0.1534 train_acc: 96.8750
Epoch: 293 train_loss: 0.1361 train_acc: 97.2656
Epoch: 294 train_loss: 0.1414 train_acc: 97.2656
Epoch: 295 train_loss: 0.1345 train_acc: 97.2656
Epoch: 296 train_loss: 0.1335 train_acc: 97.0703
Epoch: 297 train_loss: 0.1360 train_acc: 97.2656
Epoch: 298 train_loss: 0.1529 train_acc: 95.8984
Epoch: 299 train_loss: 0.1495 train_acc: 96.6797
Epoch: 300 train_loss: 0.1577 train_acc: 96.2891
Running Time: 168.18
**************************************************
Final result:
OA: 0.7520 | AA: 0.5951 | Kappa: 0.7163
[0.15909091 0.68975682 0.58375635 0.43555556 0.83224401 0.94668588
 0.03703704 0.97797357 0.15789474 0.84290358 0.80874786 0.46714032
 0.93846154 0.86439268 0.41689373 0.36363636]
**************************************************
Parameter:
dataset: Indian
flag_test: train
mode: CAF
gpu_id: 0
seed: 25
batch_size: 64
test_freq: 5
patches: 7
band_patches: 3
epoches: 300
learning_rate: 0.0005
gamma: 0.9
weight_decay: 0.005
height=145,width=145,band=200
**************************************************
patch is : 7
mirror_image shape : [151,151,200]
**************************************************
x_train shape = (512, 7, 7, 200), type = float64
x_test  shape = (9737, 7, 7, 200), type = float64
x_true  shape = (21025, 7, 7, 200), type = float64
**************************************************
x_train_band shape = (512, 147, 200), type = float64
x_test_band  shape = (9737, 147, 200), type = float64
x_true_band  shape = (21025, 147, 200), type = float64
/home/amax/anaconda3/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
**************************************************
y_train: shape = (512,) ,type = int64
y_test: shape = (9737,) ,type = int64
y_true: shape = (21025,) ,type = int64
**************************************************
start training
Epoch: 001 train_loss: 2.5675 train_acc: 22.2656
Epoch: 002 train_loss: 2.3454 train_acc: 26.3672
Epoch: 003 train_loss: 2.2613 train_acc: 24.8047
Epoch: 004 train_loss: 2.1163 train_acc: 34.3750
Epoch: 005 train_loss: 1.9454 train_acc: 35.9375
Epoch: 006 train_loss: 1.8605 train_acc: 35.9375
Epoch: 007 train_loss: 1.7979 train_acc: 38.6719
Epoch: 008 train_loss: 1.7530 train_acc: 40.6250
Epoch: 009 train_loss: 1.7071 train_acc: 40.0391
Epoch: 010 train_loss: 1.6604 train_acc: 42.1875
Epoch: 011 train_loss: 1.6291 train_acc: 43.3594
Epoch: 012 train_loss: 1.5872 train_acc: 44.3359
Epoch: 013 train_loss: 1.5573 train_acc: 44.9219
Epoch: 014 train_loss: 1.5446 train_acc: 45.5078
Epoch: 015 train_loss: 1.5045 train_acc: 46.2891
Epoch: 016 train_loss: 1.5124 train_acc: 44.9219
Epoch: 017 train_loss: 1.4952 train_acc: 46.8750
Epoch: 018 train_loss: 1.4683 train_acc: 47.8516
Epoch: 019 train_loss: 1.4607 train_acc: 48.0469
Epoch: 020 train_loss: 1.4354 train_acc: 48.6328
Epoch: 021 train_loss: 1.4376 train_acc: 47.8516
Epoch: 022 train_loss: 1.4124 train_acc: 49.8047
Epoch: 023 train_loss: 1.4024 train_acc: 49.4141
Epoch: 024 train_loss: 1.4081 train_acc: 48.6328
Epoch: 025 train_loss: 1.3941 train_acc: 49.0234
Epoch: 026 train_loss: 1.3808 train_acc: 49.6094
Epoch: 027 train_loss: 1.3612 train_acc: 50.3906
Epoch: 028 train_loss: 1.3704 train_acc: 49.6094
Epoch: 029 train_loss: 1.3662 train_acc: 50.5859
Epoch: 030 train_loss: 1.3533 train_acc: 50.3906
Epoch: 031 train_loss: 1.3433 train_acc: 49.8047
Epoch: 032 train_loss: 1.3404 train_acc: 50.3906
Epoch: 033 train_loss: 1.3312 train_acc: 51.1719
Epoch: 034 train_loss: 1.3252 train_acc: 50.7812
Epoch: 035 train_loss: 1.3024 train_acc: 51.5625
Epoch: 036 train_loss: 1.2998 train_acc: 49.6094
Epoch: 037 train_loss: 1.2904 train_acc: 52.3438
Epoch: 038 train_loss: 1.3008 train_acc: 52.1484
Epoch: 039 train_loss: 1.3056 train_acc: 51.7578
Epoch: 040 train_loss: 1.2876 train_acc: 52.1484
Epoch: 041 train_loss: 1.2656 train_acc: 52.9297
Epoch: 042 train_loss: 1.2731 train_acc: 51.5625
Epoch: 043 train_loss: 1.2793 train_acc: 52.7344
Epoch: 044 train_loss: 1.2664 train_acc: 50.9766
Epoch: 045 train_loss: 1.2570 train_acc: 52.9297
Epoch: 046 train_loss: 1.2459 train_acc: 53.5156
Epoch: 047 train_loss: 1.2824 train_acc: 51.3672
Epoch: 048 train_loss: 1.2440 train_acc: 54.1016
Epoch: 049 train_loss: 1.2348 train_acc: 53.7109
Epoch: 050 train_loss: 1.2274 train_acc: 54.8828
Epoch: 051 train_loss: 1.2279 train_acc: 53.3203
Epoch: 052 train_loss: 1.2250 train_acc: 53.7109
Epoch: 053 train_loss: 1.2412 train_acc: 52.5391
Epoch: 054 train_loss: 1.2106 train_acc: 54.4922
Epoch: 055 train_loss: 1.1931 train_acc: 53.5156
Epoch: 056 train_loss: 1.2099 train_acc: 54.4922
Epoch: 057 train_loss: 1.1933 train_acc: 55.4688
Epoch: 058 train_loss: 1.1722 train_acc: 57.2266
Epoch: 059 train_loss: 1.1723 train_acc: 54.8828
Epoch: 060 train_loss: 1.1818 train_acc: 54.1016
Epoch: 061 train_loss: 1.1603 train_acc: 56.2500
Epoch: 062 train_loss: 1.1660 train_acc: 55.4688
Epoch: 063 train_loss: 1.1309 train_acc: 58.7891
Epoch: 064 train_loss: 1.1206 train_acc: 58.0078
Epoch: 065 train_loss: 1.1153 train_acc: 58.2031
Epoch: 066 train_loss: 1.1073 train_acc: 58.3984
Epoch: 067 train_loss: 1.1140 train_acc: 57.8125
Epoch: 068 train_loss: 1.1120 train_acc: 58.7891
Epoch: 069 train_loss: 1.1644 train_acc: 54.1016
Epoch: 070 train_loss: 1.1096 train_acc: 58.0078
Epoch: 071 train_loss: 1.0599 train_acc: 59.5703
Epoch: 072 train_loss: 1.0715 train_acc: 58.7891
Epoch: 073 train_loss: 1.0395 train_acc: 60.3516
Epoch: 074 train_loss: 1.0494 train_acc: 59.9609
Epoch: 075 train_loss: 1.0682 train_acc: 60.1562
Epoch: 076 train_loss: 1.0849 train_acc: 59.7656
Epoch: 077 train_loss: 1.0813 train_acc: 58.3984
Epoch: 078 train_loss: 1.0601 train_acc: 59.9609
Epoch: 079 train_loss: 1.0316 train_acc: 59.1797
Epoch: 080 train_loss: 1.0184 train_acc: 62.1094
Epoch: 081 train_loss: 1.0146 train_acc: 59.9609
Epoch: 082 train_loss: 1.0310 train_acc: 62.1094
Epoch: 083 train_loss: 0.9664 train_acc: 61.1328
Epoch: 084 train_loss: 1.0505 train_acc: 59.9609
Epoch: 085 train_loss: 1.0448 train_acc: 58.2031
Epoch: 086 train_loss: 1.0200 train_acc: 62.3047
Epoch: 087 train_loss: 0.9578 train_acc: 62.5000
Epoch: 088 train_loss: 0.9616 train_acc: 62.8906
Epoch: 089 train_loss: 0.9198 train_acc: 67.3828
Epoch: 090 train_loss: 0.8858 train_acc: 66.4062
Epoch: 091 train_loss: 0.8642 train_acc: 69.1406
Epoch: 092 train_loss: 0.8622 train_acc: 67.5781
Epoch: 093 train_loss: 0.8687 train_acc: 67.5781
Epoch: 094 train_loss: 0.9202 train_acc: 63.8672
Epoch: 095 train_loss: 0.8957 train_acc: 65.8203
Epoch: 096 train_loss: 0.9176 train_acc: 66.2109
Epoch: 097 train_loss: 0.9158 train_acc: 65.8203
Epoch: 098 train_loss: 0.8736 train_acc: 67.1875
Epoch: 099 train_loss: 0.8784 train_acc: 66.9922
Epoch: 100 train_loss: 0.9267 train_acc: 65.2344
Epoch: 101 train_loss: 0.9591 train_acc: 65.0391
Epoch: 102 train_loss: 0.8715 train_acc: 64.6484
Epoch: 103 train_loss: 0.8155 train_acc: 73.0469
Epoch: 104 train_loss: 0.8027 train_acc: 71.8750
Epoch: 105 train_loss: 0.7999 train_acc: 71.2891
Epoch: 106 train_loss: 0.8103 train_acc: 71.6797
Epoch: 107 train_loss: 0.7862 train_acc: 70.8984
Epoch: 108 train_loss: 0.7621 train_acc: 74.4141
Epoch: 109 train_loss: 0.7933 train_acc: 68.9453
Epoch: 110 train_loss: 0.7957 train_acc: 69.9219
Epoch: 111 train_loss: 0.7395 train_acc: 74.6094
Epoch: 112 train_loss: 0.7668 train_acc: 72.8516
Epoch: 113 train_loss: 0.8104 train_acc: 68.7500
Epoch: 114 train_loss: 0.7462 train_acc: 73.8281
Epoch: 115 train_loss: 0.7559 train_acc: 73.8281
Epoch: 116 train_loss: 0.7266 train_acc: 74.8047
Epoch: 117 train_loss: 0.7469 train_acc: 73.6328
Epoch: 118 train_loss: 0.7057 train_acc: 73.8281
Epoch: 119 train_loss: 0.7003 train_acc: 77.1484
Epoch: 120 train_loss: 0.7592 train_acc: 71.6797
Epoch: 121 train_loss: 0.7220 train_acc: 74.4141
Epoch: 122 train_loss: 0.7091 train_acc: 75.1953
Epoch: 123 train_loss: 0.7166 train_acc: 76.1719
Epoch: 124 train_loss: 0.7197 train_acc: 75.5859
Epoch: 125 train_loss: 0.7034 train_acc: 73.8281
Epoch: 126 train_loss: 0.6625 train_acc: 77.3438
Epoch: 127 train_loss: 0.6768 train_acc: 75.5859
Epoch: 128 train_loss: 0.6424 train_acc: 77.1484
Epoch: 129 train_loss: 0.6352 train_acc: 79.8828
Epoch: 130 train_loss: 0.6468 train_acc: 76.7578
Epoch: 131 train_loss: 0.6336 train_acc: 78.1250
Epoch: 132 train_loss: 0.6137 train_acc: 80.2734
Epoch: 133 train_loss: 0.6229 train_acc: 78.5156
Epoch: 134 train_loss: 0.5883 train_acc: 81.2500
Epoch: 135 train_loss: 0.6246 train_acc: 78.7109
Epoch: 136 train_loss: 0.6140 train_acc: 78.7109
Epoch: 137 train_loss: 0.6275 train_acc: 77.5391
Epoch: 138 train_loss: 0.6319 train_acc: 77.3438
Epoch: 139 train_loss: 0.6078 train_acc: 78.7109
Epoch: 140 train_loss: 0.6167 train_acc: 78.7109
Epoch: 141 train_loss: 0.5871 train_acc: 78.9062
Epoch: 142 train_loss: 0.5702 train_acc: 79.6875
Epoch: 143 train_loss: 0.5452 train_acc: 82.4219
Epoch: 144 train_loss: 0.5429 train_acc: 80.4688
Epoch: 145 train_loss: 0.5318 train_acc: 82.4219
Epoch: 146 train_loss: 0.5457 train_acc: 82.0312
Epoch: 147 train_loss: 0.5681 train_acc: 80.2734
Epoch: 148 train_loss: 0.6450 train_acc: 76.9531
Epoch: 149 train_loss: 0.5857 train_acc: 78.5156
Epoch: 150 train_loss: 0.5536 train_acc: 80.6641
Epoch: 151 train_loss: 0.5414 train_acc: 81.2500
Epoch: 152 train_loss: 0.5352 train_acc: 81.0547
Epoch: 153 train_loss: 0.5257 train_acc: 82.4219
Epoch: 154 train_loss: 0.4732 train_acc: 84.3750
Epoch: 155 train_loss: 0.5048 train_acc: 84.3750
Epoch: 156 train_loss: 0.4914 train_acc: 83.5938
Epoch: 157 train_loss: 0.4967 train_acc: 84.7656
Epoch: 158 train_loss: 0.5318 train_acc: 81.2500
Epoch: 159 train_loss: 0.4637 train_acc: 84.9609
Epoch: 160 train_loss: 0.4493 train_acc: 87.3047
Epoch: 161 train_loss: 0.5328 train_acc: 80.2734
Epoch: 162 train_loss: 0.5015 train_acc: 82.4219
/home/amax/anaconda3/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
Epoch: 163 train_loss: 0.4883 train_acc: 81.8359
Epoch: 164 train_loss: 0.4809 train_acc: 83.7891
Epoch: 165 train_loss: 0.4382 train_acc: 85.9375
Epoch: 166 train_loss: 0.4819 train_acc: 83.9844
Epoch: 167 train_loss: 0.5374 train_acc: 82.6172
Epoch: 168 train_loss: 0.4847 train_acc: 83.7891
Epoch: 169 train_loss: 0.4362 train_acc: 85.3516
Epoch: 170 train_loss: 0.4109 train_acc: 87.6953
Epoch: 171 train_loss: 0.4192 train_acc: 87.3047
Epoch: 172 train_loss: 0.3959 train_acc: 87.8906
Epoch: 173 train_loss: 0.3785 train_acc: 88.6719
Epoch: 174 train_loss: 0.3962 train_acc: 85.9375
Epoch: 175 train_loss: 0.4198 train_acc: 88.0859
Epoch: 176 train_loss: 0.4226 train_acc: 85.5469
Epoch: 177 train_loss: 0.4020 train_acc: 86.9141
Epoch: 178 train_loss: 0.4153 train_acc: 85.1562
Epoch: 179 train_loss: 0.4182 train_acc: 86.3281
Epoch: 180 train_loss: 0.3897 train_acc: 88.2812
Epoch: 181 train_loss: 0.3993 train_acc: 85.7422
Epoch: 182 train_loss: 0.3849 train_acc: 88.0859
Epoch: 183 train_loss: 0.3958 train_acc: 88.0859
Epoch: 184 train_loss: 0.3706 train_acc: 89.2578
Epoch: 185 train_loss: 0.3746 train_acc: 87.6953
Epoch: 186 train_loss: 0.3484 train_acc: 90.0391
Epoch: 187 train_loss: 0.3325 train_acc: 90.6250
Epoch: 188 train_loss: 0.3577 train_acc: 89.4531
Epoch: 189 train_loss: 0.3359 train_acc: 89.2578
Epoch: 190 train_loss: 0.3390 train_acc: 90.2344
Epoch: 191 train_loss: 0.3399 train_acc: 89.0625
Epoch: 192 train_loss: 0.3500 train_acc: 88.0859
Epoch: 193 train_loss: 0.3324 train_acc: 89.2578
Epoch: 194 train_loss: 0.3560 train_acc: 89.4531
Epoch: 195 train_loss: 0.3079 train_acc: 91.4062
Epoch: 196 train_loss: 0.3234 train_acc: 89.6484
Epoch: 197 train_loss: 0.3110 train_acc: 90.6250
Epoch: 198 train_loss: 0.3445 train_acc: 89.2578
Epoch: 199 train_loss: 0.4471 train_acc: 83.9844
Epoch: 200 train_loss: 0.3470 train_acc: 90.0391
Epoch: 201 train_loss: 0.3194 train_acc: 91.7969
Epoch: 202 train_loss: 0.3623 train_acc: 89.4531
Epoch: 203 train_loss: 0.3453 train_acc: 89.0625
Epoch: 204 train_loss: 0.3334 train_acc: 90.4297
Epoch: 205 train_loss: 0.3517 train_acc: 88.2812
Epoch: 206 train_loss: 0.2953 train_acc: 90.4297
Epoch: 207 train_loss: 0.2785 train_acc: 92.9688
Epoch: 208 train_loss: 0.2899 train_acc: 91.4062
Epoch: 209 train_loss: 0.2914 train_acc: 91.0156
Epoch: 210 train_loss: 0.3046 train_acc: 91.4062
Epoch: 211 train_loss: 0.3008 train_acc: 90.4297
Epoch: 212 train_loss: 0.2680 train_acc: 91.6016
Epoch: 213 train_loss: 0.3038 train_acc: 90.2344
Epoch: 214 train_loss: 0.2925 train_acc: 91.6016
Epoch: 215 train_loss: 0.3015 train_acc: 91.0156
Epoch: 216 train_loss: 0.2807 train_acc: 91.9922
Epoch: 217 train_loss: 0.3152 train_acc: 89.4531
Epoch: 218 train_loss: 0.2764 train_acc: 91.9922
Epoch: 219 train_loss: 0.2856 train_acc: 90.2344
Epoch: 220 train_loss: 0.2875 train_acc: 91.4062
Epoch: 221 train_loss: 0.2522 train_acc: 92.9688
Epoch: 222 train_loss: 0.2749 train_acc: 91.2109
Epoch: 223 train_loss: 0.2759 train_acc: 91.9922
Epoch: 224 train_loss: 0.2667 train_acc: 92.3828
Epoch: 225 train_loss: 0.3010 train_acc: 91.0156
Epoch: 226 train_loss: 0.2620 train_acc: 91.9922
Epoch: 227 train_loss: 0.2710 train_acc: 92.5781
Epoch: 228 train_loss: 0.2871 train_acc: 90.8203
Epoch: 229 train_loss: 0.2622 train_acc: 91.4062
Epoch: 230 train_loss: 0.2389 train_acc: 93.9453
Epoch: 231 train_loss: 0.2625 train_acc: 92.1875
Epoch: 232 train_loss: 0.2809 train_acc: 92.3828
Epoch: 233 train_loss: 0.3044 train_acc: 90.8203
Epoch: 234 train_loss: 0.2374 train_acc: 93.7500
Epoch: 235 train_loss: 0.2555 train_acc: 92.9688
Epoch: 236 train_loss: 0.2333 train_acc: 94.1406
Epoch: 237 train_loss: 0.2373 train_acc: 93.5547
Epoch: 238 train_loss: 0.2345 train_acc: 93.7500
Epoch: 239 train_loss: 0.2586 train_acc: 93.1641
Epoch: 240 train_loss: 0.2474 train_acc: 92.1875
Epoch: 241 train_loss: 0.2301 train_acc: 94.3359
Epoch: 242 train_loss: 0.2367 train_acc: 93.5547
Epoch: 243 train_loss: 0.2473 train_acc: 92.7734
Epoch: 244 train_loss: 0.2220 train_acc: 93.7500
Epoch: 245 train_loss: 0.2365 train_acc: 93.9453
Epoch: 246 train_loss: 0.2028 train_acc: 94.3359
Epoch: 247 train_loss: 0.2345 train_acc: 93.5547
Epoch: 248 train_loss: 0.2285 train_acc: 93.9453
Epoch: 249 train_loss: 0.2063 train_acc: 95.8984
Epoch: 250 train_loss: 0.2171 train_acc: 93.3594
Epoch: 251 train_loss: 0.1977 train_acc: 94.9219
Epoch: 252 train_loss: 0.2022 train_acc: 94.5312
Epoch: 253 train_loss: 0.2577 train_acc: 93.1641
Epoch: 254 train_loss: 0.2002 train_acc: 95.5078
Epoch: 255 train_loss: 0.2117 train_acc: 94.3359
Epoch: 256 train_loss: 0.2096 train_acc: 93.7500
Epoch: 257 train_loss: 0.2111 train_acc: 95.8984
Epoch: 258 train_loss: 0.2218 train_acc: 95.1172
Epoch: 259 train_loss: 0.2384 train_acc: 92.5781
Epoch: 260 train_loss: 0.2283 train_acc: 93.7500
Epoch: 261 train_loss: 0.2022 train_acc: 95.5078
Epoch: 262 train_loss: 0.1954 train_acc: 94.9219
Epoch: 263 train_loss: 0.2346 train_acc: 93.3594
Epoch: 264 train_loss: 0.1936 train_acc: 96.2891
Epoch: 265 train_loss: 0.2149 train_acc: 93.9453
Epoch: 266 train_loss: 0.1851 train_acc: 94.7266
Epoch: 267 train_loss: 0.2013 train_acc: 94.5312
Epoch: 268 train_loss: 0.2025 train_acc: 94.9219
Epoch: 269 train_loss: 0.1759 train_acc: 94.7266
Epoch: 270 train_loss: 0.1920 train_acc: 95.5078
Epoch: 271 train_loss: 0.2087 train_acc: 93.7500
Epoch: 272 train_loss: 0.2415 train_acc: 93.1641
Epoch: 273 train_loss: 0.1879 train_acc: 95.8984
Epoch: 274 train_loss: 0.1963 train_acc: 94.5312
Epoch: 275 train_loss: 0.1976 train_acc: 94.9219
Epoch: 276 train_loss: 0.1813 train_acc: 95.5078
Epoch: 277 train_loss: 0.2057 train_acc: 94.3359
Epoch: 278 train_loss: 0.1749 train_acc: 96.0938
Epoch: 279 train_loss: 0.1813 train_acc: 95.7031
Epoch: 280 train_loss: 0.1770 train_acc: 95.7031
Epoch: 281 train_loss: 0.1649 train_acc: 96.4844
Epoch: 282 train_loss: 0.1502 train_acc: 97.4609
Epoch: 283 train_loss: 0.1603 train_acc: 95.8984
Epoch: 284 train_loss: 0.1559 train_acc: 95.8984
Epoch: 285 train_loss: 0.1590 train_acc: 95.7031
Epoch: 286 train_loss: 0.1854 train_acc: 94.3359
Epoch: 287 train_loss: 0.1555 train_acc: 96.8750
Epoch: 288 train_loss: 0.1511 train_acc: 97.6562
Epoch: 289 train_loss: 0.1872 train_acc: 95.1172
Epoch: 290 train_loss: 0.1803 train_acc: 95.7031
Epoch: 291 train_loss: 0.1678 train_acc: 97.0703
Epoch: 292 train_loss: 0.1712 train_acc: 95.8984
Epoch: 293 train_loss: 0.1723 train_acc: 94.9219
Epoch: 294 train_loss: 0.1769 train_acc: 95.7031
Epoch: 295 train_loss: 0.1574 train_acc: 97.0703
Epoch: 296 train_loss: 0.1565 train_acc: 96.8750
Epoch: 297 train_loss: 0.1440 train_acc: 97.2656
Epoch: 298 train_loss: 0.1733 train_acc: 95.7031
Epoch: 299 train_loss: 0.1537 train_acc: 96.6797
Epoch: 300 train_loss: 0.1722 train_acc: 95.5078
Running Time: 167.42
**************************************************
Final result:
OA: 0.7533 | AA: 0.5843 | Kappa: 0.7154
[0.06818182 0.61532793 0.70558376 0.34666667 0.68409586 0.90345821
 0.         0.9845815  0.         0.69014085 0.90523156 0.37655417
 0.92307692 0.91347754 0.46049046 0.77272727]
**************************************************
Parameter:
dataset: Indian
flag_test: train
mode: CAF
gpu_id: 0
seed: 26
batch_size: 64
test_freq: 5
patches: 7
band_patches: 3
epoches: 300
learning_rate: 0.0005
gamma: 0.9
weight_decay: 0.005
height=145,width=145,band=200
**************************************************
patch is : 7
mirror_image shape : [151,151,200]
**************************************************
x_train shape = (512, 7, 7, 200), type = float64
x_test  shape = (9737, 7, 7, 200), type = float64
x_true  shape = (21025, 7, 7, 200), type = float64
**************************************************
x_train_band shape = (512, 147, 200), type = float64
x_test_band  shape = (9737, 147, 200), type = float64
x_true_band  shape = (21025, 147, 200), type = float64
**************************************************
y_train: shape = (512,) ,type = int64
y_test: shape = (9737,) ,type = int64
y_true: shape = (21025,) ,type = int64
**************************************************
start training
Epoch: 001 train_loss: 2.5010 train_acc: 21.6797
Epoch: 002 train_loss: 2.1415 train_acc: 35.7422
Epoch: 003 train_loss: 1.9400 train_acc: 36.3281
Epoch: 004 train_loss: 1.8305 train_acc: 37.5000
Epoch: 005 train_loss: 1.7689 train_acc: 39.6484
Epoch: 006 train_loss: 1.7212 train_acc: 41.2109
Epoch: 007 train_loss: 1.6716 train_acc: 43.5547
Epoch: 008 train_loss: 1.6324 train_acc: 43.7500
Epoch: 009 train_loss: 1.5965 train_acc: 45.8984
Epoch: 010 train_loss: 1.5903 train_acc: 44.3359
Epoch: 011 train_loss: 1.5423 train_acc: 46.2891
Epoch: 012 train_loss: 1.5353 train_acc: 44.7266
Epoch: 013 train_loss: 1.4882 train_acc: 47.2656
Epoch: 014 train_loss: 1.4629 train_acc: 46.6797
Epoch: 015 train_loss: 1.4474 train_acc: 48.8281
Epoch: 016 train_loss: 1.4227 train_acc: 48.2422
Epoch: 017 train_loss: 1.4154 train_acc: 48.0469
Epoch: 018 train_loss: 1.3925 train_acc: 49.0234
Epoch: 019 train_loss: 1.3998 train_acc: 48.6328
Epoch: 020 train_loss: 1.3878 train_acc: 48.4375
Epoch: 021 train_loss: 1.4038 train_acc: 49.4141
Epoch: 022 train_loss: 1.3874 train_acc: 48.8281
Epoch: 023 train_loss: 1.3669 train_acc: 49.2188
Epoch: 024 train_loss: 1.3620 train_acc: 50.1953
Epoch: 025 train_loss: 1.3259 train_acc: 50.1953
Epoch: 026 train_loss: 1.3202 train_acc: 50.9766
Epoch: 027 train_loss: 1.3079 train_acc: 50.0000
Epoch: 028 train_loss: 1.3209 train_acc: 50.5859
Epoch: 029 train_loss: 1.3173 train_acc: 50.0000
Epoch: 030 train_loss: 1.3017 train_acc: 50.9766
Epoch: 031 train_loss: 1.2869 train_acc: 51.5625
Epoch: 032 train_loss: 1.2763 train_acc: 51.7578
Epoch: 033 train_loss: 1.2737 train_acc: 51.3672
Epoch: 034 train_loss: 1.2466 train_acc: 53.1250
Epoch: 035 train_loss: 1.2525 train_acc: 52.7344
Epoch: 036 train_loss: 1.2461 train_acc: 53.5156
Epoch: 037 train_loss: 1.2280 train_acc: 53.5156
Epoch: 038 train_loss: 1.2248 train_acc: 54.1016
Epoch: 039 train_loss: 1.2296 train_acc: 52.9297
Epoch: 040 train_loss: 1.2098 train_acc: 54.4922
Epoch: 041 train_loss: 1.2078 train_acc: 51.7578
Epoch: 042 train_loss: 1.2329 train_acc: 52.1484
Epoch: 043 train_loss: 1.2371 train_acc: 54.1016
Epoch: 044 train_loss: 1.2368 train_acc: 52.7344
Epoch: 045 train_loss: 1.2122 train_acc: 52.7344
Epoch: 046 train_loss: 1.1939 train_acc: 52.7344
Epoch: 047 train_loss: 1.1828 train_acc: 53.3203
Epoch: 048 train_loss: 1.1717 train_acc: 54.2969
Epoch: 049 train_loss: 1.1716 train_acc: 56.0547
Epoch: 050 train_loss: 1.1372 train_acc: 55.0781
Epoch: 051 train_loss: 1.1336 train_acc: 56.0547
Epoch: 052 train_loss: 1.1165 train_acc: 55.8594
Epoch: 053 train_loss: 1.1113 train_acc: 56.0547
Epoch: 054 train_loss: 1.1136 train_acc: 56.8359
Epoch: 055 train_loss: 1.1228 train_acc: 56.2500
Epoch: 056 train_loss: 1.0964 train_acc: 57.6172
Epoch: 057 train_loss: 1.1187 train_acc: 55.6641
Epoch: 058 train_loss: 1.1155 train_acc: 58.0078
Epoch: 059 train_loss: 1.0647 train_acc: 57.2266
Epoch: 060 train_loss: 1.0524 train_acc: 57.8125
Epoch: 061 train_loss: 1.0508 train_acc: 58.3984
Epoch: 062 train_loss: 1.0303 train_acc: 59.3750
Epoch: 063 train_loss: 1.0278 train_acc: 59.5703
Epoch: 064 train_loss: 1.0336 train_acc: 57.8125
Epoch: 065 train_loss: 1.0294 train_acc: 58.0078
Epoch: 066 train_loss: 1.0231 train_acc: 59.9609
Epoch: 067 train_loss: 1.0295 train_acc: 61.1328
Epoch: 068 train_loss: 0.9973 train_acc: 60.9375
Epoch: 069 train_loss: 0.9764 train_acc: 60.3516
Epoch: 070 train_loss: 0.9869 train_acc: 61.7188
Epoch: 071 train_loss: 1.0018 train_acc: 61.3281
Epoch: 072 train_loss: 1.0289 train_acc: 58.5938
Epoch: 073 train_loss: 0.9847 train_acc: 60.7422
Epoch: 074 train_loss: 0.9540 train_acc: 62.5000
Epoch: 075 train_loss: 0.9712 train_acc: 62.5000
Epoch: 076 train_loss: 0.9829 train_acc: 61.5234
Epoch: 077 train_loss: 0.9785 train_acc: 61.7188
Epoch: 078 train_loss: 0.9814 train_acc: 61.3281
Epoch: 079 train_loss: 0.9465 train_acc: 64.6484
Epoch: 080 train_loss: 0.9240 train_acc: 62.3047
Epoch: 081 train_loss: 0.9232 train_acc: 65.2344
Epoch: 082 train_loss: 0.9444 train_acc: 62.6953
Epoch: 083 train_loss: 0.9547 train_acc: 61.7188
Epoch: 084 train_loss: 0.9074 train_acc: 65.8203
Epoch: 085 train_loss: 0.9127 train_acc: 64.2578
Epoch: 086 train_loss: 0.9026 train_acc: 66.2109
Epoch: 087 train_loss: 0.9967 train_acc: 60.5469
Epoch: 088 train_loss: 0.9706 train_acc: 62.3047
Epoch: 089 train_loss: 0.8812 train_acc: 65.0391
Epoch: 090 train_loss: 0.8898 train_acc: 65.4297
Epoch: 091 train_loss: 0.8361 train_acc: 67.9688
Epoch: 092 train_loss: 0.8693 train_acc: 66.7969
Epoch: 093 train_loss: 0.8935 train_acc: 65.6250
Epoch: 094 train_loss: 0.8862 train_acc: 66.6016
Epoch: 095 train_loss: 0.8792 train_acc: 64.8438
Epoch: 096 train_loss: 0.8939 train_acc: 65.2344
Epoch: 097 train_loss: 0.8426 train_acc: 66.9922
Epoch: 098 train_loss: 0.8198 train_acc: 68.5547
Epoch: 099 train_loss: 0.8369 train_acc: 67.5781
Epoch: 100 train_loss: 0.8122 train_acc: 69.9219
Epoch: 101 train_loss: 0.7901 train_acc: 71.2891
Epoch: 102 train_loss: 0.8385 train_acc: 66.7969
Epoch: 103 train_loss: 0.7524 train_acc: 73.8281
Epoch: 104 train_loss: 0.7515 train_acc: 72.4609
Epoch: 105 train_loss: 0.8100 train_acc: 68.3594
Epoch: 106 train_loss: 0.7949 train_acc: 69.1406
Epoch: 107 train_loss: 0.7635 train_acc: 72.6562
Epoch: 108 train_loss: 0.7287 train_acc: 73.2422
Epoch: 109 train_loss: 0.7241 train_acc: 71.2891
Epoch: 110 train_loss: 0.8025 train_acc: 69.3359
Epoch: 111 train_loss: 0.7690 train_acc: 72.0703
Epoch: 112 train_loss: 0.7765 train_acc: 68.7500
Epoch: 113 train_loss: 0.8354 train_acc: 66.2109
Epoch: 114 train_loss: 0.7637 train_acc: 71.2891
Epoch: 115 train_loss: 0.7437 train_acc: 72.4609
Epoch: 116 train_loss: 0.7152 train_acc: 74.0234
Epoch: 117 train_loss: 0.6783 train_acc: 74.4141
Epoch: 118 train_loss: 0.6846 train_acc: 72.8516
Epoch: 119 train_loss: 0.6803 train_acc: 76.1719
Epoch: 120 train_loss: 0.7117 train_acc: 73.2422
Epoch: 121 train_loss: 0.6825 train_acc: 75.9766
Epoch: 122 train_loss: 0.6273 train_acc: 77.5391
Epoch: 123 train_loss: 0.6258 train_acc: 77.9297
Epoch: 124 train_loss: 0.6165 train_acc: 80.2734
Epoch: 125 train_loss: 0.6898 train_acc: 73.8281
Epoch: 126 train_loss: 0.6468 train_acc: 77.5391
Epoch: 127 train_loss: 0.5822 train_acc: 80.2734
Epoch: 128 train_loss: 0.6187 train_acc: 76.7578
Epoch: 129 train_loss: 0.6316 train_acc: 79.6875
Epoch: 130 train_loss: 0.6245 train_acc: 77.7344
Epoch: 131 train_loss: 0.5948 train_acc: 80.6641
Epoch: 132 train_loss: 0.6239 train_acc: 75.9766
Epoch: 133 train_loss: 0.6695 train_acc: 75.1953
Epoch: 134 train_loss: 0.6333 train_acc: 76.9531
Epoch: 135 train_loss: 0.5874 train_acc: 81.6406
Epoch: 136 train_loss: 0.5937 train_acc: 78.1250
Epoch: 137 train_loss: 0.5603 train_acc: 81.0547
Epoch: 138 train_loss: 0.5704 train_acc: 81.4453
Epoch: 139 train_loss: 0.5043 train_acc: 83.0078
Epoch: 140 train_loss: 0.5178 train_acc: 84.5703
Epoch: 141 train_loss: 0.4914 train_acc: 84.1797
Epoch: 142 train_loss: 0.5712 train_acc: 79.8828
Epoch: 143 train_loss: 0.5328 train_acc: 82.6172
Epoch: 144 train_loss: 0.5498 train_acc: 80.8594
Epoch: 145 train_loss: 0.4838 train_acc: 83.2031
Epoch: 146 train_loss: 0.4957 train_acc: 82.6172
Epoch: 147 train_loss: 0.4812 train_acc: 85.9375
Epoch: 148 train_loss: 0.4481 train_acc: 86.7188
Epoch: 149 train_loss: 0.4628 train_acc: 84.3750
Epoch: 150 train_loss: 0.4178 train_acc: 87.5000
Epoch: 151 train_loss: 0.4437 train_acc: 86.7188
Epoch: 152 train_loss: 0.4931 train_acc: 82.0312
Epoch: 153 train_loss: 0.4369 train_acc: 85.5469
Epoch: 154 train_loss: 0.4474 train_acc: 85.9375
Epoch: 155 train_loss: 0.4752 train_acc: 84.3750
Epoch: 156 train_loss: 0.4334 train_acc: 88.2812
Epoch: 157 train_loss: 0.4247 train_acc: 87.6953
Epoch: 158 train_loss: 0.4071 train_acc: 86.9141
Epoch: 159 train_loss: 0.4003 train_acc: 87.8906
Epoch: 160 train_loss: 0.4080 train_acc: 87.1094
Epoch: 161 train_loss: 0.4037 train_acc: 86.7188
Epoch: 162 train_loss: 0.4050 train_acc: 86.7188
Epoch: 163 train_loss: 0.3952 train_acc: 86.9141
Epoch: 164 train_loss: 0.4180 train_acc: 86.9141
Epoch: 165 train_loss: 0.4370 train_acc: 86.3281
Epoch: 166 train_loss: 0.3893 train_acc: 88.2812
Epoch: 167 train_loss: 0.4030 train_acc: 88.6719
Epoch: 168 train_loss: 0.3794 train_acc: 86.3281
Epoch: 169 train_loss: 0.4362 train_acc: 86.1328
/home/amax/anaconda3/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
Epoch: 170 train_loss: 0.4027 train_acc: 86.5234
Epoch: 171 train_loss: 0.3763 train_acc: 88.8672
Epoch: 172 train_loss: 0.3624 train_acc: 88.8672
Epoch: 173 train_loss: 0.3433 train_acc: 89.0625
Epoch: 174 train_loss: 0.3520 train_acc: 89.0625
Epoch: 175 train_loss: 0.3665 train_acc: 88.0859
Epoch: 176 train_loss: 0.3187 train_acc: 91.0156
Epoch: 177 train_loss: 0.3694 train_acc: 87.6953
Epoch: 178 train_loss: 0.3302 train_acc: 89.4531
Epoch: 179 train_loss: 0.3515 train_acc: 89.0625
Epoch: 180 train_loss: 0.3650 train_acc: 89.0625
Epoch: 181 train_loss: 0.3387 train_acc: 88.4766
Epoch: 182 train_loss: 0.3153 train_acc: 89.2578
Epoch: 183 train_loss: 0.2947 train_acc: 91.6016
Epoch: 184 train_loss: 0.3121 train_acc: 92.9688
Epoch: 185 train_loss: 0.2911 train_acc: 91.4062
Epoch: 186 train_loss: 0.2952 train_acc: 92.3828
Epoch: 187 train_loss: 0.3350 train_acc: 90.8203
Epoch: 188 train_loss: 0.3705 train_acc: 87.8906
Epoch: 189 train_loss: 0.3300 train_acc: 89.2578
Epoch: 190 train_loss: 0.3246 train_acc: 90.0391
Epoch: 191 train_loss: 0.3335 train_acc: 89.2578
Epoch: 192 train_loss: 0.3138 train_acc: 90.6250
Epoch: 193 train_loss: 0.2866 train_acc: 91.4062
Epoch: 194 train_loss: 0.3115 train_acc: 90.0391
Epoch: 195 train_loss: 0.3382 train_acc: 89.6484
Epoch: 196 train_loss: 0.3483 train_acc: 89.8438
Epoch: 197 train_loss: 0.3063 train_acc: 90.8203
Epoch: 198 train_loss: 0.2856 train_acc: 92.7734
Epoch: 199 train_loss: 0.2833 train_acc: 91.2109
Epoch: 200 train_loss: 0.2545 train_acc: 93.1641
Epoch: 201 train_loss: 0.2897 train_acc: 91.2109
Epoch: 202 train_loss: 0.2698 train_acc: 92.5781
Epoch: 203 train_loss: 0.2799 train_acc: 91.9922
Epoch: 204 train_loss: 0.2779 train_acc: 93.1641
Epoch: 205 train_loss: 0.2602 train_acc: 91.9922
Epoch: 206 train_loss: 0.2403 train_acc: 93.3594
Epoch: 207 train_loss: 0.2688 train_acc: 91.2109
Epoch: 208 train_loss: 0.2719 train_acc: 92.3828
Epoch: 209 train_loss: 0.2459 train_acc: 93.1641
Epoch: 210 train_loss: 0.2468 train_acc: 92.9688
Epoch: 211 train_loss: 0.2482 train_acc: 93.7500
Epoch: 212 train_loss: 0.2718 train_acc: 92.5781
Epoch: 213 train_loss: 0.2940 train_acc: 90.6250
Epoch: 214 train_loss: 0.2498 train_acc: 93.5547
Epoch: 215 train_loss: 0.2127 train_acc: 94.5312
Epoch: 216 train_loss: 0.2509 train_acc: 92.3828
Epoch: 217 train_loss: 0.2453 train_acc: 93.3594
Epoch: 218 train_loss: 0.2407 train_acc: 92.9688
Epoch: 219 train_loss: 0.2342 train_acc: 93.3594
Epoch: 220 train_loss: 0.2183 train_acc: 94.9219
Epoch: 221 train_loss: 0.2175 train_acc: 93.5547
Epoch: 222 train_loss: 0.2240 train_acc: 93.9453
Epoch: 223 train_loss: 0.2578 train_acc: 92.1875
Epoch: 224 train_loss: 0.1877 train_acc: 96.2891
Epoch: 225 train_loss: 0.1976 train_acc: 95.1172
Epoch: 226 train_loss: 0.1870 train_acc: 95.8984
Epoch: 227 train_loss: 0.2131 train_acc: 93.9453
Epoch: 228 train_loss: 0.2389 train_acc: 93.7500
Epoch: 229 train_loss: 0.2129 train_acc: 95.3125
Epoch: 230 train_loss: 0.2302 train_acc: 94.9219
Epoch: 231 train_loss: 0.2462 train_acc: 93.1641
Epoch: 232 train_loss: 0.2501 train_acc: 91.6016
Epoch: 233 train_loss: 0.2708 train_acc: 91.0156
Epoch: 234 train_loss: 0.2130 train_acc: 94.1406
Epoch: 235 train_loss: 0.2138 train_acc: 94.1406
Epoch: 236 train_loss: 0.2040 train_acc: 94.5312
Epoch: 237 train_loss: 0.1988 train_acc: 94.7266
Epoch: 238 train_loss: 0.2231 train_acc: 93.7500
Epoch: 239 train_loss: 0.2533 train_acc: 91.4062
Epoch: 240 train_loss: 0.2138 train_acc: 93.7500
Epoch: 241 train_loss: 0.1974 train_acc: 94.7266
Epoch: 242 train_loss: 0.1936 train_acc: 95.1172
Epoch: 243 train_loss: 0.2344 train_acc: 92.9688
Epoch: 244 train_loss: 0.2222 train_acc: 94.1406
Epoch: 245 train_loss: 0.2050 train_acc: 93.9453
Epoch: 246 train_loss: 0.1899 train_acc: 96.0938
Epoch: 247 train_loss: 0.1697 train_acc: 94.9219
Epoch: 248 train_loss: 0.1939 train_acc: 93.7500
Epoch: 249 train_loss: 0.1896 train_acc: 94.7266
Epoch: 250 train_loss: 0.2036 train_acc: 93.9453
Epoch: 251 train_loss: 0.2013 train_acc: 94.3359
Epoch: 252 train_loss: 0.1604 train_acc: 97.2656
Epoch: 253 train_loss: 0.1601 train_acc: 96.6797
Epoch: 254 train_loss: 0.1377 train_acc: 96.6797
Epoch: 255 train_loss: 0.1736 train_acc: 95.7031
Epoch: 256 train_loss: 0.1768 train_acc: 95.3125
Epoch: 257 train_loss: 0.1690 train_acc: 96.4844
Epoch: 258 train_loss: 0.1653 train_acc: 94.7266
Epoch: 259 train_loss: 0.1664 train_acc: 95.8984
Epoch: 260 train_loss: 0.1878 train_acc: 94.9219
Epoch: 261 train_loss: 0.1742 train_acc: 95.5078
Epoch: 262 train_loss: 0.1917 train_acc: 95.3125
Epoch: 263 train_loss: 0.1766 train_acc: 95.3125
Epoch: 264 train_loss: 0.1969 train_acc: 95.1172
Epoch: 265 train_loss: 0.2144 train_acc: 94.7266
Epoch: 266 train_loss: 0.1860 train_acc: 95.5078
Epoch: 267 train_loss: 0.1715 train_acc: 95.3125
Epoch: 268 train_loss: 0.1394 train_acc: 98.0469
Epoch: 269 train_loss: 0.1768 train_acc: 95.3125
Epoch: 270 train_loss: 0.1558 train_acc: 96.2891
Epoch: 271 train_loss: 0.1871 train_acc: 93.5547
Epoch: 272 train_loss: 0.1513 train_acc: 95.7031
Epoch: 273 train_loss: 0.1471 train_acc: 96.2891
Epoch: 274 train_loss: 0.1590 train_acc: 96.0938
Epoch: 275 train_loss: 0.1574 train_acc: 95.8984
Epoch: 276 train_loss: 0.1605 train_acc: 96.0938
Epoch: 277 train_loss: 0.1872 train_acc: 94.3359
Epoch: 278 train_loss: 0.1727 train_acc: 95.5078
Epoch: 279 train_loss: 0.1669 train_acc: 96.2891
Epoch: 280 train_loss: 0.1574 train_acc: 96.2891
Epoch: 281 train_loss: 0.1229 train_acc: 98.0469
Epoch: 282 train_loss: 0.1310 train_acc: 96.8750
Epoch: 283 train_loss: 0.1297 train_acc: 97.2656
Epoch: 284 train_loss: 0.1142 train_acc: 97.8516
Epoch: 285 train_loss: 0.1385 train_acc: 97.6562
Epoch: 286 train_loss: 0.1259 train_acc: 97.6562
Epoch: 287 train_loss: 0.1373 train_acc: 97.4609
Epoch: 288 train_loss: 0.1819 train_acc: 95.1172
Epoch: 289 train_loss: 0.1608 train_acc: 96.2891
Epoch: 290 train_loss: 0.1534 train_acc: 96.2891
Epoch: 291 train_loss: 0.1558 train_acc: 96.6797
Epoch: 292 train_loss: 0.1647 train_acc: 95.8984
Epoch: 293 train_loss: 0.1336 train_acc: 97.2656
Epoch: 294 train_loss: 0.1297 train_acc: 97.4609
Epoch: 295 train_loss: 0.1395 train_acc: 96.6797
Epoch: 296 train_loss: 0.1395 train_acc: 97.0703
Epoch: 297 train_loss: 0.1259 train_acc: 97.2656
Epoch: 298 train_loss: 0.1238 train_acc: 97.6562
Epoch: 299 train_loss: 0.1424 train_acc: 96.4844
Epoch: 300 train_loss: 0.1319 train_acc: 97.4609
Running Time: 167.06
**************************************************
Final result:
OA: 0.7340 | AA: 0.6180 | Kappa: 0.6982
[0.25       0.79145173 0.69035533 0.31111111 0.67755991 0.88184438
 0.07407407 0.92290749 0.10526316 0.80606717 0.6432247  0.57548845
 0.92820513 0.90599002 0.52861035 0.79545455]
**************************************************
Parameter:
dataset: Indian
flag_test: train
mode: CAF
gpu_id: 0
seed: 27
batch_size: 64
test_freq: 5
patches: 7
band_patches: 3
epoches: 300
learning_rate: 0.0005
gamma: 0.9
weight_decay: 0.005
height=145,width=145,band=200
**************************************************
patch is : 7
mirror_image shape : [151,151,200]
**************************************************
x_train shape = (512, 7, 7, 200), type = float64
x_test  shape = (9737, 7, 7, 200), type = float64
x_true  shape = (21025, 7, 7, 200), type = float64
**************************************************
x_train_band shape = (512, 147, 200), type = float64
x_test_band  shape = (9737, 147, 200), type = float64
x_true_band  shape = (21025, 147, 200), type = float64
**************************************************
y_train: shape = (512,) ,type = int64
y_test: shape = (9737,) ,type = int64
y_true: shape = (21025,) ,type = int64
**************************************************
start training
Epoch: 001 train_loss: 2.6492 train_acc: 17.5781
Epoch: 002 train_loss: 2.3487 train_acc: 24.0234
Epoch: 003 train_loss: 2.3016 train_acc: 24.0234
Epoch: 004 train_loss: 2.2012 train_acc: 31.0547
Epoch: 005 train_loss: 2.0199 train_acc: 36.1328
Epoch: 006 train_loss: 1.9057 train_acc: 35.7422
Epoch: 007 train_loss: 1.8089 train_acc: 38.2812
Epoch: 008 train_loss: 1.7627 train_acc: 40.6250
Epoch: 009 train_loss: 1.7173 train_acc: 40.6250
Epoch: 010 train_loss: 1.6822 train_acc: 41.6016
Epoch: 011 train_loss: 1.6438 train_acc: 41.7969
Epoch: 012 train_loss: 1.6122 train_acc: 43.7500
Epoch: 013 train_loss: 1.5782 train_acc: 43.9453
Epoch: 014 train_loss: 1.5581 train_acc: 45.3125
Epoch: 015 train_loss: 1.5055 train_acc: 44.9219
Epoch: 016 train_loss: 1.4911 train_acc: 45.5078
Epoch: 017 train_loss: 1.4582 train_acc: 47.0703
Epoch: 018 train_loss: 1.4303 train_acc: 47.2656
Epoch: 019 train_loss: 1.4175 train_acc: 47.0703
Epoch: 020 train_loss: 1.4066 train_acc: 48.8281
Epoch: 021 train_loss: 1.3893 train_acc: 48.4375
Epoch: 022 train_loss: 1.3885 train_acc: 47.4609
Epoch: 023 train_loss: 1.3507 train_acc: 49.2188
Epoch: 024 train_loss: 1.3651 train_acc: 49.0234
Epoch: 025 train_loss: 1.3441 train_acc: 49.0234
Epoch: 026 train_loss: 1.3434 train_acc: 51.1719
Epoch: 027 train_loss: 1.3377 train_acc: 50.5859
Epoch: 028 train_loss: 1.3233 train_acc: 50.9766
Epoch: 029 train_loss: 1.3105 train_acc: 50.7812
Epoch: 030 train_loss: 1.3076 train_acc: 51.5625
Epoch: 031 train_loss: 1.2908 train_acc: 53.5156
Epoch: 032 train_loss: 1.2943 train_acc: 51.5625
Epoch: 033 train_loss: 1.2780 train_acc: 51.7578
Epoch: 034 train_loss: 1.2769 train_acc: 54.2969
Epoch: 035 train_loss: 1.2979 train_acc: 49.8047
Epoch: 036 train_loss: 1.2677 train_acc: 51.5625
Epoch: 037 train_loss: 1.2658 train_acc: 53.7109
Epoch: 038 train_loss: 1.2571 train_acc: 52.3438
Epoch: 039 train_loss: 1.2524 train_acc: 52.5391
Epoch: 040 train_loss: 1.2311 train_acc: 52.3438
Epoch: 041 train_loss: 1.2322 train_acc: 54.8828
Epoch: 042 train_loss: 1.2123 train_acc: 54.6875
Epoch: 043 train_loss: 1.2137 train_acc: 55.6641
Epoch: 044 train_loss: 1.2054 train_acc: 54.1016
Epoch: 045 train_loss: 1.2178 train_acc: 54.1016
Epoch: 046 train_loss: 1.2202 train_acc: 53.7109
Epoch: 047 train_loss: 1.2121 train_acc: 53.3203
Epoch: 048 train_loss: 1.2045 train_acc: 55.2734
Epoch: 049 train_loss: 1.1608 train_acc: 56.4453
Epoch: 050 train_loss: 1.1716 train_acc: 56.2500
Epoch: 051 train_loss: 1.1839 train_acc: 56.4453
Epoch: 052 train_loss: 1.2035 train_acc: 55.6641
Epoch: 053 train_loss: 1.1825 train_acc: 55.0781
Epoch: 054 train_loss: 1.1801 train_acc: 55.0781
Epoch: 055 train_loss: 1.1737 train_acc: 54.6875
Epoch: 056 train_loss: 1.2017 train_acc: 54.6875
Epoch: 057 train_loss: 1.1478 train_acc: 55.8594
Epoch: 058 train_loss: 1.1530 train_acc: 56.6406
Epoch: 059 train_loss: 1.1409 train_acc: 56.8359
Epoch: 060 train_loss: 1.1401 train_acc: 56.2500
Epoch: 061 train_loss: 1.1110 train_acc: 58.3984
Epoch: 062 train_loss: 1.1272 train_acc: 57.2266
Epoch: 063 train_loss: 1.1128 train_acc: 59.5703
Epoch: 064 train_loss: 1.0902 train_acc: 57.2266
Epoch: 065 train_loss: 1.0850 train_acc: 58.9844
Epoch: 066 train_loss: 1.0933 train_acc: 57.0312
Epoch: 067 train_loss: 1.0954 train_acc: 59.7656
Epoch: 068 train_loss: 1.1099 train_acc: 56.6406
Epoch: 069 train_loss: 1.1525 train_acc: 55.8594
Epoch: 070 train_loss: 1.1233 train_acc: 57.6172
Epoch: 071 train_loss: 1.1201 train_acc: 55.6641
Epoch: 072 train_loss: 1.1008 train_acc: 58.2031
Epoch: 073 train_loss: 1.0984 train_acc: 58.3984
Epoch: 074 train_loss: 1.0647 train_acc: 61.3281
Epoch: 075 train_loss: 1.0392 train_acc: 61.1328
Epoch: 076 train_loss: 1.0320 train_acc: 59.9609
Epoch: 077 train_loss: 1.0384 train_acc: 61.5234
Epoch: 078 train_loss: 1.0086 train_acc: 60.7422
Epoch: 079 train_loss: 1.0274 train_acc: 60.3516
Epoch: 080 train_loss: 1.0122 train_acc: 61.1328
Epoch: 081 train_loss: 1.0168 train_acc: 61.3281
Epoch: 082 train_loss: 1.0624 train_acc: 59.7656
Epoch: 083 train_loss: 1.0380 train_acc: 60.1562
Epoch: 084 train_loss: 1.0282 train_acc: 60.1562
Epoch: 085 train_loss: 0.9930 train_acc: 60.7422
Epoch: 086 train_loss: 1.0394 train_acc: 60.9375
Epoch: 087 train_loss: 1.0144 train_acc: 60.9375
Epoch: 088 train_loss: 0.9993 train_acc: 60.7422
Epoch: 089 train_loss: 0.9848 train_acc: 63.2812
Epoch: 090 train_loss: 0.9843 train_acc: 61.9141
Epoch: 091 train_loss: 0.9643 train_acc: 64.4531
Epoch: 092 train_loss: 0.9800 train_acc: 62.1094
Epoch: 093 train_loss: 0.9533 train_acc: 63.2812
Epoch: 094 train_loss: 0.9290 train_acc: 63.4766
Epoch: 095 train_loss: 0.9316 train_acc: 66.9922
Epoch: 096 train_loss: 0.9376 train_acc: 62.8906
Epoch: 097 train_loss: 0.9329 train_acc: 64.2578
Epoch: 098 train_loss: 0.9237 train_acc: 64.0625
Epoch: 099 train_loss: 0.9469 train_acc: 62.3047
Epoch: 100 train_loss: 0.9505 train_acc: 63.8672
Epoch: 101 train_loss: 0.8855 train_acc: 65.2344
Epoch: 102 train_loss: 0.9015 train_acc: 64.2578
Epoch: 103 train_loss: 0.9093 train_acc: 66.2109
Epoch: 104 train_loss: 0.9144 train_acc: 65.0391
Epoch: 105 train_loss: 0.9265 train_acc: 63.2812
Epoch: 106 train_loss: 0.9254 train_acc: 65.0391
Epoch: 107 train_loss: 0.9013 train_acc: 65.0391
Epoch: 108 train_loss: 0.8525 train_acc: 66.7969
Epoch: 109 train_loss: 0.8860 train_acc: 63.8672
Epoch: 110 train_loss: 0.8966 train_acc: 66.0156
Epoch: 111 train_loss: 0.8586 train_acc: 65.8203
Epoch: 112 train_loss: 0.8420 train_acc: 68.7500
Epoch: 113 train_loss: 0.8250 train_acc: 68.1641
Epoch: 114 train_loss: 0.8185 train_acc: 69.7266
Epoch: 115 train_loss: 0.8284 train_acc: 67.7734
Epoch: 116 train_loss: 0.8546 train_acc: 65.6250
Epoch: 117 train_loss: 0.8384 train_acc: 67.1875
Epoch: 118 train_loss: 0.7897 train_acc: 69.3359
Epoch: 119 train_loss: 0.7804 train_acc: 71.4844
Epoch: 120 train_loss: 0.7836 train_acc: 69.3359
Epoch: 121 train_loss: 0.7930 train_acc: 69.9219
Epoch: 122 train_loss: 0.7919 train_acc: 70.5078
Epoch: 123 train_loss: 0.7757 train_acc: 71.0938
Epoch: 124 train_loss: 0.7529 train_acc: 70.8984
Epoch: 125 train_loss: 0.7217 train_acc: 76.1719
Epoch: 126 train_loss: 0.7362 train_acc: 72.2656
Epoch: 127 train_loss: 0.7056 train_acc: 74.0234
Epoch: 128 train_loss: 0.7503 train_acc: 72.0703
Epoch: 129 train_loss: 0.7136 train_acc: 74.6094
Epoch: 130 train_loss: 0.7091 train_acc: 73.0469
Epoch: 131 train_loss: 0.6750 train_acc: 76.5625
Epoch: 132 train_loss: 0.6511 train_acc: 77.5391
Epoch: 133 train_loss: 0.6440 train_acc: 78.5156
Epoch: 134 train_loss: 0.6666 train_acc: 75.0000
Epoch: 135 train_loss: 0.6817 train_acc: 76.5625
Epoch: 136 train_loss: 0.7157 train_acc: 75.5859
Epoch: 137 train_loss: 0.6776 train_acc: 76.1719
Epoch: 138 train_loss: 0.6026 train_acc: 79.8828
Epoch: 139 train_loss: 0.5975 train_acc: 79.6875
Epoch: 140 train_loss: 0.6875 train_acc: 72.0703
Epoch: 141 train_loss: 0.6631 train_acc: 76.3672
Epoch: 142 train_loss: 0.6735 train_acc: 76.9531
Epoch: 143 train_loss: 0.6296 train_acc: 77.1484
Epoch: 144 train_loss: 0.5866 train_acc: 79.6875
Epoch: 145 train_loss: 0.5689 train_acc: 81.6406
Epoch: 146 train_loss: 0.5837 train_acc: 78.5156
Epoch: 147 train_loss: 0.6056 train_acc: 77.9297
Epoch: 148 train_loss: 0.5488 train_acc: 81.6406
Epoch: 149 train_loss: 0.5526 train_acc: 82.4219
Epoch: 150 train_loss: 0.5689 train_acc: 79.2969
Epoch: 151 train_loss: 0.5697 train_acc: 80.8594
Epoch: 152 train_loss: 0.5676 train_acc: 81.0547
Epoch: 153 train_loss: 0.5233 train_acc: 82.4219
Epoch: 154 train_loss: 0.5155 train_acc: 83.0078
Epoch: 155 train_loss: 0.5283 train_acc: 82.8125
Epoch: 156 train_loss: 0.5391 train_acc: 81.2500
Epoch: 157 train_loss: 0.5465 train_acc: 82.0312
Epoch: 158 train_loss: 0.4607 train_acc: 84.9609
Epoch: 159 train_loss: 0.4750 train_acc: 84.7656
Epoch: 160 train_loss: 0.5125 train_acc: 81.8359
Epoch: 161 train_loss: 0.5173 train_acc: 84.1797
Epoch: 162 train_loss: 0.5004 train_acc: 83.9844
Epoch: 163 train_loss: 0.4867 train_acc: 83.5938
Epoch: 164 train_loss: 0.5029 train_acc: 82.2266
Epoch: 165 train_loss: 0.4970 train_acc: 83.0078
Epoch: 166 train_loss: 0.4856 train_acc: 83.9844
Epoch: 167 train_loss: 0.4753 train_acc: 84.3750
Epoch: 168 train_loss: 0.4716 train_acc: 83.3984
Epoch: 169 train_loss: 0.4421 train_acc: 87.3047
Epoch: 170 train_loss: 0.3835 train_acc: 89.2578
Epoch: 171 train_loss: 0.4022 train_acc: 88.4766
Epoch: 172 train_loss: 0.4048 train_acc: 88.0859
Epoch: 173 train_loss: 0.4111 train_acc: 86.9141
Epoch: 174 train_loss: 0.4167 train_acc: 85.9375
Epoch: 175 train_loss: 0.4378 train_acc: 84.1797
Epoch: 176 train_loss: 0.4159 train_acc: 86.5234
/home/amax/anaconda3/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
Epoch: 177 train_loss: 0.3558 train_acc: 89.6484
Epoch: 178 train_loss: 0.3758 train_acc: 88.2812
Epoch: 179 train_loss: 0.3961 train_acc: 88.6719
Epoch: 180 train_loss: 0.3558 train_acc: 90.8203
Epoch: 181 train_loss: 0.3626 train_acc: 89.4531
Epoch: 182 train_loss: 0.3742 train_acc: 89.6484
Epoch: 183 train_loss: 0.3532 train_acc: 90.8203
Epoch: 184 train_loss: 0.3379 train_acc: 90.0391
Epoch: 185 train_loss: 0.3479 train_acc: 89.4531
Epoch: 186 train_loss: 0.3188 train_acc: 90.0391
Epoch: 187 train_loss: 0.3356 train_acc: 90.4297
Epoch: 188 train_loss: 0.3105 train_acc: 91.2109
Epoch: 189 train_loss: 0.2885 train_acc: 92.5781
Epoch: 190 train_loss: 0.3304 train_acc: 91.0156
Epoch: 191 train_loss: 0.3551 train_acc: 87.8906
Epoch: 192 train_loss: 0.3355 train_acc: 89.4531
Epoch: 193 train_loss: 0.2924 train_acc: 91.9922
Epoch: 194 train_loss: 0.3649 train_acc: 88.4766
Epoch: 195 train_loss: 0.3173 train_acc: 90.0391
Epoch: 196 train_loss: 0.3392 train_acc: 89.6484
Epoch: 197 train_loss: 0.3280 train_acc: 89.6484
Epoch: 198 train_loss: 0.3036 train_acc: 90.8203
Epoch: 199 train_loss: 0.3230 train_acc: 88.8672
Epoch: 200 train_loss: 0.3071 train_acc: 91.4062
Epoch: 201 train_loss: 0.2679 train_acc: 93.1641
Epoch: 202 train_loss: 0.3137 train_acc: 91.9922
Epoch: 203 train_loss: 0.2780 train_acc: 92.9688
Epoch: 204 train_loss: 0.3055 train_acc: 91.2109
Epoch: 205 train_loss: 0.3221 train_acc: 89.8438
Epoch: 206 train_loss: 0.3358 train_acc: 90.6250
Epoch: 207 train_loss: 0.3146 train_acc: 89.2578
Epoch: 208 train_loss: 0.3246 train_acc: 91.2109
Epoch: 209 train_loss: 0.3149 train_acc: 90.0391
Epoch: 210 train_loss: 0.3111 train_acc: 89.4531
Epoch: 211 train_loss: 0.2897 train_acc: 91.2109
Epoch: 212 train_loss: 0.3202 train_acc: 90.2344
Epoch: 213 train_loss: 0.2887 train_acc: 92.1875
Epoch: 214 train_loss: 0.2807 train_acc: 93.1641
Epoch: 215 train_loss: 0.2505 train_acc: 93.3594
Epoch: 216 train_loss: 0.3003 train_acc: 90.6250
Epoch: 217 train_loss: 0.2202 train_acc: 94.7266
Epoch: 218 train_loss: 0.2475 train_acc: 93.7500
Epoch: 219 train_loss: 0.2519 train_acc: 91.6016
Epoch: 220 train_loss: 0.2356 train_acc: 93.3594
Epoch: 221 train_loss: 0.2284 train_acc: 95.3125
Epoch: 222 train_loss: 0.2346 train_acc: 92.9688
Epoch: 223 train_loss: 0.2626 train_acc: 93.5547
Epoch: 224 train_loss: 0.2447 train_acc: 92.9688
Epoch: 225 train_loss: 0.2704 train_acc: 92.1875
Epoch: 226 train_loss: 0.2558 train_acc: 92.3828
Epoch: 227 train_loss: 0.2466 train_acc: 93.5547
Epoch: 228 train_loss: 0.2652 train_acc: 92.5781
Epoch: 229 train_loss: 0.2552 train_acc: 93.7500
Epoch: 230 train_loss: 0.2143 train_acc: 95.3125
Epoch: 231 train_loss: 0.2467 train_acc: 94.9219
Epoch: 232 train_loss: 0.2605 train_acc: 93.9453
Epoch: 233 train_loss: 0.2294 train_acc: 93.3594
Epoch: 234 train_loss: 0.2335 train_acc: 94.5312
Epoch: 235 train_loss: 0.2412 train_acc: 93.1641
Epoch: 236 train_loss: 0.2370 train_acc: 91.6016
Epoch: 237 train_loss: 0.2162 train_acc: 93.9453
Epoch: 238 train_loss: 0.2151 train_acc: 94.3359
Epoch: 239 train_loss: 0.2375 train_acc: 93.7500
Epoch: 240 train_loss: 0.2473 train_acc: 92.7734
Epoch: 241 train_loss: 0.2482 train_acc: 91.9922
Epoch: 242 train_loss: 0.1933 train_acc: 95.5078
Epoch: 243 train_loss: 0.2243 train_acc: 93.3594
Epoch: 244 train_loss: 0.2206 train_acc: 94.3359
Epoch: 245 train_loss: 0.2765 train_acc: 92.5781
Epoch: 246 train_loss: 0.2985 train_acc: 91.0156
Epoch: 247 train_loss: 0.2381 train_acc: 93.5547
Epoch: 248 train_loss: 0.2597 train_acc: 92.3828
Epoch: 249 train_loss: 0.2019 train_acc: 94.9219
Epoch: 250 train_loss: 0.2311 train_acc: 93.7500
Epoch: 251 train_loss: 0.2613 train_acc: 92.5781
Epoch: 252 train_loss: 0.2474 train_acc: 92.5781
Epoch: 253 train_loss: 0.2314 train_acc: 93.7500
Epoch: 254 train_loss: 0.2091 train_acc: 93.9453
Epoch: 255 train_loss: 0.1912 train_acc: 94.7266
Epoch: 256 train_loss: 0.1971 train_acc: 94.9219
Epoch: 257 train_loss: 0.2093 train_acc: 94.1406
Epoch: 258 train_loss: 0.2169 train_acc: 94.1406
Epoch: 259 train_loss: 0.1934 train_acc: 94.7266
Epoch: 260 train_loss: 0.2103 train_acc: 93.9453
Epoch: 261 train_loss: 0.1853 train_acc: 94.3359
Epoch: 262 train_loss: 0.1857 train_acc: 95.1172
Epoch: 263 train_loss: 0.1634 train_acc: 97.2656
Epoch: 264 train_loss: 0.1867 train_acc: 94.7266
Epoch: 265 train_loss: 0.1954 train_acc: 94.7266
Epoch: 266 train_loss: 0.1925 train_acc: 94.9219
Epoch: 267 train_loss: 0.1938 train_acc: 95.1172
Epoch: 268 train_loss: 0.1662 train_acc: 95.5078
Epoch: 269 train_loss: 0.1768 train_acc: 95.5078
Epoch: 270 train_loss: 0.1813 train_acc: 95.1172
Epoch: 271 train_loss: 0.1741 train_acc: 95.7031
Epoch: 272 train_loss: 0.1700 train_acc: 95.7031
Epoch: 273 train_loss: 0.1721 train_acc: 95.3125
Epoch: 274 train_loss: 0.1865 train_acc: 95.1172
Epoch: 275 train_loss: 0.1639 train_acc: 96.8750
Epoch: 276 train_loss: 0.1830 train_acc: 95.5078
Epoch: 277 train_loss: 0.1658 train_acc: 95.3125
Epoch: 278 train_loss: 0.1727 train_acc: 94.9219
Epoch: 279 train_loss: 0.1740 train_acc: 96.0938
Epoch: 280 train_loss: 0.1778 train_acc: 95.3125
Epoch: 281 train_loss: 0.1998 train_acc: 94.3359
Epoch: 282 train_loss: 0.1835 train_acc: 95.7031
Epoch: 283 train_loss: 0.1736 train_acc: 95.8984
Epoch: 284 train_loss: 0.1557 train_acc: 95.8984
Epoch: 285 train_loss: 0.1360 train_acc: 96.6797
Epoch: 286 train_loss: 0.1687 train_acc: 96.4844
Epoch: 287 train_loss: 0.1719 train_acc: 95.7031
Epoch: 288 train_loss: 0.1699 train_acc: 95.5078
Epoch: 289 train_loss: 0.1872 train_acc: 95.3125
Epoch: 290 train_loss: 0.1778 train_acc: 95.8984
Epoch: 291 train_loss: 0.1664 train_acc: 95.7031
Epoch: 292 train_loss: 0.1528 train_acc: 96.8750
Epoch: 293 train_loss: 0.1908 train_acc: 95.1172
Epoch: 294 train_loss: 0.1934 train_acc: 95.7031
Epoch: 295 train_loss: 0.1981 train_acc: 93.9453
Epoch: 296 train_loss: 0.2040 train_acc: 94.5312
Epoch: 297 train_loss: 0.1759 train_acc: 95.8984
Epoch: 298 train_loss: 0.1572 train_acc: 96.8750
Epoch: 299 train_loss: 0.1576 train_acc: 95.8984
Epoch: 300 train_loss: 0.1539 train_acc: 96.8750
Running Time: 168.11
**************************************************
Final result:
OA: 0.7466 | AA: 0.6640 | Kappa: 0.7111
[0.25       0.73839352 0.5964467  0.69777778 0.79084967 0.93804035
 0.07407407 0.97797357 0.42105263 0.83423619 0.7422813  0.40852575
 1.         0.83361065 0.42234332 0.89772727]
**************************************************
Parameter:
dataset: Indian
flag_test: train
mode: CAF
gpu_id: 0
seed: 28
batch_size: 64
test_freq: 5
patches: 7
band_patches: 3
epoches: 300
learning_rate: 0.0005
gamma: 0.9
weight_decay: 0.005
height=145,width=145,band=200
**************************************************
patch is : 7
mirror_image shape : [151,151,200]
**************************************************
x_train shape = (512, 7, 7, 200), type = float64
x_test  shape = (9737, 7, 7, 200), type = float64
x_true  shape = (21025, 7, 7, 200), type = float64
**************************************************
x_train_band shape = (512, 147, 200), type = float64
x_test_band  shape = (9737, 147, 200), type = float64
x_true_band  shape = (21025, 147, 200), type = float64
**************************************************
y_train: shape = (512,) ,type = int64
y_test: shape = (9737,) ,type = int64
y_true: shape = (21025,) ,type = int64
**************************************************
start training
Epoch: 001 train_loss: 2.4777 train_acc: 20.8984
Epoch: 002 train_loss: 2.3644 train_acc: 24.0234
Epoch: 003 train_loss: 2.3054 train_acc: 24.4141
Epoch: 004 train_loss: 2.2357 train_acc: 30.2734
Epoch: 005 train_loss: 2.0671 train_acc: 36.1328
Epoch: 006 train_loss: 1.8846 train_acc: 36.5234
Epoch: 007 train_loss: 1.7882 train_acc: 38.0859
Epoch: 008 train_loss: 1.7349 train_acc: 40.6250
Epoch: 009 train_loss: 1.7259 train_acc: 39.4531
Epoch: 010 train_loss: 1.7023 train_acc: 40.4297
Epoch: 011 train_loss: 1.6677 train_acc: 41.6016
Epoch: 012 train_loss: 1.5951 train_acc: 44.7266
Epoch: 013 train_loss: 1.5782 train_acc: 44.7266
Epoch: 014 train_loss: 1.5287 train_acc: 46.8750
Epoch: 015 train_loss: 1.5066 train_acc: 47.2656
Epoch: 016 train_loss: 1.4876 train_acc: 46.2891
Epoch: 017 train_loss: 1.4656 train_acc: 48.6328
Epoch: 018 train_loss: 1.4631 train_acc: 47.6562
Epoch: 019 train_loss: 1.4209 train_acc: 49.2188
Epoch: 020 train_loss: 1.4181 train_acc: 48.2422
Epoch: 021 train_loss: 1.3862 train_acc: 49.4141
Epoch: 022 train_loss: 1.3621 train_acc: 50.5859
Epoch: 023 train_loss: 1.3518 train_acc: 50.0000
Epoch: 024 train_loss: 1.4267 train_acc: 47.8516
Epoch: 025 train_loss: 1.3595 train_acc: 51.7578
Epoch: 026 train_loss: 1.3525 train_acc: 51.9531
Epoch: 027 train_loss: 1.3241 train_acc: 50.1953
Epoch: 028 train_loss: 1.3091 train_acc: 52.5391
Epoch: 029 train_loss: 1.3095 train_acc: 51.9531
Epoch: 030 train_loss: 1.2762 train_acc: 53.1250
Epoch: 031 train_loss: 1.2796 train_acc: 55.0781
Epoch: 032 train_loss: 1.2748 train_acc: 53.9062
Epoch: 033 train_loss: 1.2547 train_acc: 53.5156
Epoch: 034 train_loss: 1.2418 train_acc: 53.9062
Epoch: 035 train_loss: 1.2252 train_acc: 57.2266
Epoch: 036 train_loss: 1.2526 train_acc: 55.0781
Epoch: 037 train_loss: 1.2324 train_acc: 54.8828
Epoch: 038 train_loss: 1.2222 train_acc: 54.2969
Epoch: 039 train_loss: 1.2040 train_acc: 55.2734
Epoch: 040 train_loss: 1.1732 train_acc: 56.4453
Epoch: 041 train_loss: 1.1979 train_acc: 56.0547
Epoch: 042 train_loss: 1.1942 train_acc: 56.4453
Epoch: 043 train_loss: 1.2032 train_acc: 56.8359
Epoch: 044 train_loss: 1.1773 train_acc: 57.0312
Epoch: 045 train_loss: 1.1619 train_acc: 56.8359
Epoch: 046 train_loss: 1.1445 train_acc: 58.2031
Epoch: 047 train_loss: 1.1272 train_acc: 59.7656
Epoch: 048 train_loss: 1.1172 train_acc: 57.0312
Epoch: 049 train_loss: 1.1968 train_acc: 55.6641
Epoch: 050 train_loss: 1.2727 train_acc: 53.3203
Epoch: 051 train_loss: 1.2108 train_acc: 56.0547
Epoch: 052 train_loss: 1.1792 train_acc: 56.2500
Epoch: 053 train_loss: 1.1592 train_acc: 57.4219
Epoch: 054 train_loss: 1.1224 train_acc: 59.1797
Epoch: 055 train_loss: 1.1168 train_acc: 59.7656
Epoch: 056 train_loss: 1.0925 train_acc: 61.5234
Epoch: 057 train_loss: 1.1023 train_acc: 58.7891
Epoch: 058 train_loss: 1.0717 train_acc: 59.1797
Epoch: 059 train_loss: 1.0805 train_acc: 60.1562
Epoch: 060 train_loss: 1.0556 train_acc: 63.0859
Epoch: 061 train_loss: 1.1059 train_acc: 59.1797
Epoch: 062 train_loss: 1.1057 train_acc: 56.8359
Epoch: 063 train_loss: 1.1030 train_acc: 60.7422
Epoch: 064 train_loss: 1.0969 train_acc: 61.3281
Epoch: 065 train_loss: 1.1285 train_acc: 56.4453
Epoch: 066 train_loss: 1.0824 train_acc: 58.2031
Epoch: 067 train_loss: 1.0616 train_acc: 59.5703
Epoch: 068 train_loss: 1.0387 train_acc: 60.9375
Epoch: 069 train_loss: 1.0381 train_acc: 61.5234
Epoch: 070 train_loss: 1.0154 train_acc: 62.3047
Epoch: 071 train_loss: 1.0620 train_acc: 60.1562
Epoch: 072 train_loss: 1.0557 train_acc: 62.1094
Epoch: 073 train_loss: 0.9979 train_acc: 63.8672
Epoch: 074 train_loss: 0.9697 train_acc: 64.6484
Epoch: 075 train_loss: 0.9525 train_acc: 64.8438
Epoch: 076 train_loss: 0.9641 train_acc: 66.0156
Epoch: 077 train_loss: 0.9801 train_acc: 63.4766
Epoch: 078 train_loss: 0.9937 train_acc: 65.4297
Epoch: 079 train_loss: 0.9873 train_acc: 64.0625
Epoch: 080 train_loss: 0.9354 train_acc: 66.6016
Epoch: 081 train_loss: 0.9542 train_acc: 65.8203
Epoch: 082 train_loss: 0.9147 train_acc: 65.4297
Epoch: 083 train_loss: 0.9138 train_acc: 68.1641
Epoch: 084 train_loss: 0.9603 train_acc: 65.6250
Epoch: 085 train_loss: 0.9245 train_acc: 65.4297
Epoch: 086 train_loss: 0.9322 train_acc: 66.4062
Epoch: 087 train_loss: 0.9193 train_acc: 66.6016
Epoch: 088 train_loss: 0.8626 train_acc: 69.1406
Epoch: 089 train_loss: 0.8854 train_acc: 66.9922
Epoch: 090 train_loss: 0.8841 train_acc: 68.9453
Epoch: 091 train_loss: 0.8527 train_acc: 69.3359
Epoch: 092 train_loss: 0.8583 train_acc: 67.5781
Epoch: 093 train_loss: 0.8424 train_acc: 69.5312
Epoch: 094 train_loss: 0.8954 train_acc: 65.8203
Epoch: 095 train_loss: 0.8725 train_acc: 67.1875
Epoch: 096 train_loss: 0.8820 train_acc: 65.8203
Epoch: 097 train_loss: 0.8403 train_acc: 70.7031
Epoch: 098 train_loss: 0.8243 train_acc: 70.7031
Epoch: 099 train_loss: 0.9137 train_acc: 66.0156
Epoch: 100 train_loss: 0.8711 train_acc: 66.9922
Epoch: 101 train_loss: 0.8474 train_acc: 68.7500
Epoch: 102 train_loss: 0.8014 train_acc: 71.2891
Epoch: 103 train_loss: 0.8039 train_acc: 70.3125
Epoch: 104 train_loss: 0.7872 train_acc: 70.8984
Epoch: 105 train_loss: 0.8009 train_acc: 71.8750
Epoch: 106 train_loss: 0.7712 train_acc: 71.4844
Epoch: 107 train_loss: 0.7332 train_acc: 75.0000
Epoch: 108 train_loss: 0.7717 train_acc: 73.8281
Epoch: 109 train_loss: 0.7213 train_acc: 73.6328
Epoch: 110 train_loss: 0.7067 train_acc: 75.1953
Epoch: 111 train_loss: 0.7200 train_acc: 74.6094
Epoch: 112 train_loss: 0.6849 train_acc: 75.5859
Epoch: 113 train_loss: 0.7345 train_acc: 72.8516
Epoch: 114 train_loss: 0.6930 train_acc: 75.7812
Epoch: 115 train_loss: 0.6877 train_acc: 76.5625
Epoch: 116 train_loss: 0.6908 train_acc: 77.7344
Epoch: 117 train_loss: 0.6677 train_acc: 75.9766
Epoch: 118 train_loss: 0.6912 train_acc: 77.7344
Epoch: 119 train_loss: 0.6556 train_acc: 76.7578
Epoch: 120 train_loss: 0.6967 train_acc: 73.8281
Epoch: 121 train_loss: 0.6898 train_acc: 74.0234
Epoch: 122 train_loss: 0.6425 train_acc: 77.3438
Epoch: 123 train_loss: 0.6355 train_acc: 78.9062
Epoch: 124 train_loss: 0.6565 train_acc: 77.1484
Epoch: 125 train_loss: 0.6614 train_acc: 75.9766
Epoch: 126 train_loss: 0.6465 train_acc: 77.3438
Epoch: 127 train_loss: 0.7126 train_acc: 75.5859
Epoch: 128 train_loss: 0.6706 train_acc: 76.3672
Epoch: 129 train_loss: 0.6285 train_acc: 77.1484
Epoch: 130 train_loss: 0.6231 train_acc: 78.3203
Epoch: 131 train_loss: 0.5783 train_acc: 80.8594
Epoch: 132 train_loss: 0.5999 train_acc: 80.2734
Epoch: 133 train_loss: 0.5710 train_acc: 80.2734
Epoch: 134 train_loss: 0.5594 train_acc: 80.4688
Epoch: 135 train_loss: 0.5866 train_acc: 78.3203
Epoch: 136 train_loss: 0.6188 train_acc: 77.5391
Epoch: 137 train_loss: 0.6130 train_acc: 77.7344
Epoch: 138 train_loss: 0.5882 train_acc: 78.5156
Epoch: 139 train_loss: 0.6059 train_acc: 77.5391
Epoch: 140 train_loss: 0.5923 train_acc: 80.4688
Epoch: 141 train_loss: 0.5610 train_acc: 81.0547
Epoch: 142 train_loss: 0.5222 train_acc: 83.5938
Epoch: 143 train_loss: 0.5619 train_acc: 81.4453
Epoch: 144 train_loss: 0.5120 train_acc: 83.7891
Epoch: 145 train_loss: 0.5432 train_acc: 81.4453
Epoch: 146 train_loss: 0.5972 train_acc: 79.4922
Epoch: 147 train_loss: 0.5419 train_acc: 82.2266
Epoch: 148 train_loss: 0.5574 train_acc: 80.0781
Epoch: 149 train_loss: 0.5108 train_acc: 82.6172
Epoch: 150 train_loss: 0.5006 train_acc: 84.1797
Epoch: 151 train_loss: 0.4736 train_acc: 84.9609
Epoch: 152 train_loss: 0.5049 train_acc: 83.5938
Epoch: 153 train_loss: 0.5041 train_acc: 84.3750
Epoch: 154 train_loss: 0.4831 train_acc: 82.0312
Epoch: 155 train_loss: 0.5074 train_acc: 83.3984
Epoch: 156 train_loss: 0.4965 train_acc: 83.3984
Epoch: 157 train_loss: 0.4744 train_acc: 84.7656
Epoch: 158 train_loss: 0.4386 train_acc: 85.7422
Epoch: 159 train_loss: 0.4525 train_acc: 85.5469
Epoch: 160 train_loss: 0.4502 train_acc: 85.7422
Epoch: 161 train_loss: 0.4853 train_acc: 83.5938
Epoch: 162 train_loss: 0.4550 train_acc: 84.9609
Epoch: 163 train_loss: 0.4302 train_acc: 88.0859
Epoch: 164 train_loss: 0.3890 train_acc: 88.6719
Epoch: 165 train_loss: 0.4243 train_acc: 86.9141
Epoch: 166 train_loss: 0.4391 train_acc: 85.5469
Epoch: 167 train_loss: 0.4227 train_acc: 86.1328
Epoch: 168 train_loss: 0.4373 train_acc: 86.1328
Epoch: 169 train_loss: 0.4433 train_acc: 85.7422
Epoch: 170 train_loss: 0.5498 train_acc: 81.0547
Epoch: 171 train_loss: 0.5066 train_acc: 80.8594
Epoch: 172 train_loss: 0.4172 train_acc: 86.5234
Epoch: 173 train_loss: 0.4148 train_acc: 86.9141
Epoch: 174 train_loss: 0.3641 train_acc: 89.2578
Epoch: 175 train_loss: 0.3699 train_acc: 88.4766
Epoch: 176 train_loss: 0.4027 train_acc: 86.7188
Epoch: 177 train_loss: 0.4484 train_acc: 83.7891
Epoch: 178 train_loss: 0.4426 train_acc: 83.7891
Epoch: 179 train_loss: 0.4356 train_acc: 83.9844
Epoch: 180 train_loss: 0.4019 train_acc: 86.7188
Epoch: 181 train_loss: 0.3999 train_acc: 87.3047
Epoch: 182 train_loss: 0.4162 train_acc: 84.7656
Epoch: 183 train_loss: 0.3791 train_acc: 87.6953
Epoch: 184 train_loss: 0.3967 train_acc: 87.3047
Epoch: 185 train_loss: 0.4256 train_acc: 86.5234
Epoch: 186 train_loss: 0.3584 train_acc: 87.6953
Epoch: 187 train_loss: 0.3422 train_acc: 89.6484
Epoch: 188 train_loss: 0.3681 train_acc: 88.6719
Epoch: 189 train_loss: 0.3297 train_acc: 89.0625
Epoch: 190 train_loss: 0.3321 train_acc: 90.0391
Epoch: 191 train_loss: 0.3225 train_acc: 90.6250
Epoch: 192 train_loss: 0.3281 train_acc: 90.2344
Epoch: 193 train_loss: 0.3776 train_acc: 86.7188
Epoch: 194 train_loss: 0.3303 train_acc: 89.8438
Epoch: 195 train_loss: 0.3339 train_acc: 89.4531
Epoch: 196 train_loss: 0.3145 train_acc: 91.4062
Epoch: 197 train_loss: 0.3186 train_acc: 90.2344
Epoch: 198 train_loss: 0.2998 train_acc: 91.2109
Epoch: 199 train_loss: 0.2799 train_acc: 91.6016
Epoch: 200 train_loss: 0.3541 train_acc: 88.0859
Epoch: 201 train_loss: 0.2989 train_acc: 90.8203
Epoch: 202 train_loss: 0.2894 train_acc: 90.0391
Epoch: 203 train_loss: 0.3106 train_acc: 89.8438
Epoch: 204 train_loss: 0.2801 train_acc: 92.5781
Epoch: 205 train_loss: 0.2691 train_acc: 91.7969
Epoch: 206 train_loss: 0.2977 train_acc: 89.8438
Epoch: 207 train_loss: 0.3548 train_acc: 88.4766
Epoch: 208 train_loss: 0.2913 train_acc: 90.0391
Epoch: 209 train_loss: 0.3033 train_acc: 90.6250
Epoch: 210 train_loss: 0.3203 train_acc: 90.2344
Epoch: 211 train_loss: 0.3218 train_acc: 88.0859
Epoch: 212 train_loss: 0.2846 train_acc: 91.9922
Epoch: 213 train_loss: 0.2941 train_acc: 90.8203
Epoch: 214 train_loss: 0.2897 train_acc: 91.6016
Epoch: 215 train_loss: 0.3112 train_acc: 89.8438
Epoch: 216 train_loss: 0.2378 train_acc: 93.5547
Epoch: 217 train_loss: 0.2519 train_acc: 92.5781
Epoch: 218 train_loss: 0.3112 train_acc: 89.4531
Epoch: 219 train_loss: 0.2491 train_acc: 91.9922
Epoch: 220 train_loss: 0.2593 train_acc: 91.9922
Epoch: 221 train_loss: 0.2630 train_acc: 92.9688
Epoch: 222 train_loss: 0.2559 train_acc: 92.9688
Epoch: 223 train_loss: 0.2299 train_acc: 94.1406
Epoch: 224 train_loss: 0.2557 train_acc: 92.3828
Epoch: 225 train_loss: 0.2420 train_acc: 94.1406
Epoch: 226 train_loss: 0.2521 train_acc: 92.7734
Epoch: 227 train_loss: 0.2465 train_acc: 93.1641
Epoch: 228 train_loss: 0.2250 train_acc: 93.7500
Epoch: 229 train_loss: 0.2522 train_acc: 92.1875
Epoch: 230 train_loss: 0.2290 train_acc: 92.9688
Epoch: 231 train_loss: 0.2503 train_acc: 91.9922
Epoch: 232 train_loss: 0.2300 train_acc: 93.9453
Epoch: 233 train_loss: 0.2205 train_acc: 94.3359
Epoch: 234 train_loss: 0.2121 train_acc: 94.1406
Epoch: 235 train_loss: 0.2145 train_acc: 92.5781
Epoch: 236 train_loss: 0.1861 train_acc: 94.5312
Epoch: 237 train_loss: 0.2243 train_acc: 92.5781
Epoch: 238 train_loss: 0.2440 train_acc: 91.7969
Epoch: 239 train_loss: 0.2083 train_acc: 93.1641
Epoch: 240 train_loss: 0.2042 train_acc: 94.3359
Epoch: 241 train_loss: 0.2196 train_acc: 94.7266
Epoch: 242 train_loss: 0.2396 train_acc: 93.9453
Epoch: 243 train_loss: 0.1863 train_acc: 94.9219
Epoch: 244 train_loss: 0.2229 train_acc: 93.5547
Epoch: 245 train_loss: 0.2409 train_acc: 92.9688
Epoch: 246 train_loss: 0.2418 train_acc: 92.5781
Epoch: 247 train_loss: 0.1978 train_acc: 94.5312
Epoch: 248 train_loss: 0.2175 train_acc: 93.9453
Epoch: 249 train_loss: 0.2523 train_acc: 92.7734
Epoch: 250 train_loss: 0.2481 train_acc: 91.7969
Epoch: 251 train_loss: 0.2259 train_acc: 92.9688
Epoch: 252 train_loss: 0.2389 train_acc: 92.9688
Epoch: 253 train_loss: 0.1889 train_acc: 94.5312
Epoch: 254 train_loss: 0.1947 train_acc: 93.5547
Epoch: 255 train_loss: 0.1966 train_acc: 94.9219
Epoch: 256 train_loss: 0.2479 train_acc: 92.1875
Epoch: 257 train_loss: 0.2248 train_acc: 91.9922
Epoch: 258 train_loss: 0.2534 train_acc: 91.7969
Epoch: 259 train_loss: 0.2145 train_acc: 94.1406
Epoch: 260 train_loss: 0.2151 train_acc: 94.1406
Epoch: 261 train_loss: 0.1996 train_acc: 94.1406
Epoch: 262 train_loss: 0.2175 train_acc: 92.9688
Epoch: 263 train_loss: 0.2335 train_acc: 92.9688
Epoch: 264 train_loss: 0.2045 train_acc: 94.9219
Epoch: 265 train_loss: 0.1976 train_acc: 95.3125
Epoch: 266 train_loss: 0.2026 train_acc: 93.9453
Epoch: 267 train_loss: 0.1827 train_acc: 96.0938
Epoch: 268 train_loss: 0.1725 train_acc: 95.7031
Epoch: 269 train_loss: 0.1674 train_acc: 96.0938
Epoch: 270 train_loss: 0.1781 train_acc: 95.5078
Epoch: 271 train_loss: 0.1687 train_acc: 95.5078
Epoch: 272 train_loss: 0.1687 train_acc: 95.1172
Epoch: 273 train_loss: 0.1470 train_acc: 97.0703
Epoch: 274 train_loss: 0.1789 train_acc: 93.3594
Epoch: 275 train_loss: 0.1646 train_acc: 96.2891
Epoch: 276 train_loss: 0.1695 train_acc: 95.5078
Epoch: 277 train_loss: 0.1862 train_acc: 95.3125
Epoch: 278 train_loss: 0.2007 train_acc: 94.9219
Epoch: 279 train_loss: 0.2059 train_acc: 93.7500
Epoch: 280 train_loss: 0.1924 train_acc: 95.3125
Epoch: 281 train_loss: 0.1617 train_acc: 96.6797
Epoch: 282 train_loss: 0.1678 train_acc: 95.8984
Epoch: 283 train_loss: 0.1552 train_acc: 96.2891
Epoch: 284 train_loss: 0.1546 train_acc: 97.2656
Epoch: 285 train_loss: 0.1807 train_acc: 94.7266
Epoch: 286 train_loss: 0.1887 train_acc: 95.3125
Epoch: 287 train_loss: 0.1594 train_acc: 95.8984
Epoch: 288 train_loss: 0.1682 train_acc: 96.0938
Epoch: 289 train_loss: 0.1555 train_acc: 96.0938
Epoch: 290 train_loss: 0.1640 train_acc: 95.8984
Epoch: 291 train_loss: 0.2212 train_acc: 93.1641
Epoch: 292 train_loss: 0.1734 train_acc: 94.7266
Epoch: 293 train_loss: 0.1812 train_acc: 95.7031
Epoch: 294 train_loss: 0.2024 train_acc: 93.9453
Epoch: 295 train_loss: 0.1791 train_acc: 95.1172
Epoch: 296 train_loss: 0.1987 train_acc: 95.7031
Epoch: 297 train_loss: 0.2241 train_acc: 92.7734
Epoch: 298 train_loss: 0.1789 train_acc: 94.5312
Epoch: 299 train_loss: 0.1889 train_acc: 95.1172
Epoch: 300 train_loss: 0.1473 train_acc: 97.2656
Running Time: 167.87
**************************************************
Final result:
OA: 0.7632 | AA: 0.6606 | Kappa: 0.7312
[0.36363636 0.75460575 0.75253807 0.32444444 0.69063181 0.88904899
 0.07407407 0.87665198 0.42105263 0.84940412 0.73198971 0.56305506
 0.90769231 0.92845258 0.55585831 0.88636364]
**************************************************
Parameter:
dataset: Indian
flag_test: train
mode: CAF
gpu_id: 0
seed: 29
batch_size: 64
test_freq: 5
patches: 7
band_patches: 3
epoches: 300
learning_rate: 0.0005
gamma: 0.9
weight_decay: 0.005
OAS: [0.7954195337372908, 0.6979562493581185, 0.7515661908185273, 0.7761117387285612, 0.7928520078052789, 0.8100030810311184, 0.7324637978843587, 0.7217828900071891, 0.7584471603163192, 0.7560850364588683, 0.7976789565574612, 0.7667659443360378, 0.7108965800554585, 0.7725172024237444, 0.6582109479305741, 0.7289719626168224, 0.7406798808667967, 0.7621443976584164, 0.7881277600903769, 0.7339016124062853, 0.8241758241758241, 0.7907979870596693, 0.7326691999589195, 0.7048372188559104, 0.7645065215158673, 0.7519769949676491, 0.7533121084522953, 0.7340043134435658, 0.7466365410290644, 0.7631714080312211]
AAS: [0.6607845696749234, 0.5777512370201185, 0.6083414930755177, 0.6286333296594371, 0.667008016143494, 0.7042991364270152, 0.5822723293691495, 0.6096118307200857, 0.6427475810215464, 0.6301780050443349, 0.6961576227725339, 0.6430172273219039, 0.5794382117556294, 0.6303671338138688, 0.5206481706752004, 0.581667043212521, 0.6352658568127698, 0.6498425849630896, 0.6542768373215605, 0.6000973565169403, 0.7077156293486859, 0.6581124796774772, 0.6001747983418553, 0.6248780234236289, 0.6233113282533793, 0.5951356825648277, 0.5843496574097862, 0.6179754723972793, 0.6639582985676897, 0.6605937397552866]
Kappas: [0.767628426956156, 0.6574531652874549, 0.7141335039015265, 0.7432290905209433, 0.7645331717413463, 0.7830120939337453, 0.6938806494558142, 0.6839149829610887, 0.727921110677198, 0.722825437512203, 0.7701461103590669, 0.7359321656493985, 0.6720207333368879, 0.7384529637885597, 0.6071716767950243, 0.6917570166129973, 0.7042826725643846, 0.7301847824924297, 0.759209225396043, 0.6960136877039069, 0.7998678074753006, 0.7597156299579786, 0.695784986595792, 0.66777344592399, 0.7311568212752027, 0.7163031105507782, 0.7153698227347236, 0.6982292655040591, 0.7110517961026529, 0.7312123532615232]
